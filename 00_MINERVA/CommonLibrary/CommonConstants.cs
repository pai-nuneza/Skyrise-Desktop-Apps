using System;
using System.Collections.Generic;
using System.Text;


namespace CommonLibrary
{
    public class CommonConstants
    {
        #region tableName

        public class TableName
        {
            public const string GenericMaster = "T_GenericMaster";
            public const string T_DTR = "T_DTR";
            public const string T_LogMaster = "T_LogMaster";


            public const string T_EmpBonusHdr = "T_EmpBonusHdr";
            public const string T_EmpBonusDtl = "T_EmpBonusDtl";
            public const string T_EmpBonusHdrHst = "T_EmpBonusHdrHst";
            public const string T_EmpBonusDtlHst = "T_EmpBonusDtlHst";
            public const string T_EmpLeaveRefundDtl = "T_EmpLeaveRefundDtl";
            public const string T_EmpLeaveRefundDtlHst = "T_EmpLeaveRefundDtlHst";
            public const string T_EmpLeaveRefundHdr = "T_EmpLeaveRefundHdr";
            public const string T_EmpLeaveRefundHdrHst = "T_EmpLeaveRefundHdrHst";
            public const string T_EmpLeaveRefundRule = "T_EmpLeaveRefundRule";
            public const string T_EmpLeaveRefundRuleHst = "T_EmpLeaveRefundRuleHst";
            public const string T_EmpLeaveCreditDtl = "T_EmpLeaveCreditDtl";
            public const string T_EmpLeaveCreditDtlHst = "T_EmpLeaveCreditDtlHst";
            public const string T_EmpLeaveCreditHdr = "T_EmpLeaveCreditHdr";
            public const string T_EmpLeaveCreditHdrHst = "T_EmpLeaveCreditHdrHst";
            public const string T_EmpLeaveCreditRule = "T_EmpLeaveCreditRule";
            public const string T_EmpLeaveCreditRuleHst = "T_EmpLeaveCreditRuleHst";
            public const string T_EmpAttendanceDtl = "T_EmpAttendanceDtl";
            public const string T_EmpAttendanceDtlHst = "T_EmpAttendanceDtlHst";
            public const string T_EmpAttendanceException = "T_EmpAttendanceException";
            public const string T_EmpAttendanceExceptionHst = "T_EmpAttendanceExceptionHst";
            public const string T_EmpAttendanceHdr = "T_EmpAttendanceHdr";
            public const string T_EmpAttendanceHdrHst = "T_EmpAttendanceHdrHst";
            public const string T_EmpAttendanceRule = "T_EmpAttendanceRule";
            public const string T_EmpAttendanceRuleHst = "T_EmpAttendanceRuleHst";
            public const string T_EmpGovLoanRemittance = "T_EmpGovLoanRemittance";
            public const string T_EmpGovPremRemittance = "T_EmpGovPremRemittance";
            public const string T_EmpSpecialGovLoanRemittance = "T_EmpSpecialGovLoanRemittance";
            public const string T_EmpSpecialGovPremRemittance = "T_EmpSpecialGovPremRemittance";

            //---------------------------------------------------------------------------------------------------------
            // Central Tables
            public const string M_Account = "M_Account";
            public const string M_AccountLink = "M_AccountLink";
            public const string M_AccountMappingDtl = "M_AccountMappingDtl";
            public const string M_AccountMappingHdr = "M_AccountMappingHdr";
            public const string M_ApprovalRoute = "M_ApprovalRoute";
            public const string M_ApprovalRouteTrl = "M_ApprovalRouteTrl";
            public const string M_Asset = "M_Asset";
            public const string M_AttendanceRuleDtl = "M_AttendanceRuleDtl";
            public const string M_AttendanceRuleDtlTrl = "M_AttendanceRuleDtlTrl";
            public const string M_AttendanceRuleHdr = "M_AttendanceRuleHdr";
            public const string M_AttendanceRuleHdrTrl = "M_AttendanceRuleHdrTrl";
            public const string M_Authority = "M_Authority";
            public const string M_Bank = "M_Bank";
            public const string M_BankTrl = "M_BankTrl";
            public const string M_Bonus = "M_Bonus";
            public const string M_BonusTrl = "M_BonusTrl";
            public const string M_CodeDtl = "M_CodeDtl";
            public const string M_CodeDtlTrl = "M_CodeDtlTrl";
            public const string M_CodeHdr = "M_CodeHdr";
            public const string M_CodeHdrTrl = "M_CodeHdrTrl";
            public const string M_Company = "M_Company";
            public const string M_CompanyTrl = "M_CompanyTrl";
            public const string M_CostCenter = "M_CostCenter";
            public const string M_CostCenterTrl = "M_CostCenterTrl";
            public const string M_Day = "M_Day";
            public const string M_DayTrl = "M_DayTrl";
            public const string M_DayDisplay = "M_DayDisplay";
            public const string M_DayPremium = "M_DayPremium";
            public const string M_DayPremiumTrl = "M_DayPremiumTrl";
            public const string M_Deduction = "M_Deduction";
            public const string M_DeductionTrl = "M_DeductionTrl";
            public const string M_Department = "M_Department";
            public const string M_DepartmentTrl = "M_DepartmentTrl";
            public const string M_Division = "M_Division";
            public const string M_DivisionTrl = "M_DivisionTrl";
            public const string M_DocumentSignatory = "M_DocumentSignatory";
            public const string M_DocumentTag = "M_DocumentTag";
            public const string M_DocumentTagType = "M_DocumentTagType";
            public const string M_DocumentType = "M_DocumentType";
            public const string M_DynamicMenu = "M_DynamicMenu";
            public const string M_EmpEducation = "M_EmpEducation";
            public const string M_EmpFamily = "M_EmpFamily";
            public const string M_EmpImage = "M_EmpImage";
            public const string M_Employee = "M_Employee";
            public const string M_EmployeeHst = "M_EmployeeHst";
            public const string M_EmpSpecialRemittance = "M_EmpSpecialRemittance";
            public const string M_EmpUnion = "M_EmpUnion";
            public const string M_Evaluation = "M_Evaluation";
            public const string M_Formula = "M_Formula";
            public const string M_GovRemittance = "M_GovRemittance";
            public const string M_GovRemittanceFile = "M_GovRemittanceFile";
            public const string M_GovRemittanceTrl = "M_GovRemittanceTrl";
            public const string M_Income = "M_Income";
            public const string M_IncomeTrl = "M_IncomeTrl";
            public const string M_InterfaceFileDtl = "M_InterfaceFileDtl";
            public const string M_InterfaceFileHdr = "M_InterfaceFileHdr";
            public const string M_Leave = "M_Leave";
            public const string M_LeaveCredit = "M_LeaveCredit";
            public const string M_LeaveTrl = "M_LeaveTrl";
            public const string M_MiscellaneousDay = "M_MiscellaneousDay";
            public const string M_MiscellaneousDayTrl = "M_MiscellaneousDayTrl";
            public const string M_OffenseDtl = "M_OffenseDtl";
            public const string M_OffenseHdr = "M_OffenseHdr";
            public const string M_Overtime = "M_Overtime";
            public const string M_Password = "M_Password";
            public const string M_PolicyCategoryDtl = "M_PolicyCategoryDtl";
            public const string M_PolicyCategoryHdr = "M_PolicyCategoryHdr";
            public const string M_PolicyDtl = "M_PolicyDtl";
            public const string M_PolicyDtlTrl = "M_PolicyDtlTrl";
            public const string M_PolicyHdr = "M_PolicyHdr";
            public const string M_PolicyHdrTrl = "M_PolicyHdrTrl";
            public const string M_Position = "M_Position";
            public const string M_PremiumSchedule = "M_PremiumSchedule";
            public const string M_PremiumScheduleTrl = "M_PremiumScheduleTrl";
            public const string M_Process = "M_Process";
            public const string M_ProcessTrl = "M_ProcessTrl";
            public const string M_Query = "M_Query";
            public const string M_QueryColumn = "M_QueryColumn";
            public const string M_Retirement = "M_Retirement";
            public const string M_Section = "M_Section";
            public const string M_SectionTrl = "M_SectionTrl";
            public const string M_Service = "M_Service";
            public const string M_ServiceSchedule = "M_ServiceSchedule";
            public const string M_Shift = "M_Shift";
            public const string M_ShiftTrl = "M_ShiftTrl";
            public const string M_Signatory = "M_Signatory";
            public const string M_Skill = "M_Skill";
            public const string M_SubDocument = "M_SubDocument";
            public const string M_SubSection = "M_SubSection";
            public const string M_SubSectionTrl = "M_SubSectionTrl";
            public const string M_Tax = "M_Tax";
            public const string M_TaxTrl = "M_TaxTrl"; 
            public const string M_TaxExemption = "M_TaxExemption";
            public const string M_TaxScheduleDtl = "M_TaxScheduleDtl";
            public const string M_TaxScheduleDtlTrl = "M_TaxScheduleDtlTrl";
            public const string M_TaxScheduleHdr = "M_TaxScheduleHdr";
            public const string M_TaxScheduleHdrTrl = "M_TaxScheduleHdrTrl";
            public const string M_Terminology = "M_Terminology";
            public const string M_Training = "M_Training";
            public const string M_Transpo = "M_Transpo";
            public const string M_User = "M_User";
            public const string M_UserCustomQuery = "M_UserCustomQuery";
            public const string M_UserDocumentType = "M_UserDocumentType";
            public const string M_UserDocumentTypeTrl = "M_UserDocumentTypeTrl";
            public const string M_UserDtl = "M_UserDtl";
            public const string M_UserDtlTrl = "M_UserDtlTrl";
            public const string M_UserExt = "M_UserExt";
            public const string M_UserExtTmp = "M_UserExtTmp";
            public const string M_UserExtTrl = "M_UserExtTrl";
            public const string M_UserProfile = "M_UserProfile";
            public const string M_UserProfileTrl = "M_UserProfileTrl";
            public const string M_UserQueryAccess = "M_UserQueryAccess";
            public const string M_UserRoleAccess = "M_UserRoleAccess";
            public const string M_UserRoleAccessTrl = "M_UserRoleAccessTrl";
            public const string M_UserServiceRecipient = "M_UserServiceRecipient";
            public const string M_VariableAllowance = "M_VariableAllowance";
            public const string M_VarianceAllowanceDtl = "M_VarianceAllowanceDtl";
            public const string M_VarianceAllowanceHdr = "M_VarianceAllowanceHdr";
            public const string M_YearlyTaxSchedule = "M_YearlyTaxSchedule";

            public const string M_UserHdr = "M_UserHdr";
            public const string T_Announcement = "T_Announcement";
            public const string T_AuditTrl = "T_AuditTrl";
            public const string T_Calendar = "T_Calendar";
            public const string T_CalendarTemp = "T_CalendarTemp";
            public const string T_DocumentNumber = "T_DocumentNumber";
            public const string T_EmailSending = "T_EmailSending";
            public const string T_EmpAchievement = "T_EmpAchievement";
            public const string T_Alphalist = "T_Alphalist";
            public const string T_EmpAlphalistDtl = "T_EmpAlphalistDtl";
            public const string T_EmpAlphalistDtlHst = "T_EmpAlphalistDtlHst";
            public const string T_EmpAlphalistHdr = "T_EmpAlphalistHdr";
            public const string T_EmpAlphalistHdrHst = "T_EmpAlphalistHdrHst";
            public const string T_EmpAlphalistStaging = "T_EmpAlphalistStaging";
            public const string T_EmpApprovalRoute = "T_EmpApprovalRoute";
            public const string T_EmpAsset = "T_EmpAsset";
            public const string T_EmpAssumeDays = "T_EmpAssumeDays";
            public const string T_EmpCalendarGroup = "T_EmpCalendarGroup";
            public const string T_EmpCommunityTax = "T_EmpCommunityTax";
            public const string T_EmpCostcenter = "T_EmpCostcenter";
            public const string T_EmpDeductionDefer = "T_EmpDeductionDefer";
            public const string T_EmpDeductionDtl = "T_EmpDeductionDtl";
            public const string T_EmpDeductionDtlFinalPay = "T_EmpDeductionDtlFinalPay";
            public const string T_EmpDeductionDtlFullPayHst = "T_EmpDeductionDtlFullPayHst";
            public const string T_EmpDeductionDtlHst = "T_EmpDeductionDtlHst";
            public const string T_EmpDeductionExempt = "T_EmpDeductionExempt";
            public const string T_EmpDeductionHdr = "T_EmpDeductionHdr";
            public const string T_EmpDeductionHdrCycle = "T_EmpDeductionHdrCycle";
            public const string T_EmpDeductionHdrCycleFinalPay = "T_EmpDeductionHdrCycleFinalPay";
            public const string T_EmpDeductionHdrCycleFinalPayHst = "T_EmpDeductionHdrCycleFinalPayHst";
            public const string T_EmpDeductionHdrHst = "T_EmpDeductionHdrHst";
            public const string T_EmpDeductionHdrTrl = "T_EmpDeductionHdrTrl";
            public const string T_EmpDesignation = "T_EmpDesignation";
            public const string T_EmpDocumentExpiry = "T_EmpDocumentExpiry";
            public const string T_EmpEmploymentStatus = "T_EmpEmploymentStatus";
            public const string T_EmpEvaluation = "T_EmpEvaluation";
            public const string T_EmpFixAllowance = "T_EmpFixAllowance";
            public const string T_EmpGovRemittance = "T_EmpGovRemittance";
            public const string T_EmpGovRemittanceFinalPay = "T_EmpGovRemittanceFinalPay";
            public const string T_EmpIDTrail = "T_EmpIDTrail";
            public const string T_EmpIncome = "T_EmpIncome";
            public const string T_EmpIncomeFinalPay = "T_EmpIncomeFinalPay";
            public const string T_EmpIncomeFinalPayHst = "T_EmpIncomeFinalPayHst";
            public const string T_EmpIncomeHst = "T_EmpIncomeHst";
            public const string T_EmpIncomeRemoval = "T_EmpIncomeRemoval";
            public const string T_EmpFinalPay = "T_EmpFinalPay";
            public const string T_EmpFinalPayHst = "T_EmpFinalPayHst";
            public const string T_EmpLeave = "T_EmpLeave";
            public const string T_EmpLeaveArc = "T_EmpLeaveArc";
            public const string T_EmpLeaveLdgCycleHst = "T_EmpLeaveLdgCycleHst";
            public const string T_EmpDeductionHdrCycleHst = "T_EmpDeductionHdrCycleHst";
            public const string T_EmpLeaveHst = "T_EmpLeaveHst";
            public const string T_EmpLeaveLdg = "T_EmpLeaveLdg";
            public const string T_EmpLeaveLdgCycle = "T_EmpLeaveLdgCycle";
            public const string T_EmpLeaveLdgHst = "T_EmpLeaveLdgHst";
            public const string T_EmpLeaveLdgTrl = "T_EmpLeaveLdgTrl";
            public const string T_EmpLogControl = "T_EmpLogControl";
            public const string T_EmpOvertime = "T_EmpOvertime";
            public const string T_EmpOvertimeArc = "T_EmpOvertimeArc";
            public const string T_EmpOvertimeHst = "T_EmpOvertimeHst";
            public const string T_EmpTimeCorrection = "T_EmpTimeCorrection";
            public const string T_EmpTimeCorrectionHst = "T_EmpTimeCorrectionHst";
            public const string T_EmpManualAdj = "T_EmpManualAdj";
            public const string T_EmpManualAdj2 = "T_EmpManualAdj2";
            public const string T_EmpManualAdjFinalPay = "T_EmpManualAdjFinalPay";
            public const string T_EmpManualAdj2FinalPay = "T_EmpManualAdj2FinalPay";
            public const string T_EmpManualAdjFinalPayHst = "T_EmpManualAdjFinalPayHst";
            public const string T_EmpManualAdj2FinalPayHst = "T_EmpManualAdj2FinalPayHst";
            public const string T_EmpManualAdjHst = "T_EmpManualAdjHst";
            public const string T_EmpManualAdj2Hst = "T_EmpManualAdj2Hst";
            public const string T_EmpManualAdjMisc = "T_EmpManualAdjMisc";
            public const string T_EmpManualAdjMisc2 = "T_EmpManualAdjMisc2";
            public const string T_EmpManualAdjMiscFinalPay = "T_EmpManualAdjMiscFinalPay";
            public const string T_EmpManualAdjMisc2FinalPay = "T_EmpManualAdjMisc2FinalPay";
            public const string T_EmpManualAdjMiscFinalPayHst = "T_EmpManualAdjMiscFinalPayHst";
            public const string T_EmpManualAdjMisc2FinalPayHst = "T_EmpManualAdjMisc2FinalPayHst";
            public const string T_EmpManualAdjMiscHst = "T_EmpManualAdjMiscHst";
            public const string T_EmpManualAdjMisc2Hst = "T_EmpManualAdjMisc2Hst";
            public const string T_EmpNotes = "T_EmpNotes";
            public const string T_EmpOffense = "T_EmpOffense";
            

            public const string T_EmpPayroll = "T_EmpPayroll";
            public const string T_EmpPayrollHst = "T_EmpPayrollHst";
            public const string T_EmpPayrollMisc = "T_EmpPayrollMisc";
            public const string T_EmpPayrollMiscHst = "T_EmpPayrollMiscHst";

            public const string T_EmpPayroll2 = "T_EmpPayroll2";
            public const string T_EmpPayroll2Hst = "T_EmpPayroll2Hst";

            public const string T_EmpPayrollYearly = "T_EmpPayrollYearly";
            public const string T_EmpPayroll2Yearly = "T_EmpPayroll2Yearly";
            public const string T_EmpPayrollMiscYearly = "T_EmpPayrollMiscYearly";

            public const string T_EmpPayrollDtl = "T_EmpPayrollDtl";
            public const string T_EmpPayrollDtlHst = "T_EmpPayrollDtlHst";
            public const string T_EmpPayrollDtlMisc = "T_EmpPayrollDtlMisc";
            public const string T_EmpPayrollDtlMiscHst = "T_EmpPayrollDtlMiscHst";

            public const string T_EmpPayrollFinalPay = "T_EmpPayrollFinalPay";
            public const string T_EmpPayrollFinalPayHst = "T_EmpPayrollFinalPayHst";
            public const string T_EmpPayrollMiscFinalPay = "T_EmpPayrollMiscFinalPay";
            public const string T_EmpPayrollMiscFinalPayHst = "T_EmpPayrollMiscFinalPayHst";

            public const string T_EmpPayroll2FinalPay = "T_EmpPayroll2FinalPay";
            public const string T_EmpPayroll2FinalPayHst = "T_EmpPayroll2FinalPayHst";

            public const string T_EmpPayrollDtlFinalPay = "T_EmpPayrollDtlFinalPay";
            public const string T_EmpPayrollDtlFinalPayHst = "T_EmpPayrollDtlFinalPayHst";
            public const string T_EmpPayrollDtlMiscFinalPay = "T_EmpPayrollDtlMiscFinalPay";
            public const string T_EmpPayrollDtlMiscFinalPayHst = "T_EmpPayrollDtlMiscFinalPayHst";

            public const string T_EmpPayrollRetro = "T_EmpPayrollRetro";
            public const string T_EmpPayrollRetroHst = "T_EmpPayrollRetroHst";
            public const string T_EmpPayrollMiscRetro = "T_EmpPayrollMiscRetro";
            public const string T_EmpPayrollMiscRetroHst = "T_EmpPayrollMiscRetroHst";
            public const string T_EmpPayrollDtlRetro = "T_EmpPayrollDtlRetro";
            public const string T_EmpPayrollDtlRetroHst = "T_EmpPayrollDtlRetroHst";
            public const string T_EmpPayrollDtlMiscRetro = "T_EmpPayrollDtlMiscRetro";
            public const string T_EmpPayrollDtlMiscRetroHst = "T_EmpPayrollDtlMiscRetroHst";

            public const string T_EmpProcessCheck = "T_EmpProcessCheck";
            public const string T_EmpProcessCheckHst = "T_EmpProcessCheckHst";
            public const string T_EmpPayrollTrack = "T_EmpPayrollTrack";

            public const string T_EmpPayTranDtl = "T_EmpPayTranDtl";
            public const string T_EmpPayTranDtlArc = "T_EmpPayTranDtlArc";
            public const string T_EmpPayTranDtlFinalPay = "T_EmpPayTranDtlFinalPay";
            public const string T_EmpPayTranDtlFinalPayHst = "T_EmpPayTranDtlFinalPayHst";
            public const string T_EmpPayTranDtlHst = "T_EmpPayTranDtlHst";
            public const string T_EmpPayTranDtlMisc = "T_EmpPayTranDtlMisc";
            public const string T_EmpPayTranDtlMiscArc = "T_EmpPayTranDtlMiscArc";
            public const string T_EmpPayTranDtlMiscFinalPay = "T_EmpPayTranDtlMiscFinalPay";
            public const string T_EmpPayTranDtlMiscFinalPayHst = "T_EmpPayTranDtlMiscFinalPayHst";
            public const string T_EmpPayTranDtlMiscHst = "T_EmpPayTranDtlMiscHst";
            public const string T_EmpPayTranDtlMiscTrl = "T_EmpPayTranDtlMiscTrl";
            public const string T_EmpPayTranDtlTrl = "T_EmpPayTranDtlTrl";
            public const string T_EmpPayTranHdr = "T_EmpPayTranHdr";
            public const string T_EmpPayTranHdrArc = "T_EmpPayTranHdrArc";
            public const string T_EmpPayTranHdrFinalPay = "T_EmpPayTranHdrFinalPay";
            public const string T_EmpPayTranHdrFinalPayHst = "T_EmpPayTranHdrFinalPayHst";
            public const string T_EmpPayTranHdrHst = "T_EmpPayTranHdrHst";
            public const string T_EmpPayTranHdrMisc = "T_EmpPayTranHdrMisc";
            public const string T_EmpPayTranHdrMiscArc = "T_EmpPayTranHdrMiscArc";
            public const string T_EmpPayTranHdrMiscFinalPay = "T_EmpPayTranHdrMiscFinalPay";
            public const string T_EmpPayTranHdrMiscFinalPayHst = "T_EmpPayTranHdrMiscFinalPayHst";
            public const string T_EmpPayTranHdrMiscHst = "T_EmpPayTranHdrMiscHst";
            public const string T_EmpPayTranHdrMiscTrl = "T_EmpPayTranHdrMiscTrl";
            public const string T_EmpPayTranHdrTrl = "T_EmpPayTranHdrTrl";
            public const string T_EmpPosition = "T_EmpPosition";
            public const string T_EmpPremiumGroup = "T_EmpPremiumGroup";
            public const string T_EmpRest = "T_EmpRest";
            public const string T_EmpSalary = "T_EmpSalary";
            public const string T_EmpSalaryTrl = "T_EmpSalaryTrl";
            public const string T_EmpSystemAdj = "T_EmpSystemAdj";
            public const string T_EmpSystemAdj2 = "T_EmpSystemAdj2";
            public const string T_EmpSystemAdjFinalPay = "T_EmpSystemAdjFinalPay";
            public const string T_EmpSystemAdj2FinalPay = "T_EmpSystemAdj2FinalPay";
            public const string T_EmpSystemAdjArc = "T_EmpSystemAdjArc";
            public const string T_EmpSystemAdjHst = "T_EmpSystemAdjHst";
            public const string T_EmpSystemAdj2Hst = "T_EmpSystemAdj2Hst";
            public const string T_EmpSystemAdj2FinalPayHst = "T_EmpSystemAdj2FinalPayHst";
            public const string T_EmpSystemAdjFinalPayHst = "T_EmpSystemAdjFinalPayHst";
            public const string T_EmpSystemAdjMisc = "T_EmpSystemAdjMisc";
            public const string T_EmpSystemAdjMisc2 = "T_EmpSystemAdjMisc2";
            public const string T_EmpSystemAdjMiscFinalPay = "T_EmpSystemAdjMiscFinalPay";
            public const string T_EmpSystemAdjMisc2FinalPay = "T_EmpSystemAdjMisc2FinalPay";
            public const string T_EmpSystemAdjMiscArc = "T_EmpSystemAdjMiscArc";
            public const string T_EmpSystemAdjMiscHst = "T_EmpSystemAdjMiscHst";
            public const string T_EmpSystemAdjMisc2Hst = "T_EmpSystemAdjMisc2Hst";
            public const string T_EmpSystemAdjMiscFinalPayHst = "T_EmpSystemAdjMiscFinalPayHst";
            public const string T_EmpSystemAdjMisc2FinalPayHst = "T_EmpSystemAdjMisc2FinalPayHst";

            public const string T_EmpSystemAdj2Retro = "T_EmpSystemAdj2Retro";
            public const string T_EmpSystemAdj2RetroHst = "T_EmpSystemAdj2RetroHst";
            public const string T_EmpSystemAdjMisc2Retro = "T_EmpSystemAdjMisc2Retro";
            public const string T_EmpSystemAdjMisc2RetroHst = "T_EmpSystemAdjMisc2RetroHst";

            public const string T_EmpCost = "T_EmpCost";
            public const string T_EmpCostHst = "T_EmpCostHst";
            public const string T_CostHdr = "T_CostHdr";
            public const string T_CostHdrHst = "T_CostHdrHst";
            public const string T_CostDtl = "T_CostDtl";
            public const string T_CostDtlHst = "T_CostDtlHst";
            public const string T_EmpCostHours = "T_EmpCostHours";

            public const string T_EmpTimeBaseAllowance = "T_EmpTimeBaseAllowance";
            public const string T_EmpTimeBaseAllowanceCycle = "T_EmpTimeBaseAllowanceCycle";
            public const string T_EmpTimeBaseAllowanceCycleFinalPay = "T_EmpTimeBaseAllowanceCycleFinalPay";
            public const string T_EmpTimeBaseAllowanceCycleFinalPayHst = "T_EmpTimeBaseAllowanceCycleFinalPayHst";
            public const string T_EmpTimeRegister = "T_EmpTimeRegister";
            public const string T_EmpTimeRegisterArc = "T_EmpTimeRegisterArc";
            public const string T_EmpTimeRegisterHst = "T_EmpTimeRegisterHst";
            public const string T_EmpTimeRegisterLog = "T_EmpTimeRegisterLog";
            public const string T_EmpTimeRegisterLogMisc = "T_EmpTimeRegisterLogMisc";
            public const string T_EmpTimeRegisterMisc = "T_EmpTimeRegisterMisc";
            public const string T_EmpTimeRegisterMiscHst = "T_EmpTimeRegisterMiscHst";
            public const string T_EmpTimeRegisterTrl = "T_EmpTimeRegisterTrl";
            public const string T_EmpTimeRegisterMiscTrl = "T_EmpTimeRegisterMiscTrl";
            public const string T_EmpDTROverride = "T_EmpDTROverride";
            public const string T_EmpTraining = "T_EmpTraining";
            public const string T_EmpTranspo = "T_EmpTranspo";
            public const string T_EmpWorkExperience = "T_EmpWorkExperience";
            public const string T_EmpWorkLocation = "T_EmpWorkLocation";
            public const string T_EmpYTD = "T_EmpYTD";
            public const string T_EmpYTDHst = "T_EmpYTDHst";
            public const string T_Holiday = "T_Holiday";
            public const string T_LeaveSchedule = "T_LeaveSchedule";
            public const string T_MonthlyIncomeTax = "T_MonthlyIncomeTax";
            public const string T_MonthlySBR = "T_MonthlySBR";
            public const string T_PaySchedule = "T_PaySchedule";
            public const string T_SettingControl = "T_SettingControl";
            public const string T_SettingControlTrl = "T_SettingControlTrl";
            public const string T_SystemMessageLog = "T_SystemMessageLog";
            public const string T_UserApprovalDelegation = "T_UserApprovalDelegation";
            public const string T_UserModuleLog = "T_UserModuleLog";
            public const string T_UserQuery = "T_UserQuery";
            public const string T_EmpLog = "T_EmpLog";
            public const string T_EmpDTR = "T_EmpDTR";
            public const string T_EmpProfile = "T_EmpProfile";
            
        }

        #endregion

        #region queries

        public class Queries
        {

            #region SelectCostCenter

            public const string SelectCostCenter = @"SELECT  Mcc_CostCenterCode as [CostCenter Code]
                                                          ,   CASE WHEN Len(Rtrim(IsNull(Mdv_DivName,' '))) > 0 THEN Rtrim(IsNull(Mdv_DivName,' '))
		                                                        ELSE ' ' END + 
		                                                        CASE WHEN Len(Rtrim(IsNull(Mdp_DptName,' '))) > 0 THEN ' / ' + Rtrim(IsNull(Mdp_DptName,' '))
		                                                        ELSE ' ' END + 
		                                                        CASE WHEN Len(Rtrim(IsNull(Msc_SecName,' '))) > 0 THEN ' / ' + Rtrim(IsNull(Msc_SecName,' '))
		                                                        ELSE ' ' END + 
		                                                        CASE WHEN Len(Rtrim(IsNull(Msb_SubSecName,' '))) > 0 THEN ' / ' + Rtrim(IsNull(Msb_SubSecName,' '))
		                                                        ELSE ' ' END  + 
		                                                        CASE WHEN Len(Rtrim(IsNull(Mpr_PrcName,' '))) > 0 THEN ' / ' + Rtrim(IsNull(Mpr_PrcName,' '))
		                                                        ELSE ' ' END  as [Description]
                                                        FROM  M_CostCenter 
                                                        LEFT JOIN M_Division on Mdv_DivCode= Mcc_DivCode 
                                                        LEFT JOIN M_Department on Mdp_DptCode = Mcc_DptCode
                                                        LEFT JOIN M_Section on  Msc_SecCode = Mcc_SecCode
                                                        LEFT JOIN M_SubSection  on Msb_SubSecCode = Mcc_SubsecCode 
                                                        LEFT JOIN M_Process on Mpr_PrcCode = Mcc_PrcCode
                                                        WHERE Mcc_CostCenterCode IN  (  SELECT Mue_CostCenterCode
								                                                        FROM M_UserExt
								                                                        WHERE Mue_SystemCode = '{0}'
								                                                        and Mue_UserCode = '{1}'
								                                                        and Mue_RecordStatus = 'A'

								                                                        UNION

								                                                        SELECT Mcc_CostCenterCode 
								                                                        FROM M_CostCenter
								                                                        WHERE Mcc_RecordStatus = 'A'
								                                                        and 1 = {2} )
                                                                 and  Mcc_RecordStatus = 'A'";

            #endregion
            #region SelectIDNumber
            //public const string Selectidi = @"INSERT INTO T_EmpDeductionDtlHst
            //                                   (Tdd_IDNo
            //                                   ,Tdd_DeductionCode
            //                                   ,Tdd_StartDate
            //                                   ,Tdd_ThisPayCycle 
            //                                   ,Tdd_PayCycle
            //                                   ,Tdd_LineNo
            //                                   ,Tdd_PaymentType
            //                                   ,Tdd_Amount
            //                                   ,Tdd_DeferredFlag
            //                                   ,Tdd_PaymentFlag
            //                                   ,Usr_Login
            //                                   ,Ludatetime)
            //                             VALUES
            //                                   (@Tdd_IDNo
            //                                   ,@Tdd_DeductionCode
            //                                   ,@Tdd_StartDate
            //                                   ,@CurrentPayPeriod
            //                                   ,@Tdd_PayCycle
            //                                   ,@Tdd_LineNo
            //                                   ,@Tdd_PaymentType
            //                                   ,@Tdd_Amount
            //                                   ,@Tdd_DeferredFlag
            //                                   ,'1'
            //                                   ,@Usr_Login
            //                                   ,GetDate())";

            public const string SelectIDNumber = @"SELECT Mem_IDNo as 'ID Number'
                                                    , Mem_LastName + CASE WHEN LEN(ISNULL(Mem_ExtensionName,'')) > 0 
													    THEN  ' ' + Mem_ExtensionName ELSE '' END as 'Last Name'
                                                    , Mem_FirstName as 'First Name'
                                                    , Mem_MiddleName as 'Middle Name'
                                                    , Mem_NickName as 'Nick Name'
                                                    , PAYGRP.Mcd_Name as [Payroll Group]
                                                    , PAYTYPE.Mcd_Name as [Payroll Type]
                                                    , EMPSTATN.Mcd_Name as [Employment Status]
                                                    , WORKSTAT.Mcd_Name as [Work Status]
                                                    , CASE WHEN '{6}' = 'S' THEN
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivShortName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcShortName, ' '))
															 ELSE ' ' END
														ELSE
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcName, ' '))
															 ELSE ' ' END
														 END
															AS [Cost Center]
                                                    FROM M_Employee
                                                    INNER JOIN {0}..M_UserExtTmp 
                                                        ON Mue_SystemCode = '{1}'
                                                        AND Mue_UserCode = '{2}'
	                                                    AND Mue_CompanyCode = '{4}'
	                                                    AND Mue_ProfileCode = '{5}'
                                                        AND Mue_CostCenterCode = Mem_CostcenterCode
	                                                    AND Mue_PayrollGroup = Mem_PayrollGroup
	                                                    AND Mue_PayrollType = Mem_PayrollType 
	                                                    AND Mue_EmploymentStatus = Mem_EmploymentStatusCode
                                                   LEFT JOIN {0}..M_CodeDtl PAYGRP 
                                                            ON PAYGRP.Mcd_Code = Mem_PayrollGroup
	                                                        AND PAYGRP.Mcd_Codetype = 'PAYGRP' 
	                                                        AND PAYGRP.Mcd_CompanyCode = '{4}' 
                                                   LEFT JOIN {0}..M_CodeDtl PAYTYPE 
                                                            ON PAYTYPE.Mcd_Code = Mem_PayrollType
	                                                        AND PAYTYPE.Mcd_Codetype = 'PAYTYPE' 
	                                                        AND PAYTYPE.Mcd_CompanyCode = '{4}' 
                                                   LEFT JOIN {0}..M_CodeDtl EMPSTATN 
                                                            ON EMPSTATN.Mcd_Code = Mem_EmploymentStatusCode
	                                                        AND EMPSTATN.Mcd_Codetype = 'EMPSTAT' 
	                                                        AND EMPSTATN.Mcd_CompanyCode = '{4}'
                                                  LEFT JOIN {0}..M_CodeDtl WORKSTAT 
                                                            ON WORKSTAT.Mcd_Code = Mem_WorkStatus
	                                                        AND WORKSTAT.Mcd_Codetype = 'WORKSTAT' 
	                                                        AND WORKSTAT.Mcd_CompanyCode = '{4}'
                                                  LEFT JOIN {0}..M_CostCenter 
															ON Mcc_CostCenterCode = Mem_CostCenterCode
															AND Mcc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Division on Mdv_CompanyCode = Mcc_CompanyCode
															AND Mdv_DivCode = Mcc_DivCode
                                                            AND Mdv_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Department on Mdp_CompanyCode = Mcc_CompanyCode
															AND Mdp_DptCode = Mcc_DptCode
                                                            AND Mdp_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Section on Mcc_CompanyCode = Mcc_CompanyCode
															AND Msc_SecCode = Mcc_SecCode
                                                            AND Msc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_SubSection on Msb_CompanyCode = Mcc_CompanyCode
															AND Msb_SubSecCode = Mcc_SubsecCode
                                                            AND Msb_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Process on Mpr_CompanyCode = Mcc_CompanyCode
															AND Mpr_PrcCode = Mcc_PrcCode
                                                            AND Mpr_CompanyCode = '{4}'";


            public const string SelectIDNumberCondition = @"
                                                    SELECT DISTINCT Mem_IDNo as 'ID Number'
															, Mem_LastName + CASE WHEN LEN(ISNULL(Mem_ExtensionName,'')) > 0 
																THEN  ' ' + Mem_ExtensionName ELSE '' END as 'Last Name'
															, Mem_FirstName as 'First Name'
															, Mem_MiddleName as 'Middle Name'
                                                            , Mem_NickName as 'Nick Name'
		                                                    , PAYGRP.Mcd_Name as [Payroll Group]
                                                            , PAYTYPE.Mcd_Name as [Payroll Type]
                                                            , EMPSTATN.Mcd_Name as [Employment Status]
                                                            , WORKSTAT.Mcd_Name as [Work Status]
                                                            , CASE WHEN '{6}' = 'S' THEN
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivShortName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcShortName, ' '))
															 ELSE ' ' END
														ELSE
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcName, ' '))
															 ELSE ' ' END
														 END
															AS [Cost Center]
                                                        , '' AS [ ]
                                                    FROM M_Employee
                                                    {7}
                                                    INNER JOIN {0}..M_UserExtTmp 
                                                        ON Mue_SystemCode = '{1}'
                                                        AND Mue_UserCode = '{2}'
	                                                    AND Mue_CompanyCode = '{4}'
	                                                    AND Mue_ProfileCode = '{5}'
                                                        AND Mue_CostCenterCode = Mem_CostcenterCode
	                                                    AND Mue_PayrollGroup = Mem_PayrollGroup
	                                                    AND Mue_PayrollType = Mem_PayrollType 
	                                                    AND Mue_EmploymentStatus = Mem_EmploymentStatusCode
                                                   LEFT JOIN {0}..M_CodeDtl PAYGRP 
                                                            ON PAYGRP.Mcd_Code = Mem_PayrollGroup
	                                                        AND PAYGRP.Mcd_Codetype = 'PAYGRP' 
	                                                        AND PAYGRP.Mcd_CompanyCode = '{4}' 
                                                   LEFT JOIN {0}..M_CodeDtl PAYTYPE 
                                                            ON PAYTYPE.Mcd_Code = Mem_PayrollType
	                                                        AND PAYTYPE.Mcd_Codetype = 'PAYTYPE' 
	                                                        AND PAYTYPE.Mcd_CompanyCode = '{4}' 
                                                   LEFT JOIN {0}..M_CodeDtl EMPSTATN 
                                                            ON EMPSTATN.Mcd_Code = Mem_EmploymentStatusCode
	                                                        AND EMPSTATN.Mcd_Codetype = 'EMPSTAT' 
	                                                        AND EMPSTATN.Mcd_CompanyCode = '{4}'
                                                  LEFT JOIN {0}..M_CodeDtl WORKSTAT 
                                                            ON WORKSTAT.Mcd_Code = Mem_WorkStatus
	                                                        AND WORKSTAT.Mcd_Codetype = 'WORKSTAT' 
	                                                        AND WORKSTAT.Mcd_CompanyCode = '{4}'
                                                  LEFT JOIN {0}..M_CostCenter 
															ON Mcc_CostCenterCode = Mem_CostCenterCode
															AND Mcc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Division on Mdv_CompanyCode = Mcc_CompanyCode
															AND Mdv_DivCode = Mcc_DivCode
                                                            AND Mdv_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Department on Mdp_CompanyCode = Mcc_CompanyCode
															AND Mdp_DptCode = Mcc_DptCode
                                                            AND Mdp_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Section on Mcc_CompanyCode = Mcc_CompanyCode
															AND Msc_SecCode = Mcc_SecCode
                                                            AND Msc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_SubSection on Msb_CompanyCode = Mcc_CompanyCode
															AND Msb_SubSecCode = Mcc_SubsecCode
                                                            AND Msb_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Process on Mpr_CompanyCode = Mcc_CompanyCode
															AND Mpr_PrcCode = Mcc_PrcCode
                                                            AND Mpr_CompanyCode = '{4}'
                                                   {8} ";

            
            public const string SelectIDNumberConditionExclude = @"SELECT Mem_IDNo as 'ID Number'
															, Mem_LastName + CASE WHEN LEN(ISNULL(Mem_ExtensionName,'')) > 0 
																THEN  ' ' + Mem_ExtensionName ELSE '' END as 'Last Name'
															, Mem_FirstName as 'First Name'
															, Mem_MiddleName as 'Middle Name'
                                                            , Mem_ExtensionName as 'Extension Name'
		                                                    , b.Mcd_Name as [Payroll Group]
															, c.Mcd_Name as [Employment Status]
															, d.Mcd_Name as [Payroll Type]
															, CASE WHEN '{6}' = 'S' THEN
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivShortName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecShortName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcShortName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcShortName, ' '))
															 ELSE ' ' END
														ELSE
															 CASE WHEN LEN(RTRIM(IsNull(Mdv_DivName, ' '))) > 0 THEN RTRIM(IsNull(Mdv_DivName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mdp_DptName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mdp_DptName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msc_SecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msc_SecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Msb_SubSecName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Msb_SubSecName, ' '))
															 ELSE ' ' END +
															 CASE WHEN LEN(RTRIM(IsNull(Mpr_PrcName, ' '))) > 0 THEN ' / ' + RTRIM(IsNull(Mpr_PrcName, ' '))
															 ELSE ' ' END
														 END
															AS [Cost Center]
                                                    FROM 
                                                    (
                                                    SELECT distinct M_Employee.*
                                                    FROM M_Employee
                                                    WHERE Mem_CostcenterCode IN  ( SELECT Mue_CostCenterCode
								                                                    FROM {0}..M_UserExt
								                                                    WHERE Mue_SystemCode = '{1}'
								                                                        AND Mue_UserCode = '{2}'
                                                                                        AND Mue_CompanyCode = '{4}'
																						AND Mue_ProfileCode = '{5}'
								                                                        AND Mue_RecordStatus = 'A'

								                                                    UNION

								                                                    SELECT Mcc_CostCenterCode 
								                                                    FROM {0}..M_CostCenter
								                                                    WHERE  
                                                                                    1 = {3} 
                                                                                    AND Mcc_CompanyCode = '{4}')
                                                    {7}
                                                   ) temp1
                                                    INNER JOIN {0}..M_UserExt PayrollGroupAccess 
                                                        ON PayrollGroupAccess.Mue_SystemCode = '{1}'
	                                                    AND PayrollGroupAccess.Mue_UserCode = '{2}'
                                                        AND PayrollGroupAccess.Mue_CompanyCode = '{4}'
														AND PayrollGroupAccess.Mue_ProfileCode = '{5}'
	                                                    AND (1 = {3} OR PayrollGroupAccess.Mue_CostCenterCode = Mem_CostcenterCode)
	                                                    AND PayrollGroupAccess.Mue_RecordStatus = 'A'
	                                                    AND Mem_PayrollGroup IN (  SELECT [Data] FROM {0}.dbo.Udf_Split (PayrollGroupAccess.Mue_PayrollGroup, ','))
                                                    INNER JOIN {0}..M_UserExt EmpStatAccess 
                                                        ON EmpStatAccess.Mue_SystemCode = '{1}'
	                                                    AND EmpStatAccess.Mue_UserCode = '{2}'
                                                        AND EmpStatAccess.Mue_CompanyCode = '{4}'
														AND EmpStatAccess.Mue_ProfileCode = '{5}'
	                                                    AND (1 = {3} OR EmpStatAccess.Mue_CostCenterCode = Mem_CostcenterCode)
	                                                    AND EmpStatAccess.Mue_RecordStatus = 'A'
	                                                    AND Mem_EmploymentStatusCode IN (  SELECT [Data] FROM {0}.dbo.Udf_Split (EmpStatAccess.Mue_EmploymentStatus, ','))
                                                    INNER JOIN {0}..M_UserExt PayrollTypeAccess 
													ON PayrollTypeAccess.Mue_SystemCode = '{1}'
	                                                    AND PayrollTypeAccess.Mue_UserCode = '{2}'
														AND PayrollTypeAccess.Mue_CompanyCode = '{4}'
														AND PayrollTypeAccess.Mue_ProfileCode = '{5}'
	                                                    AND (1 = {3} OR PayrollTypeAccess.Mue_CostCenterCode = Mem_CostcenterCode)
	                                                    AND PayrollTypeAccess.Mue_RecordStatus = 'A'
	                                                    AND Mem_PayrollType IN (  SELECT [Data] FROM {0}.dbo.Udf_Split (PayrollTypeAccess.Mue_PayrollType, ','))
                                                    LEFT JOIN {0}..M_CodeDtl b 
                                                        ON b.Mcd_Code = Mem_PayrollGroup
                                                        AND b.Mcd_CompanyCode = '{4}'
	                                                    AND b.Mcd_CodeType='PAYGRP'
                                                    LEFT JOIN {0}..M_CodeDtl c 
                                                        ON c.Mcd_Code = Mem_EmploymentStatusCode
                                                        AND c.Mcd_CompanyCode = '{4}'
	                                                    AND c.Mcd_CodeType='EMPSTAT'
                                                    LEFT JOIN {0}..M_CodeDtl d 
													    ON d.Mcd_Code = Mem_PayrollType
													    AND d.Mcd_CompanyCode = '{4}'
	                                                    AND d.Mcd_CodeType='PAYTYPE'
                                                    LEFT JOIN {0}..M_CostCenter 
															ON Mcc_CostCenterCode = Mem_CostCenterCode
															AND Mcc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Division on Mdv_CompanyCode = Mcc_CompanyCode
															AND Mdv_DivCode = Mcc_DivCode
                                                            AND Mdv_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Department on Mdp_CompanyCode = Mcc_CompanyCode
															AND Mdp_DptCode = Mcc_DptCode
                                                            AND Mdp_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Section on Mcc_CompanyCode = Mcc_CompanyCode
															AND Msc_SecCode = Mcc_SecCode
                                                            AND Msc_CompanyCode = '{4}'
													LEFT JOIN {0}..M_SubSection on Msb_CompanyCode = Mcc_CompanyCode
															AND Msb_SubSecCode = Mcc_SubsecCode
                                                            AND Msb_CompanyCode = '{4}'
													LEFT JOIN {0}..M_Process on Mpr_CompanyCode = Mcc_CompanyCode
															AND Mpr_PrcCode = Mcc_PrcCode
                                                            AND Mpr_CompanyCode = '{4}'";

            #endregion
            #region SelectEmployeeAll
            public const string SelectEmployeeAll = @"SELECT  Mem_IDNo AS [Employee ID],
                                                        Mem_LastName AS [Last Name],
                                                        Mem_FirstName AS [First Name],
                                                        Mem_MiddleName AS [Middle Name]
                                                    FROM M_Employee ";


            #endregion
            #region selectEmplyeeID
            public const string selectEmplyeeID = @"SELECT DISTINCT Mem_IDNo as 'ID no'
                                                        ,Mem_LastName as 'Last Name'
                                                        ,Mem_FirstName as 'First Name'
                                                        ,Mem_MiddleName as 'Middle Name'
                                                    FROM M_Employee 
                                                    INNER JOIN M_EmpFamily on Mem_IDNo=Mfm_IDNo";
            #endregion
            #region DeferredPaymentEntry
            public const string SelectDeferredPaymentEntry = @"
                                                                SELECT  
	                                                                M_Employee.Mem_IDNo AS EmployeeID,
	                                                                M_Employee.Mem_FirstName AS Firstname,
	                                                                M_Employee.Mem_LastName AS Lastname,
	                                                                M_Employee.Mem_MiddleName AS MiddleName,
	                                                                T_DeferredPayments.Dpt_DeductionCode AS DeductionCode,
	                                                                M_Deduction.Mdn_DeductionName AS DeductionDesc,
	                                                                T_DeferredPayments.Dpt_StartDeductionCode AS StartDeductionCode,
	                                                                T_EmployeeDeduction.Edt_DeductionAmount AS DeductionAmount,
	                                                                T_EmployeeDeduction.Edt_PaidAmount AS PaidAmount,
	                                                                T_DeferredPayments.Dpt_DeferredAmount AS DeferredAmount,
	                                                                T_EmployeeDeduction.Edt_AmortizationAmount AS AmortizationAmount
                                                                FROM 
	                                                                T_DeferredPayments, 
	                                                                M_Employee,
	                                                                M_Deduction,
	                                                                T_EmployeeDeduction
                                                                WHERE 
	                                                                M_Employee.Mem_IDNo = T_DeferredPayments.Dpt_EmployeeID 
                                                                AND
	                                                                T_DeferredPayments.Dpt_DeductionCode = M_Deduction.Mdn_DeductionCode
                                                                AND 
	                                                                M_Employee.Mem_IDNo = T_EmployeeDeduction.Edt_EmployeeID
                                                              ";

            #endregion
            #region AccountHeaderFetch
            public const string AccountHeaderfetch = @"SELECT Mch_CodeType as 'Account Type', Mch_TypeName as 'Description', CASE Mch_RecordStatus 
                                                        WHEN 'A' then 'ACTIVE'
                                                        WHEN 'C' then 'CANCELLED'
                                                        END as 'Status'
                                                        FROM M_CodeHdr
                                                        WHERE Mch_RecordStatus<>'C'";
            #endregion
            #region PositionComboBoxQuery
            public const string PositionComboBoxQuery = @"
                                                        SELECT '' AS POSITION_VAL, '' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'ADMIN' AS POSITION_VAL, 'ADMIN' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'ASST. MANAGER' AS POSITION_VAL, 'ASST. MANAGER' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'ENGINEER' AS POSITION_VAL, 'ENGINEER' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'FORMAN' AS POSITION_VAL, 'FORMAN' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'I.T. SYSTEMS ANALYST' AS POSITION_VAL, 'I.T. SYSTEMS ANALYST' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'LINE LEADER' AS POSITION_VAL, 'LINE LEADER' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'PRODUCTION OPERATOR' AS POSITION_VAL, 'PRODUCTION OPERATOR' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'SENIOR CLERK' AS POSITION_VAL, 'SENIOR CLERK' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'SENIOR WAREHOUSEMAN' AS POSITION_VAL, 'SENIOR WAREHOUSEMAN' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'SUPERVISOR' AS POSITION_VAL, 'SUPERVISOR' AS POSITION_DISP
                                                        UNION
                                                        SELECT 'WAREHOUSEMAN' AS POSITION_VAL, 'WAREHOUSEMAN' AS POSITION_DISP
                                                        ";
            #endregion
            #region selectUserGrantAll
            public const string selectUserGrantAll = @"SELECT     M_UserRoleAccess.Mra_UserRoleCode, 
	                                                               M_UserRoleAccess.Mra_SystemCode,
                                                                   M_UserRoleAccess.Mra_ModuleCode, 
                                                                   M_UserRole.Ugh_UserGroupDesc,
                                                                   M_SystemModule.Smc_MenuDesc, 
                                                                   M_UserRoleAccess.Mra_CanView,
                                                                   M_UserRoleAccess.Mra_CanAppend,
                                                                   M_UserRoleAccess.Mra_CanUpdate,
                                                                   M_UserRoleAccess.Mra_CanDelete,
                                                                   M_UserRoleAccess.Mra_CanProcess,
                                                                   M_UserRoleAccess.Mra_CanCheck,
                                                                   M_UserRoleAccess.Mra_CanApprove,
                                                                   M_UserRoleAccess.Mra_CanPrintPreview,
                                                                   M_UserRoleAccess.Mra_CanPrint,
                                                                   M_UserRoleAccess.Mra_CanReprint,
		                                                           M_SystemModule.Smc_MenuType,
                                                                   M_UserRoleAccess.Mra_RecordStatus 
                                                            FROM         M_UserRoleAccess 
                                                                      INNER JOIN M_UserRole 
                                                            ON (M_UserRoleAccess.Mra_UserRoleCode = M_UserRole.Mur_UserRoleCode)
                                                                      INNER JOIN
                                                                      M_SystemModule 
                                                            ON (M_UserRoleAccess.Mra_ModuleCode = M_SystemModule.Msm_ModuleCode)";
            #endregion
            #region selectUserGrantDuplicate
            public const string selectUserGrantDuplicate = @"SELECT     Mra_UserRoleCode, Mra_ModuleCode
                                                            FROM        M_UserRoleAccess
                                                            WHERE       (Mra_UserRoleCode = @userGroup) AND 
                                                                        (Mra_ModuleCode = @menuCode)";
            #endregion
            #region fetchUserGrant
            public const string fetchUserGrant = @"select * FROM M_UserRoleAccess";
            #endregion
            #region selectSubSectionMaster
            public const string selectSubSectionMaster = @"SELECT Msb_SubSecCode, Msb_SubSecName, Msb_RecordStatus 
                                                                FROM M_SubSection ORDER BY ludatetime DESC";
            #endregion
            #region SelectSubSectionDesc
            public const string SelectSubSectionDesc = @"SELECT Msb_SubSecName FROM M_SubSection WHERE Msb_SubSecCode = @Msb_SubSecCode";
            #endregion
            #region checkNickExist
            public const string checkNickExist = @"SELECT * FROM M_Process WHERE Mpr_PrcName = @pcm_ProcessNickName";
            #endregion
            #region fetchAllowedCostCenters
            public const string fetchAllowedCostCenters = @"select 
	                                                            Mcc_CostCenterCode,
	                                                            Mcc_DivCode,
	                                                            Mcc_DptCode,
	                                                            Mcc_SecCode,
	                                                            Mcc_SubsecCode,
	                                                            Mcc_PrcCode
                                                            from M_CostCenter {0}";
            #endregion
            #region selectCostCenterMasterTypeList
            public const string selectCostCenterMasterTypeList = @"SELECT
                                                                      CC.Mcc_CostCenterCode,
                                                                      CC.Mcc_DivCode,
                                                                      CC.Mcc_DptCode, 
                                                                      CC.Mcc_SecCode, 
                                                                      CC.Mcc_SubsecCode, 
                                                                      CC.Mcc_PrcCode, 
                                                                                          
                                                                      CC.Mcc_RecordStatus, 
                                                                      CC.Usr_login, 
                                                                      CC.ludatetime, 
                                                                      ISNULL(M_CodeDtl.Mcd_Name, ' ') AS ClassificationDesc, 
                                                                                          
                                                                      M_Division.Mdv_DivName, 
                                                                      M_Department.Mdp_DptName, 
                                                                      M_Section.Msc_SecName, 
                                                                                          
                                                                      M_SubSection.Msb_SubSecName, 
                                                                      M_Process.Mpr_PrcName
                                                                FROM         M_CostCenter AS CC LEFT OUTER JOIN
                                                                  M_Division ON CC.Mcc_DivCode = M_Division.Mdv_DivCode LEFT OUTER JOIN
                                                                  M_Department ON CC.Mcc_DptCode = M_Department.Mdp_DptCode LEFT OUTER JOIN
                                                                  M_Section ON CC.Mcc_SecCode = M_Section.Msc_SecCode LEFT OUTER JOIN
                                                                  M_SubSection ON CC.Mcc_SubsecCode = M_SubSection.Msb_SubSecCode LEFT OUTER JOIN
                                                                  M_Process ON CC.Mcc_PrcCode = M_Process.Mpr_PrcCode LEFT OUTER JOIN
                                                                  M_CodeDtl ON CC.Mcc_ExpenseClass = M_CodeDtl.Mcd_Code AND Mcd_CodeType = 'CCTRCLASS' ";
            #endregion
            #region
            public const string CalendarScope = @"  select 
                                                        '  ' as 'CalendarScopeValue'
                                                        ,'[COMPANY]' as 'CalendarScopeDisplay'

                                                    union

                                                    select distinct
	                                                    Mcc_CostCenterCode as 'CalendarScopeValue'
	                                                    ,'['+RTRIM(Msc_SecName)+']'+' '+'['+RTRIM(Msb_SubSecName)+']' as 'CalendarScopeDisplay'
                                                    from dbo.M_CostCenter
	                                                    join dbo.M_Section
		                                                    on Msc_SecCode = Mcc_SecCode
														join dbo.M_SubSection
															on Msb_SubSecCode = Mcc_SubsecCode
                                                    where Mcc_DivCode = '02'
	                                                    and Mcc_DptCode = '09'
	                                                    and LEN(Mcc_CostCenterCode) = 8";
            #endregion
            #region SelectCostCenterDesc
            public const string SelectCostCenterDesc = @"SELECT DISTINCT dbo.getCostCenterName(Mcc_CostCenterCode) as [Cost Center Desc] FROM M_CostCenter WHERE Mcc_CostCenterCode = @Umt_UserCostCenter AND LEN(Mcc_CostCenterCode) = 6";
            #endregion
            #region SelectUser
            public const string SelectUser = @"SELECT [Muh_LastName] 
                                                  ,[Muh_FirstName] 
                                                  ,[Umt_userview] 
                                                  ,[Umt_userappend] 
                                                  ,[Umt_useredit] 
                                                  ,[Umt_userdelete] 
                                                  ,[Umt_userprint] 
                                                  ,[Umt_usersupv] 
                                                  ,[Umt_usermnt] 
                                                  ,[Muh_UserCode]
                                                  ,[Umt_Userpswd]
                                                  ,[Umt_Usernumber]      
                                                  ,[Muh_MiddleName]     
                                                  ,[Umt_status]                                                                      
                                                FROM T_UserMaster
                                                WHERE (Muh_UserCode = @userCode)";
            #endregion
            #region SelectIfUserGroupCodeExist
            public const string SelectIfUserGroupCodeExist = @"SELECT DISTINCT Mur_UserRoleCode FROM M_UserRole WHERE Mur_UserRoleCode = @Ugh_usergroupcode";
            #endregion
            #region SelectUserMenu
            public const string SelectUserMenu = @"SELECT 
	                                                    Mra_ModuleCode
                                                      ,Mra_CanView
                                                      ,Mra_CanAppend
                                                      ,Mra_CanUpdate
                                                      ,Mra_CanDelete
                                                      ,Mra_CanProcess
                                                      ,Mra_CanApprove
                                                      ,Mra_CanPrint
                                                      ,Mra_CanReprint
                                                    FROM M_UserRoleAccess
                                                    INNER JOIN M_UserDtl
                                                        ON Mra_UserRoleCode = Mud_UserRoleCode
                                                        	And Mra_SystemCode = Mud_SystemCode
                                                            And Mud_RecordStatus = 'A'
                                                    WHERE Mud_UserCode = @userCode
                                                    AND Mra_RecordStatus = 'A'";
            public const string SelectUserMenu2 = @"SELECT Mra_ModuleCode 
	                                                        , Mra_SystemCode
	                                                        , Mra_UserRoleCode
	                                                        , Mra_CanView
	                                                        , Mra_CanAppend
	                                                        , Mra_CanUpdate
	                                                        , Mra_CanDelete
	                                                        , Mra_CanProcess
	                                                        , Mra_CanApprove
	                                                        , Mra_CanPrint
	                                                        , Mra_CanReprint
                                                        FROM M_UserRoleAccess
                                                        INNER JOIN M_UserDtl 
                                                        ON Mra_CompanyCode = Mud_CompanyCode
                                                        AND Mra_SystemCode = Mud_SystemCode
                                                        AND Mra_UserRoleCode = Mud_UserRoleCode
                                                        AND Mud_RecordStatus = 'A'
                                                        INNER JOIN M_Company ON Mra_CompanyCode = Mcm_CompanyCode
                                                        INNER JOIN M_Profile ON Mud_ProfileCode = Mpf_DatabaseNo
                                                        WHERE Mud_UserCode = @UserCode
                                                        AND Mcm_CompanyName = @CompanyCode
                                                        AND Mpf_ProfileName = @ProfileCode
                                                        AND Mra_RecordStatus = 'A'";
            #endregion
            #region SelectIfParameterIDExist
            public const string SelectIfParameterIDExist = @"SELECT DISTINCT Mph_PolicyCode FROM M_PolicyHdr WHERE Mph_PolicyCode = @ParameterID";
            #endregion
            #region FetchCostCenterName
            public const string FetchCostCenterName = @"Select Mdv_DivName,
                                                            Mdp_DptName,
                                                            Msc_SecName,
                                                            Msb_SubSecName, 
                                                            Mpr_PrcName
                                                        FROM M_CostCenter
                                                        LEFT JOIN M_Division ON Mcc_DivCode = Mdv_DivCode
                                                        LEFT JOIN M_Department ON Mcc_DptCode = Mdp_DptCode
                                                        LEFT JOIN M_Section ON Mcc_SecCode = Msc_SecCode
                                                        LEFT JOIN M_SubSection ON Mcc_SubsecCode = Msb_SubSecCode
                                                        LEFT JOIN M_Process ON Mcc_PrcCode = Mpr_PrcCode
                                                        WHERE Mcc_CostCenterCode = @Mem_CostcenterCode";
            #endregion
            #region GetEmployeeID
            public const string getEmployeeID = @"SELECT Mem_IDNo as [ID Number],
		                                                                    Mem_LastName as [Last Name],
		                                                                    Mem_FirstName as [First Name],
		                                                                    Mem_MiddleName as [MI]
		                                                            FROM M_Employee
                                                                        WHERE LEFT(Mem_WorkStatus, 1) = 'A'";


            #endregion
            #region GetCostCenterLookUp
            public const string GetCostCenterLookUp = @"SELECT DISTINCT Mcc_CostCenterCode AS [Cost Center Code]
	                                                          ,Mdv_DivName AS [Division Description]
                                                              ,Mdp_DptName AS [Department Description]
                                                              ,Msc_SecName AS [Section Description]
                                                              ,Msb_SubSecName AS [Sub-Section Description]
                                                              ,Mpr_PrcName AS [Process Description]
	                                                        FROM M_CostCenter 
		                                                        LEFT JOIN M_Division ON Mdv_DivCode= Mcc_DivCode 
		                                                        LEFT JOIN M_Department ON Mdp_DptCode = Mcc_DptCode
		                                                        LEFT JOIN M_Section ON  Msc_SecCode = Mcc_SecCode
		                                                        LEFT JOIN M_SubSection  ON Msb_SubSecCode = Mcc_SubsecCode 
		                                                        LEFT JOIN M_Process ON Mpr_PrcCode = Mcc_PrcCode
                                                        ORDER BY Mcc_CostCenterCode";


            #endregion
            #region IfCutOff
            public const string IfCutOff = @"SELECT Tsc_SetFlag
                            FROM T_SettingControl
                            WHERE Tsc_SystemCode = 'LEAVE' AND Tsc_SettingCode = 'CUT-OFF' AND Tsc_SetFlag = 'true'";
            #endregion

            #region [Jule Added 20081226 : Cycle Processing CommonQueries]
            #region [Count for Cycle Closing]
            public const string countProcess1 = @"SELECT IsNull(Count(Tin_IDNo), 0) NumEmp FROM T_EmpIncomeHst";
            public const string countAdded1 = @"SELECT IsNull(Count(A.Tin_IDNo), 0) NumEmp 
                                                FROM T_EmpIncome A
                                                Left Join T_EmpIncomeHst B
                                                On A.Tin_IDNo = B.Tin_IDNo
                                                And A.Tin_PayCycle = B.Tin_PayCycle
                                                And A.Tin_IncomeCode = B.Tin_IncomeCode
                                                WHERE A.Tin_PayCycle = @CurPayPeriod
                                                And B.Tin_PayCycle Is Null";

            public const string countProcess2 = @"SELECT IsNull(COUNT(Tma_IDNo), 0) NumEmp FROM T_EmpManualAdjHst";
            public const string countAdded2 = @"SELECT IsNull(COUNT(A.Tma_IDNo), 0) NumEmp 
                                                FROM T_EmpManualAdj A
                                                Left Join T_EmpManualAdjHst B
                                                On A.Tma_IDNo = B.Tma_IDNo
                                                And A.Tma_PayCycle = B.Tma_PayCycle
                                                WHERE A.Tma_PayCycle = @CurPayPeriod
                                                And B.Tma_PayCycle Is Null";

            public const string countProcess3 = @"SELECT IsNull(Count(Tdd_IDNo), 0) NumEmp, IsNull(Sum(Tdd_Amount), 0) SumAmt FROM T_EmpDeductionDtlHst";
            public const string countAdded3 = @"SELECT IsNull(COUNT(A.Tdd_IDNo), 0) NumEmp, 
		                                                IsNull(Sum(A.Tdd_Amount), 0) SumAmt 
                                                FROM T_EmpDeductionDtl A
                                                Left Join T_EmpDeductionDtlHst B
                                                On A.Tdd_IDNo = B.Tdd_IDNo
                                                And A.Tdd_DeductionCode = B.Tdd_DeductionCode
                                                And A.Tdd_StartDate = B.Tdd_StartDate
                                                And A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle
                                                And A.Tdd_PayCycle = B.Tdd_PayCycle
                                                And A.Tdd_LineNo = B.Tdd_LineNo
                                                WHERE A.Tdd_ThisPayCycle = @CurPayPeriod
                                                And B.Tdd_ThisPayCycle Is Null";

            public const string countProcess4 = @"SELECT IsNull(COUNT(Tpy_IDNo), 0) NumEmp, IsNull(SUM(Tpy_NetAmt), 0) SumAmt FROM T_EmpPayrollYearly";
            public const string countAdded4 = @"SELECT	IsNull(COUNT(A.Tpy_IDNo), 0) NumEmp, 
		                                                IsNull(SUM(A.Tpy_NetAmt), 0) SumAmt 
                                                FROM T_EmpPayroll A
                                                Left Join T_EmpPayrollYearly B
                                                On A.Tpy_IDNo = B.Tpy_IDNo
                                                And A.Tpy_PayCycle = B.Tpy_PayCycle
                                                WHERE A.Tpy_PayCycle = @CurPayPeriod 
                                                And B.Tpy_PayCycle Is Null";

            public const string countProcess5 = @"SELECT IsNull(count(Tpc_IDNo), 0) NumEmp FROM  T_EmpProcessCheckHst";
            public const string countAdded5 = @"SELECT ISNULL(count(A.Tpc_IDNo), 0) NumEmp 
                                                FROM T_EmpProcessCheck A
                                                LEFT JOIN T_EmpProcessCheckHst B
                                                ON A.Tpc_IDNo = B.Tpc_IDNo
                                                AND A.Tpc_Remarks = B.Tpc_Remarks
                                                AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                WHERE AND A.Tpc_ModuleCode = 'PAYROLLCALC'
                                                AND A.Tpc_PayCycle = @CURPAYPERIOD
                                                AND B.Tpc_PayCycle IS NULL

                                                UNION 

                                                SELECT ISNULL(count(A.Tpc_IDNo), 0) NumEmp 
                                                FROM T_EmpProcessCheck A
                                                LEFT JOIN T_EmpProcessCheckHst B
                                                ON A.Tpc_IDNo = B.Tpc_IDNo
                                                AND A.Tpc_Remarks = B.Tpc_Remarks
                                                AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                WHERE AND A.Tpc_ModuleCode = 'LABORCOST'
                                                AND A.Tpc_PayCycle = @CURPAYPERIOD
                                                AND B.Tpc_PayCycle IS NULL";

            public const string countProcess6 = @"SELECT IsNull(SUM(Tdh_PaidAmount), 0) PaidAmt, IsNull(SUM(Tdh_DeferredAmount), 0) DefAmt FROM T_EmpDeductionHdr";
            public const string countAdded6 = @"SELECT  PaidAmt = IsNull(Sum(Tdd_Amount), 0) , DeferredAmt = IsNull(Sum(Case When Tdd_DeferredFlag = 1  Then Tdd_Amount Else 0 End), 0) FROM T_EmpDeductionDtl WHERE Tdd_ThisPayCycle = @CurPayPeriod and  Tdd_PaymentFlag = 1";

            public const string countProcess7 = @"SELECT IsNull(count(Tdh_IDNo), 0) NumEmp, IsNull(SUM(Tdh_PaidAmount), 0) SumAmt FROM T_EmpDeductionHdrHst";
            public const string countAdded7 = @"SELECT IsNull(count(A.Tdh_IDNo), 0) NumEmp
	                                                ,IsNull(SUM(A.Tdh_PaidAmount), 0) SumAmt 
                                                FROM T_EmpDeductionHdr A
                                                Left Join T_EmpDeductionHdrHst B
                                                On A.Tdh_IDNo = B.Tdh_IDNo
                                                And A.Tdh_DeductionCode = B.Tdh_DeductionCode
                                                And A.Tdh_StartDate = B.Tdh_StartDate
                                                WHERE B.Ludatetime Is Null
                                                and A.Tdh_DeductionAmount = A.Tdh_PaidAmount
                                                And A.Tdh_PaymentDate is not null";

            public const string countProcess7_1 = @"SELECT IsNull(count(Tdh_IDNo), 0) NumEmp, IsNull(SUM(Tdh_PaidAmountThisCycle), 0) SumAmt FROM T_EmpDeductionHdrCycleHst";
            public const string countAdded7_1 = @"SELECT IsNull(count(A.Tdh_IDNo), 0) NumEmp
	                                                ,IsNull(SUM(A.Tdh_PaidAmount), 0) SumAmt 
                                                FROM T_EmpDeductionHdrCycle A
                                                Left Join T_EmpDeductionHdrCycleHst B
                                                On A.Tdh_IDNo = B.Tdh_IDNo
                                                And A.Tdh_DeductionCode = B.Tdh_DeductionCode
                                                And A.Tdh_StartDate = B.Tdh_StartDate
												And A.Tdh_PayCycle = B.Tdh_PayCycle 
                                                WHERE A.Tdh_PayCycle = @CurPayPeriod
                                                And B.Tdh_PayCycle Is Null";

            public const string countProcess8 = @"SELECT IsNull(Count(Tdd_IDNo), 0) NumEmp, IsNull(Sum(Tdd_Amount), 0) SumAmt FROM T_EmpDeductionDtlFullPayHst";
            public const string countAdded8 = @"SELECT IsNull(COUNT(A.Tdd_IDNo), 0) NumEmp, IsNull(Sum(A.Tdd_Amount), 0) SumAmt
                                                From T_EmpDeductionDtlHst A
                                                Inner join T_EmpDeductionHdr on Tdh_IDNo = A.Tdd_IDNo
                                                and Tdh_DeductionCode = A.Tdd_DeductionCode
                                                and Tdh_StartDate = A.Tdd_StartDate
                                                and Tdh_PaymentDate is not null
                                                and Tdh_DeductionAmount = Tdh_PaidAmount
                                                Left Join T_EmpDeductionDtlFullPayHst B
                                                On A.Tdd_IDNo = B.Tdd_IDNo
                                                And A.Tdd_DeductionCode = B.Tdd_DeductionCode
                                                And A.Tdd_StartDate = B.Tdd_StartDate
                                                And A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle
                                                And A.Tdd_PayCycle = B.Tdd_PayCycle
                                                And A.Tdd_LineNo = B.Tdd_LineNo
                                                Where B.Ludatetime Is Null";

            public const string countProcess9 = @"SELECT IsNull(COUNT(Tdd_IDNo), 0) NumEmp, IsNull(SUM(Tdd_DeferredAmt), 0) SumAmt FROM T_EmpDeductionDefer";
            public const string countAdded9 = @"SELECT IsNull(COUNT(A.Tdd_IDNo), 0) NumEmp, IsNull(Sum(A.Tdd_Amount), 0) SumAmt
                                                FROM T_EmpDeductionDtl A
                                                Left Join T_EmpDeductionDefer B
                                                On A.Tdd_IDNo = B.Tdd_IDNo
                                                And A.Tdd_DeductionCode = B.Tdd_DeductionCode
                                                And A.Tdd_StartDate = B.Tdd_StartDate
                                                And A.Tdd_PayCycle = B.Tdd_PayCycle
                                                And A.Tdd_LineNo = B.Tdd_LineNo
                                                WHERE A.Tdd_ThisPayCycle = @CurPayPeriod
                                                    and A.Tdd_PaymentFlag = 0
                                                    and A.Tdd_DeferredFlag = 0
                                                    And B.Ludatetime Is Null";

            public const string countProcess10 = @"SELECT IsNull(SUM(Tdh_DeferredAmount ), 0) SumAmt FROM T_EmpDeductionHdr";
            public const string countAdded10 = @"SELECT ISNULL(Sum(Tdd_Amount),0) DeferredAmt
                                                        FROM T_EmpDeductionDtl                            
                                                        WHERE Tdd_ThisPayCycle = @CurPayPeriod
	                                                        and Tdd_PaymentFlag = 0
	                                                        and Tdd_DeferredFlag = 0";

            public const string countProcess11 = @"SELECT IsNull(Count(Ttr_IDNo), 0) NumEmp FROM T_EmpTimeRegisterHst";
            public const string countAdded11 = @"SELECT IsNull(Count(A.Ttr_IDNo), 0) NumEmp 
                                                FROM T_EmpTimeRegister A
                                                Left Join T_EmpTimeRegisterHst B
                                                On A.Ttr_IDNo = B.Ttr_IDNo
                                                And A.Ttr_Date = B.Ttr_Date
                                                WHERE A.Ttr_PayCycle = @CurPayPeriod
                                                And B.Ttr_PayCycle Is Null";

            public const string countProcess111 = @"SELECT IsNull(Count(Tph_IDNo), 0) NumEmp FROM T_EmpPayTranHdrHst";
            public const string countAdded111 = @"SELECT IsNull(Count(A.Tph_IDNo), 0) NumEmp 
                                                FROM T_EmpPayTranHdr A
                                                Left Join T_EmpPayTranHdrHst B
                                                On A.Tph_IDNo = B.Tph_IDNo
                                                AND A.Tph_PayCycle = B.Tph_PayCycle
                                                WHERE A.Tph_PayCycle = @CurPayPeriod
                                                And B.Tph_PayCycle Is Null";

            public const string countProcess112 = @"SELECT IsNull(Count(Tpd_IDNo), 0) NumEmp FROM T_EmpPayTranDtlHst";
            public const string countAdded112 = @"SELECT IsNull(Count(A.Tpd_IDNo), 0) NumEmp 
                                                FROM T_EmpPayTranDtl A
                                                Left Join T_EmpPayTranDtlHst B
                                                On A.Tpd_IDNo = B.Tpd_IDNo
                                                AND A.Tpd_PayCycle = B.Tpd_PayCycle
                                                AND A.Tpd_Date = B.Tpd_Date
                                                WHERE A.Tpd_PayCycle = @CurPayPeriod
                                                And B.Tpd_PayCycle Is Null";

            public const string countProcess12 = @"SELECT IsNull(Count(Off_EmployeeId), 0) NumEmp FROM T_OffSet WHERE Off_Served = 1 and Off_Type = 'U'";
            public const string countAdded12 = @"SELECT IsNull(Count(Off_EmployeeId), 0) NumEmp
	                                            FROM T_OffSet
	                                            Inner Join T_EmpTimeRegister On Ttr_IDNo = Off_EmployeeId
	                                            and Ttr_Date = Off_DateWork
	                                            Where Off_Served = 0
	                                            and Off_Type = 'U'
	                                            and Ttr_CompWorkMin = Ttr_ForOffsetMin";

            public const string countProcess13 = @"SELECT IsNull(COUNT(Off_EmployeeId), 0) NumEmp FROM T_Offset";
            public const string countAdded13 = @"SELECT IsNull(COUNT(Ttr_IDNo), 0) NumEmp
		                                        FROM T_EmpTimeRegister
		                                        WHERE Ttr_PayCycle = @CURPAYPERIOD
		                                        and Ttr_DayCode = 'SOFF'
		                                        and Ttr_EarnedSatOff > 0";

            public const string countProcess14 = @"SELECT IsNull(COUNT(Off_EmployeeId), 0) NumEmp FROM T_Offset";
            public const string countAdded14 = @"SELECT IsNull(COUNT(Ttr_IDNo), 0) NumEmp
		                                        FROM T_EmpTimeRegister
		                                        WHERE Ttr_PayCycle = @CURPAYPERIOD
		                                        and Ttr_ExcOffset > 0";
            /// Not Sure
            public const string countProcess15 = @"SELECT IsNull(Count(Mem_IDNo), 0) NumEmp
                                                From M_Employee
                                                Inner Join T_EmpTimeRegister on T_EmpTimeRegister.Ttr_IDNo = M_Employee.Mem_IDNo  
                                                Inner Join ( Select Ttr_IDNo
		                                                , RegDate =Max(Ttr_Date)
			                                                From T_EmpTimeRegister
			                                                where Ttr_PayCycle = @CURPAYPERIOD
				                                                and Ttr_DayCode = 'REG'
		                                                Group by Ttr_IDNo) EmpShift on EmpShift.Ttr_IDNo = T_EmpTimeRegister.Ttr_IDNo
					                                                and EmpShift.RegDate = T_EmpTimeRegister.Ttr_Date";


            public const string countProcess16 = @"SELECT IsNull(count(Tlc_IDNo), 0) NumEmp FROM T_EmpLaborCheckHst";
            public const string countAdded16 = @"SELECT IsNull(count(A.Tlc_IDNo), 0) NumEmp 
                                                FROM T_EmpLaborCheck A
                                                Left Join dbo.T_EmpLaborCheckHst B
                                                On A.Tlc_IDNo = B.Tlc_IDNo
                                                And A.Tlc_PayCycle = B.Tlc_PayCycle
                                                WHERE A.Tlc_PayCycle = @CURPAYPERIOD
                                                And B.Tlc_PayCycle Is Null";

            public const string countProcess17 = @"SELECT IsNull(COUNT(Tlv_IDNo), 0) NumEmp FROM T_EmpLeaveHst";
            public const string countAdded17 = @"SELECT IsNull(COUNT(B.Tlv_IDNo), 0) NumEmp 
                                                FROM  T_EmpLeave B
                                                left Join T_EmpLeaveHst C
                                                ON	B.Tlv_IDNo = C.Tlv_IDNo
                                                AND	B.Tlv_LeaveDate = C.Tlv_LeaveDate
                                                AND	B.Tlv_LeaveCode = C.Tlv_LeaveCode
                                                WHERE C.Tlv_LeaveFlag IS NULL
                                                AND B.Tlv_LeaveFlag in ('C','P')";

            public const string countProcess17_1 = @"SELECT IsNull(COUNT(Tll_IDNo), 0) NumEmp FROM T_EmpLeaveLdgCycleHst";
            public const string countAdded17_1 = @"SELECT IsNull(COUNT(A.Tll_IDNo), 0) NumEmp 
                                                FROM T_EmpLeaveLdgCycle A
                                                left Join T_EmpLeaveLdgCycleHst B
                                                ON	A.Tll_IDNo = B.Tll_IDNo
                                                AND	A.Tll_LeaveDate = B.Tll_LeaveDate
                                                AND	A.Tll_LeaveCode = B.Tll_LeaveCode
                                                WHERE B.Tll_LeaveFlag IS NULL
                                                AND A.Tll_LeaveFlag in ('C','P')";

            public const string countProcess18 = @"SELECT IsNull(COUNT(Tlr_IDNo), 0) NumEmp FROM T_EmpLeaveConversionHst";
            public const string countAdded18 = @"SELECT IsNull(COUNT(A.Tlr_IDNo), 0) NumEmp
                                                FROM  T_EmpLeaveConversion A
                                                Left Join T_EmpLeaveConversionHst B
                                                On A.Tlr_IDNo = B.Tlr_IDNo 
                                                And A.Tlr_PayCycle = B.Tlr_PayCycle
                                                And A.Tlr_LeaveCode = B.Tlr_LeaveCode
                                                And A.Tlr_TaxClass = B.Tlr_TaxClass
                                                WHERE A.Tlr_PayCycle = @CURPAYPERIOD
                                                And B.Tlr_PayCycle Is Null";
            public const string countProcess19 = @"SELECT IsNull(COUNT(Tot_IDNo), 0) NumEmp FROM T_EmpOvertimeHst";
            public const string countAdded19 = @"SELECT IsNull(COUNT(A.Tot_IDNo), 0) NumEmp 
                                                FROM  T_EmpOvertime A
                                                Left Join T_EmpOvertimeHst B
                                                On A.Tot_PayCycle = B.Tot_PayCycle
                                                And A.Tot_IDNo = B.Tot_IDNo
                                                And A.Tot_OvertimeDate = B.Tot_OvertimeDate
                                                And A.Tot_OvertimeType = B.Tot_OvertimeType
                                                WHERE A.Tot_PayCycle = @CURPAYPERIOD
                                                AND B.Tot_PayCycle Is Null";

            public const string countProcess20 = @"SELECT IsNull(COUNT(Mem_IDNo), 0) NumEmp FROM M_EmployeeHst";
            public const string countAdded20 = @"SELECT IsNull(COUNT(A.Mem_IDNo), 0) NumEmp FROM M_Employee A
                                                Left Join M_EmployeeHst B
                                                On A.Mem_IDNo = B.Mem_IDNo
                                                And B.Mem_PayCycle = @CURPAYPERIOD
                                                Where B.Ludatetime Is Null";

            public const string countProcessUnionDues = @"SELECT IsNull(COUNT(Mup_IDNo), 0) NumEmp FROM M_EmpUnionHst";
            public const string countAddedUnionDues = @"SELECT IsNull(COUNT(A.Mup_IDNo), 0) NumEmp FROM M_EmpUnion A
                                                Left Join M_EmpUnionHst B
                                                On A.Mup_IDNo = B.Mup_IDNo
                                                And B.Mup_PayCycle = @CURPAYPERIOD
                                                Where B.Ludatetime Is Null";

            public const string countProcess21 = @"SELECT IsNull(COUNT(Eof_EmployeeId), 0) NumEmp FROM T_EmployeeOffsetHist";
            public const string countAdded21 = @"SELECT IsNull(COUNT(A.Eof_EmployeeId), 0) NumEmp 
                                                FROM  T_EmployeeOffset A
                                                Left Join T_EmployeeOffsetHist B
                                                On A.Eof_CurrentPayPeriod = B.Eof_CurrentPayPeriod
                                                And A.Eof_EmployeeId = B.Eof_EmployeeId
                                                And A.Eof_OffsetDate = B.Eof_OffsetDate
                                                And A.Eof_Seqno = B.Eof_Seqno
                                                WHERE A.Eof_CurrentPayPeriod = @CURPAYPERIOD
                                                AND B.Eof_CurrentPayPeriod Is Null";

            public const string countProcess22 = @"SELECT IsNull(COUNT(Ttm_IDNo), 0) NumEmp FROM T_EmpTimeCorrectionHst";
            public const string countAdded22 = @"SELECT IsNull(COUNT(A.Ttm_IDNo), 0) NumEmp 
                                                FROM  T_EmpTimeCorrection A
                                                Left Join T_EmpTimeCorrectionHst B
                                                On A.Ttm_PayCycle = B.Ttm_PayCycle
                                                And A.Ttm_IDNo = B.Ttm_IDNo
                                                And A.Ttm_TimeCorDate = B.Ttm_TimeCorDate
                                                And A.Ttm_TimeCorType = B.Ttm_TimeCorType
                                                WHERE A.Ttm_PayCycle = @CURPAYPERIOD
                                                AND B.Ttm_PayCycle Is Null";

            #endregion
            #region [InsertUpdate  for Cycle Closing]
            public const string insertIncome= @"INSERT INTO T_EmpIncomeHst
                                                        (Tin_IDNo,
                                                        Tin_PayCycle,
                                                        Tin_OrigPayCycle,
                                                        Tin_IncomeCode,
                                                        Tin_PostFlag,
                                                        Tin_IncomeAmt,
                                                        Usr_Login,
                                                        Ludatetime) 
                                                    SELECT 
                                                        A.Tin_IDNo,
	                                                    A.Tin_PayCycle,
                                                        A.Tin_OrigPayCycle,
	                                                    A.Tin_IncomeCode,
	                                                    A.Tin_PostFlag,
	                                                    A.Tin_IncomeAmt,
	                                                    A.Usr_Login,
	                                                    A.Ludatetime
                                                    FROM T_EmpIncome A
                                                    LEFT JOIN T_EmpIncomeHst B
                                                    ON A.Tin_IDNo = B.Tin_IDNo
                                                    AND A.Tin_PayCycle = B.Tin_PayCycle
                                                    AND A.Tin_OrigPayCycle = B.Tin_OrigPayCycle
                                                    AND A.Tin_IncomeCode = B.Tin_IncomeCode
                                                    WHERE A.Tin_PayCycle = @CurPayPeriod
                                                    AND B.Tin_PayCycle IS NULL";
            public const string insertTimeBasedIncome = @"INSERT INTO T_EmpTimeBaseAllowanceCycleHst
                                                        (Tta_IDNo,
                                                        Tta_PayCycle,
														Tta_OrigPayCycle,
                                                        Tta_IncomeCode,
                                                        Tta_PostFlag,
                                                        Tta_IncomeAmt,
                                                        Tta_CycleIndicator,
                                                        Usr_Login,
                                                        Ludatetime) 
                                                    SELECT 
                                                        A.Tta_IDNo,
	                                                    A.Tta_PayCycle,
														A.Tta_OrigPayCycle,
	                                                    A.Tta_IncomeCode,
	                                                    A.Tta_PostFlag,
	                                                    A.Tta_IncomeAmt,
                                                        A.Tta_CycleIndicator,
	                                                    A.Usr_Login,
	                                                    A.Ludatetime
                                                    FROM T_EmpTimeBaseAllowanceCycle A
                                                    LEFT JOIN T_EmpTimeBaseAllowanceCycleHst B
                                                    ON A.Tta_IDNo = B.Tta_IDNo
                                                    AND A.Tta_PayCycle = B.Tta_PayCycle
													AND A.Tta_OrigPayCycle = B.Tta_OrigPayCycle
                                                    AND A.Tta_IncomeCode = B.Tta_IncomeCode
                                                    WHERE A.Tta_PayCycle = @CurPayPeriod
                                                    AND B.Tta_PayCycle IS NULL";

            public const string updateTimeBasedIncome = @"UPDATE T_EmpTimeBaseAllowanceCycle SET Tta_PayCycle = @CurPayPeriod
                                                                , Tta_IncomeCode = CASE WHEN Tta_CycleIndicator = 'C' THEN Mvh_CarryOverAllowanceCode ELSE Mvh_CarryOverAllowanceCode END
                                                                , Usr_Login = @UserLogin
                                                                , Ludatetime = GETDATE()
                                                                FROM T_EmpTimeBaseAllowanceCycle 
                                                                LEFT JOIN {0}..M_VarianceAllowanceHdr 
	                                                                ON Tta_IncomeCode = CASE WHEN Tta_CycleIndicator = 'C' THEN Mvh_AllowanceCode ELSE Mvh_AllowanceCode END
	                                                                AND Mvh_CompanyCode = @CompanyCode
                                                                WHERE Tta_PostFlag = 0
	                                                                AND Tta_PayCycle = @CurPayPeriod";

            public const string insertBackupIncomeMaster = @"INSERT INTO M_IncomeHst
                                                            (Min_CompanyCode
                                                            ,Min_PayCycle
                                                            ,Min_IncomeCode
                                                            ,Min_IncomeName
                                                            ,Min_TaxClass
                                                            ,Min_IsRecurring
                                                            ,Min_ApplicablePayCycle
                                                            ,Min_IncomeGroup
                                                            ,Min_AlphalistCategory
                                                            ,Min_IsSystemReserved
                                                            ,Min_AccountGrp
                                                            ,Min_RemittanceLoanType
                                                            ,Min_ProcessFlag
                                                            ,Min_ProcessInfo
                                                            ,Min_RecordStatus
                                                            ,Min_CreatedBy
                                                            ,Min_CreatedDate
                                                            ,Min_UpdatedBy
                                                            ,Min_UpdatedDate)
                                                            SELECT Min_CompanyCode
                                                            , @CurPayPeriod
                                                            ,Min_IncomeCode
                                                            ,Min_IncomeName
                                                            ,Min_TaxClass
                                                            ,Min_IsRecurring
                                                            ,Min_ApplicablePayCycle
                                                            ,Min_IncomeGroup
                                                            ,Min_AlphalistCategory
                                                            ,Min_IsSystemReserved
                                                            ,Min_AccountGrp
                                                            ,Min_RemittanceLoanType
                                                            ,Min_ProcessFlag
                                                            ,Min_ProcessInfo
                                                            ,Min_RecordStatus
                                                            ,Min_CreatedBy
                                                            ,Min_CreatedDate
                                                            ,Min_UpdatedBy
                                                            ,Min_UpdatedDate
                                                            FROM B_Income
                                                            WHERE Min_CompanyCode = @CompanyCode";

            public const string insertManualAdj = @"INSERT INTO T_EmpManualAdjHst (Tma_IDNo
                                                , Tma_PayCycle
                                                , Tma_OrigPayCycle
                                                , Tma_SalaryRate
                                                , Tma_REGHr
                                                , Tma_REGOTHr
                                                , Tma_REGNDHr
                                                , Tma_REGNDOTHr
                                                , Tma_RESTHr
                                                , Tma_RESTOTHr
                                                , Tma_RESTNDHr
                                                , Tma_RESTNDOTHr
                                                , Tma_LEGHOLHr
                                                , Tma_LEGHOLOTHr
                                                , Tma_LEGHOLNDHr
                                                , Tma_LEGHOLNDOTHr
                                                , Tma_SPLHOLHr
                                                , Tma_SPLHOLOTHr
                                                , Tma_SPLHOLNDHr
                                                , Tma_SPLHOLNDOTHr
                                                , Tma_PSDHr
                                                , Tma_PSDOTHr
                                                , Tma_PSDNDHr
                                                , Tma_PSDNDOTHr
                                                , Tma_COMPHOLHr
                                                , Tma_COMPHOLOTHr
                                                , Tma_COMPHOLNDHr
                                                , Tma_COMPHOLNDOTHr
                                                , Tma_RESTLEGHOLHr
                                                , Tma_RESTLEGHOLOTHr
                                                , Tma_RESTLEGHOLNDHr
                                                , Tma_RESTLEGHOLNDOTHr
                                                , Tma_RESTSPLHOLHr
                                                , Tma_RESTSPLHOLOTHr
                                                , Tma_RESTSPLHOLNDHr
                                                , Tma_RESTSPLHOLNDOTHr
                                                , Tma_RESTCOMPHOLHr
                                                , Tma_RESTCOMPHOLOTHr
                                                , Tma_RESTCOMPHOLNDHr
                                                , Tma_RESTCOMPHOLNDOTHr
                                                , Tma_RESTPSDHr
                                                , Tma_RESTPSDOTHr
                                                , Tma_RESTPSDNDHr
                                                , Tma_RESTPSDNDOTHr
                                                , Tma_PDLEGHOLHr
                                                , Tma_PDSPLHOLHr
                                                , Tma_PDCOMPHOLHr
                                                , Tma_PDPSDHr
                                                , Tma_PDOTHHOLHr
                                                , Tma_PostFlag
                                                , Tma_Remarks
                                                , Tma_RetainUserEntry
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tma_IDNo
	                                                , A.Tma_PayCycle
                                                    , A.Tma_OrigPayCycle
	                                                , A.Tma_SalaryRate
	                                                , A.Tma_REGHr
	                                                , A.Tma_REGOTHr
	                                                , A.Tma_REGNDHr
	                                                , A.Tma_REGNDOTHr
	                                                , A.Tma_RESTHr
	                                                , A.Tma_RESTOTHr
	                                                , A.Tma_RESTNDHr
	                                                , A.Tma_RESTNDOTHr
	                                                , A.Tma_LEGHOLHr
	                                                , A.Tma_LEGHOLOTHr
	                                                , A.Tma_LEGHOLNDHr
	                                                , A.Tma_LEGHOLNDOTHr
	                                                , A.Tma_SPLHOLHr
	                                                , A.Tma_SPLHOLOTHr
	                                                , A.Tma_SPLHOLNDHr
	                                                , A.Tma_SPLHOLNDOTHr
	                                                , A.Tma_PSDHr
	                                                , A.Tma_PSDOTHr
	                                                , A.Tma_PSDNDHr
	                                                , A.Tma_PSDNDOTHr
	                                                , A.Tma_COMPHOLHr
	                                                , A.Tma_COMPHOLOTHr
	                                                , A.Tma_COMPHOLNDHr
	                                                , A.Tma_COMPHOLNDOTHr
	                                                , A.Tma_RESTLEGHOLHr
	                                                , A.Tma_RESTLEGHOLOTHr
	                                                , A.Tma_RESTLEGHOLNDHr
	                                                , A.Tma_RESTLEGHOLNDOTHr
	                                                , A.Tma_RESTSPLHOLHr
	                                                , A.Tma_RESTSPLHOLOTHr
	                                                , A.Tma_RESTSPLHOLNDHr
	                                                , A.Tma_RESTSPLHOLNDOTHr
	                                                , A.Tma_RESTCOMPHOLHr
	                                                , A.Tma_RESTCOMPHOLOTHr
	                                                , A.Tma_RESTCOMPHOLNDHr
	                                                , A.Tma_RESTCOMPHOLNDOTHr
	                                                , A.Tma_RESTPSDHr
	                                                , A.Tma_RESTPSDOTHr
	                                                , A.Tma_RESTPSDNDHr
	                                                , A.Tma_RESTPSDNDOTHr
	                                                , A.Tma_PDLEGHOLHr
	                                                , A.Tma_PDSPLHOLHr
	                                                , A.Tma_PDCOMPHOLHr
	                                                , A.Tma_PDPSDHr
	                                                , A.Tma_PDOTHHOLHr
	                                                , A.Tma_PostFlag
	                                                , A.Tma_Remarks
	                                                , A.Tma_RetainUserEntry
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM T_EmpManualAdj A
                                                LEFT JOIN T_EmpManualAdjHst B ON A.Tma_IDNo = B.Tma_IDNo
	                                                AND A.Tma_PayCycle = B.Tma_PayCycle
                                                    AND A.Tma_OrigPayCycle = B.Tma_OrigPayCycle
	                                                AND A.Tma_SalaryRate = B.Tma_SalaryRate 
                                                WHERE A.Tma_PayCycle = @CurPayPeriod
	                                                AND B.Tma_PayCycle IS NULL


                                                INSERT INTO T_EmpManualAdj2Hst ( Tma_IDNo
                                                , Tma_PayCycle
                                                , Tma_OrigPayCycle
                                                , Tma_SalaryRate
                                                , Tma_REGAmt
                                                , Tma_REGOTAmt
                                                , Tma_REGNDAmt
                                                , Tma_REGNDOTAmt
                                                , Tma_RESTAmt
                                                , Tma_RESTOTAmt
                                                , Tma_RESTNDAmt
                                                , Tma_RESTNDOTAmt
                                                , Tma_LEGHOLAmt
                                                , Tma_LEGHOLOTAmt
                                                , Tma_LEGHOLNDAmt
                                                , Tma_LEGHOLNDOTAmt
                                                , Tma_SPLHOLAmt
                                                , Tma_SPLHOLOTAmt
                                                , Tma_SPLHOLNDAmt
                                                , Tma_SPLHOLNDOTAmt
                                                , Tma_PSDAmt
                                                , Tma_PSDOTAmt
                                                , Tma_PSDNDAmt
                                                , Tma_PSDNDOTAmt
                                                , Tma_COMPHOLAmt
                                                , Tma_COMPHOLOTAmt
                                                , Tma_COMPHOLNDAmt
                                                , Tma_COMPHOLNDOTAmt
                                                , Tma_RESTLEGHOLAmt
                                                , Tma_RESTLEGHOLOTAmt
                                                , Tma_RESTLEGHOLNDAmt
                                                , Tma_RESTLEGHOLNDOTAmt
                                                , Tma_RESTSPLHOLAmt
                                                , Tma_RESTSPLHOLOTAmt
                                                , Tma_RESTSPLHOLNDAmt
                                                , Tma_RESTSPLHOLNDOTAmt
                                                , Tma_RESTCOMPHOLAmt
                                                , Tma_RESTCOMPHOLOTAmt
                                                , Tma_RESTCOMPHOLNDAmt
                                                , Tma_RESTCOMPHOLNDOTAmt
                                                , Tma_RESTPSDAmt
                                                , Tma_RESTPSDOTAmt
                                                , Tma_RESTPSDNDAmt
                                                , Tma_RESTPSDNDOTAmt
                                                , Tma_PDLEGHOLAmt
                                                , Tma_PDSPLHOLAmt
                                                , Tma_PDCOMPHOLAmt
                                                , Tma_PDPSDAmt
                                                , Tma_PDOTHHOLAmt
                                                , Tma_HourRate
                                                , Tma_PayrollType
                                                , Tma_PremiumGrpCode
                                                , Tma_RGAdjAmt
                                                , Tma_OTAdjAmt
                                                , Tma_HOLAdjAmt
                                                , Tma_NDAdjAmt
                                                , Tma_TotalAdjAmt
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tma_IDNo
	                                                , A.Tma_PayCycle
                                                    , A.Tma_OrigPayCycle
	                                                , A.Tma_SalaryRate
	                                                , A.Tma_REGAmt
	                                                , A.Tma_REGOTAmt
	                                                , A.Tma_REGNDAmt
	                                                , A.Tma_REGNDOTAmt
	                                                , A.Tma_RESTAmt
	                                                , A.Tma_RESTOTAmt
	                                                , A.Tma_RESTNDAmt
	                                                , A.Tma_RESTNDOTAmt
	                                                , A.Tma_LEGHOLAmt
	                                                , A.Tma_LEGHOLOTAmt
	                                                , A.Tma_LEGHOLNDAmt
	                                                , A.Tma_LEGHOLNDOTAmt
	                                                , A.Tma_SPLHOLAmt
	                                                , A.Tma_SPLHOLOTAmt
	                                                , A.Tma_SPLHOLNDAmt
	                                                , A.Tma_SPLHOLNDOTAmt
	                                                , A.Tma_PSDAmt
	                                                , A.Tma_PSDOTAmt
	                                                , A.Tma_PSDNDAmt
	                                                , A.Tma_PSDNDOTAmt
	                                                , A.Tma_COMPHOLAmt
	                                                , A.Tma_COMPHOLOTAmt
	                                                , A.Tma_COMPHOLNDAmt
	                                                , A.Tma_COMPHOLNDOTAmt
	                                                , A.Tma_RESTLEGHOLAmt
	                                                , A.Tma_RESTLEGHOLOTAmt
	                                                , A.Tma_RESTLEGHOLNDAmt
	                                                , A.Tma_RESTLEGHOLNDOTAmt
	                                                , A.Tma_RESTSPLHOLAmt
	                                                , A.Tma_RESTSPLHOLOTAmt
	                                                , A.Tma_RESTSPLHOLNDAmt
	                                                , A.Tma_RESTSPLHOLNDOTAmt
	                                                , A.Tma_RESTCOMPHOLAmt
	                                                , A.Tma_RESTCOMPHOLOTAmt
	                                                , A.Tma_RESTCOMPHOLNDAmt
	                                                , A.Tma_RESTCOMPHOLNDOTAmt
	                                                , A.Tma_RESTPSDAmt
	                                                , A.Tma_RESTPSDOTAmt
	                                                , A.Tma_RESTPSDNDAmt
	                                                , A.Tma_RESTPSDNDOTAmt
	                                                , A.Tma_PDLEGHOLAmt
	                                                , A.Tma_PDSPLHOLAmt
	                                                , A.Tma_PDCOMPHOLAmt
	                                                , A.Tma_PDPSDAmt
	                                                , A.Tma_PDOTHHOLAmt
	                                                , A.Tma_HourRate
	                                                , A.Tma_PayrollType
                                                    , A.Tma_PremiumGrpCode
	                                                , A.Tma_RGAdjAmt
	                                                , A.Tma_OTAdjAmt
	                                                , A.Tma_HOLAdjAmt
	                                                , A.Tma_NDAdjAmt
	                                                , A.Tma_TotalAdjAmt
	                                                , A.Usr_Login
	                                                , A.Ludatetime                    
                                                FROM T_EmpManualAdj2 A
                                                LEFT JOIN T_EmpManualAdj2Hst B ON A.Tma_IDNo = B.Tma_IDNo
	                                                AND A.Tma_PayCycle = B.Tma_PayCycle
                                                    AND A.Tma_OrigPayCycle = B.Tma_OrigPayCycle
	                                                AND A.Tma_SalaryRate = B.Tma_SalaryRate
                                                WHERE A.Tma_PayCycle = @CurPayPeriod
	                                                AND B.Tma_PayCycle IS NULL


                                                INSERT INTO T_EmpManualAdjMiscHst (Tmm_IDNo
                                                , Tmm_PayCycle
                                                , Tmm_OrigPayCycle
                                                , Tmm_SalaryRate
                                                , Tmm_Misc1Hr
                                                , Tmm_Misc1OTHr
                                                , Tmm_Misc1NDHr
                                                , Tmm_Misc1NDOTHr
                                                , Tmm_Misc2Hr
                                                , Tmm_Misc2OTHr
                                                , Tmm_Misc2NDHr
                                                , Tmm_Misc2NDOTHr
                                                , Tmm_Misc3Hr
                                                , Tmm_Misc3OTHr
                                                , Tmm_Misc3NDHr
                                                , Tmm_Misc3NDOTHr
                                                , Tmm_Misc4Hr
                                                , Tmm_Misc4OTHr
                                                , Tmm_Misc4NDHr
                                                , Tmm_Misc4NDOTHr
                                                , Tmm_Misc5Hr
                                                , Tmm_Misc5OTHr
                                                , Tmm_Misc5NDHr
                                                , Tmm_Misc5NDOTHr
                                                , Tmm_Misc6Hr
                                                , Tmm_Misc6OTHr
                                                , Tmm_Misc6NDHr
                                                , Tmm_Misc6NDOTHr
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tmm_IDNo
	                                                , A.Tmm_PayCycle
                                                    , A.Tmm_OrigPayCycle
	                                                , A.Tmm_SalaryRate
	                                                , A.Tmm_Misc1Hr
	                                                , A.Tmm_Misc1OTHr
	                                                , A.Tmm_Misc1NDHr
	                                                , A.Tmm_Misc1NDOTHr
	                                                , A.Tmm_Misc2Hr
	                                                , A.Tmm_Misc2OTHr
	                                                , A.Tmm_Misc2NDHr
	                                                , A.Tmm_Misc2NDOTHr
	                                                , A.Tmm_Misc3Hr
	                                                , A.Tmm_Misc3OTHr
	                                                , A.Tmm_Misc3NDHr
	                                                , A.Tmm_Misc3NDOTHr
	                                                , A.Tmm_Misc4Hr
	                                                , A.Tmm_Misc4OTHr
	                                                , A.Tmm_Misc4NDHr
	                                                , A.Tmm_Misc4NDOTHr
	                                                , A.Tmm_Misc5Hr
	                                                , A.Tmm_Misc5OTHr
	                                                , A.Tmm_Misc5NDHr
	                                                , A.Tmm_Misc5NDOTHr
	                                                , A.Tmm_Misc6Hr
	                                                , A.Tmm_Misc6OTHr
	                                                , A.Tmm_Misc6NDHr
	                                                , A.Tmm_Misc6NDOTHr
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM T_EmpManualAdjMisc A
                                                LEFT JOIN T_EmpManualAdjMiscHst B ON A.Tmm_IDNo = B.Tmm_IDNo
	                                                AND A.Tmm_PayCycle = B.Tmm_PayCycle
                                                    AND A.Tmm_OrigPayCycle = B.Tmm_OrigPayCycle
	                                                AND A.Tmm_SalaryRate = B.Tmm_SalaryRate
                                                WHERE A.Tmm_PayCycle = @CurPayPeriod
	                                                AND B.Tmm_PayCycle IS NULL


                                                INSERT INTO T_EmpManualAdjMisc2Hst (Tmm_IDNo
                                                , Tmm_PayCycle
                                                , Tmm_OrigPayCycle
                                                , Tmm_SalaryRate
                                                , Tmm_Misc1Amt
                                                , Tmm_Misc1OTAmt
                                                , Tmm_Misc1NDAmt
                                                , Tmm_Misc1NDOTAmt
                                                , Tmm_Misc2Amt
                                                , Tmm_Misc2OTAmt
                                                , Tmm_Misc2NDAmt
                                                , Tmm_Misc2NDOTAmt
                                                , Tmm_Misc3Amt
                                                , Tmm_Misc3OTAmt
                                                , Tmm_Misc3NDAmt
                                                , Tmm_Misc3NDOTAmt
                                                , Tmm_Misc4Amt
                                                , Tmm_Misc4OTAmt
                                                , Tmm_Misc4NDAmt
                                                , Tmm_Misc4NDOTAmt
                                                , Tmm_Misc5Amt
                                                , Tmm_Misc5OTAmt
                                                , Tmm_Misc5NDAmt
                                                , Tmm_Misc5NDOTAmt
                                                , Tmm_Misc6Amt
                                                , Tmm_Misc6OTAmt
                                                , Tmm_Misc6NDAmt
                                                , Tmm_Misc6NDOTAmt
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tmm_IDNo
	                                                , A.Tmm_PayCycle
                                                    , A.Tmm_OrigPayCycle
	                                                , A.Tmm_SalaryRate
	                                                , A.Tmm_Misc1Amt
	                                                , A.Tmm_Misc1OTAmt
	                                                , A.Tmm_Misc1NDAmt
	                                                , A.Tmm_Misc1NDOTAmt
	                                                , A.Tmm_Misc2Amt
	                                                , A.Tmm_Misc2OTAmt
	                                                , A.Tmm_Misc2NDAmt
	                                                , A.Tmm_Misc2NDOTAmt
	                                                , A.Tmm_Misc3Amt
	                                                , A.Tmm_Misc3OTAmt
	                                                , A.Tmm_Misc3NDAmt
	                                                , A.Tmm_Misc3NDOTAmt
	                                                , A.Tmm_Misc4Amt
	                                                , A.Tmm_Misc4OTAmt
	                                                , A.Tmm_Misc4NDAmt
	                                                , A.Tmm_Misc4NDOTAmt
	                                                , A.Tmm_Misc5Amt
	                                                , A.Tmm_Misc5OTAmt
	                                                , A.Tmm_Misc5NDAmt
	                                                , A.Tmm_Misc5NDOTAmt
	                                                , A.Tmm_Misc6Amt
	                                                , A.Tmm_Misc6OTAmt
	                                                , A.Tmm_Misc6NDAmt
	                                                , A.Tmm_Misc6NDOTAmt
	                                                , A.Usr_Login
	                                                , A.Ludatetime     
                                                FROM T_EmpManualAdjMisc2 A
                                                LEFT JOIN T_EmpManualAdjMisc2Hst B ON A.Tmm_IDNo = B.Tmm_IDNo
	                                                AND A.Tmm_PayCycle = B.Tmm_PayCycle
                                                    AND A.Tmm_OrigPayCycle = B.Tmm_OrigPayCycle
	                                                AND A.Tmm_SalaryRate = B.Tmm_SalaryRate
                                                WHERE A.Tmm_PayCycle = @CurPayPeriod
	                                                AND B.Tmm_PayCycle IS NULL";

            public const string insertSystemAdj = @"INSERT INTO T_EmpSystemAdjHst 
                                                    (Tsa_IDNo
                                                    ,Tsa_AdjPayCycle
                                                    ,Tsa_OrigAdjPayCycle
                                                    ,Tsa_PayCycle
                                                    ,Tsa_Date
                                                    ,Tsa_LTHr
                                                    ,Tsa_UTHr
                                                    ,Tsa_UPLVHr
                                                    ,Tsa_ABSLEGHOLHr
                                                    ,Tsa_ABSSPLHOLHr
                                                    ,Tsa_ABSCOMPHOLHr
                                                    ,Tsa_ABSPSDHr
                                                    ,Tsa_ABSOTHHOLHr
                                                    ,Tsa_WDABSHr
                                                    ,Tsa_LTUTMaxHr
                                                    ,Tsa_ABSHr
                                                    ,Tsa_REGHr
                                                    ,Tsa_PDLVHr
                                                    ,Tsa_PDLEGHOLHr
                                                    ,Tsa_PDSPLHOLHr
                                                    ,Tsa_PDCOMPHOLHr
                                                    ,Tsa_PDPSDHr
                                                    ,Tsa_PDOTHHOLHr
                                                    ,Tsa_PDRESTLEGHOLHr
                                                    ,Tsa_REGOTHr
                                                    ,Tsa_REGNDHr
                                                    ,Tsa_REGNDOTHr
                                                    ,Tsa_RESTHr
                                                    ,Tsa_RESTOTHr
                                                    ,Tsa_RESTNDHr
                                                    ,Tsa_RESTNDOTHr
                                                    ,Tsa_LEGHOLHr
                                                    ,Tsa_LEGHOLOTHr
                                                    ,Tsa_LEGHOLNDHr
                                                    ,Tsa_LEGHOLNDOTHr
                                                    ,Tsa_SPLHOLHr
                                                    ,Tsa_SPLHOLOTHr
                                                    ,Tsa_SPLHOLNDHr
                                                    ,Tsa_SPLHOLNDOTHr
                                                    ,Tsa_PSDHr
                                                    ,Tsa_PSDOTHr
                                                    ,Tsa_PSDNDHr
                                                    ,Tsa_PSDNDOTHr
                                                    ,Tsa_COMPHOLHr
                                                    ,Tsa_COMPHOLOTHr
                                                    ,Tsa_COMPHOLNDHr
                                                    ,Tsa_COMPHOLNDOTHr
                                                    ,Tsa_RESTLEGHOLHr
                                                    ,Tsa_RESTLEGHOLOTHr
                                                    ,Tsa_RESTLEGHOLNDHr
                                                    ,Tsa_RESTLEGHOLNDOTHr
                                                    ,Tsa_RESTSPLHOLHr
                                                    ,Tsa_RESTSPLHOLOTHr
                                                    ,Tsa_RESTSPLHOLNDHr
                                                    ,Tsa_RESTSPLHOLNDOTHr
                                                    ,Tsa_RESTCOMPHOLHr
                                                    ,Tsa_RESTCOMPHOLOTHr
                                                    ,Tsa_RESTCOMPHOLNDHr
                                                    ,Tsa_RESTCOMPHOLNDOTHr
                                                    ,Tsa_RESTPSDHr
                                                    ,Tsa_RESTPSDOTHr
                                                    ,Tsa_RESTPSDNDHr
                                                    ,Tsa_RESTPSDNDOTHr
                                                    ,Tsa_PostFlag
                                                    , Usr_Login
                                                    , Ludatetime )
                                                    SELECT A.Tsa_IDNo
                                                        ,A.Tsa_AdjPayCycle
                                                        ,A.Tsa_OrigAdjPayCycle
                                                        ,A.Tsa_PayCycle
                                                        ,A.Tsa_Date
                                                        ,A.Tsa_LTHr
                                                        ,A.Tsa_UTHr
                                                        ,A.Tsa_UPLVHr
                                                        ,A.Tsa_ABSLEGHOLHr
                                                        ,A.Tsa_ABSSPLHOLHr
                                                        ,A.Tsa_ABSCOMPHOLHr
                                                        ,A.Tsa_ABSPSDHr
                                                        ,A.Tsa_ABSOTHHOLHr
                                                        ,A.Tsa_WDABSHr
                                                        ,A.Tsa_LTUTMaxHr
                                                        ,A.Tsa_ABSHr
                                                        ,A.Tsa_REGHr
                                                        ,A.Tsa_PDLVHr
                                                        ,A.Tsa_PDLEGHOLHr
                                                        ,A.Tsa_PDSPLHOLHr
                                                        ,A.Tsa_PDCOMPHOLHr
                                                        ,A.Tsa_PDPSDHr
                                                        ,A.Tsa_PDOTHHOLHr
                                                        ,A.Tsa_PDRESTLEGHOLHr
                                                        ,A.Tsa_REGOTHr
                                                        ,A.Tsa_REGNDHr
                                                        ,A.Tsa_REGNDOTHr
                                                        ,A.Tsa_RESTHr
                                                        ,A.Tsa_RESTOTHr
                                                        ,A.Tsa_RESTNDHr
                                                        ,A.Tsa_RESTNDOTHr
                                                        ,A.Tsa_LEGHOLHr
                                                        ,A.Tsa_LEGHOLOTHr
                                                        ,A.Tsa_LEGHOLNDHr
                                                        ,A.Tsa_LEGHOLNDOTHr
                                                        ,A.Tsa_SPLHOLHr
                                                        ,A.Tsa_SPLHOLOTHr
                                                        ,A.Tsa_SPLHOLNDHr
                                                        ,A.Tsa_SPLHOLNDOTHr
                                                        ,A.Tsa_PSDHr
                                                        ,A.Tsa_PSDOTHr
                                                        ,A.Tsa_PSDNDHr
                                                        ,A.Tsa_PSDNDOTHr
                                                        ,A.Tsa_COMPHOLHr
                                                        ,A.Tsa_COMPHOLOTHr
                                                        ,A.Tsa_COMPHOLNDHr
                                                        ,A.Tsa_COMPHOLNDOTHr
                                                        ,A.Tsa_RESTLEGHOLHr
                                                        ,A.Tsa_RESTLEGHOLOTHr
                                                        ,A.Tsa_RESTLEGHOLNDHr
                                                        ,A.Tsa_RESTLEGHOLNDOTHr
                                                        ,A.Tsa_RESTSPLHOLHr
                                                        ,A.Tsa_RESTSPLHOLOTHr
                                                        ,A.Tsa_RESTSPLHOLNDHr
                                                        ,A.Tsa_RESTSPLHOLNDOTHr
                                                        ,A.Tsa_RESTCOMPHOLHr
                                                        ,A.Tsa_RESTCOMPHOLOTHr
                                                        ,A.Tsa_RESTCOMPHOLNDHr
                                                        ,A.Tsa_RESTCOMPHOLNDOTHr
                                                        ,A.Tsa_RESTPSDHr
                                                        ,A.Tsa_RESTPSDOTHr
                                                        ,A.Tsa_RESTPSDNDHr
                                                        ,A.Tsa_RESTPSDNDOTHr
                                                        ,A.Tsa_PostFlag
	                                                    ,A.Usr_Login
	                                                    ,A.Ludatetime
                                                    FROM T_EmpSystemAdj A
                                                    LEFT JOIN T_EmpSystemAdjHst B ON A.Tsa_IDNo = B.Tsa_IDNo
	                                                    AND A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                        AND A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
	                                                    AND A.Tsa_PayCycle = B.Tsa_PayCycle
	                                                    AND A.Tsa_Date = B.Tsa_Date
                                                    WHERE A.Tsa_AdjPayCycle = @CurPayPeriod
	                                                    AND B.Tsa_AdjPayCycle IS NULL

                                                    INSERT INTO T_EmpSystemAdj2Hst (Tsa_IDNo
                                                    , Tsa_AdjPayCycle
                                                    , Tsa_OrigAdjPayCycle
                                                    , Tsa_PayCycle
                                                    , Tsa_Date
                                                    , Tsa_SalaryRate
                                                    , Tsa_HourRate
                                                    , Tsa_PayrollType
                                                    , Tsa_SpecialRate
                                                    , Tsa_SpecialHourRate
                                                    , Tsa_LTAmt
                                                    , Tsa_UTAmt
                                                    , Tsa_UPLVAmt
                                                    , Tsa_ABSLEGHOLAmt
                                                    , Tsa_ABSSPLHOLAmt
                                                    , Tsa_ABSCOMPHOLAmt
                                                    , Tsa_ABSPSDAmt
                                                    , Tsa_ABSOTHHOLAmt
                                                    , Tsa_WDABSAmt
                                                    , Tsa_LTUTMaxAmt
                                                    , Tsa_ABSAmt
                                                    , Tsa_REGAmt
                                                    , Tsa_PDLVAmt
                                                    , Tsa_PDLEGHOLAmt
                                                    , Tsa_PDSPLHOLAmt
                                                    , Tsa_PDCOMPHOLAmt
                                                    , Tsa_PDPSDAmt
                                                    , Tsa_PDOTHHOLAmt
                                                    , Tsa_PDRESTLEGHOLAmt
                                                    , Tsa_REGOTAmt
                                                    , Tsa_REGNDAmt
                                                    , Tsa_REGNDOTAmt
                                                    , Tsa_RESTAmt
                                                    , Tsa_RESTOTAmt
                                                    , Tsa_RESTNDAmt
                                                    , Tsa_RESTNDOTAmt
                                                    , Tsa_LEGHOLAmt
                                                    , Tsa_LEGHOLOTAmt
                                                    , Tsa_LEGHOLNDAmt
                                                    , Tsa_LEGHOLNDOTAmt
                                                    , Tsa_SPLHOLAmt
                                                    , Tsa_SPLHOLOTAmt
                                                    , Tsa_SPLHOLNDAmt
                                                    , Tsa_SPLHOLNDOTAmt
                                                    , Tsa_PSDAmt
                                                    , Tsa_PSDOTAmt
                                                    , Tsa_PSDNDAmt
                                                    , Tsa_PSDNDOTAmt
                                                    , Tsa_COMPHOLAmt
                                                    , Tsa_COMPHOLOTAmt
                                                    , Tsa_COMPHOLNDAmt
                                                    , Tsa_COMPHOLNDOTAmt
                                                    , Tsa_RESTLEGHOLAmt
                                                    , Tsa_RESTLEGHOLOTAmt
                                                    , Tsa_RESTLEGHOLNDAmt
                                                    , Tsa_RESTLEGHOLNDOTAmt
                                                    , Tsa_RESTSPLHOLAmt
                                                    , Tsa_RESTSPLHOLOTAmt
                                                    , Tsa_RESTSPLHOLNDAmt
                                                    , Tsa_RESTSPLHOLNDOTAmt
                                                    , Tsa_RESTCOMPHOLAmt
                                                    , Tsa_RESTCOMPHOLOTAmt
                                                    , Tsa_RESTCOMPHOLNDAmt
                                                    , Tsa_RESTCOMPHOLNDOTAmt
                                                    , Tsa_RESTPSDAmt
                                                    , Tsa_RESTPSDOTAmt
                                                    , Tsa_RESTPSDNDAmt
                                                    , Tsa_RESTPSDNDOTAmt
                                                    , Tsa_RGAdjAmt
                                                    , Tsa_OTAdjAmt
                                                    , Tsa_HOLAdjAmt
                                                    , Tsa_NDAdjAmt
                                                    , Tsa_LVAdjAmt
                                                    , Tsa_TotalAdjAmt
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tsa_IDNo
	                                                    , A.Tsa_AdjPayCycle 
                                                        , A.Tsa_OrigAdjPayCycle
	                                                    , A.Tsa_PayCycle
	                                                    , A.Tsa_Date
	                                                    , A.Tsa_SalaryRate
	                                                    , A.Tsa_HourRate
	                                                    , A.Tsa_PayrollType
                                                        , A.Tsa_SpecialRate
                                                        , A.Tsa_SpecialHourRate
	                                                    , A.Tsa_LTAmt
	                                                    , A.Tsa_UTAmt
                                                        , A.Tsa_UPLVAmt
	                                                    , A.Tsa_ABSLEGHOLAmt
	                                                    , A.Tsa_ABSSPLHOLAmt
	                                                    , A.Tsa_ABSCOMPHOLAmt
	                                                    , A.Tsa_ABSPSDAmt
	                                                    , A.Tsa_ABSOTHHOLAmt
	                                                    , A.Tsa_WDABSAmt
                                                        , A.Tsa_LTUTMaxAmt
	                                                    , A.Tsa_ABSAmt
	                                                    , A.Tsa_REGAmt
                                                        , A.Tsa_PDLVAmt
	                                                    , A.Tsa_PDLEGHOLAmt
	                                                    , A.Tsa_PDSPLHOLAmt
	                                                    , A.Tsa_PDCOMPHOLAmt
	                                                    , A.Tsa_PDPSDAmt
	                                                    , A.Tsa_PDOTHHOLAmt
	                                                    , A.Tsa_PDRESTLEGHOLAmt
	                                                    , A.Tsa_REGOTAmt
	                                                    , A.Tsa_REGNDAmt
	                                                    , A.Tsa_REGNDOTAmt
	                                                    , A.Tsa_RESTAmt
	                                                    , A.Tsa_RESTOTAmt
	                                                    , A.Tsa_RESTNDAmt
	                                                    , A.Tsa_RESTNDOTAmt
	                                                    , A.Tsa_LEGHOLAmt
	                                                    , A.Tsa_LEGHOLOTAmt
	                                                    , A.Tsa_LEGHOLNDAmt
	                                                    , A.Tsa_LEGHOLNDOTAmt
	                                                    , A.Tsa_SPLHOLAmt
	                                                    , A.Tsa_SPLHOLOTAmt
	                                                    , A.Tsa_SPLHOLNDAmt
	                                                    , A.Tsa_SPLHOLNDOTAmt
	                                                    , A.Tsa_PSDAmt
	                                                    , A.Tsa_PSDOTAmt
	                                                    , A.Tsa_PSDNDAmt
	                                                    , A.Tsa_PSDNDOTAmt
	                                                    , A.Tsa_COMPHOLAmt
	                                                    , A.Tsa_COMPHOLOTAmt
	                                                    , A.Tsa_COMPHOLNDAmt
	                                                    , A.Tsa_COMPHOLNDOTAmt
	                                                    , A.Tsa_RESTLEGHOLAmt
	                                                    , A.Tsa_RESTLEGHOLOTAmt
	                                                    , A.Tsa_RESTLEGHOLNDAmt
	                                                    , A.Tsa_RESTLEGHOLNDOTAmt
	                                                    , A.Tsa_RESTSPLHOLAmt
	                                                    , A.Tsa_RESTSPLHOLOTAmt
	                                                    , A.Tsa_RESTSPLHOLNDAmt
	                                                    , A.Tsa_RESTSPLHOLNDOTAmt
	                                                    , A.Tsa_RESTCOMPHOLAmt
	                                                    , A.Tsa_RESTCOMPHOLOTAmt
	                                                    , A.Tsa_RESTCOMPHOLNDAmt
	                                                    , A.Tsa_RESTCOMPHOLNDOTAmt
	                                                    , A.Tsa_RESTPSDAmt
	                                                    , A.Tsa_RESTPSDOTAmt
	                                                    , A.Tsa_RESTPSDNDAmt
	                                                    , A.Tsa_RESTPSDNDOTAmt
	                                                    , A.Tsa_RGAdjAmt
	                                                    , A.Tsa_OTAdjAmt
	                                                    , A.Tsa_HOLAdjAmt
	                                                    , A.Tsa_NDAdjAmt
	                                                    , A.Tsa_LVAdjAmt
	                                                    , A.Tsa_TotalAdjAmt
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpSystemAdj2 A 
                                                    LEFT JOIN T_EmpSystemAdj2Hst B ON A.Tsa_IDNo = B.Tsa_IDNo 
	                                                    AND A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                        AND A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
	                                                    AND A.Tsa_PayCycle = B.Tsa_PayCycle
	                                                    AND A.Tsa_Date = B.Tsa_Date
                                                    WHERE A.Tsa_AdjPayCycle = @CURPAYPERIOD
	                                                    AND B.Tsa_AdjPayCycle IS NULL


                                                    INSERT INTO T_EmpSystemAdjMiscHst 
                                                    (Tsm_IDNo
                                                    , Tsm_AdjPayCycle
                                                    , Tsm_OrigAdjPayCycle
                                                    , Tsm_PayCycle
                                                    , Tsm_Date
                                                    , Tsm_Misc1Hr
                                                    , Tsm_Misc1OTHr
                                                    , Tsm_Misc1NDHr
                                                    , Tsm_Misc1NDOTHr
                                                    , Tsm_Misc2Hr
                                                    , Tsm_Misc2OTHr
                                                    , Tsm_Misc2NDHr
                                                    , Tsm_Misc2NDOTHr
                                                    , Tsm_Misc3Hr
                                                    , Tsm_Misc3OTHr
                                                    , Tsm_Misc3NDHr
                                                    , Tsm_Misc3NDOTHr
                                                    , Tsm_Misc4Hr
                                                    , Tsm_Misc4OTHr
                                                    , Tsm_Misc4NDHr
                                                    , Tsm_Misc4NDOTHr
                                                    , Tsm_Misc5Hr
                                                    , Tsm_Misc5OTHr
                                                    , Tsm_Misc5NDHr
                                                    , Tsm_Misc5NDOTHr
                                                    , Tsm_Misc6Hr
                                                    , Tsm_Misc6OTHr
                                                    , Tsm_Misc6NDHr
                                                    , Tsm_Misc6NDOTHr
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tsm_IDNo
	                                                    , A.Tsm_AdjPayCycle
                                                        , A.Tsm_OrigAdjPayCycle
	                                                    , A.Tsm_PayCycle
	                                                    , A.Tsm_Date
	                                                    , A.Tsm_Misc1Hr
	                                                    , A.Tsm_Misc1OTHr
	                                                    , A.Tsm_Misc1NDHr
	                                                    , A.Tsm_Misc1NDOTHr
	                                                    , A.Tsm_Misc2Hr
	                                                    , A.Tsm_Misc2OTHr
	                                                    , A.Tsm_Misc2NDHr
	                                                    , A.Tsm_Misc2NDOTHr
	                                                    , A.Tsm_Misc3Hr
	                                                    , A.Tsm_Misc3OTHr
	                                                    , A.Tsm_Misc3NDHr
	                                                    , A.Tsm_Misc3NDOTHr
	                                                    , A.Tsm_Misc4Hr
	                                                    , A.Tsm_Misc4OTHr
	                                                    , A.Tsm_Misc4NDHr
	                                                    , A.Tsm_Misc4NDOTHr
	                                                    , A.Tsm_Misc5Hr
	                                                    , A.Tsm_Misc5OTHr
	                                                    , A.Tsm_Misc5NDHr
	                                                    , A.Tsm_Misc5NDOTHr
	                                                    , A.Tsm_Misc6Hr
	                                                    , A.Tsm_Misc6OTHr
	                                                    , A.Tsm_Misc6NDHr
	                                                    , A.Tsm_Misc6NDOTHr
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpSystemAdjMisc A
                                                    LEFT JOIN T_EmpSystemAdjMiscHst B ON A.Tsm_IDNo = B.Tsm_IDNo
	                                                    AND A.Tsm_AdjPayCycle = B.Tsm_AdjPayCycle
                                                        AND A.Tsm_OrigAdjPayCycle = B.Tsm_OrigAdjPayCycle
	                                                    AND A.Tsm_PayCycle = B.Tsm_PayCycle
	                                                    AND A.Tsm_Date = B.Tsm_Date
                                                    WHERE A.Tsm_AdjPayCycle = @CurPayPeriod
	                                                    AND B.Tsm_AdjPayCycle IS NULL

                                                    INSERT INTO T_EmpSystemAdjMisc2Hst
                                                    (Tsm_IDNo
                                                    , Tsm_AdjPayCycle
                                                    , Tsm_OrigAdjPayCycle
                                                    , Tsm_PayCycle
                                                    , Tsm_Date
                                                    , Tsm_Misc1Amt
                                                    , Tsm_Misc1OTAmt
                                                    , Tsm_Misc1NDAmt
                                                    , Tsm_Misc1NDOTAmt
                                                    , Tsm_Misc2Amt
                                                    , Tsm_Misc2OTAmt
                                                    , Tsm_Misc2NDAmt
                                                    , Tsm_Misc2NDOTAmt
                                                    , Tsm_Misc3Amt
                                                    , Tsm_Misc3OTAmt
                                                    , Tsm_Misc3NDAmt
                                                    , Tsm_Misc3NDOTAmt
                                                    , Tsm_Misc4Amt
                                                    , Tsm_Misc4OTAmt
                                                    , Tsm_Misc4NDAmt
                                                    , Tsm_Misc4NDOTAmt
                                                    , Tsm_Misc5Amt
                                                    , Tsm_Misc5OTAmt
                                                    , Tsm_Misc5NDAmt
                                                    , Tsm_Misc5NDOTAmt
                                                    , Tsm_Misc6Amt
                                                    , Tsm_Misc6OTAmt
                                                    , Tsm_Misc6NDAmt
                                                    , Tsm_Misc6NDOTAmt
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tsm_IDNo
	                                                    , A.Tsm_AdjPayCycle
                                                        , A.Tsm_OrigAdjPayCycle
	                                                    , A.Tsm_PayCycle
	                                                    , A.Tsm_Date
	                                                    , A.Tsm_Misc1Amt
	                                                    , A.Tsm_Misc1OTAmt
	                                                    , A.Tsm_Misc1NDAmt
	                                                    , A.Tsm_Misc1NDOTAmt
	                                                    , A.Tsm_Misc2Amt
	                                                    , A.Tsm_Misc2OTAmt
	                                                    , A.Tsm_Misc2NDAmt
	                                                    , A.Tsm_Misc2NDOTAmt
	                                                    , A.Tsm_Misc3Amt
	                                                    , A.Tsm_Misc3OTAmt
	                                                    , A.Tsm_Misc3NDAmt
	                                                    , A.Tsm_Misc3NDOTAmt
	                                                    , A.Tsm_Misc4Amt
	                                                    , A.Tsm_Misc4OTAmt
	                                                    , A.Tsm_Misc4NDAmt
	                                                    , A.Tsm_Misc4NDOTAmt
	                                                    , A.Tsm_Misc5Amt
	                                                    , A.Tsm_Misc5OTAmt
	                                                    , A.Tsm_Misc5NDAmt
	                                                    , A.Tsm_Misc5NDOTAmt
	                                                    , A.Tsm_Misc6Amt
	                                                    , A.Tsm_Misc6OTAmt
	                                                    , A.Tsm_Misc6NDAmt
	                                                    , A.Tsm_Misc6NDOTAmt
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpSystemAdjMisc2 A 
                                                    LEFT JOIN T_EmpSystemAdjMisc2Hst B ON A.Tsm_IDNo = B.Tsm_IDNo
	                                                    AND A.Tsm_AdjPayCycle = B.Tsm_AdjPayCycle
                                                        AND A.Tsm_OrigAdjPayCycle = B.Tsm_OrigAdjPayCycle
	                                                    AND A.Tsm_PayCycle = B.Tsm_PayCycle
	                                                    AND A.Tsm_Date = B.Tsm_Date
                                                    WHERE A.Tsm_AdjPayCycle = @CURPAYPERIOD
	                                                    AND B.Tsm_AdjPayCycle IS NULL";

            public const string insertDeductionDtl = @"INSERT INTO T_EmpDeductionDtlHst 
                                                    (Tdd_IDNo
                                                    , Tdd_DeductionCode
                                                    , Tdd_StartDate
                                                    , Tdd_ThisPayCycle
                                                    , Tdd_PayCycle
                                                    , Tdd_LineNo
                                                    , Tdd_PaymentType
                                                    , Tdd_Amount
                                                    , Tdd_DeferredFlag
                                                    , Tdd_PaymentFlag
                                                    , Tdd_Remarks
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tdd_IDNo
	                                                    , A.Tdd_DeductionCode
	                                                    , A.Tdd_StartDate
	                                                    , A.Tdd_ThisPayCycle
	                                                    , A.Tdd_PayCycle
	                                                    , A.Tdd_LineNo
	                                                    , A.Tdd_PaymentType
	                                                    , A.Tdd_Amount
	                                                    , A.Tdd_DeferredFlag
	                                                    , A.Tdd_PaymentFlag
	                                                    , A.Tdd_Remarks
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpDeductionDtl A
                                                    LEFT JOIN T_EmpDeductionDtlHst B ON A.Tdd_IDNo = B.Tdd_IDNo
	                                                    AND A.Tdd_DeductionCode = B.Tdd_DeductionCode
	                                                    AND A.Tdd_StartDate = B.Tdd_StartDate
	                                                    AND A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle
	                                                    AND A.Tdd_PayCycle = B.Tdd_PayCycle
	                                                    AND A.Tdd_LineNo = B.Tdd_LineNo
                                                    WHERE A.Tdd_ThisPayCycle = @CurPayPeriod
	                                                    AND B.Tdd_ThisPayCycle IS NULL";
            public const string insertPayrollYearly = @"INSERT INTO T_EmpPayrollYearly 
                                                    (Tpy_IDNo
                                                    ,Tpy_PayCycle
                                                    ,Tpy_SalaryRate
                                                    ,Tpy_HourRate
                                                    ,Tpy_SpecialRate
                                                    ,Tpy_SpecialHourRate
                                                    ,Tpy_LTHr
                                                    ,Tpy_LTAmt
                                                    ,Tpy_UTHr
                                                    ,Tpy_UTAmt
                                                    ,Tpy_UPLVHr
                                                    ,Tpy_UPLVAmt
                                                    ,Tpy_ABSLEGHOLHr
                                                    ,Tpy_ABSLEGHOLAmt
                                                    ,Tpy_ABSSPLHOLHr
                                                    ,Tpy_ABSSPLHOLAmt
                                                    ,Tpy_ABSCOMPHOLHr
                                                    ,Tpy_ABSCOMPHOLAmt
                                                    ,Tpy_ABSPSDHr
                                                    ,Tpy_ABSPSDAmt
                                                    ,Tpy_ABSOTHHOLHr
                                                    ,Tpy_ABSOTHHOLAmt
                                                    ,Tpy_WDABSHr
                                                    ,Tpy_WDABSAmt
                                                    ,Tpy_LTUTMaxHr
                                                    ,Tpy_LTUTMaxAmt
                                                    ,Tpy_ABSHr
                                                    ,Tpy_ABSAmt
                                                    ,Tpy_REGHr
                                                    ,Tpy_REGAmt
                                                    ,Tpy_PDLVHr
                                                    ,Tpy_PDLVAmt
                                                    ,Tpy_PDLEGHOLHr
                                                    ,Tpy_PDLEGHOLAmt
                                                    ,Tpy_PDSPLHOLHr
                                                    ,Tpy_PDSPLHOLAmt
                                                    ,Tpy_PDCOMPHOLHr
                                                    ,Tpy_PDCOMPHOLAmt
                                                    ,Tpy_PDPSDHr
                                                    ,Tpy_PDPSDAmt
                                                    ,Tpy_PDOTHHOLHr
                                                    ,Tpy_PDOTHHOLAmt
                                                    ,Tpy_PDRESTLEGHOLHr
                                                    ,Tpy_PDRESTLEGHOLAmt
                                                    ,Tpy_TotalREGHr
                                                    ,Tpy_TotalREGAmt
                                                    ,Tpy_REGOTHr
                                                    ,Tpy_REGOTAmt
                                                    ,Tpy_REGNDHr
                                                    ,Tpy_REGNDAmt
                                                    ,Tpy_REGNDOTHr
                                                    ,Tpy_REGNDOTAmt
                                                    ,Tpy_RESTHr
                                                    ,Tpy_RESTAmt
                                                    ,Tpy_RESTOTHr
                                                    ,Tpy_RESTOTAmt
                                                    ,Tpy_RESTNDHr
                                                    ,Tpy_RESTNDAmt
                                                    ,Tpy_RESTNDOTHr
                                                    ,Tpy_RESTNDOTAmt
                                                    ,Tpy_LEGHOLHr
                                                    ,Tpy_LEGHOLAmt
                                                    ,Tpy_LEGHOLOTHr
                                                    ,Tpy_LEGHOLOTAmt
                                                    ,Tpy_LEGHOLNDHr
                                                    ,Tpy_LEGHOLNDAmt
                                                    ,Tpy_LEGHOLNDOTHr
                                                    ,Tpy_LEGHOLNDOTAmt
                                                    ,Tpy_SPLHOLHr
                                                    ,Tpy_SPLHOLAmt
                                                    ,Tpy_SPLHOLOTHr
                                                    ,Tpy_SPLHOLOTAmt
                                                    ,Tpy_SPLHOLNDHr
                                                    ,Tpy_SPLHOLNDAmt
                                                    ,Tpy_SPLHOLNDOTHr
                                                    ,Tpy_SPLHOLNDOTAmt
                                                    ,Tpy_PSDHr
                                                    ,Tpy_PSDAmt
                                                    ,Tpy_PSDOTHr
                                                    ,Tpy_PSDOTAmt
                                                    ,Tpy_PSDNDHr
                                                    ,Tpy_PSDNDAmt
                                                    ,Tpy_PSDNDOTHr
                                                    ,Tpy_PSDNDOTAmt
                                                    ,Tpy_COMPHOLHr
                                                    ,Tpy_COMPHOLAmt
                                                    ,Tpy_COMPHOLOTHr
                                                    ,Tpy_COMPHOLOTAmt
                                                    ,Tpy_COMPHOLNDHr
                                                    ,Tpy_COMPHOLNDAmt
                                                    ,Tpy_COMPHOLNDOTHr
                                                    ,Tpy_COMPHOLNDOTAmt
                                                    ,Tpy_RESTLEGHOLHr
                                                    ,Tpy_RESTLEGHOLAmt
                                                    ,Tpy_RESTLEGHOLOTHr
                                                    ,Tpy_RESTLEGHOLOTAmt
                                                    ,Tpy_RESTLEGHOLNDHr
                                                    ,Tpy_RESTLEGHOLNDAmt
                                                    ,Tpy_RESTLEGHOLNDOTHr
                                                    ,Tpy_RESTLEGHOLNDOTAmt
                                                    ,Tpy_RESTSPLHOLHr
                                                    ,Tpy_RESTSPLHOLAmt
                                                    ,Tpy_RESTSPLHOLOTHr
                                                    ,Tpy_RESTSPLHOLOTAmt
                                                    ,Tpy_RESTSPLHOLNDHr
                                                    ,Tpy_RESTSPLHOLNDAmt
                                                    ,Tpy_RESTSPLHOLNDOTHr
                                                    ,Tpy_RESTSPLHOLNDOTAmt
                                                    ,Tpy_RESTCOMPHOLHr
                                                    ,Tpy_RESTCOMPHOLAmt
                                                    ,Tpy_RESTCOMPHOLOTHr
                                                    ,Tpy_RESTCOMPHOLOTAmt
                                                    ,Tpy_RESTCOMPHOLNDHr
                                                    ,Tpy_RESTCOMPHOLNDAmt
                                                    ,Tpy_RESTCOMPHOLNDOTHr
                                                    ,Tpy_RESTCOMPHOLNDOTAmt
                                                    ,Tpy_RESTPSDHr
                                                    ,Tpy_RESTPSDAmt
                                                    ,Tpy_RESTPSDOTHr
                                                    ,Tpy_RESTPSDOTAmt
                                                    ,Tpy_RESTPSDNDHr
                                                    ,Tpy_RESTPSDNDAmt
                                                    ,Tpy_RESTPSDNDOTHr
                                                    ,Tpy_RESTPSDNDOTAmt
                                                    ,Tpy_TotalOTNDAmt
                                                    ,Tpy_WorkDay
                                                    ,Tpy_DayCountOldSalaryRate
                                                    ,Tpy_SRGAdjHr
                                                    ,Tpy_SRGAdjAmt
                                                    ,Tpy_SOTAdjHr
                                                    ,Tpy_SOTAdjAmt
                                                    ,Tpy_SHOLAdjHr
                                                    ,Tpy_SHOLAdjAmt
                                                    ,Tpy_SNDAdjHr
                                                    ,Tpy_SNDAdjAmt
                                                    ,Tpy_SLVAdjHr
                                                    ,Tpy_SLVAdjAmt
                                                    ,Tpy_MRGAdjHr
                                                    ,Tpy_MRGAdjAmt
                                                    ,Tpy_MOTAdjHr
                                                    ,Tpy_MOTAdjAmt
                                                    ,Tpy_MHOLAdjHr
                                                    ,Tpy_MHOLAdjAmt
                                                    ,Tpy_MNDAdjHr
                                                    ,Tpy_MNDAdjAmt
                                                    ,Tpy_TotalAdjAmt
                                                    ,Tpy_TaxableIncomeAmt
                                                    ,Tpy_TotalTaxableIncomeAmt
                                                    ,Tpy_NontaxableIncomeAmt
                                                    ,Tpy_GrossIncomeAmt
                                                    ,Tpy_WtaxAmt
                                                    ,Tpy_TaxBaseAmt
                                                    ,Tpy_TaxRule
                                                    ,Tpy_TaxShare
                                                    ,Tpy_TaxBracket
                                                    ,Tpy_TaxCode
                                                    ,Tpy_IsTaxExempted
                                                    ,Tpy_SSSEE
                                                    ,Tpy_SSSER
                                                    ,Tpy_ECFundAmt
                                                    ,Tpy_SSSBaseAmt
                                                    ,Tpy_SSSRule
                                                    ,Tpy_SSSShare
                                                    ,Tpy_MPFEE
                                                    ,Tpy_MPFER
                                                    ,Tpy_PhilhealthEE
                                                    ,Tpy_PhilhealthER
                                                    ,Tpy_PhilhealthBaseAmt
                                                    ,Tpy_PhilhealthRule
                                                    ,Tpy_PhilhealthShare
                                                    ,Tpy_PagIbigEE
                                                    ,Tpy_PagIbigER
                                                    ,Tpy_PagIbigTaxEE
                                                    ,Tpy_PagIbigBaseAmt
                                                    ,Tpy_PagIbigRule
                                                    ,Tpy_PagIbigShare
                                                    ,Tpy_UnionAmt
                                                    ,Tpy_UnionRule
                                                    ,Tpy_UnionShare
                                                    ,Tpy_UnionBaseAmt
                                                    ,Tpy_OtherDeductionAmt
                                                    ,Tpy_TotalDeductionAmt
                                                    ,Tpy_NetAmt
                                                    ,Tpy_CostcenterCode
                                                    ,Tpy_PositionCode
                                                    ,Tpy_EmploymentStatus
                                                    ,Tpy_PayrollType
                                                    ,Tpy_PaymentMode
                                                    ,Tpy_BankCode
                                                    ,Tpy_BankAcctNo
                                                    ,Tpy_PayrollGroup
                                                    ,Tpy_CalendarGrpCode
                                                    ,Tpy_WorkLocationCode
                                                    ,Tpy_AltAcctCode
                                                    ,Tpy_ExpenseClass
                                                    ,Tpy_PositionGrade
                                                    ,Tpy_WorkStatus
                                                    ,Tpy_PremiumGrpCode
                                                    ,Tpy_IsComputedPerDay
                                                    ,Tpy_IsMultipleSalary
                                                    ,Tpy_RegRule
                                                    ,Usr_Login
                                                    ,Ludatetime)
                                                    SELECT A.Tpy_IDNo
                                                        ,A.Tpy_PayCycle
                                                        ,A.Tpy_SalaryRate
                                                        ,A.Tpy_HourRate
                                                        ,A.Tpy_SpecialRate
                                                        ,A.Tpy_SpecialHourRate
                                                        ,A.Tpy_LTHr
                                                        ,A.Tpy_LTAmt
                                                        ,A.Tpy_UTHr
                                                        ,A.Tpy_UTAmt
                                                        ,A.Tpy_UPLVHr
                                                        ,A.Tpy_UPLVAmt
                                                        ,A.Tpy_ABSLEGHOLHr
                                                        ,A.Tpy_ABSLEGHOLAmt
                                                        ,A.Tpy_ABSSPLHOLHr
                                                        ,A.Tpy_ABSSPLHOLAmt
                                                        ,A.Tpy_ABSCOMPHOLHr
                                                        ,A.Tpy_ABSCOMPHOLAmt
                                                        ,A.Tpy_ABSPSDHr
                                                        ,A.Tpy_ABSPSDAmt
                                                        ,A.Tpy_ABSOTHHOLHr
                                                        ,A.Tpy_ABSOTHHOLAmt
                                                        ,A.Tpy_WDABSHr
                                                        ,A.Tpy_WDABSAmt
                                                        ,A.Tpy_LTUTMaxHr
                                                        ,A.Tpy_LTUTMaxAmt
                                                        ,A.Tpy_ABSHr
                                                        ,A.Tpy_ABSAmt
                                                        ,A.Tpy_REGHr
                                                        ,A.Tpy_REGAmt
                                                        ,A.Tpy_PDLVHr
                                                        ,A.Tpy_PDLVAmt
                                                        ,A.Tpy_PDLEGHOLHr
                                                        ,A.Tpy_PDLEGHOLAmt
                                                        ,A.Tpy_PDSPLHOLHr
                                                        ,A.Tpy_PDSPLHOLAmt
                                                        ,A.Tpy_PDCOMPHOLHr
                                                        ,A.Tpy_PDCOMPHOLAmt
                                                        ,A.Tpy_PDPSDHr
                                                        ,A.Tpy_PDPSDAmt
                                                        ,A.Tpy_PDOTHHOLHr
                                                        ,A.Tpy_PDOTHHOLAmt
                                                        ,A.Tpy_PDRESTLEGHOLHr
                                                        ,A.Tpy_PDRESTLEGHOLAmt
                                                        ,A.Tpy_TotalREGHr
                                                        ,A.Tpy_TotalREGAmt
                                                        ,A.Tpy_REGOTHr
                                                        ,A.Tpy_REGOTAmt
                                                        ,A.Tpy_REGNDHr
                                                        ,A.Tpy_REGNDAmt
                                                        ,A.Tpy_REGNDOTHr
                                                        ,A.Tpy_REGNDOTAmt
                                                        ,A.Tpy_RESTHr
                                                        ,A.Tpy_RESTAmt
                                                        ,A.Tpy_RESTOTHr
                                                        ,A.Tpy_RESTOTAmt
                                                        ,A.Tpy_RESTNDHr
                                                        ,A.Tpy_RESTNDAmt
                                                        ,A.Tpy_RESTNDOTHr
                                                        ,A.Tpy_RESTNDOTAmt
                                                        ,A.Tpy_LEGHOLHr
                                                        ,A.Tpy_LEGHOLAmt
                                                        ,A.Tpy_LEGHOLOTHr
                                                        ,A.Tpy_LEGHOLOTAmt
                                                        ,A.Tpy_LEGHOLNDHr
                                                        ,A.Tpy_LEGHOLNDAmt
                                                        ,A.Tpy_LEGHOLNDOTHr
                                                        ,A.Tpy_LEGHOLNDOTAmt
                                                        ,A.Tpy_SPLHOLHr
                                                        ,A.Tpy_SPLHOLAmt
                                                        ,A.Tpy_SPLHOLOTHr
                                                        ,A.Tpy_SPLHOLOTAmt
                                                        ,A.Tpy_SPLHOLNDHr
                                                        ,A.Tpy_SPLHOLNDAmt
                                                        ,A.Tpy_SPLHOLNDOTHr
                                                        ,A.Tpy_SPLHOLNDOTAmt
                                                        ,A.Tpy_PSDHr
                                                        ,A.Tpy_PSDAmt
                                                        ,A.Tpy_PSDOTHr
                                                        ,A.Tpy_PSDOTAmt
                                                        ,A.Tpy_PSDNDHr
                                                        ,A.Tpy_PSDNDAmt
                                                        ,A.Tpy_PSDNDOTHr
                                                        ,A.Tpy_PSDNDOTAmt
                                                        ,A.Tpy_COMPHOLHr
                                                        ,A.Tpy_COMPHOLAmt
                                                        ,A.Tpy_COMPHOLOTHr
                                                        ,A.Tpy_COMPHOLOTAmt
                                                        ,A.Tpy_COMPHOLNDHr
                                                        ,A.Tpy_COMPHOLNDAmt
                                                        ,A.Tpy_COMPHOLNDOTHr
                                                        ,A.Tpy_COMPHOLNDOTAmt
                                                        ,A.Tpy_RESTLEGHOLHr
                                                        ,A.Tpy_RESTLEGHOLAmt
                                                        ,A.Tpy_RESTLEGHOLOTHr
                                                        ,A.Tpy_RESTLEGHOLOTAmt
                                                        ,A.Tpy_RESTLEGHOLNDHr
                                                        ,A.Tpy_RESTLEGHOLNDAmt
                                                        ,A.Tpy_RESTLEGHOLNDOTHr
                                                        ,A.Tpy_RESTLEGHOLNDOTAmt
                                                        ,A.Tpy_RESTSPLHOLHr
                                                        ,A.Tpy_RESTSPLHOLAmt
                                                        ,A.Tpy_RESTSPLHOLOTHr
                                                        ,A.Tpy_RESTSPLHOLOTAmt
                                                        ,A.Tpy_RESTSPLHOLNDHr
                                                        ,A.Tpy_RESTSPLHOLNDAmt
                                                        ,A.Tpy_RESTSPLHOLNDOTHr
                                                        ,A.Tpy_RESTSPLHOLNDOTAmt
                                                        ,A.Tpy_RESTCOMPHOLHr
                                                        ,A.Tpy_RESTCOMPHOLAmt
                                                        ,A.Tpy_RESTCOMPHOLOTHr
                                                        ,A.Tpy_RESTCOMPHOLOTAmt
                                                        ,A.Tpy_RESTCOMPHOLNDHr
                                                        ,A.Tpy_RESTCOMPHOLNDAmt
                                                        ,A.Tpy_RESTCOMPHOLNDOTHr
                                                        ,A.Tpy_RESTCOMPHOLNDOTAmt
                                                        ,A.Tpy_RESTPSDHr
                                                        ,A.Tpy_RESTPSDAmt
                                                        ,A.Tpy_RESTPSDOTHr
                                                        ,A.Tpy_RESTPSDOTAmt
                                                        ,A.Tpy_RESTPSDNDHr
                                                        ,A.Tpy_RESTPSDNDAmt
                                                        ,A.Tpy_RESTPSDNDOTHr
                                                        ,A.Tpy_RESTPSDNDOTAmt
                                                        ,A.Tpy_TotalOTNDAmt
                                                        ,A.Tpy_WorkDay
                                                        ,A.Tpy_DayCountOldSalaryRate
                                                        ,A.Tpy_SRGAdjHr
                                                        ,A.Tpy_SRGAdjAmt
                                                        ,A.Tpy_SOTAdjHr
                                                        ,A.Tpy_SOTAdjAmt
                                                        ,A.Tpy_SHOLAdjHr
                                                        ,A.Tpy_SHOLAdjAmt
                                                        ,A.Tpy_SNDAdjHr
                                                        ,A.Tpy_SNDAdjAmt
                                                        ,A.Tpy_SLVAdjHr
                                                        ,A.Tpy_SLVAdjAmt
                                                        ,A.Tpy_MRGAdjHr
                                                        ,A.Tpy_MRGAdjAmt
                                                        ,A.Tpy_MOTAdjHr
                                                        ,A.Tpy_MOTAdjAmt
                                                        ,A.Tpy_MHOLAdjHr
                                                        ,A.Tpy_MHOLAdjAmt
                                                        ,A.Tpy_MNDAdjHr
                                                        ,A.Tpy_MNDAdjAmt
                                                        ,A.Tpy_TotalAdjAmt
                                                        ,A.Tpy_TaxableIncomeAmt
                                                        ,A.Tpy_TotalTaxableIncomeAmt
                                                        ,A.Tpy_NontaxableIncomeAmt
                                                        ,A.Tpy_GrossIncomeAmt
                                                        ,A.Tpy_WtaxAmt
                                                        ,A.Tpy_TaxBaseAmt
                                                        ,A.Tpy_TaxRule
                                                        ,A.Tpy_TaxShare
                                                        ,A.Tpy_TaxBracket
                                                        ,A.Tpy_TaxCode
                                                        ,A.Tpy_IsTaxExempted
                                                        ,A.Tpy_SSSEE
                                                        ,A.Tpy_SSSER
                                                        ,A.Tpy_ECFundAmt
                                                        ,A.Tpy_SSSBaseAmt
                                                        ,A.Tpy_SSSRule
                                                        ,A.Tpy_SSSShare
                                                        ,A.Tpy_MPFEE
                                                        ,A.Tpy_MPFER
                                                        ,A.Tpy_PhilhealthEE
                                                        ,A.Tpy_PhilhealthER
                                                        ,A.Tpy_PhilhealthBaseAmt
                                                        ,A.Tpy_PhilhealthRule
                                                        ,A.Tpy_PhilhealthShare
                                                        ,A.Tpy_PagIbigEE
                                                        ,A.Tpy_PagIbigER
                                                        ,A.Tpy_PagIbigTaxEE
                                                        ,A.Tpy_PagIbigBaseAmt
                                                        ,A.Tpy_PagIbigRule
                                                        ,A.Tpy_PagIbigShare
                                                        ,A.Tpy_UnionAmt
                                                        ,A.Tpy_UnionRule
                                                        ,A.Tpy_UnionShare
                                                        ,A.Tpy_UnionBaseAmt
                                                        ,A.Tpy_OtherDeductionAmt
                                                        ,A.Tpy_TotalDeductionAmt
                                                        ,A.Tpy_NetAmt
                                                        ,A.Tpy_CostcenterCode
                                                        ,A.Tpy_PositionCode
                                                        ,A.Tpy_EmploymentStatus
                                                        ,A.Tpy_PayrollType
                                                        ,A.Tpy_PaymentMode
                                                        ,A.Tpy_BankCode
                                                        ,A.Tpy_BankAcctNo
                                                        ,A.Tpy_PayrollGroup
                                                        ,A.Tpy_CalendarGrpCode
                                                        ,A.Tpy_WorkLocationCode
                                                        ,A.Tpy_AltAcctCode
                                                        ,A.Tpy_ExpenseClass
                                                        ,A.Tpy_PositionGrade
                                                        ,A.Tpy_WorkStatus
                                                        ,A.Tpy_PremiumGrpCode
                                                        ,A.Tpy_IsComputedPerDay
                                                        ,A.Tpy_IsMultipleSalary
                                                        ,A.Tpy_RegRule
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpPayroll A
                                                    LEFT JOIN T_EmpPayrollYearly B ON A.Tpy_IDNo = B.Tpy_IDNo
	                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE A.Tpy_PayCycle = @CurPayPeriod 
	                                                    AND B.Tpy_PayCycle IS NULL

                                                    INSERT INTO T_EmpPayrollMiscYearly 
                                                    (Tpm_IDNo
                                                    , Tpm_PayCycle
                                                    , Tpm_Misc1Hr
                                                    , Tpm_Misc1Amt
                                                    , Tpm_Misc1OTHr
                                                    , Tpm_Misc1OTAmt
                                                    , Tpm_Misc1NDHr
                                                    , Tpm_Misc1NDAmt
                                                    , Tpm_Misc1NDOTHr
                                                    , Tpm_Misc1NDOTAmt
                                                    , Tpm_Misc2Hr
                                                    , Tpm_Misc2Amt
                                                    , Tpm_Misc2OTHr
                                                    , Tpm_Misc2OTAmt
                                                    , Tpm_Misc2NDHr
                                                    , Tpm_Misc2NDAmt
                                                    , Tpm_Misc2NDOTHr
                                                    , Tpm_Misc2NDOTAmt
                                                    , Tpm_Misc3Hr
                                                    , Tpm_Misc3Amt
                                                    , Tpm_Misc3OTHr
                                                    , Tpm_Misc3OTAmt
                                                    , Tpm_Misc3NDHr
                                                    , Tpm_Misc3NDAmt
                                                    , Tpm_Misc3NDOTHr
                                                    , Tpm_Misc3NDOTAmt
                                                    , Tpm_Misc4Hr
                                                    , Tpm_Misc4Amt
                                                    , Tpm_Misc4OTHr
                                                    , Tpm_Misc4OTAmt
                                                    , Tpm_Misc4NDHr
                                                    , Tpm_Misc4NDAmt
                                                    , Tpm_Misc4NDOTHr
                                                    , Tpm_Misc4NDOTAmt
                                                    , Tpm_Misc5Hr
                                                    , Tpm_Misc5Amt
                                                    , Tpm_Misc5OTHr
                                                    , Tpm_Misc5OTAmt
                                                    , Tpm_Misc5NDHr
                                                    , Tpm_Misc5NDAmt
                                                    , Tpm_Misc5NDOTHr
                                                    , Tpm_Misc5NDOTAmt
                                                    , Tpm_Misc6Hr
                                                    , Tpm_Misc6Amt
                                                    , Tpm_Misc6OTHr
                                                    , Tpm_Misc6OTAmt
                                                    , Tpm_Misc6NDHr
                                                    , Tpm_Misc6NDAmt
                                                    , Tpm_Misc6NDOTHr
                                                    , Tpm_Misc6NDOTAmt
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tpm_IDNo
	                                                    , A.Tpm_PayCycle
	                                                    , A.Tpm_Misc1Hr
	                                                    , A.Tpm_Misc1Amt
	                                                    , A.Tpm_Misc1OTHr
	                                                    , A.Tpm_Misc1OTAmt
	                                                    , A.Tpm_Misc1NDHr
	                                                    , A.Tpm_Misc1NDAmt
	                                                    , A.Tpm_Misc1NDOTHr
	                                                    , A.Tpm_Misc1NDOTAmt
	                                                    , A.Tpm_Misc2Hr
	                                                    , A.Tpm_Misc2Amt
	                                                    , A.Tpm_Misc2OTHr
	                                                    , A.Tpm_Misc2OTAmt
	                                                    , A.Tpm_Misc2NDHr
	                                                    , A.Tpm_Misc2NDAmt
	                                                    , A.Tpm_Misc2NDOTHr
	                                                    , A.Tpm_Misc2NDOTAmt
	                                                    , A.Tpm_Misc3Hr
	                                                    , A.Tpm_Misc3Amt
	                                                    , A.Tpm_Misc3OTHr
	                                                    , A.Tpm_Misc3OTAmt
	                                                    , A.Tpm_Misc3NDHr
	                                                    , A.Tpm_Misc3NDAmt
	                                                    , A.Tpm_Misc3NDOTHr
	                                                    , A.Tpm_Misc3NDOTAmt
	                                                    , A.Tpm_Misc4Hr
	                                                    , A.Tpm_Misc4Amt
	                                                    , A.Tpm_Misc4OTHr
	                                                    , A.Tpm_Misc4OTAmt
	                                                    , A.Tpm_Misc4NDHr
	                                                    , A.Tpm_Misc4NDAmt
	                                                    , A.Tpm_Misc4NDOTHr
	                                                    , A.Tpm_Misc4NDOTAmt
	                                                    , A.Tpm_Misc5Hr
	                                                    , A.Tpm_Misc5Amt
	                                                    , A.Tpm_Misc5OTHr
	                                                    , A.Tpm_Misc5OTAmt
	                                                    , A.Tpm_Misc5NDHr
	                                                    , A.Tpm_Misc5NDAmt
	                                                    , A.Tpm_Misc5NDOTHr
	                                                    , A.Tpm_Misc5NDOTAmt
	                                                    , A.Tpm_Misc6Hr
	                                                    , A.Tpm_Misc6Amt
	                                                    , A.Tpm_Misc6OTHr
	                                                    , A.Tpm_Misc6OTAmt
	                                                    , A.Tpm_Misc6NDHr
	                                                    , A.Tpm_Misc6NDAmt
	                                                    , A.Tpm_Misc6NDOTHr
	                                                    , A.Tpm_Misc6NDOTAmt
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpPayrollMisc A
                                                    LEFT JOIN T_EmpPayrollMiscYearly B ON A.Tpm_IDNo = B.Tpm_IDNo
	                                                    AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                    WHERE A.Tpm_PayCycle = @CurPayPeriod 
	                                                    AND B.Tpm_PayCycle IS NULL

                                                    INSERT INTO T_EmpPayroll2Yearly 
                                                    (Tpy_IDNo
                                                    , Tpy_PayCycle
                                                    , Tpy_RemainingPayCycle
                                                    , Tpy_YTDRegularAmtBefore
                                                    , Tpy_AssumeRegularAmt
                                                    , Tpy_RegularTotal
                                                    , Tpy_YTDRecurringAllowanceAmtBefore
                                                    , Tpy_RecurringAllowanceAmt
                                                    , Tpy_AssumeRecurringAllowanceAmt
                                                    , Tpy_RecurringAllowanceTotal
                                                    , Tpy_YTDBonusAmtBefore
                                                    , Tpy_BonusNontaxAmt
                                                    , Tpy_BonusTaxAmt
                                                    , Tpy_Assume13thMonthAmt
                                                    , Tpy_BonusTotal
                                                    , Tpy_BonusTaxRevaluated
                                                    , Tpy_YTDBonusTaxBefore
                                                    , Tpy_YTDOtherTaxableIncomeAmtBefore
                                                    , Tpy_OtherTaxableIncomeAmt
                                                    , Tpy_OtherTaxableIncomeTotal
                                                    , Tpy_YTDSSSAmtBefore
                                                    , Tpy_AssumeSSSAmt
                                                    , Tpy_SSSTotal
                                                    , Tpy_YTDPhilhealthAmtBefore
                                                    , Tpy_AssumePhilhealthAmt
                                                    , Tpy_PhilhealthTotal
                                                    , Tpy_YTDPagIbigAmtBefore
                                                    , Tpy_AssumePagIbigAmt
                                                    , Tpy_PagIbigTotal
                                                    , Tpy_YTDPagIbigTaxAmtBefore
                                                    , Tpy_AssumePagIbigTaxAmt
                                                    , Tpy_TotalTaxableIncomeWAssumeAmt
                                                    , Tpy_YTDUnionAmtBefore
                                                    , Tpy_AssumeUnionAmt
                                                    , Tpy_UnionTotal
                                                    , Tpy_PremiumPaidOnHealth
                                                    , Tpy_TotalExemptions
                                                    , Tpy_NetTaxableIncomeAmt
                                                    , Tpy_YTDREGAmt
                                                    , Tpy_YTDTotalTaxableIncomeAmtBefore
                                                    , Tpy_YTDTotalTaxableIncomeAmt
                                                    , Tpy_YTDWtaxAmtBefore
                                                    , Tpy_YTDWtaxAmt
                                                    , Tpy_YTDSSSAmt
                                                    , Tpy_YTDPhilhealthAmt
                                                    , Tpy_YTDPagIbigAmt
                                                    , Tpy_YTDPagIbigTaxAmt
                                                    , Tpy_YTDUnionAmt
                                                    , Tpy_YTDNontaxableAmtBefore
                                                    , Tpy_YTDNontaxableAmt
                                                    , Tpy_BIRTotalAmountofCompensation
                                                    , Tpy_BIRStatutoryMinimumWage
                                                    , Tpy_BIRHolidayOvertimeNightShiftHazard
                                                    , Tpy_BIR13thMonthPayOtherBenefits
                                                    , Tpy_BIRDeMinimisBenefits
                                                    , Tpy_BIRSSSGSISPHICHDMFUnionDues
                                                    , Tpy_BIROtherNonTaxableCompensation
                                                    , Tpy_BIRTotalTaxableCompensation
                                                    , Tpy_BIRTaxableCompensationNotSubjectToWithholdingTax
                                                    , Tpy_BIRTotalTaxesWithheld
                                                    , Tpy_TaxDue
                                                    , Tpy_AssumeMonthlyRegularAmt
                                                    , Tpy_AssumeMonthlySSSAmt
                                                    , Tpy_AssumeMonthlyPhilhealthAmt
                                                    , Tpy_AssumeMonthlyPagibigAmt
                                                    , Tpy_AssumeMonthlyUnionAmt
                                                    , Tpy_YTDMPFAmtBefore
                                                    , Tpy_YTDMPFAmt
                                                    , Usr_Login
                                                    , Ludatetime)

                                                    SELECT A.Tpy_IDNo
	                                                    , A.Tpy_PayCycle
	                                                    , A.Tpy_RemainingPayCycle
	                                                    , A.Tpy_YTDRegularAmtBefore
	                                                    , A.Tpy_AssumeRegularAmt
	                                                    , A.Tpy_RegularTotal
	                                                    , A.Tpy_YTDRecurringAllowanceAmtBefore
	                                                    , A.Tpy_RecurringAllowanceAmt
	                                                    , A.Tpy_AssumeRecurringAllowanceAmt
	                                                    , A.Tpy_RecurringAllowanceTotal
                                                        , A.Tpy_YTDBonusAmtBefore
	                                                    , A.Tpy_BonusNontaxAmt
                                                        , A.Tpy_BonusTaxAmt
                                                        , A.Tpy_Assume13thMonthAmt
                                                        , A.Tpy_BonusTotal
                                                        , A.Tpy_BonusTaxRevaluated
                                                        , A.Tpy_YTDBonusTaxBefore
	                                                    , A.Tpy_YTDOtherTaxableIncomeAmtBefore
	                                                    , A.Tpy_OtherTaxableIncomeAmt
	                                                    , A.Tpy_OtherTaxableIncomeTotal
	                                                    , A.Tpy_YTDSSSAmtBefore
	                                                    , A.Tpy_AssumeSSSAmt
	                                                    , A.Tpy_SSSTotal
	                                                    , A.Tpy_YTDPhilhealthAmtBefore
	                                                    , A.Tpy_AssumePhilhealthAmt
	                                                    , A.Tpy_PhilhealthTotal
	                                                    , A.Tpy_YTDPagIbigAmtBefore
	                                                    , A.Tpy_AssumePagIbigAmt
	                                                    , A.Tpy_PagIbigTotal
	                                                    , A.Tpy_YTDPagIbigTaxAmtBefore
	                                                    , A.Tpy_AssumePagIbigTaxAmt
	                                                    , A.Tpy_TotalTaxableIncomeWAssumeAmt
	                                                    , A.Tpy_YTDUnionAmtBefore
	                                                    , A.Tpy_AssumeUnionAmt
	                                                    , A.Tpy_UnionTotal
	                                                    , A.Tpy_PremiumPaidOnHealth
	                                                    , A.Tpy_TotalExemptions
	                                                    , A.Tpy_NetTaxableIncomeAmt
	                                                    , A.Tpy_YTDREGAmt
	                                                    , A.Tpy_YTDTotalTaxableIncomeAmtBefore
	                                                    , A.Tpy_YTDTotalTaxableIncomeAmt
	                                                    , A.Tpy_YTDWtaxAmtBefore
	                                                    , A.Tpy_YTDWtaxAmt
	                                                    , A.Tpy_YTDSSSAmt
	                                                    , A.Tpy_YTDPhilhealthAmt
	                                                    , A.Tpy_YTDPagIbigAmt
	                                                    , A.Tpy_YTDPagIbigTaxAmt
	                                                    , A.Tpy_YTDUnionAmt
	                                                    , A.Tpy_YTDNontaxableAmtBefore
	                                                    , A.Tpy_YTDNontaxableAmt
                                                        , A.Tpy_BIRTotalAmountofCompensation
                                                        , A.Tpy_BIRStatutoryMinimumWage
                                                        , A.Tpy_BIRHolidayOvertimeNightShiftHazard
                                                        , A.Tpy_BIR13thMonthPayOtherBenefits
                                                        , A.Tpy_BIRDeMinimisBenefits
                                                        , A.Tpy_BIRSSSGSISPHICHDMFUnionDues
                                                        , A.Tpy_BIROtherNonTaxableCompensation
                                                        , A.Tpy_BIRTotalTaxableCompensation
                                                        , A.Tpy_BIRTaxableCompensationNotSubjectToWithholdingTax
                                                        , A.Tpy_BIRTotalTaxesWithheld
                                                        , A.Tpy_TaxDue
                                                        , A.Tpy_AssumeMonthlyRegularAmt
                                                        , A.Tpy_AssumeMonthlySSSAmt
                                                        , A.Tpy_AssumeMonthlyPhilhealthAmt
                                                        , A.Tpy_AssumeMonthlyPagibigAmt
                                                        , A.Tpy_AssumeMonthlyUnionAmt
                                                        , A.Tpy_YTDMPFAmtBefore
                                                        , A.Tpy_YTDMPFAmt
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpPayroll2 A
                                                    LEFT JOIN T_EmpPayroll2Yearly B ON A.Tpy_IDNo = B.Tpy_IDNo
	                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE A.Tpy_PayCycle = @CurPayPeriod
	                                                    AND B.Tpy_PayCycle IS NULL


                                                   INSERT INTO T_EmpPayrollDtlYearly
                                                   (Tpd_IDNo
                                                    ,Tpd_PayCycle
                                                    ,Tpd_Date
                                                    ,Tpd_DayCode
                                                    ,Tpd_RestDayFlag
                                                    ,Tpd_WorkDay
                                                    ,Tpd_SalaryRate
                                                    ,Tpd_HourRate
                                                    ,Tpd_PayrollType
                                                    ,Tpd_SpecialRate
                                                    ,Tpd_SpecialHourRate
                                                    ,Tpd_PremiumGrpCode
                                                    ,Tpd_LTHr
                                                    ,Tpd_LTAmt
                                                    ,Tpd_UTHr
                                                    ,Tpd_UTAmt
                                                    ,Tpd_UPLVHr
                                                    ,Tpd_UPLVAmt
                                                    ,Tpd_ABSLEGHOLHr
                                                    ,Tpd_ABSLEGHOLAmt
                                                    ,Tpd_ABSSPLHOLHr
                                                    ,Tpd_ABSSPLHOLAmt
                                                    ,Tpd_ABSCOMPHOLHr
                                                    ,Tpd_ABSCOMPHOLAmt
                                                    ,Tpd_ABSPSDHr
                                                    ,Tpd_ABSPSDAmt
                                                    ,Tpd_ABSOTHHOLHr
                                                    ,Tpd_ABSOTHHOLAmt
                                                    ,Tpd_WDABSHr
                                                    ,Tpd_WDABSAmt
                                                    ,Tpd_LTUTMaxHr
                                                    ,Tpd_LTUTMaxAmt
                                                    ,Tpd_ABSHr
                                                    ,Tpd_ABSAmt
                                                    ,Tpd_REGHr
                                                    ,Tpd_REGAmt
                                                    ,Tpd_PDLVHr
                                                    ,Tpd_PDLVAmt
                                                    ,Tpd_PDLEGHOLHr
                                                    ,Tpd_PDLEGHOLAmt
                                                    ,Tpd_PDSPLHOLHr
                                                    ,Tpd_PDSPLHOLAmt
                                                    ,Tpd_PDCOMPHOLHr
                                                    ,Tpd_PDCOMPHOLAmt
                                                    ,Tpd_PDPSDHr
                                                    ,Tpd_PDPSDAmt
                                                    ,Tpd_PDOTHHOLHr
                                                    ,Tpd_PDOTHHOLAmt
                                                    ,Tpd_PDRESTLEGHOLHr
                                                    ,Tpd_PDRESTLEGHOLAmt
                                                    ,Tpd_TotalREGHr
                                                    ,Tpd_TotalREGAmt
                                                    ,Tpd_REGOTHr
                                                    ,Tpd_REGOTAmt
                                                    ,Tpd_REGNDHr
                                                    ,Tpd_REGNDAmt
                                                    ,Tpd_REGNDOTHr
                                                    ,Tpd_REGNDOTAmt
                                                    ,Tpd_RESTHr
                                                    ,Tpd_RESTAmt
                                                    ,Tpd_RESTOTHr
                                                    ,Tpd_RESTOTAmt
                                                    ,Tpd_RESTNDHr
                                                    ,Tpd_RESTNDAmt
                                                    ,Tpd_RESTNDOTHr
                                                    ,Tpd_RESTNDOTAmt
                                                    ,Tpd_LEGHOLHr
                                                    ,Tpd_LEGHOLAmt
                                                    ,Tpd_LEGHOLOTHr
                                                    ,Tpd_LEGHOLOTAmt
                                                    ,Tpd_LEGHOLNDHr
                                                    ,Tpd_LEGHOLNDAmt
                                                    ,Tpd_LEGHOLNDOTHr
                                                    ,Tpd_LEGHOLNDOTAmt
                                                    ,Tpd_SPLHOLHr
                                                    ,Tpd_SPLHOLAmt
                                                    ,Tpd_SPLHOLOTHr
                                                    ,Tpd_SPLHOLOTAmt
                                                    ,Tpd_SPLHOLNDHr
                                                    ,Tpd_SPLHOLNDAmt
                                                    ,Tpd_SPLHOLNDOTHr
                                                    ,Tpd_SPLHOLNDOTAmt
                                                    ,Tpd_PSDHr
                                                    ,Tpd_PSDAmt
                                                    ,Tpd_PSDOTHr
                                                    ,Tpd_PSDOTAmt
                                                    ,Tpd_PSDNDHr
                                                    ,Tpd_PSDNDAmt
                                                    ,Tpd_PSDNDOTHr
                                                    ,Tpd_PSDNDOTAmt
                                                    ,Tpd_COMPHOLHr
                                                    ,Tpd_COMPHOLAmt
                                                    ,Tpd_COMPHOLOTHr
                                                    ,Tpd_COMPHOLOTAmt
                                                    ,Tpd_COMPHOLNDHr
                                                    ,Tpd_COMPHOLNDAmt
                                                    ,Tpd_COMPHOLNDOTHr
                                                    ,Tpd_COMPHOLNDOTAmt
                                                    ,Tpd_RESTLEGHOLHr
                                                    ,Tpd_RESTLEGHOLAmt
                                                    ,Tpd_RESTLEGHOLOTHr
                                                    ,Tpd_RESTLEGHOLOTAmt
                                                    ,Tpd_RESTLEGHOLNDHr
                                                    ,Tpd_RESTLEGHOLNDAmt
                                                    ,Tpd_RESTLEGHOLNDOTHr
                                                    ,Tpd_RESTLEGHOLNDOTAmt
                                                    ,Tpd_RESTSPLHOLHr
                                                    ,Tpd_RESTSPLHOLAmt
                                                    ,Tpd_RESTSPLHOLOTHr
                                                    ,Tpd_RESTSPLHOLOTAmt
                                                    ,Tpd_RESTSPLHOLNDHr
                                                    ,Tpd_RESTSPLHOLNDAmt
                                                    ,Tpd_RESTSPLHOLNDOTHr
                                                    ,Tpd_RESTSPLHOLNDOTAmt
                                                    ,Tpd_RESTCOMPHOLHr
                                                    ,Tpd_RESTCOMPHOLAmt
                                                    ,Tpd_RESTCOMPHOLOTHr
                                                    ,Tpd_RESTCOMPHOLOTAmt
                                                    ,Tpd_RESTCOMPHOLNDHr
                                                    ,Tpd_RESTCOMPHOLNDAmt
                                                    ,Tpd_RESTCOMPHOLNDOTHr
                                                    ,Tpd_RESTCOMPHOLNDOTAmt
                                                    ,Tpd_RESTPSDHr
                                                    ,Tpd_RESTPSDAmt
                                                    ,Tpd_RESTPSDOTHr
                                                    ,Tpd_RESTPSDOTAmt
                                                    ,Tpd_RESTPSDNDHr
                                                    ,Tpd_RESTPSDNDAmt
                                                    ,Tpd_RESTPSDNDOTHr
                                                    ,Tpd_RESTPSDNDOTAmt
                                                    ,Tpd_TotalOTNDAmt
                                                    ,Usr_Login
                                                    ,Ludatetime)

                                                    SELECT A.Tpd_IDNo
                                                    ,A.Tpd_PayCycle
                                                    ,A.Tpd_Date
                                                    ,A.Tpd_DayCode
                                                    ,A.Tpd_RestDayFlag
                                                    ,A.Tpd_WorkDay
                                                    ,A.Tpd_SalaryRate
                                                    ,A.Tpd_HourRate
                                                    ,A.Tpd_PayrollType
                                                    ,A.Tpd_SpecialRate
                                                    ,A.Tpd_SpecialHourRate
                                                    ,A.Tpd_PremiumGrpCode
                                                    ,A.Tpd_LTHr
                                                    ,A.Tpd_LTAmt
                                                    ,A.Tpd_UTHr
                                                    ,A.Tpd_UTAmt
                                                    ,A.Tpd_UPLVHr
                                                    ,A.Tpd_UPLVAmt
                                                    ,A.Tpd_ABSLEGHOLHr
                                                    ,A.Tpd_ABSLEGHOLAmt
                                                    ,A.Tpd_ABSSPLHOLHr
                                                    ,A.Tpd_ABSSPLHOLAmt
                                                    ,A.Tpd_ABSCOMPHOLHr
                                                    ,A.Tpd_ABSCOMPHOLAmt
                                                    ,A.Tpd_ABSPSDHr
                                                    ,A.Tpd_ABSPSDAmt
                                                    ,A.Tpd_ABSOTHHOLHr
                                                    ,A.Tpd_ABSOTHHOLAmt
                                                    ,A.Tpd_WDABSHr
                                                    ,A.Tpd_WDABSAmt
                                                    ,A.Tpd_LTUTMaxHr
                                                    ,A.Tpd_LTUTMaxAmt
                                                    ,A.Tpd_ABSHr
                                                    ,A.Tpd_ABSAmt
                                                    ,A.Tpd_REGHr
                                                    ,A.Tpd_REGAmt
                                                    ,A.Tpd_PDLVHr
                                                    ,A.Tpd_PDLVAmt
                                                    ,A.Tpd_PDLEGHOLHr
                                                    ,A.Tpd_PDLEGHOLAmt
                                                    ,A.Tpd_PDSPLHOLHr
                                                    ,A.Tpd_PDSPLHOLAmt
                                                    ,A.Tpd_PDCOMPHOLHr
                                                    ,A.Tpd_PDCOMPHOLAmt
                                                    ,A.Tpd_PDPSDHr
                                                    ,A.Tpd_PDPSDAmt
                                                    ,A.Tpd_PDOTHHOLHr
                                                    ,A.Tpd_PDOTHHOLAmt
                                                    ,A.Tpd_PDRESTLEGHOLHr
                                                    ,A.Tpd_PDRESTLEGHOLAmt
                                                    ,A.Tpd_TotalREGHr
                                                    ,A.Tpd_TotalREGAmt
                                                    ,A.Tpd_REGOTHr
                                                    ,A.Tpd_REGOTAmt
                                                    ,A.Tpd_REGNDHr
                                                    ,A.Tpd_REGNDAmt
                                                    ,A.Tpd_REGNDOTHr
                                                    ,A.Tpd_REGNDOTAmt
                                                    ,A.Tpd_RESTHr
                                                    ,A.Tpd_RESTAmt
                                                    ,A.Tpd_RESTOTHr
                                                    ,A.Tpd_RESTOTAmt
                                                    ,A.Tpd_RESTNDHr
                                                    ,A.Tpd_RESTNDAmt
                                                    ,A.Tpd_RESTNDOTHr
                                                    ,A.Tpd_RESTNDOTAmt
                                                    ,A.Tpd_LEGHOLHr
                                                    ,A.Tpd_LEGHOLAmt
                                                    ,A.Tpd_LEGHOLOTHr
                                                    ,A.Tpd_LEGHOLOTAmt
                                                    ,A.Tpd_LEGHOLNDHr
                                                    ,A.Tpd_LEGHOLNDAmt
                                                    ,A.Tpd_LEGHOLNDOTHr
                                                    ,A.Tpd_LEGHOLNDOTAmt
                                                    ,A.Tpd_SPLHOLHr
                                                    ,A.Tpd_SPLHOLAmt
                                                    ,A.Tpd_SPLHOLOTHr
                                                    ,A.Tpd_SPLHOLOTAmt
                                                    ,A.Tpd_SPLHOLNDHr
                                                    ,A.Tpd_SPLHOLNDAmt
                                                    ,A.Tpd_SPLHOLNDOTHr
                                                    ,A.Tpd_SPLHOLNDOTAmt
                                                    ,A.Tpd_PSDHr
                                                    ,A.Tpd_PSDAmt
                                                    ,A.Tpd_PSDOTHr
                                                    ,A.Tpd_PSDOTAmt
                                                    ,A.Tpd_PSDNDHr
                                                    ,A.Tpd_PSDNDAmt
                                                    ,A.Tpd_PSDNDOTHr
                                                    ,A.Tpd_PSDNDOTAmt
                                                    ,A.Tpd_COMPHOLHr
                                                    ,A.Tpd_COMPHOLAmt
                                                    ,A.Tpd_COMPHOLOTHr
                                                    ,A.Tpd_COMPHOLOTAmt
                                                    ,A.Tpd_COMPHOLNDHr
                                                    ,A.Tpd_COMPHOLNDAmt
                                                    ,A.Tpd_COMPHOLNDOTHr
                                                    ,A.Tpd_COMPHOLNDOTAmt
                                                    ,A.Tpd_RESTLEGHOLHr
                                                    ,A.Tpd_RESTLEGHOLAmt
                                                    ,A.Tpd_RESTLEGHOLOTHr
                                                    ,A.Tpd_RESTLEGHOLOTAmt
                                                    ,A.Tpd_RESTLEGHOLNDHr
                                                    ,A.Tpd_RESTLEGHOLNDAmt
                                                    ,A.Tpd_RESTLEGHOLNDOTHr
                                                    ,A.Tpd_RESTLEGHOLNDOTAmt
                                                    ,A.Tpd_RESTSPLHOLHr
                                                    ,A.Tpd_RESTSPLHOLAmt
                                                    ,A.Tpd_RESTSPLHOLOTHr
                                                    ,A.Tpd_RESTSPLHOLOTAmt
                                                    ,A.Tpd_RESTSPLHOLNDHr
                                                    ,A.Tpd_RESTSPLHOLNDAmt
                                                    ,A.Tpd_RESTSPLHOLNDOTHr
                                                    ,A.Tpd_RESTSPLHOLNDOTAmt
                                                    ,A.Tpd_RESTCOMPHOLHr
                                                    ,A.Tpd_RESTCOMPHOLAmt
                                                    ,A.Tpd_RESTCOMPHOLOTHr
                                                    ,A.Tpd_RESTCOMPHOLOTAmt
                                                    ,A.Tpd_RESTCOMPHOLNDHr
                                                    ,A.Tpd_RESTCOMPHOLNDAmt
                                                    ,A.Tpd_RESTCOMPHOLNDOTHr
                                                    ,A.Tpd_RESTCOMPHOLNDOTAmt
                                                    ,A.Tpd_RESTPSDHr
                                                    ,A.Tpd_RESTPSDAmt
                                                    ,A.Tpd_RESTPSDOTHr
                                                    ,A.Tpd_RESTPSDOTAmt
                                                    ,A.Tpd_RESTPSDNDHr
                                                    ,A.Tpd_RESTPSDNDAmt
                                                    ,A.Tpd_RESTPSDNDOTHr
                                                    ,A.Tpd_RESTPSDNDOTAmt
                                                    ,A.Tpd_TotalOTNDAmt
                                                    ,A.Usr_Login
                                                    ,A.Ludatetime
                                                    FROM T_EmpPayrollDtl A
                                                    LEFT JOIN T_EmpPayrollDtlYearly B ON A.Tpd_IDNo = B.Tpd_IDNo
	                                                    AND A.Tpd_PayCycle = B.Tpd_PayCycle
                                                        AND A.Tpd_Date = B.Tpd_Date
                                                    WHERE A.Tpd_PayCycle = @CurPayPeriod
	                                                    AND B.Tpd_PayCycle IS NULL

                                                    INSERT INTO T_EmpPayrollDtlMiscYearly
                                                    (Tpm_IDNo
                                                    ,Tpm_PayCycle
                                                    ,Tpm_Date
                                                    ,Tpm_Misc1Hr
                                                    ,Tpm_Misc1Amt
                                                    ,Tpm_Misc1OTHr
                                                    ,Tpm_Misc1OTAmt
                                                    ,Tpm_Misc1NDHr
                                                    ,Tpm_Misc1NDAmt
                                                    ,Tpm_Misc1NDOTHr
                                                    ,Tpm_Misc1NDOTAmt
                                                    ,Tpm_Misc2Hr
                                                    ,Tpm_Misc2Amt
                                                    ,Tpm_Misc2OTHr
                                                    ,Tpm_Misc2OTAmt
                                                    ,Tpm_Misc2NDHr
                                                    ,Tpm_Misc2NDAmt
                                                    ,Tpm_Misc2NDOTHr
                                                    ,Tpm_Misc2NDOTAmt
                                                    ,Tpm_Misc3Hr
                                                    ,Tpm_Misc3Amt
                                                    ,Tpm_Misc3OTHr
                                                    ,Tpm_Misc3OTAmt
                                                    ,Tpm_Misc3NDHr
                                                    ,Tpm_Misc3NDAmt
                                                    ,Tpm_Misc3NDOTHr
                                                    ,Tpm_Misc3NDOTAmt
                                                    ,Tpm_Misc4Hr
                                                    ,Tpm_Misc4Amt
                                                    ,Tpm_Misc4OTHr
                                                    ,Tpm_Misc4OTAmt
                                                    ,Tpm_Misc4NDHr
                                                    ,Tpm_Misc4NDAmt
                                                    ,Tpm_Misc4NDOTHr
                                                    ,Tpm_Misc4NDOTAmt
                                                    ,Tpm_Misc5Hr
                                                    ,Tpm_Misc5Amt
                                                    ,Tpm_Misc5OTHr
                                                    ,Tpm_Misc5OTAmt
                                                    ,Tpm_Misc5NDHr
                                                    ,Tpm_Misc5NDAmt
                                                    ,Tpm_Misc5NDOTHr
                                                    ,Tpm_Misc5NDOTAmt
                                                    ,Tpm_Misc6Hr
                                                    ,Tpm_Misc6Amt
                                                    ,Tpm_Misc6OTHr
                                                    ,Tpm_Misc6OTAmt
                                                    ,Tpm_Misc6NDHr
                                                    ,Tpm_Misc6NDAmt
                                                    ,Tpm_Misc6NDOTHr
                                                    ,Tpm_Misc6NDOTAmt
                                                    ,Usr_Login
                                                    ,Ludatetime)
                                                    SELECT A.Tpm_IDNo
                                                    ,A.Tpm_PayCycle
                                                    ,A.Tpm_Date
                                                    ,A.Tpm_Misc1Hr
                                                    ,A.Tpm_Misc1Amt
                                                    ,A.Tpm_Misc1OTHr
                                                    ,A.Tpm_Misc1OTAmt
                                                    ,A.Tpm_Misc1NDHr
                                                    ,A.Tpm_Misc1NDAmt
                                                    ,A.Tpm_Misc1NDOTHr
                                                    ,A.Tpm_Misc1NDOTAmt
                                                    ,A.Tpm_Misc2Hr
                                                    ,A.Tpm_Misc2Amt
                                                    ,A.Tpm_Misc2OTHr
                                                    ,A.Tpm_Misc2OTAmt
                                                    ,A.Tpm_Misc2NDHr
                                                    ,A.Tpm_Misc2NDAmt
                                                    ,A.Tpm_Misc2NDOTHr
                                                    ,A.Tpm_Misc2NDOTAmt
                                                    ,A.Tpm_Misc3Hr
                                                    ,A.Tpm_Misc3Amt
                                                    ,A.Tpm_Misc3OTHr
                                                    ,A.Tpm_Misc3OTAmt
                                                    ,A.Tpm_Misc3NDHr
                                                    ,A.Tpm_Misc3NDAmt
                                                    ,A.Tpm_Misc3NDOTHr
                                                    ,A.Tpm_Misc3NDOTAmt
                                                    ,A.Tpm_Misc4Hr
                                                    ,A.Tpm_Misc4Amt
                                                    ,A.Tpm_Misc4OTHr
                                                    ,A.Tpm_Misc4OTAmt
                                                    ,A.Tpm_Misc4NDHr
                                                    ,A.Tpm_Misc4NDAmt
                                                    ,A.Tpm_Misc4NDOTHr
                                                    ,A.Tpm_Misc4NDOTAmt
                                                    ,A.Tpm_Misc5Hr
                                                    ,A.Tpm_Misc5Amt
                                                    ,A.Tpm_Misc5OTHr
                                                    ,A.Tpm_Misc5OTAmt
                                                    ,A.Tpm_Misc5NDHr
                                                    ,A.Tpm_Misc5NDAmt
                                                    ,A.Tpm_Misc5NDOTHr
                                                    ,A.Tpm_Misc5NDOTAmt
                                                    ,A.Tpm_Misc6Hr
                                                    ,A.Tpm_Misc6Amt
                                                    ,A.Tpm_Misc6OTHr
                                                    ,A.Tpm_Misc6OTAmt
                                                    ,A.Tpm_Misc6NDHr
                                                    ,A.Tpm_Misc6NDAmt
                                                    ,A.Tpm_Misc6NDOTHr
                                                    ,A.Tpm_Misc6NDOTAmt
                                                    ,A.Usr_Login
                                                    ,A.Ludatetime
                                                    FROM T_EmpPayrollDtlMisc A
                                                    LEFT JOIN T_EmpPayrollDtlMiscYearly B ON A.Tpm_IDNo = B.Tpm_IDNo
	                                                    AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                        AND A.Tpm_Date = B.Tpm_Date
                                                    WHERE A.Tpm_PayCycle = @CurPayPeriod 
	                                                    AND B.Tpm_PayCycle IS NULL";

            public const string insertDeleteRetroPay = @"INSERT INTO T_EmpPayrollDtlRetroHst
                                                        (Tpd_IDNo
                                                            ,Tpd_RetroPayCycle
                                                            ,Tpd_PayCycle
                                                            ,Tpd_Date
                                                            ,Tpd_DayCode
                                                            ,Tpd_RestDayFlag
                                                            ,Tpd_SalaryRate
                                                            ,Tpd_HourRate
                                                            ,Tpd_PayrollType
                                                            ,Tpd_SpecialRate
                                                            ,Tpd_SpecialHourRate
                                                            ,Tpd_PremiumGrpCode
                                                            ,Tpd_LTHr
                                                            ,Tpd_LTAmt
                                                            ,Tpd_LTVarAmt
                                                            ,Tpd_UTHr
                                                            ,Tpd_UTAmt
                                                            ,Tpd_UTVarAmt
                                                            ,Tpd_UPLVHr
                                                            ,Tpd_UPLVAmt
                                                            ,Tpd_UPLVVarAmt
                                                            ,Tpd_ABSLEGHOLHr
                                                            ,Tpd_ABSLEGHOLAmt
                                                            ,Tpd_ABSLEGHOLVarAmt
                                                            ,Tpd_ABSSPLHOLHr
                                                            ,Tpd_ABSSPLHOLAmt
                                                            ,Tpd_ABSSPLHOLVarAmt
                                                            ,Tpd_ABSCOMPHOLHr
                                                            ,Tpd_ABSCOMPHOLAmt
                                                            ,Tpd_ABSCOMPHOLVarAmt
                                                            ,Tpd_ABSPSDHr
                                                            ,Tpd_ABSPSDAmt
                                                            ,Tpd_ABSPSDVarAmt
                                                            ,Tpd_ABSOTHHOLHr
                                                            ,Tpd_ABSOTHHOLAmt
                                                            ,Tpd_ABSOTHHOLVarAmt
                                                            ,Tpd_WDABSHr
                                                            ,Tpd_WDABSAmt
                                                            ,Tpd_WDABSVarAmt
                                                            ,Tpd_LTUTMaxHr
                                                            ,Tpd_LTUTMaxAmt
                                                            ,Tpd_LTUTMaxVarAmt
                                                            ,Tpd_ABSHr
                                                            ,Tpd_ABSAmt
                                                            ,Tpd_ABSVarAmt
                                                            ,Tpd_REGHr
                                                            ,Tpd_REGAmt
                                                            ,Tpd_REGVarAmt
                                                            ,Tpd_PDLVHr
                                                            ,Tpd_PDLVAmt
                                                            ,Tpd_PDLVVarAmt
                                                            ,Tpd_PDLEGHOLHr
                                                            ,Tpd_PDLEGHOLAmt
                                                            ,Tpd_PDLEGHOLVarAmt
                                                            ,Tpd_PDSPLHOLHr
                                                            ,Tpd_PDSPLHOLAmt
                                                            ,Tpd_PDSPLHOLVarAmt
                                                            ,Tpd_PDCOMPHOLHr
                                                            ,Tpd_PDCOMPHOLAmt
                                                            ,Tpd_PDCOMPHOLVarAmt
                                                            ,Tpd_PDPSDHr
                                                            ,Tpd_PDPSDAmt
                                                            ,Tpd_PDPSDVarAmt
                                                            ,Tpd_PDOTHHOLHr
                                                            ,Tpd_PDOTHHOLAmt
                                                            ,Tpd_PDOTHHOLVarAmt
                                                            ,Tpd_PDRESTLEGHOLHr
                                                            ,Tpd_PDRESTLEGHOLAmt
                                                            ,Tpd_PDRESTLEGHOLVarAmt
                                                            ,Tpd_TotalREGHr
                                                            ,Tpd_TotalREGAmt
                                                            ,Tpd_TotalREGVarAmt
                                                            ,Tpd_REGOTHr
                                                            ,Tpd_REGOTAmt
                                                            ,Tpd_REGOTVarAmt
                                                            ,Tpd_REGNDHr
                                                            ,Tpd_REGNDAmt
                                                            ,Tpd_REGNDVarAmt
                                                            ,Tpd_REGNDOTHr
                                                            ,Tpd_REGNDOTAmt
                                                            ,Tpd_REGNDOTVarAmt
                                                            ,Tpd_RESTHr
                                                            ,Tpd_RESTAmt
                                                            ,Tpd_RESTVarAmt
                                                            ,Tpd_RESTOTHr
                                                            ,Tpd_RESTOTAmt
                                                            ,Tpd_RESTOTVarAmt
                                                            ,Tpd_RESTNDHr
                                                            ,Tpd_RESTNDAmt
                                                            ,Tpd_RESTNDVarAmt
                                                            ,Tpd_RESTNDOTHr
                                                            ,Tpd_RESTNDOTAmt
                                                            ,Tpd_RESTNDOTVarAmt
                                                            ,Tpd_LEGHOLHr
                                                            ,Tpd_LEGHOLAmt
                                                            ,Tpd_LEGHOLVarAmt
                                                            ,Tpd_LEGHOLOTHr
                                                            ,Tpd_LEGHOLOTAmt
                                                            ,Tpd_LEGHOLOTVarAmt
                                                            ,Tpd_LEGHOLNDHr
                                                            ,Tpd_LEGHOLNDAmt
                                                            ,Tpd_LEGHOLNDVarAmt
                                                            ,Tpd_LEGHOLNDOTHr
                                                            ,Tpd_LEGHOLNDOTAmt
                                                            ,Tpd_LEGHOLNDOTVarAmt
                                                            ,Tpd_SPLHOLHr
                                                            ,Tpd_SPLHOLAmt
                                                            ,Tpd_SPLHOLVarAmt
                                                            ,Tpd_SPLHOLOTHr
                                                            ,Tpd_SPLHOLOTAmt
                                                            ,Tpd_SPLHOLOTVarAmt
                                                            ,Tpd_SPLHOLNDHr
                                                            ,Tpd_SPLHOLNDAmt
                                                            ,Tpd_SPLHOLNDVarAmt
                                                            ,Tpd_SPLHOLNDOTHr
                                                            ,Tpd_SPLHOLNDOTAmt
                                                            ,Tpd_SPLHOLNDOTVarAmt
                                                            ,Tpd_PSDHr
                                                            ,Tpd_PSDAmt
                                                            ,Tpd_PSDVarAmt
                                                            ,Tpd_PSDOTHr
                                                            ,Tpd_PSDOTAmt
                                                            ,Tpd_PSDOTVarAmt
                                                            ,Tpd_PSDNDHr
                                                            ,Tpd_PSDNDAmt
                                                            ,Tpd_PSDNDVarAmt
                                                            ,Tpd_PSDNDOTHr
                                                            ,Tpd_PSDNDOTAmt
                                                            ,Tpd_PSDNDOTVarAmt
                                                            ,Tpd_COMPHOLHr
                                                            ,Tpd_COMPHOLAmt
                                                            ,Tpd_COMPHOLVarAmt
                                                            ,Tpd_COMPHOLOTHr
                                                            ,Tpd_COMPHOLOTAmt
                                                            ,Tpd_COMPHOLOTVarAmt
                                                            ,Tpd_COMPHOLNDHr
                                                            ,Tpd_COMPHOLNDAmt
                                                            ,Tpd_COMPHOLNDVarAmt
                                                            ,Tpd_COMPHOLNDOTHr
                                                            ,Tpd_COMPHOLNDOTAmt
                                                            ,Tpd_COMPHOLNDOTVarAmt
                                                            ,Tpd_RESTLEGHOLHr
                                                            ,Tpd_RESTLEGHOLAmt
                                                            ,Tpd_RESTLEGHOLVarAmt
                                                            ,Tpd_RESTLEGHOLOTHr
                                                            ,Tpd_RESTLEGHOLOTAmt
                                                            ,Tpd_RESTLEGHOLOTVarAmt
                                                            ,Tpd_RESTLEGHOLNDHr
                                                            ,Tpd_RESTLEGHOLNDAmt
                                                            ,Tpd_RESTLEGHOLNDVarAmt
                                                            ,Tpd_RESTLEGHOLNDOTHr
                                                            ,Tpd_RESTLEGHOLNDOTAmt
                                                            ,Tpd_RESTLEGHOLNDOTVarAmt
                                                            ,Tpd_RESTSPLHOLHr
                                                            ,Tpd_RESTSPLHOLAmt
                                                            ,Tpd_RESTSPLHOLVarAmt
                                                            ,Tpd_RESTSPLHOLOTHr
                                                            ,Tpd_RESTSPLHOLOTAmt
                                                            ,Tpd_RESTSPLHOLOTVarAmt
                                                            ,Tpd_RESTSPLHOLNDHr
                                                            ,Tpd_RESTSPLHOLNDAmt
                                                            ,Tpd_RESTSPLHOLNDVarAmt
                                                            ,Tpd_RESTSPLHOLNDOTHr
                                                            ,Tpd_RESTSPLHOLNDOTAmt
                                                            ,Tpd_RESTSPLHOLNDOTVarAmt
                                                            ,Tpd_RESTCOMPHOLHr
                                                            ,Tpd_RESTCOMPHOLAmt
                                                            ,Tpd_RESTCOMPHOLVarAmt
                                                            ,Tpd_RESTCOMPHOLOTHr
                                                            ,Tpd_RESTCOMPHOLOTAmt
                                                            ,Tpd_RESTCOMPHOLOTVarAmt
                                                            ,Tpd_RESTCOMPHOLNDHr
                                                            ,Tpd_RESTCOMPHOLNDAmt
                                                            ,Tpd_RESTCOMPHOLNDVarAmt
                                                            ,Tpd_RESTCOMPHOLNDOTHr
                                                            ,Tpd_RESTCOMPHOLNDOTAmt
                                                            ,Tpd_RESTCOMPHOLNDOTVarAmt
                                                            ,Tpd_RESTPSDHr
                                                            ,Tpd_RESTPSDAmt
                                                            ,Tpd_RESTPSDVarAmt
                                                            ,Tpd_RESTPSDOTHr
                                                            ,Tpd_RESTPSDOTAmt
                                                            ,Tpd_RESTPSDOTVarAmt
                                                            ,Tpd_RESTPSDNDHr
                                                            ,Tpd_RESTPSDNDAmt
                                                            ,Tpd_RESTPSDNDVarAmt
                                                            ,Tpd_RESTPSDNDOTHr
                                                            ,Tpd_RESTPSDNDOTAmt
                                                            ,Tpd_RESTPSDNDOTVarAmt
                                                            ,Tpd_RGRetroAmt
                                                            ,Tpd_OTRetroAmt
                                                            ,Tpd_NDRetroAmt
                                                            ,Tpd_HLRetroAmt
                                                            ,Tpd_LVRetroAmt
                                                            ,Tpd_TotalRetroAmt
                                                            ,Usr_Login
                                                            ,Ludatetime) 
                                                        SELECT A.Tpd_IDNo
                                                            ,A.Tpd_RetroPayCycle
                                                            ,A.Tpd_PayCycle
                                                            ,A.Tpd_Date
                                                            ,A.Tpd_DayCode
                                                            ,A.Tpd_RestDayFlag
                                                            ,A.Tpd_SalaryRate
                                                            ,A.Tpd_HourRate
                                                            ,A.Tpd_PayrollType
                                                            ,A.Tpd_SpecialRate
                                                            ,A.Tpd_SpecialHourRate
                                                            ,A.Tpd_PremiumGrpCode
                                                            ,A.Tpd_LTHr
                                                            ,A.Tpd_LTAmt
                                                            ,A.Tpd_LTVarAmt
                                                            ,A.Tpd_UTHr
                                                            ,A.Tpd_UTAmt
                                                            ,A.Tpd_UTVarAmt
                                                            ,A.Tpd_UPLVHr
                                                            ,A.Tpd_UPLVAmt
                                                            ,A.Tpd_UPLVVarAmt
                                                            ,A.Tpd_ABSLEGHOLHr
                                                            ,A.Tpd_ABSLEGHOLAmt
                                                            ,A.Tpd_ABSLEGHOLVarAmt
                                                            ,A.Tpd_ABSSPLHOLHr
                                                            ,A.Tpd_ABSSPLHOLAmt
                                                            ,A.Tpd_ABSSPLHOLVarAmt
                                                            ,A.Tpd_ABSCOMPHOLHr
                                                            ,A.Tpd_ABSCOMPHOLAmt
                                                            ,A.Tpd_ABSCOMPHOLVarAmt
                                                            ,A.Tpd_ABSPSDHr
                                                            ,A.Tpd_ABSPSDAmt
                                                            ,A.Tpd_ABSPSDVarAmt
                                                            ,A.Tpd_ABSOTHHOLHr
                                                            ,A.Tpd_ABSOTHHOLAmt
                                                            ,A.Tpd_ABSOTHHOLVarAmt
                                                            ,A.Tpd_WDABSHr
                                                            ,A.Tpd_WDABSAmt
                                                            ,A.Tpd_WDABSVarAmt
                                                            ,A.Tpd_LTUTMaxHr
                                                            ,A.Tpd_LTUTMaxAmt
                                                            ,A.Tpd_LTUTMaxVarAmt
                                                            ,A.Tpd_ABSHr
                                                            ,A.Tpd_ABSAmt
                                                            ,A.Tpd_ABSVarAmt
                                                            ,A.Tpd_REGHr
                                                            ,A.Tpd_REGAmt
                                                            ,A.Tpd_REGVarAmt
                                                            ,A.Tpd_PDLVHr
                                                            ,A.Tpd_PDLVAmt
                                                            ,A.Tpd_PDLVVarAmt
                                                            ,A.Tpd_PDLEGHOLHr
                                                            ,A.Tpd_PDLEGHOLAmt
                                                            ,A.Tpd_PDLEGHOLVarAmt
                                                            ,A.Tpd_PDSPLHOLHr
                                                            ,A.Tpd_PDSPLHOLAmt
                                                            ,A.Tpd_PDSPLHOLVarAmt
                                                            ,A.Tpd_PDCOMPHOLHr
                                                            ,A.Tpd_PDCOMPHOLAmt
                                                            ,A.Tpd_PDCOMPHOLVarAmt
                                                            ,A.Tpd_PDPSDHr
                                                            ,A.Tpd_PDPSDAmt
                                                            ,A.Tpd_PDPSDVarAmt
                                                            ,A.Tpd_PDOTHHOLHr
                                                            ,A.Tpd_PDOTHHOLAmt
                                                            ,A.Tpd_PDOTHHOLVarAmt
                                                            ,A.Tpd_PDRESTLEGHOLHr
                                                            ,A.Tpd_PDRESTLEGHOLAmt
                                                            ,A.Tpd_PDRESTLEGHOLVarAmt
                                                            ,A.Tpd_TotalREGHr
                                                            ,A.Tpd_TotalREGAmt
                                                            ,A.Tpd_TotalREGVarAmt
                                                            ,A.Tpd_REGOTHr
                                                            ,A.Tpd_REGOTAmt
                                                            ,A.Tpd_REGOTVarAmt
                                                            ,A.Tpd_REGNDHr
                                                            ,A.Tpd_REGNDAmt
                                                            ,A.Tpd_REGNDVarAmt
                                                            ,A.Tpd_REGNDOTHr
                                                            ,A.Tpd_REGNDOTAmt
                                                            ,A.Tpd_REGNDOTVarAmt
                                                            ,A.Tpd_RESTHr
                                                            ,A.Tpd_RESTAmt
                                                            ,A.Tpd_RESTVarAmt
                                                            ,A.Tpd_RESTOTHr
                                                            ,A.Tpd_RESTOTAmt
                                                            ,A.Tpd_RESTOTVarAmt
                                                            ,A.Tpd_RESTNDHr
                                                            ,A.Tpd_RESTNDAmt
                                                            ,A.Tpd_RESTNDVarAmt
                                                            ,A.Tpd_RESTNDOTHr
                                                            ,A.Tpd_RESTNDOTAmt
                                                            ,A.Tpd_RESTNDOTVarAmt
                                                            ,A.Tpd_LEGHOLHr
                                                            ,A.Tpd_LEGHOLAmt
                                                            ,A.Tpd_LEGHOLVarAmt
                                                            ,A.Tpd_LEGHOLOTHr
                                                            ,A.Tpd_LEGHOLOTAmt
                                                            ,A.Tpd_LEGHOLOTVarAmt
                                                            ,A.Tpd_LEGHOLNDHr
                                                            ,A.Tpd_LEGHOLNDAmt
                                                            ,A.Tpd_LEGHOLNDVarAmt
                                                            ,A.Tpd_LEGHOLNDOTHr
                                                            ,A.Tpd_LEGHOLNDOTAmt
                                                            ,A.Tpd_LEGHOLNDOTVarAmt
                                                            ,A.Tpd_SPLHOLHr
                                                            ,A.Tpd_SPLHOLAmt
                                                            ,A.Tpd_SPLHOLVarAmt
                                                            ,A.Tpd_SPLHOLOTHr
                                                            ,A.Tpd_SPLHOLOTAmt
                                                            ,A.Tpd_SPLHOLOTVarAmt
                                                            ,A.Tpd_SPLHOLNDHr
                                                            ,A.Tpd_SPLHOLNDAmt
                                                            ,A.Tpd_SPLHOLNDVarAmt
                                                            ,A.Tpd_SPLHOLNDOTHr
                                                            ,A.Tpd_SPLHOLNDOTAmt
                                                            ,A.Tpd_SPLHOLNDOTVarAmt
                                                            ,A.Tpd_PSDHr
                                                            ,A.Tpd_PSDAmt
                                                            ,A.Tpd_PSDVarAmt
                                                            ,A.Tpd_PSDOTHr
                                                            ,A.Tpd_PSDOTAmt
                                                            ,A.Tpd_PSDOTVarAmt
                                                            ,A.Tpd_PSDNDHr
                                                            ,A.Tpd_PSDNDAmt
                                                            ,A.Tpd_PSDNDVarAmt
                                                            ,A.Tpd_PSDNDOTHr
                                                            ,A.Tpd_PSDNDOTAmt
                                                            ,A.Tpd_PSDNDOTVarAmt
                                                            ,A.Tpd_COMPHOLHr
                                                            ,A.Tpd_COMPHOLAmt
                                                            ,A.Tpd_COMPHOLVarAmt
                                                            ,A.Tpd_COMPHOLOTHr
                                                            ,A.Tpd_COMPHOLOTAmt
                                                            ,A.Tpd_COMPHOLOTVarAmt
                                                            ,A.Tpd_COMPHOLNDHr
                                                            ,A.Tpd_COMPHOLNDAmt
                                                            ,A.Tpd_COMPHOLNDVarAmt
                                                            ,A.Tpd_COMPHOLNDOTHr
                                                            ,A.Tpd_COMPHOLNDOTAmt
                                                            ,A.Tpd_COMPHOLNDOTVarAmt
                                                            ,A.Tpd_RESTLEGHOLHr
                                                            ,A.Tpd_RESTLEGHOLAmt
                                                            ,A.Tpd_RESTLEGHOLVarAmt
                                                            ,A.Tpd_RESTLEGHOLOTHr
                                                            ,A.Tpd_RESTLEGHOLOTAmt
                                                            ,A.Tpd_RESTLEGHOLOTVarAmt
                                                            ,A.Tpd_RESTLEGHOLNDHr
                                                            ,A.Tpd_RESTLEGHOLNDAmt
                                                            ,A.Tpd_RESTLEGHOLNDVarAmt
                                                            ,A.Tpd_RESTLEGHOLNDOTHr
                                                            ,A.Tpd_RESTLEGHOLNDOTAmt
                                                            ,A.Tpd_RESTLEGHOLNDOTVarAmt
                                                            ,A.Tpd_RESTSPLHOLHr
                                                            ,A.Tpd_RESTSPLHOLAmt
                                                            ,A.Tpd_RESTSPLHOLVarAmt
                                                            ,A.Tpd_RESTSPLHOLOTHr
                                                            ,A.Tpd_RESTSPLHOLOTAmt
                                                            ,A.Tpd_RESTSPLHOLOTVarAmt
                                                            ,A.Tpd_RESTSPLHOLNDHr
                                                            ,A.Tpd_RESTSPLHOLNDAmt
                                                            ,A.Tpd_RESTSPLHOLNDVarAmt
                                                            ,A.Tpd_RESTSPLHOLNDOTHr
                                                            ,A.Tpd_RESTSPLHOLNDOTAmt
                                                            ,A.Tpd_RESTSPLHOLNDOTVarAmt
                                                            ,A.Tpd_RESTCOMPHOLHr
                                                            ,A.Tpd_RESTCOMPHOLAmt
                                                            ,A.Tpd_RESTCOMPHOLVarAmt
                                                            ,A.Tpd_RESTCOMPHOLOTHr
                                                            ,A.Tpd_RESTCOMPHOLOTAmt
                                                            ,A.Tpd_RESTCOMPHOLOTVarAmt
                                                            ,A.Tpd_RESTCOMPHOLNDHr
                                                            ,A.Tpd_RESTCOMPHOLNDAmt
                                                            ,A.Tpd_RESTCOMPHOLNDVarAmt
                                                            ,A.Tpd_RESTCOMPHOLNDOTHr
                                                            ,A.Tpd_RESTCOMPHOLNDOTAmt
                                                            ,A.Tpd_RESTCOMPHOLNDOTVarAmt
                                                            ,A.Tpd_RESTPSDHr
                                                            ,A.Tpd_RESTPSDAmt
                                                            ,A.Tpd_RESTPSDVarAmt
                                                            ,A.Tpd_RESTPSDOTHr
                                                            ,A.Tpd_RESTPSDOTAmt
                                                            ,A.Tpd_RESTPSDOTVarAmt
                                                            ,A.Tpd_RESTPSDNDHr
                                                            ,A.Tpd_RESTPSDNDAmt
                                                            ,A.Tpd_RESTPSDNDVarAmt
                                                            ,A.Tpd_RESTPSDNDOTHr
                                                            ,A.Tpd_RESTPSDNDOTAmt
                                                            ,A.Tpd_RESTPSDNDOTVarAmt
                                                            ,A.Tpd_RGRetroAmt
                                                            ,A.Tpd_OTRetroAmt
                                                            ,A.Tpd_NDRetroAmt
                                                            ,A.Tpd_HLRetroAmt
                                                            ,A.Tpd_LVRetroAmt
                                                            ,A.Tpd_TotalRetroAmt
                                                            ,A.Usr_Login
                                                            ,A.Ludatetime
                                                        FROM T_EmpPayrollDtlRetro A
                                                        LEFT JOIN T_EmpPayrollDtlRetroHst B 
                                                            ON A.Tpd_IDNo = B.Tpd_IDNo
	                                                        AND A.Tpd_RetroPayCycle = B.Tpd_RetroPayCycle
                                                            AND A.Tpd_PayCycle = B.Tpd_PayCycle
                                                            AND A.Tpd_Date = B.Tpd_Date
                                                        WHERE A.Tpd_RetroPayCycle = @CurPayPeriod 
	                                                        AND B.Tpd_RetroPayCycle IS NULL

                                                    DELETE FROM T_EmpPayrollDtlRetro
                                                    WHERE Tpd_RetroPayCycle = @CurPayPeriod 

                                                    INSERT INTO T_EmpPayrollDtlMiscRetroHst
                                                    (Tpm_IDNo
                                                    ,Tpm_RetroPayCycle
                                                    ,Tpm_PayCycle
                                                    ,Tpm_Date
                                                    ,Tpm_Misc1Hr
                                                    ,Tpm_Misc1Amt
                                                    ,Tpm_Misc1VarAmt
                                                    ,Tpm_Misc1OTHr
                                                    ,Tpm_Misc1OTAmt
                                                    ,Tpm_Misc1OTVarAmt
                                                    ,Tpm_Misc1NDHr
                                                    ,Tpm_Misc1NDAmt
                                                    ,Tpm_Misc1NDVarAmt
                                                    ,Tpm_Misc1NDOTHr
                                                    ,Tpm_Misc1NDOTAmt
                                                    ,Tpm_Misc1NDOTVarAmt
                                                    ,Tpm_Misc2Hr
                                                    ,Tpm_Misc2Amt
                                                    ,Tpm_Misc2VarAmt
                                                    ,Tpm_Misc2OTHr
                                                    ,Tpm_Misc2OTAmt
                                                    ,Tpm_Misc2OTVarAmt
                                                    ,Tpm_Misc2NDHr
                                                    ,Tpm_Misc2NDAmt
                                                    ,Tpm_Misc2NDVarAmt
                                                    ,Tpm_Misc2NDOTHr
                                                    ,Tpm_Misc2NDOTAmt
                                                    ,Tpm_Misc2NDOTVarAmt
                                                    ,Tpm_Misc3Hr
                                                    ,Tpm_Misc3Amt
                                                    ,Tpm_Misc3VarAmt
                                                    ,Tpm_Misc3OTHr
                                                    ,Tpm_Misc3OTAmt
                                                    ,Tpm_Misc3OTVarAmt
                                                    ,Tpm_Misc3NDHr
                                                    ,Tpm_Misc3NDAmt
                                                    ,Tpm_Misc3NDVarAmt
                                                    ,Tpm_Misc3NDOTHr
                                                    ,Tpm_Misc3NDOTAmt
                                                    ,Tpm_Misc3NDOTVarAmt
                                                    ,Tpm_Misc4Hr
                                                    ,Tpm_Misc4Amt
                                                    ,Tpm_Misc4VarAmt
                                                    ,Tpm_Misc4OTHr
                                                    ,Tpm_Misc4OTAmt
                                                    ,Tpm_Misc4OTVarAmt
                                                    ,Tpm_Misc4NDHr
                                                    ,Tpm_Misc4NDAmt
                                                    ,Tpm_Misc4NDVarAmt
                                                    ,Tpm_Misc4NDOTHr
                                                    ,Tpm_Misc4NDOTAmt
                                                    ,Tpm_Misc4NDOTVarAmt
                                                    ,Tpm_Misc5Hr
                                                    ,Tpm_Misc5Amt
                                                    ,Tpm_Misc5VarAmt
                                                    ,Tpm_Misc5OTHr
                                                    ,Tpm_Misc5OTAmt
                                                    ,Tpm_Misc5OTVarAmt
                                                    ,Tpm_Misc5NDHr
                                                    ,Tpm_Misc5NDAmt
                                                    ,Tpm_Misc5NDVarAmt
                                                    ,Tpm_Misc5NDOTHr
                                                    ,Tpm_Misc5NDOTAmt
                                                    ,Tpm_Misc5NDOTVarAmt
                                                    ,Tpm_Misc6Hr
                                                    ,Tpm_Misc6Amt
                                                    ,Tpm_Misc6VarAmt
                                                    ,Tpm_Misc6OTHr
                                                    ,Tpm_Misc6OTAmt
                                                    ,Tpm_Misc6OTVarAmt
                                                    ,Tpm_Misc6NDHr
                                                    ,Tpm_Misc6NDAmt
                                                    ,Tpm_Misc6NDVarAmt
                                                    ,Tpm_Misc6NDOTHr
                                                    ,Tpm_Misc6NDOTAmt
                                                    ,Tpm_Misc6NDOTVarAmt
                                                    ,Usr_Login
                                                    ,Ludatetime)
                                                    SELECT A.Tpm_IDNo
                                                        ,A.Tpm_RetroPayCycle
                                                        ,A.Tpm_PayCycle
                                                        ,A.Tpm_Date
                                                        ,A.Tpm_Misc1Hr
                                                        ,A.Tpm_Misc1Amt
                                                        ,A.Tpm_Misc1VarAmt
                                                        ,A.Tpm_Misc1OTHr
                                                        ,A.Tpm_Misc1OTAmt
                                                        ,A.Tpm_Misc1OTVarAmt
                                                        ,A.Tpm_Misc1NDHr
                                                        ,A.Tpm_Misc1NDAmt
                                                        ,A.Tpm_Misc1NDVarAmt
                                                        ,A.Tpm_Misc1NDOTHr
                                                        ,A.Tpm_Misc1NDOTAmt
                                                        ,A.Tpm_Misc1NDOTVarAmt
                                                        ,A.Tpm_Misc2Hr
                                                        ,A.Tpm_Misc2Amt
                                                        ,A.Tpm_Misc2VarAmt
                                                        ,A.Tpm_Misc2OTHr
                                                        ,A.Tpm_Misc2OTAmt
                                                        ,A.Tpm_Misc2OTVarAmt
                                                        ,A.Tpm_Misc2NDHr
                                                        ,A.Tpm_Misc2NDAmt
                                                        ,A.Tpm_Misc2NDVarAmt
                                                        ,A.Tpm_Misc2NDOTHr
                                                        ,A.Tpm_Misc2NDOTAmt
                                                        ,A.Tpm_Misc2NDOTVarAmt
                                                        ,A.Tpm_Misc3Hr
                                                        ,A.Tpm_Misc3Amt
                                                        ,A.Tpm_Misc3VarAmt
                                                        ,A.Tpm_Misc3OTHr
                                                        ,A.Tpm_Misc3OTAmt
                                                        ,A.Tpm_Misc3OTVarAmt
                                                        ,A.Tpm_Misc3NDHr
                                                        ,A.Tpm_Misc3NDAmt
                                                        ,A.Tpm_Misc3NDVarAmt
                                                        ,A.Tpm_Misc3NDOTHr
                                                        ,A.Tpm_Misc3NDOTAmt
                                                        ,A.Tpm_Misc3NDOTVarAmt
                                                        ,A.Tpm_Misc4Hr
                                                        ,A.Tpm_Misc4Amt
                                                        ,A.Tpm_Misc4VarAmt
                                                        ,A.Tpm_Misc4OTHr
                                                        ,A.Tpm_Misc4OTAmt
                                                        ,A.Tpm_Misc4OTVarAmt
                                                        ,A.Tpm_Misc4NDHr
                                                        ,A.Tpm_Misc4NDAmt
                                                        ,A.Tpm_Misc4NDVarAmt
                                                        ,A.Tpm_Misc4NDOTHr
                                                        ,A.Tpm_Misc4NDOTAmt
                                                        ,A.Tpm_Misc4NDOTVarAmt
                                                        ,A.Tpm_Misc5Hr
                                                        ,A.Tpm_Misc5Amt
                                                        ,A.Tpm_Misc5VarAmt
                                                        ,A.Tpm_Misc5OTHr
                                                        ,A.Tpm_Misc5OTAmt
                                                        ,A.Tpm_Misc5OTVarAmt
                                                        ,A.Tpm_Misc5NDHr
                                                        ,A.Tpm_Misc5NDAmt
                                                        ,A.Tpm_Misc5NDVarAmt
                                                        ,A.Tpm_Misc5NDOTHr
                                                        ,A.Tpm_Misc5NDOTAmt
                                                        ,A.Tpm_Misc5NDOTVarAmt
                                                        ,A.Tpm_Misc6Hr
                                                        ,A.Tpm_Misc6Amt
                                                        ,A.Tpm_Misc6VarAmt
                                                        ,A.Tpm_Misc6OTHr
                                                        ,A.Tpm_Misc6OTAmt
                                                        ,A.Tpm_Misc6OTVarAmt
                                                        ,A.Tpm_Misc6NDHr
                                                        ,A.Tpm_Misc6NDAmt
                                                        ,A.Tpm_Misc6NDVarAmt
                                                        ,A.Tpm_Misc6NDOTHr
                                                        ,A.Tpm_Misc6NDOTAmt
                                                        ,A.Tpm_Misc6NDOTVarAmt
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM T_EmpPayrollDtlMiscRetro A
                                                    LEFT JOIN T_EmpPayrollDtlMiscRetroHst B ON A.Tpm_IDNo = B.Tpm_IDNo
	                                                    AND A.Tpm_RetroPayCycle = B.Tpm_RetroPayCycle
                                                        AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                        AND A.Tpm_Date = B.Tpm_Date
                                                    WHERE A.Tpm_RetroPayCycle = @CurPayPeriod 
	                                                    AND B.Tpm_RetroPayCycle IS NULL

                                                    DELETE FROM T_EmpPayrollDtlMiscRetro
                                                    WHERE Tpm_RetroPayCycle = @CurPayPeriod

                                                    INSERT INTO T_EmpPayrollRetroHst
                                                    (Tpy_IDNo
                                                        ,Tpy_RetroPayCycle
                                                        ,Tpy_PayCycle
                                                        ,Tpy_SalaryRate
                                                        ,Tpy_HourRate
                                                        ,Tpy_PayrollType
                                                        ,Tpy_SpecialRate
                                                        ,Tpy_SpecialHourRate
                                                        ,Tpy_LTHr
                                                        ,Tpy_LTAmt
                                                        ,Tpy_LTVarAmt
                                                        ,Tpy_UTHr
                                                        ,Tpy_UTAmt
                                                        ,Tpy_UTVarAmt
                                                        ,Tpy_UPLVHr
                                                        ,Tpy_UPLVAmt
                                                        ,Tpy_UPLVVarAmt
                                                        ,Tpy_ABSLEGHOLHr
                                                        ,Tpy_ABSLEGHOLAmt
                                                        ,Tpy_ABSLEGHOLVarAmt
                                                        ,Tpy_ABSSPLHOLHr
                                                        ,Tpy_ABSSPLHOLAmt
                                                        ,Tpy_ABSSPLHOLVarAmt
                                                        ,Tpy_ABSCOMPHOLHr
                                                        ,Tpy_ABSCOMPHOLAmt
                                                        ,Tpy_ABSCOMPHOLVarAmt
                                                        ,Tpy_ABSPSDHr
                                                        ,Tpy_ABSPSDAmt
                                                        ,Tpy_ABSPSDVarAmt
                                                        ,Tpy_ABSOTHHOLHr
                                                        ,Tpy_ABSOTHHOLAmt
                                                        ,Tpy_ABSOTHHOLVarAmt
                                                        ,Tpy_WDABSHr
                                                        ,Tpy_WDABSAmt
                                                        ,Tpy_WDABSVarAmt
                                                        ,Tpy_LTUTMaxHr
                                                        ,Tpy_LTUTMaxAmt
                                                        ,Tpy_LTUTMaxVarAmt
                                                        ,Tpy_ABSHr
                                                        ,Tpy_ABSAmt
                                                        ,Tpy_ABSVarAmt
                                                        ,Tpy_REGHr
                                                        ,Tpy_REGAmt
                                                        ,Tpy_REGVarAmt
                                                        ,Tpy_PDLVHr
                                                        ,Tpy_PDLVAmt
                                                        ,Tpy_PDLVVarAmt
                                                        ,Tpy_PDLEGHOLHr
                                                        ,Tpy_PDLEGHOLAmt
                                                        ,Tpy_PDLEGHOLVarAmt
                                                        ,Tpy_PDSPLHOLHr
                                                        ,Tpy_PDSPLHOLAmt
                                                        ,Tpy_PDSPLHOLVarAmt
                                                        ,Tpy_PDCOMPHOLHr
                                                        ,Tpy_PDCOMPHOLAmt
                                                        ,Tpy_PDCOMPHOLVarAmt
                                                        ,Tpy_PDPSDHr
                                                        ,Tpy_PDPSDAmt
                                                        ,Tpy_PDPSDVarAmt
                                                        ,Tpy_PDOTHHOLHr
                                                        ,Tpy_PDOTHHOLAmt
                                                        ,Tpy_PDOTHHOLVarAmt
                                                        ,Tpy_PDRESTLEGHOLHr
                                                        ,Tpy_PDRESTLEGHOLAmt
                                                        ,Tpy_PDRESTLEGHOLVarAmt
                                                        ,Tpy_TotalREGHr
                                                        ,Tpy_TotalREGAmt
                                                        ,Tpy_TotalREGVarAmt
                                                        ,Tpy_REGOTHr
                                                        ,Tpy_REGOTAmt
                                                        ,Tpy_REGOTVarAmt
                                                        ,Tpy_REGNDHr
                                                        ,Tpy_REGNDAmt
                                                        ,Tpy_REGNDVarAmt
                                                        ,Tpy_REGNDOTHr
                                                        ,Tpy_REGNDOTAmt
                                                        ,Tpy_REGNDOTVarAmt
                                                        ,Tpy_RESTHr
                                                        ,Tpy_RESTAmt
                                                        ,Tpy_RESTVarAmt
                                                        ,Tpy_RESTOTHr
                                                        ,Tpy_RESTOTAmt
                                                        ,Tpy_RESTOTVarAmt
                                                        ,Tpy_RESTNDHr
                                                        ,Tpy_RESTNDAmt
                                                        ,Tpy_RESTNDVarAmt
                                                        ,Tpy_RESTNDOTHr
                                                        ,Tpy_RESTNDOTAmt
                                                        ,Tpy_RESTNDOTVarAmt
                                                        ,Tpy_LEGHOLHr
                                                        ,Tpy_LEGHOLAmt
                                                        ,Tpy_LEGHOLVarAmt
                                                        ,Tpy_LEGHOLOTHr
                                                        ,Tpy_LEGHOLOTAmt
                                                        ,Tpy_LEGHOLOTVarAmt
                                                        ,Tpy_LEGHOLNDHr
                                                        ,Tpy_LEGHOLNDAmt
                                                        ,Tpy_LEGHOLNDVarAmt
                                                        ,Tpy_LEGHOLNDOTHr
                                                        ,Tpy_LEGHOLNDOTAmt
                                                        ,Tpy_LEGHOLNDOTVarAmt
                                                        ,Tpy_SPLHOLHr
                                                        ,Tpy_SPLHOLAmt
                                                        ,Tpy_SPLHOLVarAmt
                                                        ,Tpy_SPLHOLOTHr
                                                        ,Tpy_SPLHOLOTAmt
                                                        ,Tpy_SPLHOLOTVarAmt
                                                        ,Tpy_SPLHOLNDHr
                                                        ,Tpy_SPLHOLNDAmt
                                                        ,Tpy_SPLHOLNDVarAmt
                                                        ,Tpy_SPLHOLNDOTHr
                                                        ,Tpy_SPLHOLNDOTAmt
                                                        ,Tpy_SPLHOLNDOTVarAmt
                                                        ,Tpy_PSDHr
                                                        ,Tpy_PSDAmt
                                                        ,Tpy_PSDVarAmt
                                                        ,Tpy_PSDOTHr
                                                        ,Tpy_PSDOTAmt
                                                        ,Tpy_PSDOTVarAmt
                                                        ,Tpy_PSDNDHr
                                                        ,Tpy_PSDNDAmt
                                                        ,Tpy_PSDNDVarAmt
                                                        ,Tpy_PSDNDOTHr
                                                        ,Tpy_PSDNDOTAmt
                                                        ,Tpy_PSDNDOTVarAmt
                                                        ,Tpy_COMPHOLHr
                                                        ,Tpy_COMPHOLAmt
                                                        ,Tpy_COMPHOLVarAmt
                                                        ,Tpy_COMPHOLOTHr
                                                        ,Tpy_COMPHOLOTAmt
                                                        ,Tpy_COMPHOLOTVarAmt
                                                        ,Tpy_COMPHOLNDHr
                                                        ,Tpy_COMPHOLNDAmt
                                                        ,Tpy_COMPHOLNDVarAmt
                                                        ,Tpy_COMPHOLNDOTHr
                                                        ,Tpy_COMPHOLNDOTAmt
                                                        ,Tpy_COMPHOLNDOTVarAmt
                                                        ,Tpy_RESTLEGHOLHr
                                                        ,Tpy_RESTLEGHOLAmt
                                                        ,Tpy_RESTLEGHOLVarAmt
                                                        ,Tpy_RESTLEGHOLOTHr
                                                        ,Tpy_RESTLEGHOLOTAmt
                                                        ,Tpy_RESTLEGHOLOTVarAmt
                                                        ,Tpy_RESTLEGHOLNDHr
                                                        ,Tpy_RESTLEGHOLNDAmt
                                                        ,Tpy_RESTLEGHOLNDVarAmt
                                                        ,Tpy_RESTLEGHOLNDOTHr
                                                        ,Tpy_RESTLEGHOLNDOTAmt
                                                        ,Tpy_RESTLEGHOLNDOTVarAmt
                                                        ,Tpy_RESTSPLHOLHr
                                                        ,Tpy_RESTSPLHOLAmt
                                                        ,Tpy_RESTSPLHOLVarAmt
                                                        ,Tpy_RESTSPLHOLOTHr
                                                        ,Tpy_RESTSPLHOLOTAmt
                                                        ,Tpy_RESTSPLHOLOTVarAmt
                                                        ,Tpy_RESTSPLHOLNDHr
                                                        ,Tpy_RESTSPLHOLNDAmt
                                                        ,Tpy_RESTSPLHOLNDVarAmt
                                                        ,Tpy_RESTSPLHOLNDOTHr
                                                        ,Tpy_RESTSPLHOLNDOTAmt
                                                        ,Tpy_RESTSPLHOLNDOTVarAmt
                                                        ,Tpy_RESTCOMPHOLHr
                                                        ,Tpy_RESTCOMPHOLAmt
                                                        ,Tpy_RESTCOMPHOLVarAmt
                                                        ,Tpy_RESTCOMPHOLOTHr
                                                        ,Tpy_RESTCOMPHOLOTAmt
                                                        ,Tpy_RESTCOMPHOLOTVarAmt
                                                        ,Tpy_RESTCOMPHOLNDHr
                                                        ,Tpy_RESTCOMPHOLNDAmt
                                                        ,Tpy_RESTCOMPHOLNDVarAmt
                                                        ,Tpy_RESTCOMPHOLNDOTHr
                                                        ,Tpy_RESTCOMPHOLNDOTAmt
                                                        ,Tpy_RESTCOMPHOLNDOTVarAmt
                                                        ,Tpy_RESTPSDHr
                                                        ,Tpy_RESTPSDAmt
                                                        ,Tpy_RESTPSDVarAmt
                                                        ,Tpy_RESTPSDOTHr
                                                        ,Tpy_RESTPSDOTAmt
                                                        ,Tpy_RESTPSDOTVarAmt
                                                        ,Tpy_RESTPSDNDHr
                                                        ,Tpy_RESTPSDNDAmt
                                                        ,Tpy_RESTPSDNDVarAmt
                                                        ,Tpy_RESTPSDNDOTHr
                                                        ,Tpy_RESTPSDNDOTAmt
                                                        ,Tpy_RESTPSDNDOTVarAmt
                                                        ,Tpy_TotalOTNDAmt
                                                        ,Tpy_DayCountOldSalaryRate
                                                        ,Tpy_IsMultipleSalary
                                                        ,Tpy_RegRule
                                                        ,Tpy_RGRetroAmt
                                                        ,Tpy_OTRetroAmt
                                                        ,Tpy_NDRetroAmt
                                                        ,Tpy_HLRetroAmt
                                                        ,Tpy_LVRetroAmt
                                                        ,Tpy_TotalRetroAmt
                                                        ,Tpy_CostcenterCode
                                                        ,Tpy_EmploymentStatus
                                                        ,Tpy_PayrollGroup
                                                        ,Usr_Login
                                                        ,Ludatetime)
                                                    SELECT A.Tpy_IDNo
                                                        ,A.Tpy_RetroPayCycle
                                                        ,A.Tpy_PayCycle
                                                        ,A.Tpy_SalaryRate
                                                        ,A.Tpy_HourRate
                                                        ,A.Tpy_PayrollType
                                                        ,A.Tpy_SpecialRate
                                                        ,A.Tpy_SpecialHourRate
                                                        ,A.Tpy_LTHr
                                                        ,A.Tpy_LTAmt
                                                        ,A.Tpy_LTVarAmt
                                                        ,A.Tpy_UTHr
                                                        ,A.Tpy_UTAmt
                                                        ,A.Tpy_UTVarAmt
                                                        ,A.Tpy_UPLVHr
                                                        ,A.Tpy_UPLVAmt
                                                        ,A.Tpy_UPLVVarAmt
                                                        ,A.Tpy_ABSLEGHOLHr
                                                        ,A.Tpy_ABSLEGHOLAmt
                                                        ,A.Tpy_ABSLEGHOLVarAmt
                                                        ,A.Tpy_ABSSPLHOLHr
                                                        ,A.Tpy_ABSSPLHOLAmt
                                                        ,A.Tpy_ABSSPLHOLVarAmt
                                                        ,A.Tpy_ABSCOMPHOLHr
                                                        ,A.Tpy_ABSCOMPHOLAmt
                                                        ,A.Tpy_ABSCOMPHOLVarAmt
                                                        ,A.Tpy_ABSPSDHr
                                                        ,A.Tpy_ABSPSDAmt
                                                        ,A.Tpy_ABSPSDVarAmt
                                                        ,A.Tpy_ABSOTHHOLHr
                                                        ,A.Tpy_ABSOTHHOLAmt
                                                        ,A.Tpy_ABSOTHHOLVarAmt
                                                        ,A.Tpy_WDABSHr
                                                        ,A.Tpy_WDABSAmt
                                                        ,A.Tpy_WDABSVarAmt
                                                        ,A.Tpy_LTUTMaxHr
                                                        ,A.Tpy_LTUTMaxAmt
                                                        ,A.Tpy_LTUTMaxVarAmt
                                                        ,A.Tpy_ABSHr
                                                        ,A.Tpy_ABSAmt
                                                        ,A.Tpy_ABSVarAmt
                                                        ,A.Tpy_REGHr
                                                        ,A.Tpy_REGAmt
                                                        ,A.Tpy_REGVarAmt
                                                        ,A.Tpy_PDLVHr
                                                        ,A.Tpy_PDLVAmt
                                                        ,A.Tpy_PDLVVarAmt
                                                        ,A.Tpy_PDLEGHOLHr
                                                        ,A.Tpy_PDLEGHOLAmt
                                                        ,A.Tpy_PDLEGHOLVarAmt
                                                        ,A.Tpy_PDSPLHOLHr
                                                        ,A.Tpy_PDSPLHOLAmt
                                                        ,A.Tpy_PDSPLHOLVarAmt
                                                        ,A.Tpy_PDCOMPHOLHr
                                                        ,A.Tpy_PDCOMPHOLAmt
                                                        ,A.Tpy_PDCOMPHOLVarAmt
                                                        ,A.Tpy_PDPSDHr
                                                        ,A.Tpy_PDPSDAmt
                                                        ,A.Tpy_PDPSDVarAmt
                                                        ,A.Tpy_PDOTHHOLHr
                                                        ,A.Tpy_PDOTHHOLAmt
                                                        ,A.Tpy_PDOTHHOLVarAmt
                                                        ,A.Tpy_PDRESTLEGHOLHr
                                                        ,A.Tpy_PDRESTLEGHOLAmt
                                                        ,A.Tpy_PDRESTLEGHOLVarAmt
                                                        ,A.Tpy_TotalREGHr
                                                        ,A.Tpy_TotalREGAmt
                                                        ,A.Tpy_TotalREGVarAmt
                                                        ,A.Tpy_REGOTHr
                                                        ,A.Tpy_REGOTAmt
                                                        ,A.Tpy_REGOTVarAmt
                                                        ,A.Tpy_REGNDHr
                                                        ,A.Tpy_REGNDAmt
                                                        ,A.Tpy_REGNDVarAmt
                                                        ,A.Tpy_REGNDOTHr
                                                        ,A.Tpy_REGNDOTAmt
                                                        ,A.Tpy_REGNDOTVarAmt
                                                        ,A.Tpy_RESTHr
                                                        ,A.Tpy_RESTAmt
                                                        ,A.Tpy_RESTVarAmt
                                                        ,A.Tpy_RESTOTHr
                                                        ,A.Tpy_RESTOTAmt
                                                        ,A.Tpy_RESTOTVarAmt
                                                        ,A.Tpy_RESTNDHr
                                                        ,A.Tpy_RESTNDAmt
                                                        ,A.Tpy_RESTNDVarAmt
                                                        ,A.Tpy_RESTNDOTHr
                                                        ,A.Tpy_RESTNDOTAmt
                                                        ,A.Tpy_RESTNDOTVarAmt
                                                        ,A.Tpy_LEGHOLHr
                                                        ,A.Tpy_LEGHOLAmt
                                                        ,A.Tpy_LEGHOLVarAmt
                                                        ,A.Tpy_LEGHOLOTHr
                                                        ,A.Tpy_LEGHOLOTAmt
                                                        ,A.Tpy_LEGHOLOTVarAmt
                                                        ,A.Tpy_LEGHOLNDHr
                                                        ,A.Tpy_LEGHOLNDAmt
                                                        ,A.Tpy_LEGHOLNDVarAmt
                                                        ,A.Tpy_LEGHOLNDOTHr
                                                        ,A.Tpy_LEGHOLNDOTAmt
                                                        ,A.Tpy_LEGHOLNDOTVarAmt
                                                        ,A.Tpy_SPLHOLHr
                                                        ,A.Tpy_SPLHOLAmt
                                                        ,A.Tpy_SPLHOLVarAmt
                                                        ,A.Tpy_SPLHOLOTHr
                                                        ,A.Tpy_SPLHOLOTAmt
                                                        ,A.Tpy_SPLHOLOTVarAmt
                                                        ,A.Tpy_SPLHOLNDHr
                                                        ,A.Tpy_SPLHOLNDAmt
                                                        ,A.Tpy_SPLHOLNDVarAmt
                                                        ,A.Tpy_SPLHOLNDOTHr
                                                        ,A.Tpy_SPLHOLNDOTAmt
                                                        ,A.Tpy_SPLHOLNDOTVarAmt
                                                        ,A.Tpy_PSDHr
                                                        ,A.Tpy_PSDAmt
                                                        ,A.Tpy_PSDVarAmt
                                                        ,A.Tpy_PSDOTHr
                                                        ,A.Tpy_PSDOTAmt
                                                        ,A.Tpy_PSDOTVarAmt
                                                        ,A.Tpy_PSDNDHr
                                                        ,A.Tpy_PSDNDAmt
                                                        ,A.Tpy_PSDNDVarAmt
                                                        ,A.Tpy_PSDNDOTHr
                                                        ,A.Tpy_PSDNDOTAmt
                                                        ,A.Tpy_PSDNDOTVarAmt
                                                        ,A.Tpy_COMPHOLHr
                                                        ,A.Tpy_COMPHOLAmt
                                                        ,A.Tpy_COMPHOLVarAmt
                                                        ,A.Tpy_COMPHOLOTHr
                                                        ,A.Tpy_COMPHOLOTAmt
                                                        ,A.Tpy_COMPHOLOTVarAmt
                                                        ,A.Tpy_COMPHOLNDHr
                                                        ,A.Tpy_COMPHOLNDAmt
                                                        ,A.Tpy_COMPHOLNDVarAmt
                                                        ,A.Tpy_COMPHOLNDOTHr
                                                        ,A.Tpy_COMPHOLNDOTAmt
                                                        ,A.Tpy_COMPHOLNDOTVarAmt
                                                        ,A.Tpy_RESTLEGHOLHr
                                                        ,A.Tpy_RESTLEGHOLAmt
                                                        ,A.Tpy_RESTLEGHOLVarAmt
                                                        ,A.Tpy_RESTLEGHOLOTHr
                                                        ,A.Tpy_RESTLEGHOLOTAmt
                                                        ,A.Tpy_RESTLEGHOLOTVarAmt
                                                        ,A.Tpy_RESTLEGHOLNDHr
                                                        ,A.Tpy_RESTLEGHOLNDAmt
                                                        ,A.Tpy_RESTLEGHOLNDVarAmt
                                                        ,A.Tpy_RESTLEGHOLNDOTHr
                                                        ,A.Tpy_RESTLEGHOLNDOTAmt
                                                        ,A.Tpy_RESTLEGHOLNDOTVarAmt
                                                        ,A.Tpy_RESTSPLHOLHr
                                                        ,A.Tpy_RESTSPLHOLAmt
                                                        ,A.Tpy_RESTSPLHOLVarAmt
                                                        ,A.Tpy_RESTSPLHOLOTHr
                                                        ,A.Tpy_RESTSPLHOLOTAmt
                                                        ,A.Tpy_RESTSPLHOLOTVarAmt
                                                        ,A.Tpy_RESTSPLHOLNDHr
                                                        ,A.Tpy_RESTSPLHOLNDAmt
                                                        ,A.Tpy_RESTSPLHOLNDVarAmt
                                                        ,A.Tpy_RESTSPLHOLNDOTHr
                                                        ,A.Tpy_RESTSPLHOLNDOTAmt
                                                        ,A.Tpy_RESTSPLHOLNDOTVarAmt
                                                        ,A.Tpy_RESTCOMPHOLHr
                                                        ,A.Tpy_RESTCOMPHOLAmt
                                                        ,A.Tpy_RESTCOMPHOLVarAmt
                                                        ,A.Tpy_RESTCOMPHOLOTHr
                                                        ,A.Tpy_RESTCOMPHOLOTAmt
                                                        ,A.Tpy_RESTCOMPHOLOTVarAmt
                                                        ,A.Tpy_RESTCOMPHOLNDHr
                                                        ,A.Tpy_RESTCOMPHOLNDAmt
                                                        ,A.Tpy_RESTCOMPHOLNDVarAmt
                                                        ,A.Tpy_RESTCOMPHOLNDOTHr
                                                        ,A.Tpy_RESTCOMPHOLNDOTAmt
                                                        ,A.Tpy_RESTCOMPHOLNDOTVarAmt
                                                        ,A.Tpy_RESTPSDHr
                                                        ,A.Tpy_RESTPSDAmt
                                                        ,A.Tpy_RESTPSDVarAmt
                                                        ,A.Tpy_RESTPSDOTHr
                                                        ,A.Tpy_RESTPSDOTAmt
                                                        ,A.Tpy_RESTPSDOTVarAmt
                                                        ,A.Tpy_RESTPSDNDHr
                                                        ,A.Tpy_RESTPSDNDAmt
                                                        ,A.Tpy_RESTPSDNDVarAmt
                                                        ,A.Tpy_RESTPSDNDOTHr
                                                        ,A.Tpy_RESTPSDNDOTAmt
                                                        ,A.Tpy_RESTPSDNDOTVarAmt
                                                        ,A.Tpy_TotalOTNDAmt
                                                        ,A.Tpy_DayCountOldSalaryRate
                                                        ,A.Tpy_IsMultipleSalary
                                                        ,A.Tpy_RegRule
                                                        ,A.Tpy_RGRetroAmt
                                                        ,A.Tpy_OTRetroAmt
                                                        ,A.Tpy_NDRetroAmt
                                                        ,A.Tpy_HLRetroAmt
                                                        ,A.Tpy_LVRetroAmt
                                                        ,A.Tpy_TotalRetroAmt
                                                        ,A.Tpy_CostcenterCode
                                                        ,A.Tpy_EmploymentStatus
                                                        ,A.Tpy_PayrollGroup
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM T_EmpPayrollRetro A
                                                    LEFT JOIN T_EmpPayrollRetroHst B ON A.Tpy_IDNo = B.Tpy_IDNo
	                                                    AND A.Tpy_RetroPayCycle = B.Tpy_RetroPayCycle
                                                        AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE A.Tpy_RetroPayCycle = @CurPayPeriod 
	                                                    AND B.Tpy_RetroPayCycle IS NULL

                                                    DELETE FROM T_EmpPayrollRetro
                                                    WHERE Tpy_RetroPayCycle = @CurPayPeriod

                                                    INSERT INTO T_EmpPayrollMiscRetroHst
                                                    (Tpm_IDNo
                                                        ,Tpm_RetroPayCycle
                                                        ,Tpm_PayCycle
                                                        ,Tpm_Misc1Hr
                                                        ,Tpm_Misc1Amt
                                                        ,Tpm_Misc1VarAmt
                                                        ,Tpm_Misc1OTHr
                                                        ,Tpm_Misc1OTAmt
                                                        ,Tpm_Misc1OTVarAmt
                                                        ,Tpm_Misc1NDHr
                                                        ,Tpm_Misc1NDAmt
                                                        ,Tpm_Misc1NDVarAmt
                                                        ,Tpm_Misc1NDOTHr
                                                        ,Tpm_Misc1NDOTAmt
                                                        ,Tpm_Misc1NDOTVarAmt
                                                        ,Tpm_Misc2Hr
                                                        ,Tpm_Misc2Amt
                                                        ,Tpm_Misc2VarAmt
                                                        ,Tpm_Misc2OTHr
                                                        ,Tpm_Misc2OTAmt
                                                        ,Tpm_Misc2OTVarAmt
                                                        ,Tpm_Misc2NDHr
                                                        ,Tpm_Misc2NDAmt
                                                        ,Tpm_Misc2NDVarAmt
                                                        ,Tpm_Misc2NDOTHr
                                                        ,Tpm_Misc2NDOTAmt
                                                        ,Tpm_Misc2NDOTVarAmt
                                                        ,Tpm_Misc3Hr
                                                        ,Tpm_Misc3Amt
                                                        ,Tpm_Misc3VarAmt
                                                        ,Tpm_Misc3OTHr
                                                        ,Tpm_Misc3OTAmt
                                                        ,Tpm_Misc3OTVarAmt
                                                        ,Tpm_Misc3NDHr
                                                        ,Tpm_Misc3NDAmt
                                                        ,Tpm_Misc3NDVarAmt
                                                        ,Tpm_Misc3NDOTHr
                                                        ,Tpm_Misc3NDOTAmt
                                                        ,Tpm_Misc3NDOTVarAmt
                                                        ,Tpm_Misc4Hr
                                                        ,Tpm_Misc4Amt
                                                        ,Tpm_Misc4VarAmt
                                                        ,Tpm_Misc4OTHr
                                                        ,Tpm_Misc4OTAmt
                                                        ,Tpm_Misc4OTVarAmt
                                                        ,Tpm_Misc4NDHr
                                                        ,Tpm_Misc4NDAmt
                                                        ,Tpm_Misc4NDVarAmt
                                                        ,Tpm_Misc4NDOTHr
                                                        ,Tpm_Misc4NDOTAmt
                                                        ,Tpm_Misc4NDOTVarAmt
                                                        ,Tpm_Misc5Hr
                                                        ,Tpm_Misc5Amt
                                                        ,Tpm_Misc5VarAmt
                                                        ,Tpm_Misc5OTHr
                                                        ,Tpm_Misc5OTAmt
                                                        ,Tpm_Misc5OTVarAmt
                                                        ,Tpm_Misc5NDHr
                                                        ,Tpm_Misc5NDAmt
                                                        ,Tpm_Misc5NDVarAmt
                                                        ,Tpm_Misc5NDOTHr
                                                        ,Tpm_Misc5NDOTAmt
                                                        ,Tpm_Misc5NDOTVarAmt
                                                        ,Tpm_Misc6Hr
                                                        ,Tpm_Misc6Amt
                                                        ,Tpm_Misc6VarAmt
                                                        ,Tpm_Misc6OTHr
                                                        ,Tpm_Misc6OTAmt
                                                        ,Tpm_Misc6OTVarAmt
                                                        ,Tpm_Misc6NDHr
                                                        ,Tpm_Misc6NDAmt
                                                        ,Tpm_Misc6NDVarAmt
                                                        ,Tpm_Misc6NDOTHr
                                                        ,Tpm_Misc6NDOTAmt
                                                        ,Tpm_Misc6NDOTVarAmt
                                                        ,Usr_Login
                                                        ,Ludatetime)
                                                    SELECT A.Tpm_IDNo
                                                        ,A.Tpm_RetroPayCycle
                                                        ,A.Tpm_PayCycle
                                                        ,A.Tpm_Misc1Hr
                                                        ,A.Tpm_Misc1Amt
                                                        ,A.Tpm_Misc1VarAmt
                                                        ,A.Tpm_Misc1OTHr
                                                        ,A.Tpm_Misc1OTAmt
                                                        ,A.Tpm_Misc1OTVarAmt
                                                        ,A.Tpm_Misc1NDHr
                                                        ,A.Tpm_Misc1NDAmt
                                                        ,A.Tpm_Misc1NDVarAmt
                                                        ,A.Tpm_Misc1NDOTHr
                                                        ,A.Tpm_Misc1NDOTAmt
                                                        ,A.Tpm_Misc1NDOTVarAmt
                                                        ,A.Tpm_Misc2Hr
                                                        ,A.Tpm_Misc2Amt
                                                        ,A.Tpm_Misc2VarAmt
                                                        ,A.Tpm_Misc2OTHr
                                                        ,A.Tpm_Misc2OTAmt
                                                        ,A.Tpm_Misc2OTVarAmt
                                                        ,A.Tpm_Misc2NDHr
                                                        ,A.Tpm_Misc2NDAmt
                                                        ,A.Tpm_Misc2NDVarAmt
                                                        ,A.Tpm_Misc2NDOTHr
                                                        ,A.Tpm_Misc2NDOTAmt
                                                        ,A.Tpm_Misc2NDOTVarAmt
                                                        ,A.Tpm_Misc3Hr
                                                        ,A.Tpm_Misc3Amt
                                                        ,A.Tpm_Misc3VarAmt
                                                        ,A.Tpm_Misc3OTHr
                                                        ,A.Tpm_Misc3OTAmt
                                                        ,A.Tpm_Misc3OTVarAmt
                                                        ,A.Tpm_Misc3NDHr
                                                        ,A.Tpm_Misc3NDAmt
                                                        ,A.Tpm_Misc3NDVarAmt
                                                        ,A.Tpm_Misc3NDOTHr
                                                        ,A.Tpm_Misc3NDOTAmt
                                                        ,A.Tpm_Misc3NDOTVarAmt
                                                        ,A.Tpm_Misc4Hr
                                                        ,A.Tpm_Misc4Amt
                                                        ,A.Tpm_Misc4VarAmt
                                                        ,A.Tpm_Misc4OTHr
                                                        ,A.Tpm_Misc4OTAmt
                                                        ,A.Tpm_Misc4OTVarAmt
                                                        ,A.Tpm_Misc4NDHr
                                                        ,A.Tpm_Misc4NDAmt
                                                        ,A.Tpm_Misc4NDVarAmt
                                                        ,A.Tpm_Misc4NDOTHr
                                                        ,A.Tpm_Misc4NDOTAmt
                                                        ,A.Tpm_Misc4NDOTVarAmt
                                                        ,A.Tpm_Misc5Hr
                                                        ,A.Tpm_Misc5Amt
                                                        ,A.Tpm_Misc5VarAmt
                                                        ,A.Tpm_Misc5OTHr
                                                        ,A.Tpm_Misc5OTAmt
                                                        ,A.Tpm_Misc5OTVarAmt
                                                        ,A.Tpm_Misc5NDHr
                                                        ,A.Tpm_Misc5NDAmt
                                                        ,A.Tpm_Misc5NDVarAmt
                                                        ,A.Tpm_Misc5NDOTHr
                                                        ,A.Tpm_Misc5NDOTAmt
                                                        ,A.Tpm_Misc5NDOTVarAmt
                                                        ,A.Tpm_Misc6Hr
                                                        ,A.Tpm_Misc6Amt
                                                        ,A.Tpm_Misc6VarAmt
                                                        ,A.Tpm_Misc6OTHr
                                                        ,A.Tpm_Misc6OTAmt
                                                        ,A.Tpm_Misc6OTVarAmt
                                                        ,A.Tpm_Misc6NDHr
                                                        ,A.Tpm_Misc6NDAmt
                                                        ,A.Tpm_Misc6NDVarAmt
                                                        ,A.Tpm_Misc6NDOTHr
                                                        ,A.Tpm_Misc6NDOTAmt
                                                        ,A.Tpm_Misc6NDOTVarAmt
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM T_EmpPayrollMiscRetro A
                                                    LEFT JOIN T_EmpPayrollMiscRetroHst B ON A.Tpm_IDNo = B.Tpm_IDNo
	                                                    AND A.Tpm_RetroPayCycle = B.Tpm_RetroPayCycle
                                                        AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                    WHERE A.Tpm_RetroPayCycle = @CurPayPeriod 
	                                                    AND B.Tpm_RetroPayCycle IS NULL
                                                    
                                                    DELETE FROM T_EmpPayrollMiscRetro
                                                    WHERE Tpm_RetroPayCycle = @CurPayPeriod

                                                    INSERT INTO T_EmpSystemAdj2RetroHst
                                                    (Tsa_IDNo
                                                        ,Tsa_RetroPayCycle
                                                        ,Tsa_AdjPayCycle
                                                        ,Tsa_OrigAdjPayCycle
                                                        ,Tsa_PayCycle
                                                        ,Tsa_Date
                                                        ,Tsa_SalaryRate
                                                        ,Tsa_HourRate
                                                        ,Tsa_PayrollType
                                                        ,Tsa_SpecialRate
                                                        ,Tsa_SpecialHourRate
                                                        ,Tsa_PremiumGrpCode
                                                        ,Tsa_LTAmt
                                                        ,Tsa_UTAmt
                                                        ,Tsa_UPLVAmt
                                                        ,Tsa_ABSLEGHOLAmt
                                                        ,Tsa_ABSSPLHOLAmt
                                                        ,Tsa_ABSCOMPHOLAmt
                                                        ,Tsa_ABSPSDAmt
                                                        ,Tsa_ABSOTHHOLAmt
                                                        ,Tsa_WDABSAmt
                                                        ,Tsa_LTUTMaxAmt
                                                        ,Tsa_ABSAmt
                                                        ,Tsa_REGAmt
                                                        ,Tsa_PDLVAmt
                                                        ,Tsa_PDLEGHOLAmt
                                                        ,Tsa_PDSPLHOLAmt
                                                        ,Tsa_PDCOMPHOLAmt
                                                        ,Tsa_PDPSDAmt
                                                        ,Tsa_PDOTHHOLAmt
                                                        ,Tsa_PDRESTLEGHOLAmt
                                                        ,Tsa_REGOTAmt
                                                        ,Tsa_REGNDAmt
                                                        ,Tsa_REGNDOTAmt
                                                        ,Tsa_RESTAmt
                                                        ,Tsa_RESTOTAmt
                                                        ,Tsa_RESTNDAmt
                                                        ,Tsa_RESTNDOTAmt
                                                        ,Tsa_LEGHOLAmt
                                                        ,Tsa_LEGHOLOTAmt
                                                        ,Tsa_LEGHOLNDAmt
                                                        ,Tsa_LEGHOLNDOTAmt
                                                        ,Tsa_SPLHOLAmt
                                                        ,Tsa_SPLHOLOTAmt
                                                        ,Tsa_SPLHOLNDAmt
                                                        ,Tsa_SPLHOLNDOTAmt
                                                        ,Tsa_PSDAmt
                                                        ,Tsa_PSDOTAmt
                                                        ,Tsa_PSDNDAmt
                                                        ,Tsa_PSDNDOTAmt
                                                        ,Tsa_COMPHOLAmt
                                                        ,Tsa_COMPHOLOTAmt
                                                        ,Tsa_COMPHOLNDAmt
                                                        ,Tsa_COMPHOLNDOTAmt
                                                        ,Tsa_RESTLEGHOLAmt
                                                        ,Tsa_RESTLEGHOLOTAmt
                                                        ,Tsa_RESTLEGHOLNDAmt
                                                        ,Tsa_RESTLEGHOLNDOTAmt
                                                        ,Tsa_RESTSPLHOLAmt
                                                        ,Tsa_RESTSPLHOLOTAmt
                                                        ,Tsa_RESTSPLHOLNDAmt
                                                        ,Tsa_RESTSPLHOLNDOTAmt
                                                        ,Tsa_RESTCOMPHOLAmt
                                                        ,Tsa_RESTCOMPHOLOTAmt
                                                        ,Tsa_RESTCOMPHOLNDAmt
                                                        ,Tsa_RESTCOMPHOLNDOTAmt
                                                        ,Tsa_RESTPSDAmt
                                                        ,Tsa_RESTPSDOTAmt
                                                        ,Tsa_RESTPSDNDAmt
                                                        ,Tsa_RESTPSDNDOTAmt
                                                        ,Tsa_RGAdjAmt
                                                        ,Tsa_OTAdjAmt
                                                        ,Tsa_HOLAdjAmt
                                                        ,Tsa_NDAdjAmt
                                                        ,Tsa_LVAdjAmt
                                                        ,Tsa_TotalAdjAmt
                                                        ,Tsa_RGRetroAmt
                                                        ,Tsa_OTRetroAmt
                                                        ,Tsa_NDRetroAmt
                                                        ,Tsa_HLRetroAmt
                                                        ,Tsa_LVRetroAmt
                                                        ,Tsa_TotalRetroAmt
                                                        ,Usr_Login
                                                        ,Ludatetime)
                                                    SELECT A.Tsa_IDNo
                                                        ,A.Tsa_RetroPayCycle
                                                        ,A.Tsa_AdjPayCycle
                                                        ,A.Tsa_OrigAdjPayCycle
                                                        ,A.Tsa_PayCycle
                                                        ,A.Tsa_Date
                                                        ,A.Tsa_SalaryRate
                                                        ,A.Tsa_HourRate
                                                        ,A.Tsa_PayrollType
                                                        ,A.Tsa_SpecialRate
                                                        ,A.Tsa_SpecialHourRate
                                                        ,A.Tsa_PremiumGrpCode
                                                        ,A.Tsa_LTAmt
                                                        ,A.Tsa_UTAmt
                                                        ,A.Tsa_UPLVAmt
                                                        ,A.Tsa_ABSLEGHOLAmt
                                                        ,A.Tsa_ABSSPLHOLAmt
                                                        ,A.Tsa_ABSCOMPHOLAmt
                                                        ,A.Tsa_ABSPSDAmt
                                                        ,A.Tsa_ABSOTHHOLAmt
                                                        ,A.Tsa_WDABSAmt
                                                        ,A.Tsa_LTUTMaxAmt
                                                        ,A.Tsa_ABSAmt
                                                        ,A.Tsa_REGAmt
                                                        ,A.Tsa_PDLVAmt
                                                        ,A.Tsa_PDLEGHOLAmt
                                                        ,A.Tsa_PDSPLHOLAmt
                                                        ,A.Tsa_PDCOMPHOLAmt
                                                        ,A.Tsa_PDPSDAmt
                                                        ,A.Tsa_PDOTHHOLAmt
                                                        ,A.Tsa_PDRESTLEGHOLAmt
                                                        ,A.Tsa_REGOTAmt
                                                        ,A.Tsa_REGNDAmt
                                                        ,A.Tsa_REGNDOTAmt
                                                        ,A.Tsa_RESTAmt
                                                        ,A.Tsa_RESTOTAmt
                                                        ,A.Tsa_RESTNDAmt
                                                        ,A.Tsa_RESTNDOTAmt
                                                        ,A.Tsa_LEGHOLAmt
                                                        ,A.Tsa_LEGHOLOTAmt
                                                        ,A.Tsa_LEGHOLNDAmt
                                                        ,A.Tsa_LEGHOLNDOTAmt
                                                        ,A.Tsa_SPLHOLAmt
                                                        ,A.Tsa_SPLHOLOTAmt
                                                        ,A.Tsa_SPLHOLNDAmt
                                                        ,A.Tsa_SPLHOLNDOTAmt
                                                        ,A.Tsa_PSDAmt
                                                        ,A.Tsa_PSDOTAmt
                                                        ,A.Tsa_PSDNDAmt
                                                        ,A.Tsa_PSDNDOTAmt
                                                        ,A.Tsa_COMPHOLAmt
                                                        ,A.Tsa_COMPHOLOTAmt
                                                        ,A.Tsa_COMPHOLNDAmt
                                                        ,A.Tsa_COMPHOLNDOTAmt
                                                        ,A.Tsa_RESTLEGHOLAmt
                                                        ,A.Tsa_RESTLEGHOLOTAmt
                                                        ,A.Tsa_RESTLEGHOLNDAmt
                                                        ,A.Tsa_RESTLEGHOLNDOTAmt
                                                        ,A.Tsa_RESTSPLHOLAmt
                                                        ,A.Tsa_RESTSPLHOLOTAmt
                                                        ,A.Tsa_RESTSPLHOLNDAmt
                                                        ,A.Tsa_RESTSPLHOLNDOTAmt
                                                        ,A.Tsa_RESTCOMPHOLAmt
                                                        ,A.Tsa_RESTCOMPHOLOTAmt
                                                        ,A.Tsa_RESTCOMPHOLNDAmt
                                                        ,A.Tsa_RESTCOMPHOLNDOTAmt
                                                        ,A.Tsa_RESTPSDAmt
                                                        ,A.Tsa_RESTPSDOTAmt
                                                        ,A.Tsa_RESTPSDNDAmt
                                                        ,A.Tsa_RESTPSDNDOTAmt
                                                        ,A.Tsa_RGAdjAmt
                                                        ,A.Tsa_OTAdjAmt
                                                        ,A.Tsa_HOLAdjAmt
                                                        ,A.Tsa_NDAdjAmt
                                                        ,A.Tsa_LVAdjAmt
                                                        ,A.Tsa_TotalAdjAmt
                                                        ,A.Tsa_RGRetroAmt
                                                        ,A.Tsa_OTRetroAmt
                                                        ,A.Tsa_NDRetroAmt
                                                        ,A.Tsa_HLRetroAmt
                                                        ,A.Tsa_LVRetroAmt
                                                        ,A.Tsa_TotalRetroAmt
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM T_EmpSystemAdj2Retro A
                                                    LEFT JOIN T_EmpSystemAdj2RetroHst B ON A.Tsa_IDNo = B.Tsa_IDNo
	                                                    AND A.Tsa_RetroPayCycle = B.Tsa_RetroPayCycle
                                                        AND A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                        AND A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
                                                        AND A.Tsa_PayCycle = B.Tsa_PayCycle
                                                        AND A.Tsa_Date = B.Tsa_Date
                                                    WHERE A.Tsa_RetroPayCycle = @CurPayPeriod 
	                                                    AND B.Tsa_RetroPayCycle IS NULL
                                                    
                                                    DELETE FROM T_EmpSystemAdj2Retro
                                                    WHERE Tsa_RetroPayCycle = @CurPayPeriod

                                                    INSERT INTO T_EmpSystemAdjMisc2RetroHst
                                                    (Tsm_IDNo
                                                        ,Tsm_RetroPayCycle
                                                        ,Tsm_AdjPayCycle
                                                        ,Tsm_OrigAdjPayCycle
                                                        ,Tsm_PayCycle
                                                        ,Tsm_Date
                                                        ,Tsm_Misc1Amt
                                                        ,Tsm_Misc1OTAmt
                                                        ,Tsm_Misc1NDAmt
                                                        ,Tsm_Misc1NDOTAmt
                                                        ,Tsm_Misc2Amt
                                                        ,Tsm_Misc2OTAmt
                                                        ,Tsm_Misc2NDAmt
                                                        ,Tsm_Misc2NDOTAmt
                                                        ,Tsm_Misc3Amt
                                                        ,Tsm_Misc3OTAmt
                                                        ,Tsm_Misc3NDAmt
                                                        ,Tsm_Misc3NDOTAmt
                                                        ,Tsm_Misc4Amt
                                                        ,Tsm_Misc4OTAmt
                                                        ,Tsm_Misc4NDAmt
                                                        ,Tsm_Misc4NDOTAmt
                                                        ,Tsm_Misc5Amt
                                                        ,Tsm_Misc5OTAmt
                                                        ,Tsm_Misc5NDAmt
                                                        ,Tsm_Misc5NDOTAmt
                                                        ,Tsm_Misc6Amt
                                                        ,Tsm_Misc6OTAmt
                                                        ,Tsm_Misc6NDAmt
                                                        ,Tsm_Misc6NDOTAmt
                                                        ,Usr_Login
                                                        ,Ludatetime)
                                                    SELECT A.Tsm_IDNo
                                                        ,A.Tsm_RetroPayCycle
                                                        ,A.Tsm_AdjPayCycle
                                                        ,A.Tsm_OrigAdjPayCycle
                                                        ,A.Tsm_PayCycle
                                                        ,A.Tsm_Date
                                                        ,A.Tsm_Misc1Amt
                                                        ,A.Tsm_Misc1OTAmt
                                                        ,A.Tsm_Misc1NDAmt
                                                        ,A.Tsm_Misc1NDOTAmt
                                                        ,A.Tsm_Misc2Amt
                                                        ,A.Tsm_Misc2OTAmt
                                                        ,A.Tsm_Misc2NDAmt
                                                        ,A.Tsm_Misc2NDOTAmt
                                                        ,A.Tsm_Misc3Amt
                                                        ,A.Tsm_Misc3OTAmt
                                                        ,A.Tsm_Misc3NDAmt
                                                        ,A.Tsm_Misc3NDOTAmt
                                                        ,A.Tsm_Misc4Amt
                                                        ,A.Tsm_Misc4OTAmt
                                                        ,A.Tsm_Misc4NDAmt
                                                        ,A.Tsm_Misc4NDOTAmt
                                                        ,A.Tsm_Misc5Amt
                                                        ,A.Tsm_Misc5OTAmt
                                                        ,A.Tsm_Misc5NDAmt
                                                        ,A.Tsm_Misc5NDOTAmt
                                                        ,A.Tsm_Misc6Amt
                                                        ,A.Tsm_Misc6OTAmt
                                                        ,A.Tsm_Misc6NDAmt
                                                        ,A.Tsm_Misc6NDOTAmt
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM T_EmpSystemAdjMisc2Retro A
                                                    LEFT JOIN T_EmpSystemAdjMisc2RetroHst B ON A.Tsm_IDNo = B.Tsm_IDNo
	                                                    AND A.Tsm_RetroPayCycle = B.Tsm_RetroPayCycle
                                                        AND A.Tsm_AdjPayCycle = B.Tsm_AdjPayCycle
                                                        AND A.Tsm_OrigAdjPayCycle = B.Tsm_OrigAdjPayCycle
                                                        AND A.Tsm_PayCycle = B.Tsm_PayCycle
                                                        AND A.Tsm_Date = B.Tsm_Date
                                                    WHERE A.Tsm_RetroPayCycle = @CurPayPeriod 
	                                                    AND B.Tsm_RetroPayCycle IS NULL
                                                    
                                                    DELETE FROM T_EmpSystemAdjMisc2Retro
                                                    WHERE Tsm_RetroPayCycle = @CurPayPeriod

                                                    INSERT INTO T_EmpRetroPayHst (Ter_PayCycle
													    ,Ter_IDNo
													    ,Ter_SalaryDate
													    ,Ter_SalaryRate
													    ,Ter_PayrollType
													    ,Ter_RGRetroAmt
													    ,Ter_OTRetroAmt
													    ,Ter_NDRetroAmt
													    ,Ter_HLRetroAmt
													    ,Ter_LVRetroAmt
													    ,Ter_TotalRetroAmt
													    ,Ter_AdjustPayCycles
													    ,Ter_PostFlag
													    ,Usr_Login
													    ,Ludatetime)
													SELECT A.Ter_PayCycle
													    ,A.Ter_IDNo
													    ,A.Ter_SalaryDate
													    ,A.Ter_SalaryRate
													    ,A.Ter_PayrollType
													    ,A.Ter_RGRetroAmt
													    ,A.Ter_OTRetroAmt
													    ,A.Ter_NDRetroAmt
													    ,A.Ter_HLRetroAmt
													    ,A.Ter_LVRetroAmt
													    ,A.Ter_TotalRetroAmt
													    ,A.Ter_AdjustPayCycles
													    ,A.Ter_PostFlag
													    ,A.Usr_Login
													    ,A.Ludatetime
													FROM T_EmpRetroPay A
                                                    LEFT JOIN T_EmpRetroPayHst B ON A.Ter_IDNo = B.Ter_IDNo
	                                                    AND A.Ter_PayCycle = B.Ter_PayCycle
                                                    WHERE A.Ter_PayCycle = @CurPayPeriod 
	                                                    AND B.Ter_PayCycle IS NULL
                                                    
                                                    DELETE FROM T_EmpRetroPay
                                                    WHERE Ter_PayCycle = @CurPayPeriod";


            public const string insertProcessCheck = @"INSERT INTO T_EmpProcessCheckHst 
                                                (Tpc_ModuleCode
                                                , Tpc_IDNo
                                                , Tpc_Type
                                                , Tpc_PayCycle
                                                , Tpc_NumValue1
                                                , Tpc_NumValue2
                                                , Tpc_Remarks
                                                , Tpc_SystemDefined
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tpc_ModuleCode
                                                    , A.Tpc_IDNo
	                                                , A.Tpc_Type
	                                                , A.Tpc_PayCycle
	                                                , A.Tpc_NumValue1
	                                                , A.Tpc_NumValue2
	                                                , A.Tpc_Remarks
                                                    , A.Tpc_SystemDefined
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM T_EmpProcessCheck A
                                                LEFT JOIN T_EmpProcessCheckHst B ON A.Tpc_IDNo = B.Tpc_IDNo
	                                                AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                    AND A.Tpc_ModuleCode = B.Tpc_ModuleCode
                                                WHERE A.Tpc_PayCycle = @CURPAYPERIOD
                                                     AND A.Tpc_ModuleCode = 'PAYROLLCALC'
	                                                AND B.Tpc_PayCycle IS NULL
                                                UNION ALL
                                                SELECT A.Tpc_ModuleCode
                                                    , A.Tpc_IDNo
	                                                , A.Tpc_Type
	                                                , A.Tpc_PayCycle
	                                                , A.Tpc_NumValue1
	                                                , A.Tpc_NumValue2
	                                                , A.Tpc_Remarks
                                                    , A.Tpc_SystemDefined
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM T_EmpProcessCheck A
                                                LEFT JOIN T_EmpProcessCheckHst B ON A.Tpc_IDNo = B.Tpc_IDNo
	                                                AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                    AND A.Tpc_ModuleCode = B.Tpc_ModuleCode
                                                WHERE A.Tpc_PayCycle = @CURPAYPERIOD
                                                     AND A.Tpc_ModuleCode = 'LABORCOST'
	                                                AND B.Tpc_PayCycle IS NULL
                                                UNION ALL
                                                SELECT A.Tpc_ModuleCode
                                                    , A.Tpc_IDNo
	                                                , A.Tpc_Type
	                                                , A.Tpc_PayCycle
	                                                , A.Tpc_NumValue1
	                                                , A.Tpc_NumValue2
	                                                , A.Tpc_Remarks
                                                    , A.Tpc_SystemDefined
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM T_EmpProcessCheck A
                                                LEFT JOIN T_EmpProcessCheckHst B ON A.Tpc_IDNo = B.Tpc_IDNo
	                                                AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                    AND A.Tpc_ModuleCode = B.Tpc_ModuleCode
                                                WHERE A.Tpc_PayCycle = @CURPAYPERIOD
                                                     AND A.Tpc_ModuleCode = 'RETROADJ'
	                                                AND B.Tpc_PayCycle IS NULL
                                                ";

            public const string updateDeductionHdr = @"DECLARE @CurPayPeriodEndDate as datetime 
                                                    SET @CurPayPeriodEndDate = (SELECT Tps_EndCycle FROM T_PaySchedule WHERE Tps_PayCycle = @CURPAYPERIOD)

                                                    UPDATE {0}..T_EmpDeductionHdr
                                                    SET   Tdh_PaidAmount = Tdh_PaidAmount  + PaidAmt
	                                                    , Tdh_DeferredAmount = Tdh_DeferredAmount - DeferredAmt
	                                                    , Tdh_PaymentDate = CASE WHEN Tdh_PaidAmount  + PaidAmt = Tdh_DeductionAmount then @CurPayPeriodEndDate ELSE Tdh_PaymentDate END
	                                                    , Usr_Login = @UserLogin
	                                                    , Ludatetime = GetDate()
                                                    FROM {0}..T_EmpDeductionHdr
                                                    INNER JOIN ( SELECT Tdd_IDNo  
				                                                    , Tdd_DeductionCode 
				                                                    , Tdd_StartDate  
				                                                    , PaidAmt = Sum(Tdd_Amount) 
				                                                    , DeferredAmt = Sum(Case When Tdd_DeferredFlag = 1  Then Tdd_Amount Else 0 End)
			                                                    FROM T_EmpDeductionDtl
			                                                    WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                                                    AND  Tdd_PaymentFlag = 1
			                                                    GROUP BY Tdd_IDNo  
				                                                    , Tdd_DeductionCode 
				                                                    , Tdd_StartDate  ) PaidDed on PaidDed.Tdd_IDNo = T_EmpDeductionHdr.Tdh_IDNo
								                                                    AND PaidDed.Tdd_DeductionCode = T_EmpDeductionHdr.Tdh_DeductionCode
								                                                    AND PaidDed.Tdd_StartDate = T_EmpDeductionHdr.Tdh_StartDate";

            public const string insertDeductionHdr = @"INSERT INTO {0}..T_EmpDeductionHdrHst 
                                                (Tdh_IDNo
                                                , Tdh_DeductionCode
                                                , Tdh_StartDate
                                                , Tdh_EndDate
                                                , Tdh_DeductionAmount
                                                , Tdh_PaidAmount
                                                , Tdh_CycleAmount
                                                , Tdh_DeferredAmount
                                                , Tdh_CheckDate
                                                , Tdh_VoucherNumber
                                                , Tdh_PaymentDate
                                                , Tdh_ExemptInPayroll
                                                , Tdh_PrincipalAmount
                                                , Tdh_ApplicablePayCycle
                                                , Tdh_AgreementNo
                                                , Tdh_DocumentNo
                                                , Tdh_EntryDate
                                                , Tdh_PaymentTerms
                                                , Usr_Login
                                                , Ludatetime)
                                                SELECT A.Tdh_IDNo
	                                                , A.Tdh_DeductionCode
	                                                , A.Tdh_StartDate
	                                                , A.Tdh_EndDate
	                                                , A.Tdh_DeductionAmount
	                                                , A.Tdh_PaidAmount
	                                                , A.Tdh_CycleAmount
	                                                , A.Tdh_DeferredAmount
	                                                , A.Tdh_CheckDate
	                                                , A.Tdh_VoucherNumber
	                                                , A.Tdh_PaymentDate
	                                                , A.Tdh_ExemptInPayroll
	                                                , A.Tdh_PrincipalAmount
	                                                , A.Tdh_ApplicablePayCycle
	                                                , A.Tdh_AgreementNo
	                                                , A.Tdh_DocumentNo
	                                                , A.Tdh_EntryDate
	                                                , A.Tdh_PaymentTerms
	                                                , A.Usr_Login
	                                                , A.Ludatetime
                                                FROM {0}..T_EmpDeductionHdr A
                                                INNER JOIN M_Employee ON Mem_IDNo = A.Tdh_IDNo
	                                                AND Mem_WorkStatus <> 'IM'
                                                LEFT JOIN {0}..T_EmpDeductionHdrHst B ON A.Tdh_IDNo = B.Tdh_IDNo
	                                                AND A.Tdh_DeductionCode = B.Tdh_DeductionCode
	                                                AND A.Tdh_StartDate = B.Tdh_StartDate
                                                WHERE B.Ludatetime IS NULL
	                                                AND A.Tdh_DeductionAmount = A.Tdh_PaidAmount
	                                                AND A.Tdh_PaymentDate IS NOT NULL";

            public const string insertDeductionHdrCycle = @"INSERT INTO T_EmpDeductionHdrCycleHst 
                                                    (Tdh_PayCycle
                                                    , Tdh_IDNo
                                                    , Tdh_DeductionCode
                                                    , Tdh_StartDate
                                                    , Tdh_EndDate
                                                    , Tdh_DeductionAmount
                                                    , Tdh_AccumulatedPaidAmount
                                                    , Tdh_CycleAmount
                                                    , Tdh_PaidAmountThisCycle
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tdh_PayCycle
	                                                    , A.Tdh_IDNo
	                                                    , A.Tdh_DeductionCode
	                                                    , A.Tdh_StartDate
	                                                    , A.Tdh_EndDate
	                                                    , A.Tdh_DeductionAmount
	                                                    , A.Tdh_AccumulatedPaidAmount
	                                                    , A.Tdh_CycleAmount
	                                                    , A.Tdh_PaidAmountThisCycle
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpDeductionHdrCycle A
                                                    LEFT JOIN T_EmpDeductionHdrCycleHst B ON A.Tdh_IDNo = B.Tdh_IDNo
	                                                    AND A.Tdh_PayCycle = B.Tdh_PayCycle
	                                                    AND A.Tdh_DeductionCode = B.Tdh_DeductionCode
	                                                    AND A.Tdh_StartDate = B.Tdh_StartDate
                                                    WHERE A.Tdh_PayCycle = @CURPAYPERIOD
	                                                    AND B.Tdh_PayCycle IS NULL";

            public const string insertDeductionDtlFullPay = @"INSERT INTO T_EmpDeductionDtlFullPayHst 
                                                    (Tdd_IDNo
                                                    , Tdd_DeductionCode
                                                    , Tdd_StartDate
                                                    , Tdd_ThisPayCycle
                                                    , Tdd_PayCycle
                                                    , Tdd_LineNo
                                                    , Tdd_PaymentType
                                                    , Tdd_Amount
                                                    , Tdd_DeferredFlag
                                                    , Tdd_PaymentFlag
                                                    , Tdd_Remarks
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tdd_IDNo
	                                                    , A.Tdd_DeductionCode
	                                                    , A.Tdd_StartDate
	                                                    , A.Tdd_ThisPayCycle
	                                                    , A.Tdd_PayCycle
	                                                    , A.Tdd_LineNo
	                                                    , A.Tdd_PaymentType
	                                                    , A.Tdd_Amount
	                                                    , A.Tdd_DeferredFlag
	                                                    , A.Tdd_PaymentFlag
	                                                    , A.Tdd_Remarks
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpDeductionDtlHst A
                                                    INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = A.Tdd_IDNo
	                                                    AND Tdh_DeductionCode = A.Tdd_DeductionCode
	                                                    AND Tdh_StartDate = A.Tdd_StartDate
	                                                    AND Tdh_PaymentDate IS NOT NULL
	                                                    AND Tdh_DeductionAmount = Tdh_PaidAmount
                                                    LEFT JOIN T_EmpDeductionDtlFullPayHst B ON A.Tdd_IDNo = B.Tdd_IDNo
	                                                    AND A.Tdd_DeductionCode = B.Tdd_DeductionCode
	                                                    AND A.Tdd_StartDate = B.Tdd_StartDate
	                                                    AND A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle
	                                                    AND A.Tdd_PayCycle = B.Tdd_PayCycle
	                                                    AND A.Tdd_LineNo = B.Tdd_LineNo
                                                    WHERE B.Ludatetime IS NULL";

            public const string insertDeductionDefer = @"INSERT INTO T_EmpDeductionDefer 
                                                    (Tdd_IDNo
                                                    , Tdd_DeductionCode
                                                    , Tdd_StartDate
                                                    , Tdd_PayCycle
                                                    , Tdd_LineNo
                                                    , Tdd_DeferredAmt
                                                    , Tdd_Remarks
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tdd_IDNo  
                                                        , A.Tdd_DeductionCode 
                                                        , A.Tdd_StartDate  
                                                        , A.Tdd_ThisPayCycle 
                                                        , A.Tdd_LineNo 
                                                        , A.Tdd_Amount
                                                        , A.Tdd_Remarks
                                                        , A.Usr_Login       
                                                        , A.Ludatetime
                                                    FROM T_EmpDeductionDtl A
                                                    LEFT JOIN T_EmpDeductionDefer B ON A.Tdd_IDNo = B.Tdd_IDNo
	                                                    AND A.Tdd_DeductionCode = B.Tdd_DeductionCode
	                                                    AND A.Tdd_StartDate = B.Tdd_StartDate
	                                                    AND A.Tdd_PayCycle = B.Tdd_PayCycle
	                                                    AND A.Tdd_LineNo = B.Tdd_LineNo
                                                    INNER JOIN {0}..M_Deduction on Mdn_DeductionCode =  A.Tdd_DeductionCode 
	                                                    AND Mdn_IsAllowDeferred = 1
	                                                    AND Mdn_CompanyCode = @CompanyCode
                                                    WHERE A.Tdd_ThisPayCycle = @CurPayPeriod
                                                        AND A.Tdd_PaymentFlag = 0
                                                        AND A.Tdd_DeferredFlag = 0
	                                                    AND B.Ludatetime IS NULL";

            public const string updateDeductionHdrDeferred = @"UPDATE {0}..T_EmpDeductionHdr
                                                    SET Tdh_DeferredAmount = Tdh_DeferredAmount + DeferredAmt
	                                                    , Usr_Login = @UserLogin
	                                                    , Ludatetime = GetDate()
                                                    FROM {0}..T_EmpDeductionHdr
                                                    INNER JOIN ( SELECT Tdd_IDNo  
				                                                    , Tdd_DeductionCode 
				                                                    , Tdd_StartDate  
				                                                    , DeferredAmt = Sum(Tdd_Amount) 
			                                                    FROM T_EmpDeductionDtl  
                                                                INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
                                                                    AND Mdn_IsAllowDeferred = 1                          
				                                                    AND Mdn_CompanyCode = @CompanyCode
			                                                    WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                                                    AND Tdd_PaymentFlag = 0
				                                                    AND Tdd_DeferredFlag = 0
			                                                    GROUP BY Tdd_IDNo  
			                                                    , Tdd_DeductionCode 
			                                                    , Tdd_StartDate  ) DeferredDed on DeferredDed.Tdd_IDNo = T_EmpDeductionHdr.Tdh_IDNo
						                                                    AND DeferredDed.Tdd_DeductionCode = T_EmpDeductionHdr.Tdh_DeductionCode
						                                                    AND DeferredDed.Tdd_StartDate = T_EmpDeductionHdr.Tdh_StartDate";


            public const string insertTimeRegister = @"INSERT INTO  T_EmpTimeRegisterHst 
                                                (Ttr_IDNo
                                                    ,Ttr_Date
                                                    ,Ttr_PayCycle
                                                    ,Ttr_DayCode
                                                    ,Ttr_ShiftCode
                                                    ,Ttr_HolidayFlag
                                                    ,Ttr_RestDayFlag
                                                    ,Ttr_ActIn_1
                                                    ,Ttr_ActOut_1
                                                    ,Ttr_ActIn_2
                                                    ,Ttr_ActOut_2
                                                    ,Ttr_WFPayLVCode
                                                    ,Ttr_WFPayLVHr
                                                    ,Ttr_PayLVMin
                                                    ,Ttr_ExcLVMin
                                                    ,Ttr_WFNoPayLVCode
                                                    ,Ttr_WFNoPayLVHr
                                                    ,Ttr_NoPayLVMin
                                                    ,Ttr_WFOTAdvHr
                                                    ,Ttr_WFOTPostHr
                                                    ,Ttr_OTMin
                                                    ,Ttr_CompOTMin
                                                    ,Ttr_OffsetOTMin
                                                    ,Ttr_WFTimeMod
                                                    ,Ttr_WFFlexTime
                                                    ,Ttr_Amnesty
                                                    ,Ttr_SkipService
                                                    ,Ttr_SkipServiceBy
                                                    ,Ttr_SkipServiceDate
                                                    ,Ttr_AssumedFlag
                                                    ,Ttr_AssumedBy
                                                    ,Ttr_AssumedDate
                                                    ,Ttr_AssumedPost
                                                    ,Ttr_ConvIn_1Min
                                                    ,Ttr_ConvOut_1Min
                                                    ,Ttr_ConvIn_2Min
                                                    ,Ttr_ConvOut_2Min
                                                    ,Ttr_CompIn_1Min
                                                    ,Ttr_CompOut_1Min
                                                    ,Ttr_CompIn_2Min
                                                    ,Ttr_CompOut_2Min
                                                    ,Ttr_CompAdvOTMin
                                                    ,Ttr_ShiftIn_1Min
                                                    ,Ttr_ShiftOut_1Min
                                                    ,Ttr_ShiftIn_2Min
                                                    ,Ttr_ShiftOut_2Min
                                                    ,Ttr_ShiftMin
                                                    ,Ttr_ScheduleType
                                                    ,Ttr_ActLT1Min
                                                    ,Ttr_ActLT2Min
                                                    ,Ttr_CompLT1Min
                                                    ,Ttr_CompLT2Min
                                                    ,Ttr_ActUT1Min
                                                    ,Ttr_ActUT2Min
                                                    ,Ttr_CompUT1Min
                                                    ,Ttr_CompUT2Min
                                                    ,Ttr_InitialABSMin
                                                    ,Ttr_CompABSMin
                                                    ,Ttr_CompREGMin
                                                    ,Ttr_CompWorkMin
                                                    ,Ttr_CompNDMin
                                                    ,Ttr_CompNDOTMin
                                                    ,Ttr_PrvDayWorkMin
                                                    ,Ttr_PrvDayHolRef
                                                    ,Ttr_PDHOLHour
                                                    ,Ttr_PDRESTLEGHOLDay
                                                    ,Ttr_WorkDay
                                                    ,Ttr_EXPHour
                                                    ,Ttr_ABSHour
                                                    ,Ttr_REGHour
                                                    ,Ttr_OTHour
                                                    ,Ttr_NDHour
                                                    ,Ttr_NDOTHour
                                                    ,Ttr_LVHour
                                                    ,Ttr_PaidBreakHour
                                                    ,Ttr_OBHour
                                                    ,Ttr_RegPlusHour
                                                    ,Ttr_TBAmt01
                                                    ,Ttr_TBAmt02
                                                    ,Ttr_TBAmt03
                                                    ,Ttr_TBAmt04
                                                    ,Ttr_TBAmt05
                                                    ,Ttr_TBAmt06
                                                    ,Ttr_TBAmt07
                                                    ,Ttr_TBAmt08
                                                    ,Ttr_TBAmt09
                                                    ,Ttr_TBAmt10
                                                    ,Ttr_TBAmt11
                                                    ,Ttr_TBAmt12
                                                    ,Ttr_WorkLocationCode
                                                    ,Ttr_CalendarGroup
                                                    ,Ttr_PremiumGrpCode
                                                    ,Ttr_PayrollGroup
                                                    ,Ttr_CostcenterCode
                                                    ,Ttr_EmploymentStatusCode
                                                    ,Ttr_PayrollType
                                                    ,Ttr_Grade
                                                    , Usr_Login
                                                    , Ludatetime)

                                                SELECT A.Ttr_IDNo
	                                                ,A.Ttr_Date
                                                    ,A.Ttr_PayCycle
                                                    ,A.Ttr_DayCode
                                                    ,A.Ttr_ShiftCode
                                                    ,A.Ttr_HolidayFlag
                                                    ,A.Ttr_RestDayFlag
                                                    ,A.Ttr_ActIn_1
                                                    ,A.Ttr_ActOut_1
                                                    ,A.Ttr_ActIn_2
                                                    ,A.Ttr_ActOut_2
                                                    ,A.Ttr_WFPayLVCode
                                                    ,A.Ttr_WFPayLVHr
                                                    ,A.Ttr_PayLVMin
                                                    ,A.Ttr_ExcLVMin
                                                    ,A.Ttr_WFNoPayLVCode
                                                    ,A.Ttr_WFNoPayLVHr
                                                    ,A.Ttr_NoPayLVMin
                                                    ,A.Ttr_WFOTAdvHr
                                                    ,A.Ttr_WFOTPostHr
                                                    ,A.Ttr_OTMin
                                                    ,A.Ttr_CompOTMin
                                                    ,A.Ttr_OffsetOTMin
                                                    ,A.Ttr_WFTimeMod
                                                    ,A.Ttr_WFFlexTime
                                                    ,A.Ttr_Amnesty
                                                    ,A.Ttr_SkipService
                                                    ,A.Ttr_SkipServiceBy
                                                    ,A.Ttr_SkipServiceDate
                                                    ,A.Ttr_AssumedFlag
                                                    ,A.Ttr_AssumedBy
                                                    ,A.Ttr_AssumedDate
                                                    ,A.Ttr_AssumedPost
                                                    ,A.Ttr_ConvIn_1Min
                                                    ,A.Ttr_ConvOut_1Min
                                                    ,A.Ttr_ConvIn_2Min
                                                    ,A.Ttr_ConvOut_2Min
                                                    ,A.Ttr_CompIn_1Min
                                                    ,A.Ttr_CompOut_1Min
                                                    ,A.Ttr_CompIn_2Min
                                                    ,A.Ttr_CompOut_2Min
                                                    ,A.Ttr_CompAdvOTMin
                                                    ,A.Ttr_ShiftIn_1Min
                                                    ,A.Ttr_ShiftOut_1Min
                                                    ,A.Ttr_ShiftIn_2Min
                                                    ,A.Ttr_ShiftOut_2Min
                                                    ,A.Ttr_ShiftMin
                                                    ,A.Ttr_ScheduleType
                                                    ,A.Ttr_ActLT1Min
                                                    ,A.Ttr_ActLT2Min
                                                    ,A.Ttr_CompLT1Min
                                                    ,A.Ttr_CompLT2Min
                                                    ,A.Ttr_ActUT1Min
                                                    ,A.Ttr_ActUT2Min
                                                    ,A.Ttr_CompUT1Min
                                                    ,A.Ttr_CompUT2Min
                                                    ,A.Ttr_InitialABSMin
                                                    ,A.Ttr_CompABSMin
                                                    ,A.Ttr_CompREGMin
                                                    ,A.Ttr_CompWorkMin
                                                    ,A.Ttr_CompNDMin
                                                    ,A.Ttr_CompNDOTMin
                                                    ,A.Ttr_PrvDayWorkMin
                                                    ,A.Ttr_PrvDayHolRef
                                                    ,A.Ttr_PDHOLHour
                                                    ,A.Ttr_PDRESTLEGHOLDay
                                                    ,A.Ttr_WorkDay
                                                    ,A.Ttr_EXPHour
                                                    ,A.Ttr_ABSHour
                                                    ,A.Ttr_REGHour
                                                    ,A.Ttr_OTHour
                                                    ,A.Ttr_NDHour
                                                    ,A.Ttr_NDOTHour
                                                    ,A.Ttr_LVHour
                                                    ,A.Ttr_PaidBreakHour
                                                    ,A.Ttr_OBHour
                                                    ,A.Ttr_RegPlusHour
                                                    ,A.Ttr_TBAmt01
                                                    ,A.Ttr_TBAmt02
                                                    ,A.Ttr_TBAmt03
                                                    ,A.Ttr_TBAmt04
                                                    ,A.Ttr_TBAmt05
                                                    ,A.Ttr_TBAmt06
                                                    ,A.Ttr_TBAmt07
                                                    ,A.Ttr_TBAmt08
                                                    ,A.Ttr_TBAmt09
                                                    ,A.Ttr_TBAmt10
                                                    ,A.Ttr_TBAmt11
                                                    ,A.Ttr_TBAmt12
                                                    ,A.Ttr_WorkLocationCode
                                                    ,A.Ttr_CalendarGroup
                                                    ,A.Ttr_PremiumGrpCode
                                                    ,A.Ttr_PayrollGroup
                                                    ,A.Ttr_CostcenterCode
                                                    ,A.Ttr_EmploymentStatusCode
                                                    ,A.Ttr_PayrollType
                                                    ,A.Ttr_Grade
	                                                ,A.Usr_Login
	                                                ,A.Ludatetime
                                                FROM T_EmpTimeRegister A
                                                LEFT JOIN T_EmpTimeRegisterHst B ON A.Ttr_IDNo = B.Ttr_IDNo
	                                                AND A.Ttr_Date = B.Ttr_Date
                                                WHERE A.Ttr_PayCycle = @CurPayPeriod
	                                                AND B.Ttr_PayCycle IS NULL";


            public const string insertTimeRegisterMisc = @"INSERT INTO T_EmpTimeRegisterMiscHst
                                                            (Ttm_IDNo
                                                            ,Ttm_Date
                                                            ,Ttm_PayCycle
                                                            ,Ttm_ActIn_01
                                                            ,Ttm_ActOut_01
                                                            ,Ttm_ActIn_02
                                                            ,Ttm_ActOut_02
                                                            ,Ttm_ActIn_03
                                                            ,Ttm_ActOut_03
                                                            ,Ttm_ActIn_04
                                                            ,Ttm_ActOut_04
                                                            ,Ttm_ActIn_05
                                                            ,Ttm_ActOut_05
                                                            ,Ttm_ActIn_06
                                                            ,Ttm_ActOut_06
                                                            ,Ttm_ActIn_07
                                                            ,Ttm_ActOut_07
                                                            ,Ttm_ActIn_08
                                                            ,Ttm_ActOut_08
                                                            ,Ttm_ActIn_09
                                                            ,Ttm_ActOut_09
                                                            ,Ttm_ActIn_10
                                                            ,Ttm_ActOut_10
                                                            ,Ttm_ActIn_11
                                                            ,Ttm_ActOut_11
                                                            ,Ttm_ActIn_12
                                                            ,Ttm_ActOut_12
                                                            ,Ttm_Result
                                                            ,Ttm_ActIn1
                                                            ,Ttm_ActIn2
                                                            ,Ttm_ActOut1
                                                            ,Ttm_ActOut2
                                                            ,Usr_Login
                                                            ,Ludatetime)
                                                        SELECT A.Ttm_IDNo
                                                            ,A.Ttm_Date
                                                            ,A.Ttm_PayCycle
                                                            ,A.Ttm_ActIn_01
                                                            ,A.Ttm_ActOut_01
                                                            ,A.Ttm_ActIn_02
                                                            ,A.Ttm_ActOut_02
                                                            ,A.Ttm_ActIn_03
                                                            ,A.Ttm_ActOut_03
                                                            ,A.Ttm_ActIn_04
                                                            ,A.Ttm_ActOut_04
                                                            ,A.Ttm_ActIn_05
                                                            ,A.Ttm_ActOut_05
                                                            ,A.Ttm_ActIn_06
                                                            ,A.Ttm_ActOut_06
                                                            ,A.Ttm_ActIn_07
                                                            ,A.Ttm_ActOut_07
                                                            ,A.Ttm_ActIn_08
                                                            ,A.Ttm_ActOut_08
                                                            ,A.Ttm_ActIn_09
                                                            ,A.Ttm_ActOut_09
                                                            ,A.Ttm_ActIn_10
                                                            ,A.Ttm_ActOut_10
                                                            ,A.Ttm_ActIn_11
                                                            ,A.Ttm_ActOut_11
                                                            ,A.Ttm_ActIn_12
                                                            ,A.Ttm_ActOut_12
                                                            ,A.Ttm_Result
                                                            ,A.Ttm_ActIn1
                                                            ,A.Ttm_ActIn2
                                                            ,A.Ttm_ActOut1
                                                            ,A.Ttm_ActOut2
                                                            ,A.Usr_Login
                                                            ,A.Ludatetime
                                                        FROM T_EmpTimeRegisterMisc A
                                                        LEFT JOIN T_EmpTimeRegisterMiscHst B 
                                                            ON A.Ttm_IDNo = B.Ttm_IDNo
	                                                        AND A.Ttm_Date = B.Ttm_Date
                                                        WHERE A.Ttm_PayCycle = @CurPayPeriod
	                                                        AND B.Ttm_PayCycle IS NULL";


            public const string insertPayTranHdr = @"INSERT INTO  T_EmpPayTranHdrHst 
                                                    (Tph_IDNo
                                                    ,Tph_PayCycle
                                                    ,Tph_LTHr
                                                    ,Tph_UTHr
                                                    ,Tph_UPLVHr
                                                    ,Tph_ABSLEGHOLHr
                                                    ,Tph_ABSSPLHOLHr
                                                    ,Tph_ABSCOMPHOLHr
                                                    ,Tph_ABSPSDHr
                                                    ,Tph_ABSOTHHOLHr
                                                    ,Tph_WDABSHr
                                                    ,Tph_LTUTMaxHr
                                                    ,Tph_ABSHr
                                                    ,Tph_REGHr
                                                    ,Tph_PDLVHr
                                                    ,Tph_PDLEGHOLHr
                                                    ,Tph_PDSPLHOLHr
                                                    ,Tph_PDCOMPHOLHr
                                                    ,Tph_PDPSDHr
                                                    ,Tph_PDOTHHOLHr
                                                    ,Tph_PDRESTLEGHOLHr
                                                    ,Tph_REGOTHr
                                                    ,Tph_REGNDHr
                                                    ,Tph_REGNDOTHr
                                                    ,Tph_RESTHr
                                                    ,Tph_RESTOTHr
                                                    ,Tph_RESTNDHr
                                                    ,Tph_RESTNDOTHr
                                                    ,Tph_LEGHOLHr
                                                    ,Tph_LEGHOLOTHr
                                                    ,Tph_LEGHOLNDHr
                                                    ,Tph_LEGHOLNDOTHr
                                                    ,Tph_SPLHOLHr
                                                    ,Tph_SPLHOLOTHr
                                                    ,Tph_SPLHOLNDHr
                                                    ,Tph_SPLHOLNDOTHr
                                                    ,Tph_PSDHr
                                                    ,Tph_PSDOTHr
                                                    ,Tph_PSDNDHr
                                                    ,Tph_PSDNDOTHr
                                                    ,Tph_COMPHOLHr
                                                    ,Tph_COMPHOLOTHr
                                                    ,Tph_COMPHOLNDHr
                                                    ,Tph_COMPHOLNDOTHr
                                                    ,Tph_RESTLEGHOLHr
                                                    ,Tph_RESTLEGHOLOTHr
                                                    ,Tph_RESTLEGHOLNDHr
                                                    ,Tph_RESTLEGHOLNDOTHr
                                                    ,Tph_RESTSPLHOLHr
                                                    ,Tph_RESTSPLHOLOTHr
                                                    ,Tph_RESTSPLHOLNDHr
                                                    ,Tph_RESTSPLHOLNDOTHr
                                                    ,Tph_RESTCOMPHOLHr
                                                    ,Tph_RESTCOMPHOLOTHr
                                                    ,Tph_RESTCOMPHOLNDHr
                                                    ,Tph_RESTCOMPHOLNDOTHr
                                                    ,Tph_RESTPSDHr
                                                    ,Tph_RESTPSDOTHr
                                                    ,Tph_RESTPSDNDHr
                                                    ,Tph_RESTPSDNDOTHr
                                                    ,Tph_SRGAdjHr
                                                    ,Tph_SRGAdjAmt
                                                    ,Tph_SOTAdjHr
                                                    ,Tph_SOTAdjAmt
                                                    ,Tph_SHOLAdjHr
                                                    ,Tph_SHOLAdjAmt
                                                    ,Tph_SNDAdjHr
                                                    ,Tph_SNDAdjAmt
                                                    ,Tph_SLVAdjHr
                                                    ,Tph_SLVAdjAmt
                                                    ,Tph_MRGAdjHr
                                                    ,Tph_MRGAdjAmt
                                                    ,Tph_MOTAdjHr
                                                    ,Tph_MOTAdjAmt
                                                    ,Tph_MHOLAdjHr
                                                    ,Tph_MHOLAdjAmt
                                                    ,Tph_MNDAdjHr
                                                    ,Tph_MNDAdjAmt
                                                    ,Tph_TotalAdjAmt
                                                    ,Tph_TaxableIncomeAmt
                                                    ,Tph_NontaxableIncomeAmt
                                                    ,Tph_WorkDay
                                                    ,Tph_PayrollType
                                                    ,Tph_PremiumGrpCode
                                                    ,Tph_RetainUserEntry
                                                    ,Usr_Login
                                                    ,Ludatetime)

                                                    SELECT A.Tph_IDNo
	                                                    ,A.Tph_PayCycle
                                                        ,A.Tph_LTHr
                                                        ,A.Tph_UTHr
                                                        ,A.Tph_UPLVHr
                                                        ,A.Tph_ABSLEGHOLHr
                                                        ,A.Tph_ABSSPLHOLHr
                                                        ,A.Tph_ABSCOMPHOLHr
                                                        ,A.Tph_ABSPSDHr
                                                        ,A.Tph_ABSOTHHOLHr
                                                        ,A.Tph_WDABSHr
                                                        ,A.Tph_LTUTMaxHr
                                                        ,A.Tph_ABSHr
                                                        ,A.Tph_REGHr
                                                        ,A.Tph_PDLVHr
                                                        ,A.Tph_PDLEGHOLHr
                                                        ,A.Tph_PDSPLHOLHr
                                                        ,A.Tph_PDCOMPHOLHr
                                                        ,A.Tph_PDPSDHr
                                                        ,A.Tph_PDOTHHOLHr
                                                        ,A.Tph_PDRESTLEGHOLHr
                                                        ,A.Tph_REGOTHr
                                                        ,A.Tph_REGNDHr
                                                        ,A.Tph_REGNDOTHr
                                                        ,A.Tph_RESTHr
                                                        ,A.Tph_RESTOTHr
                                                        ,A.Tph_RESTNDHr
                                                        ,A.Tph_RESTNDOTHr
                                                        ,A.Tph_LEGHOLHr
                                                        ,A.Tph_LEGHOLOTHr
                                                        ,A.Tph_LEGHOLNDHr
                                                        ,A.Tph_LEGHOLNDOTHr
                                                        ,A.Tph_SPLHOLHr
                                                        ,A.Tph_SPLHOLOTHr
                                                        ,A.Tph_SPLHOLNDHr
                                                        ,A.Tph_SPLHOLNDOTHr
                                                        ,A.Tph_PSDHr
                                                        ,A.Tph_PSDOTHr
                                                        ,A.Tph_PSDNDHr
                                                        ,A.Tph_PSDNDOTHr
                                                        ,A.Tph_COMPHOLHr
                                                        ,A.Tph_COMPHOLOTHr
                                                        ,A.Tph_COMPHOLNDHr
                                                        ,A.Tph_COMPHOLNDOTHr
                                                        ,A.Tph_RESTLEGHOLHr
                                                        ,A.Tph_RESTLEGHOLOTHr
                                                        ,A.Tph_RESTLEGHOLNDHr
                                                        ,A.Tph_RESTLEGHOLNDOTHr
                                                        ,A.Tph_RESTSPLHOLHr
                                                        ,A.Tph_RESTSPLHOLOTHr
                                                        ,A.Tph_RESTSPLHOLNDHr
                                                        ,A.Tph_RESTSPLHOLNDOTHr
                                                        ,A.Tph_RESTCOMPHOLHr
                                                        ,A.Tph_RESTCOMPHOLOTHr
                                                        ,A.Tph_RESTCOMPHOLNDHr
                                                        ,A.Tph_RESTCOMPHOLNDOTHr
                                                        ,A.Tph_RESTPSDHr
                                                        ,A.Tph_RESTPSDOTHr
                                                        ,A.Tph_RESTPSDNDHr
                                                        ,A.Tph_RESTPSDNDOTHr
                                                        ,A.Tph_SRGAdjHr
                                                        ,A.Tph_SRGAdjAmt
                                                        ,A.Tph_SOTAdjHr
                                                        ,A.Tph_SOTAdjAmt
                                                        ,A.Tph_SHOLAdjHr
                                                        ,A.Tph_SHOLAdjAmt
                                                        ,A.Tph_SNDAdjHr
                                                        ,A.Tph_SNDAdjAmt
                                                        ,A.Tph_SLVAdjHr
                                                        ,A.Tph_SLVAdjAmt
                                                        ,A.Tph_MRGAdjHr
                                                        ,A.Tph_MRGAdjAmt
                                                        ,A.Tph_MOTAdjHr
                                                        ,A.Tph_MOTAdjAmt
                                                        ,A.Tph_MHOLAdjHr
                                                        ,A.Tph_MHOLAdjAmt
                                                        ,A.Tph_MNDAdjHr
                                                        ,A.Tph_MNDAdjAmt
                                                        ,A.Tph_TotalAdjAmt
                                                        ,A.Tph_TaxableIncomeAmt
                                                        ,A.Tph_NontaxableIncomeAmt
                                                        ,A.Tph_WorkDay
                                                        ,A.Tph_PayrollType
                                                        ,A.Tph_PremiumGrpCode
                                                        ,A.Tph_RetainUserEntry
	                                                    ,A.Usr_Login
	                                                    ,A.Ludatetime
                                                    FROM T_EmpPayTranHdr A
                                                    LEFT JOIN T_EmpPayTranHdrHst B ON A.Tph_IDNo = B.Tph_IDNo
	                                                    AND A.Tph_PayCycle = B.Tph_PayCycle
                                                    WHERE A.Tph_PayCycle = @CurPayPeriod
	                                                    AND B.Tph_PayCycle IS NULL

                                                    INSERT INTO  T_EmpPayTranHdrMiscHst 
                                                    (Tph_IDNo
                                                    , Tph_PayCycle
                                                    , Tph_Misc1Hr
                                                    , Tph_Misc1OTHr
                                                    , Tph_Misc1NDHr
                                                    , Tph_Misc1NDOTHr
                                                    , Tph_Misc2Hr
                                                    , Tph_Misc2OTHr
                                                    , Tph_Misc2NDHr
                                                    , Tph_Misc2NDOTHr
                                                    , Tph_Misc3Hr
                                                    , Tph_Misc3OTHr
                                                    , Tph_Misc3NDHr
                                                    , Tph_Misc3NDOTHr
                                                    , Tph_Misc4Hr
                                                    , Tph_Misc4OTHr
                                                    , Tph_Misc4NDHr
                                                    , Tph_Misc4NDOTHr
                                                    , Tph_Misc5Hr
                                                    , Tph_Misc5OTHr
                                                    , Tph_Misc5NDHr
                                                    , Tph_Misc5NDOTHr
                                                    , Tph_Misc6Hr
                                                    , Tph_Misc6OTHr
                                                    , Tph_Misc6NDHr
                                                    , Tph_Misc6NDOTHr
                                                    , Usr_Login
                                                    , Ludatetime)

                                                    SELECT  A.Tph_IDNo
	                                                    , A.Tph_PayCycle
	                                                    , A.Tph_Misc1Hr
	                                                    , A.Tph_Misc1OTHr
	                                                    , A.Tph_Misc1NDHr
	                                                    , A.Tph_Misc1NDOTHr
	                                                    , A.Tph_Misc2Hr
	                                                    , A.Tph_Misc2OTHr
	                                                    , A.Tph_Misc2NDHr
	                                                    , A.Tph_Misc2NDOTHr
	                                                    , A.Tph_Misc3Hr
	                                                    , A.Tph_Misc3OTHr
	                                                    , A.Tph_Misc3NDHr
	                                                    , A.Tph_Misc3NDOTHr
	                                                    , A.Tph_Misc4Hr
	                                                    , A.Tph_Misc4OTHr
	                                                    , A.Tph_Misc4NDHr
	                                                    , A.Tph_Misc4NDOTHr
	                                                    , A.Tph_Misc5Hr
	                                                    , A.Tph_Misc5OTHr
	                                                    , A.Tph_Misc5NDHr
	                                                    , A.Tph_Misc5NDOTHr
	                                                    , A.Tph_Misc6Hr
	                                                    , A.Tph_Misc6OTHr
	                                                    , A.Tph_Misc6NDHr
	                                                    , A.Tph_Misc6NDOTHr
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpPayTranHdrMisc A
                                                    LEFT JOIN T_EmpPayTranHdrMiscHst B ON A.Tph_IDNo = B.Tph_IDNo
	                                                    AND A.Tph_PayCycle = B.Tph_PayCycle
                                                    WHERE A.Tph_PayCycle = @CurPayPeriod
	                                                    AND B.Tph_PayCycle IS NULL";

            public const string insertPayTranDtl = @"INSERT INTO  T_EmpPayTranDtlHst 
                                                    (Tpd_IDNo
                                                    ,Tpd_PayCycle
                                                    ,Tpd_Date
                                                    ,Tpd_LTHr
                                                    ,Tpd_UTHr
                                                    ,Tpd_UPLVHr
                                                    ,Tpd_ABSLEGHOLHr
                                                    ,Tpd_ABSSPLHOLHr
                                                    ,Tpd_ABSCOMPHOLHr
                                                    ,Tpd_ABSPSDHr
                                                    ,Tpd_ABSOTHHOLHr
                                                    ,Tpd_WDABSHr
                                                    ,Tpd_LTUTMaxHr
                                                    ,Tpd_ABSHr
                                                    ,Tpd_REGHr
                                                    ,Tpd_PDLVHr
                                                    ,Tpd_PDLEGHOLHr
                                                    ,Tpd_PDSPLHOLHr
                                                    ,Tpd_PDCOMPHOLHr
                                                    ,Tpd_PDPSDHr
                                                    ,Tpd_PDOTHHOLHr
                                                    ,Tpd_PDRESTLEGHOLHr
                                                    ,Tpd_REGOTHr
                                                    ,Tpd_REGNDHr
                                                    ,Tpd_REGNDOTHr
                                                    ,Tpd_RESTHr
                                                    ,Tpd_RESTOTHr
                                                    ,Tpd_RESTNDHr
                                                    ,Tpd_RESTNDOTHr
                                                    ,Tpd_LEGHOLHr
                                                    ,Tpd_LEGHOLOTHr
                                                    ,Tpd_LEGHOLNDHr
                                                    ,Tpd_LEGHOLNDOTHr
                                                    ,Tpd_SPLHOLHr
                                                    ,Tpd_SPLHOLOTHr
                                                    ,Tpd_SPLHOLNDHr
                                                    ,Tpd_SPLHOLNDOTHr
                                                    ,Tpd_PSDHr
                                                    ,Tpd_PSDOTHr
                                                    ,Tpd_PSDNDHr
                                                    ,Tpd_PSDNDOTHr
                                                    ,Tpd_COMPHOLHr
                                                    ,Tpd_COMPHOLOTHr
                                                    ,Tpd_COMPHOLNDHr
                                                    ,Tpd_COMPHOLNDOTHr
                                                    ,Tpd_RESTLEGHOLHr
                                                    ,Tpd_RESTLEGHOLOTHr
                                                    ,Tpd_RESTLEGHOLNDHr
                                                    ,Tpd_RESTLEGHOLNDOTHr
                                                    ,Tpd_RESTSPLHOLHr
                                                    ,Tpd_RESTSPLHOLOTHr
                                                    ,Tpd_RESTSPLHOLNDHr
                                                    ,Tpd_RESTSPLHOLNDOTHr
                                                    ,Tpd_RESTCOMPHOLHr
                                                    ,Tpd_RESTCOMPHOLOTHr
                                                    ,Tpd_RESTCOMPHOLNDHr
                                                    ,Tpd_RESTCOMPHOLNDOTHr
                                                    ,Tpd_RESTPSDHr
                                                    ,Tpd_RESTPSDOTHr
                                                    ,Tpd_RESTPSDNDHr
                                                    ,Tpd_RESTPSDNDOTHr
                                                    ,Tpd_WorkDay
                                                    ,Tpd_PayrollType
                                                    ,Tpd_PremiumGrpCode
                                                    ,Usr_Login
                                                    ,Ludatetime)     
                                               
                                                    SELECT A.Tpd_IDNo
	                                                    ,A.Tpd_PayCycle
                                                        ,A.Tpd_Date
                                                        ,A.Tpd_LTHr
                                                        ,A.Tpd_UTHr
                                                        ,A.Tpd_UPLVHr
                                                        ,A.Tpd_ABSLEGHOLHr
                                                        ,A.Tpd_ABSSPLHOLHr
                                                        ,A.Tpd_ABSCOMPHOLHr
                                                        ,A.Tpd_ABSPSDHr
                                                        ,A.Tpd_ABSOTHHOLHr
                                                        ,A.Tpd_WDABSHr
                                                        ,A.Tpd_LTUTMaxHr
                                                        ,A.Tpd_ABSHr
                                                        ,A.Tpd_REGHr
                                                        ,A.Tpd_PDLVHr
                                                        ,A.Tpd_PDLEGHOLHr
                                                        ,A.Tpd_PDSPLHOLHr
                                                        ,A.Tpd_PDCOMPHOLHr
                                                        ,A.Tpd_PDPSDHr
                                                        ,A.Tpd_PDOTHHOLHr
                                                        ,A.Tpd_PDRESTLEGHOLHr
                                                        ,A.Tpd_REGOTHr
                                                        ,A.Tpd_REGNDHr
                                                        ,A.Tpd_REGNDOTHr
                                                        ,A.Tpd_RESTHr
                                                        ,A.Tpd_RESTOTHr
                                                        ,A.Tpd_RESTNDHr
                                                        ,A.Tpd_RESTNDOTHr
                                                        ,A.Tpd_LEGHOLHr
                                                        ,A.Tpd_LEGHOLOTHr
                                                        ,A.Tpd_LEGHOLNDHr
                                                        ,A.Tpd_LEGHOLNDOTHr
                                                        ,A.Tpd_SPLHOLHr
                                                        ,A.Tpd_SPLHOLOTHr
                                                        ,A.Tpd_SPLHOLNDHr
                                                        ,A.Tpd_SPLHOLNDOTHr
                                                        ,A.Tpd_PSDHr
                                                        ,A.Tpd_PSDOTHr
                                                        ,A.Tpd_PSDNDHr
                                                        ,A.Tpd_PSDNDOTHr
                                                        ,A.Tpd_COMPHOLHr
                                                        ,A.Tpd_COMPHOLOTHr
                                                        ,A.Tpd_COMPHOLNDHr
                                                        ,A.Tpd_COMPHOLNDOTHr
                                                        ,A.Tpd_RESTLEGHOLHr
                                                        ,A.Tpd_RESTLEGHOLOTHr
                                                        ,A.Tpd_RESTLEGHOLNDHr
                                                        ,A.Tpd_RESTLEGHOLNDOTHr
                                                        ,A.Tpd_RESTSPLHOLHr
                                                        ,A.Tpd_RESTSPLHOLOTHr
                                                        ,A.Tpd_RESTSPLHOLNDHr
                                                        ,A.Tpd_RESTSPLHOLNDOTHr
                                                        ,A.Tpd_RESTCOMPHOLHr
                                                        ,A.Tpd_RESTCOMPHOLOTHr
                                                        ,A.Tpd_RESTCOMPHOLNDHr
                                                        ,A.Tpd_RESTCOMPHOLNDOTHr
                                                        ,A.Tpd_RESTPSDHr
                                                        ,A.Tpd_RESTPSDOTHr
                                                        ,A.Tpd_RESTPSDNDHr
                                                        ,A.Tpd_RESTPSDNDOTHr
                                                        ,A.Tpd_WorkDay
                                                        ,A.Tpd_PayrollType
                                                        ,A.Tpd_PremiumGrpCode
	                                                    ,A.Usr_Login
	                                                    ,A.Ludatetime
                                                    FROM T_EmpPayTranDtl A
                                                    LEFT JOIN T_EmpPayTranDtlHst B ON A.Tpd_IDNo = B.Tpd_IDNo
	                                                    AND A.Tpd_PayCycle = B.Tpd_PayCycle
	                                                    AND A.Tpd_Date = B.Tpd_Date
                                                    WHERE A.Tpd_PayCycle = @CurPayPeriod
	                                                    AND B.Tpd_PayCycle IS NULL

                                                    INSERT INTO T_EmpPayTranDtlMiscHst 
                                                    (Tpd_IDNo
                                                    , Tpd_PayCycle
                                                    , Tpd_Date
                                                    , Tpd_Misc1Hr
                                                    , Tpd_Misc1OTHr
                                                    , Tpd_Misc1NDHr
                                                    , Tpd_Misc1NDOTHr
                                                    , Tpd_Misc2Hr
                                                    , Tpd_Misc2OTHr
                                                    , Tpd_Misc2NDHr
                                                    , Tpd_Misc2NDOTHr
                                                    , Tpd_Misc3Hr
                                                    , Tpd_Misc3OTHr
                                                    , Tpd_Misc3NDHr
                                                    , Tpd_Misc3NDOTHr
                                                    , Tpd_Misc4Hr
                                                    , Tpd_Misc4OTHr
                                                    , Tpd_Misc4NDHr
                                                    , Tpd_Misc4NDOTHr
                                                    , Tpd_Misc5Hr
                                                    , Tpd_Misc5OTHr
                                                    , Tpd_Misc5NDHr
                                                    , Tpd_Misc5NDOTHr
                                                    , Tpd_Misc6Hr
                                                    , Tpd_Misc6OTHr
                                                    , Tpd_Misc6NDHr
                                                    , Tpd_Misc6NDOTHr
                                                    , Usr_Login
                                                    , Ludatetime)

                                                    SELECT A.Tpd_IDNo
	                                                    , A.Tpd_PayCycle
	                                                    , A.Tpd_Date
	                                                    , A.Tpd_Misc1Hr
	                                                    , A.Tpd_Misc1OTHr
	                                                    , A.Tpd_Misc1NDHr
	                                                    , A.Tpd_Misc1NDOTHr
	                                                    , A.Tpd_Misc2Hr
	                                                    , A.Tpd_Misc2OTHr
	                                                    , A.Tpd_Misc2NDHr
	                                                    , A.Tpd_Misc2NDOTHr
	                                                    , A.Tpd_Misc3Hr
	                                                    , A.Tpd_Misc3OTHr
	                                                    , A.Tpd_Misc3NDHr
	                                                    , A.Tpd_Misc3NDOTHr
	                                                    , A.Tpd_Misc4Hr
	                                                    , A.Tpd_Misc4OTHr
	                                                    , A.Tpd_Misc4NDHr
	                                                    , A.Tpd_Misc4NDOTHr
	                                                    , A.Tpd_Misc5Hr
	                                                    , A.Tpd_Misc5OTHr
	                                                    , A.Tpd_Misc5NDHr
	                                                    , A.Tpd_Misc5NDOTHr
	                                                    , A.Tpd_Misc6Hr
	                                                    , A.Tpd_Misc6OTHr
	                                                    , A.Tpd_Misc6NDHr
	                                                    , A.Tpd_Misc6NDOTHr
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpPayTranDtlMisc A
                                                    LEFT JOIN T_EmpPayTranDtlMiscHst B ON A.Tpd_IDNo = B.Tpd_IDNo
	                                                    AND A.Tpd_PayCycle = B.Tpd_PayCycle
	                                                    AND A.Tpd_Date = B.Tpd_Date
                                                    WHERE A.Tpd_PayCycle = @CurPayPeriod
	                                                    AND B.Tpd_PayCycle IS NULL";
            public const string updatePosting12 = @"UPDATE T_OffSet
		                                            SET Off_Served = 1
		                                            , Usr_login = @UserLogin      
		                                            , Ludatetime = GetDate()
		                                            From T_OffSet
		                                            Inner Join T_EmpTimeRegister On Ttr_IDNo = Off_EmployeeId
		                                              And Ttr_Date = Off_DateWork
		                                            Where Off_Served = 0
		                                              And Off_Type = 'U'
		                                              And Ttr_CompWorkMin = Ttr_ForOffsetMin";
            public const string insertPosting13 = @"INSERT INTO T_Offset
		                                            SELECT 
		                                            Ttr_IDNo
		                                            , Ttr_Date
		                                            , 'E'
		                                            , '00'
		                                            , Ttr_EarnedSatOff/60.000
		                                            , 0
		                                            , 1
		                                            , Null
		                                            , @UserLogin
		                                            , Getdate()
		                                             FROM T_EmpTimeRegister
		                                            WHERE Ttr_PayCycle = @CurPayPeriod
			                                            and Ttr_DayCode = 'SOFF'
		                                               and Ttr_EarnedSatOff >  0";
            public const string insertPosting14 = @"INSERT INTO T_Offset
		                                            SELECT Ttr_IDNo
		                                            , Ttr_Date
		                                            , 'E'
		                                            , IsNull((REPLICATE ( '0', 2 - len(MaxSeq))+ Convert(char,MaxSeq)), 0) as MaxSeq
		                                            , Ttr_ExcOffset/60.000
		                                            , 0
		                                            , 1
		                                            , Null
		                                            , @UserLogin
		                                            , Getdate()
		                                            FROM T_EmpTimeRegister
		                                            LEFT JOIN ( SELECT Off_EmployeeId
				                                            , Off_DateWork
				                                            , Max(IsNull(Off_Seqno,0))+ 1 as MaxSeq 
				                                            FROM T_Offset 
			                                            GROUP BY Off_EmployeeId
				                                            , Off_DateWork ) Offset on Off_EmployeeId =Ttr_IDNo
					                                            and Off_DateWork = Ttr_Date
		                                            WHERE Ttr_PayCycle = @CurPayPeriod
		                                            and Ttr_ExcOffset > 0";
            public const string updatePosting15 = @"UPDATE M_Employee
                                                    SET Emt_Shiftcode = T_EmpTimeRegister.Ttr_ShiftCode
                                                    From M_Employee
                                                    Inner Join T_EmpTimeRegister on T_EmpTimeRegister.Ttr_IDNo = M_Employee.Mem_IDNo  
                                                    Inner Join ( Select Ttr_IDNo
                                                                , RegDate =Max(Ttr_Date)
                                                                    From T_EmpTimeRegister
                                                                    where Ttr_PayCycle =  @CURPAYPERIOD
                                                                        and Ttr_DayCode = 'REG'
                                                                Group by Ttr_IDNo) EmpShift on EmpShift.Ttr_IDNo = T_EmpTimeRegister.Ttr_IDNo
                                                                            and EmpShift.RegDate = T_EmpTimeRegister.Ttr_Date  ";
            public const string insertDeleteLaborCheck = @"INSERT INTO T_EmpLaborCheckHst 
                                                    (Tlc_IDNo
                                                    , Tlc_Type
                                                    , Tlc_PayCycle
                                                    , Tlc_Date
                                                    , Tlc_NumValue
                                                    , Tlc_Remarks
                                                    , Tlc_SystemDefined
                                                    , Usr_Login
                                                    , Ludatetime)
                                                    SELECT A.Tlc_IDNo
                                                        , A.Tlc_Type
	                                                    , A.Tlc_PayCycle
	                                                    , A.Tlc_Date
                                                        , A.Tlc_NumValue
	                                                    , A.Tlc_Remarks
                                                        , A.Tlc_SystemDefined
	                                                    , A.Usr_Login
	                                                    , A.Ludatetime
                                                    FROM T_EmpLaborCheck A
                                                    LEFT JOIN dbo.T_EmpLaborCheckHst B ON A.Tlc_IDNo = B.Tlc_IDNo
	                                                    AND A.Tlc_PayCycle = B.Tlc_PayCycle
                                                    WHERE A.Tlc_PayCycle = @CURPAYPERIOD
	                                                    AND B.Tlc_PayCycle IS NULL
                                                    
                                                    DELETE FROM T_EmpLaborCheck
                                                    WHERE Tlc_PayCycle = @CURPAYPERIOD";

            public const string insertDeleteEmailSending = @"INSERT INTO T_EmailSendingHst
                                                            (Ten_DocumentNo
                                                            , Ten_LineNo
                                                            , Ten_DocumentCode
                                                            , Ten_ActivityCode
                                                            , Ten_RecordStatus
                                                            , Ten_CreatedBy
                                                            , Ten_CreatedDate
                                                            , Ten_UpdatedBy
                                                            , Ten_UpdatedDate)

                                                SELECT Ten_DocumentNo
	                                                , Ten_LineNo
	                                                , Ten_DocumentCode
	                                                , Ten_ActivityCode
	                                                , Ten_RecordStatus
	                                                , Ten_CreatedBy
	                                                , Ten_CreatedDate
	                                                , Ten_UpdatedBy
	                                                , Ten_UpdatedDate 
                                                FROM T_EmailSending
                                                INNER JOIN (SELECT Tot_DocumentNo AS DocumentNo 
			                                                FROM T_EmpOvertime
			                                                INNER JOIN T_PaySchedule ON Tot_OvertimeDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tot_OvertimeStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tlv_DocumentNo AS DocumentNo 
			                                                FROM T_EmpLeave
			                                                INNER JOIN T_PaySchedule ON Tlv_LeaveDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tlv_LeaveStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Ttm_DocumentNo AS DocumentNo 
			                                                FROM T_EmpTimeCorrection
			                                                INNER JOIN T_PaySchedule ON Ttm_TimeCorDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Ttm_TimeCorStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tes_DocumentNo AS DocumentNo 
			                                                FROM T_EmpShift
			                                                INNER JOIN T_PaySchedule ON Tes_ShiftDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tes_ShiftStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tei_DocumentNo AS DocumentNo 
			                                                FROM T_EmpInfo
			                                                INNER JOIN T_PaySchedule ON Tei_RequestDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tei_EmpUpdateStatus IN ('03','05','07','09','11','13','14','15')) Trn ON Trn.DocumentNo = Ten_DocumentNo


                                                DELETE FROM T_EmailSending
                                                FROM T_EmailSending
                                                INNER JOIN (SELECT Tot_DocumentNo AS DocumentNo 
			                                                FROM T_EmpOvertime
			                                                INNER JOIN T_PaySchedule ON Tot_OvertimeDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tot_OvertimeStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tlv_DocumentNo AS DocumentNo 
			                                                FROM T_EmpLeave
			                                                INNER JOIN T_PaySchedule ON Tlv_LeaveDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tlv_LeaveStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Ttm_DocumentNo AS DocumentNo 
			                                                FROM T_EmpTimeCorrection
			                                                INNER JOIN T_PaySchedule ON Ttm_TimeCorDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Ttm_TimeCorStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tes_DocumentNo AS DocumentNo 
			                                                FROM T_EmpShift
			                                                INNER JOIN T_PaySchedule ON Tes_ShiftDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tes_ShiftStatus IN ('03','05','07','09','11','13','14','15')
			                                                UNION ALL
			                                                SELECT Tei_DocumentNo AS DocumentNo 
			                                                FROM T_EmpInfo
			                                                INNER JOIN T_PaySchedule ON Tei_RequestDate BETWEEN Tps_StartCycle AND Tps_EndCycle 
				                                                AND Tps_CycleIndicator = 'C' 
				                                                AND Tps_CycleType = 'N'
			                                                WHERE Tei_EmpUpdateStatus IN ('03','05','07','09','11','13','14','15')) Trn on Trn.DocumentNo = Ten_DocumentNo
                                                      ";

            public const string insertLeave = @"INSERT INTO T_EmpLeaveHst 
                                                    (Tlv_DocumentNo
                                                    , Tlv_PayCycle
                                                    , Tlv_RequestType
                                                    , Tlv_RequestDate
                                                    , Tlv_IDNo
                                                    , Tlv_LeaveDate
                                                    , Tlv_LeaveCode
                                                    , Tlv_StartTime
                                                    , Tlv_EndTime
                                                    , Tlv_LeaveHours
                                                    , Tlv_LeaveUnit
                                                    , Tlv_ReasonForRequest
                                                    , Tlv_InitiatedBy
                                                    , Tlv_LeaveReasonCode
                                                    , Tlv_LeaveClass
                                                    , Tlv_LeaveStatus
                                                    , Tlv_LeaveFlag
                                                    , Tlv_SubmittedBy
                                                    , Tlv_SubmittedDate
                                                    , Tlv_Authority1
                                                    , Tlv_Authority1Date
                                                    , Tlv_Authority2
                                                    , Tlv_Authority2Date
                                                    , Tlv_Authority3
                                                    , Tlv_Authority3Date
                                                    , Tlv_Authority4
                                                    , Tlv_Authority4Date
                                                    , Tlv_Authority5
                                                    , Tlv_Authority5Date
                                                    , Tlv_ShiftCode
                                                    , Tlv_CostcenterCode
                                                    , Tlv_EmploymentStatusCode
                                                    , Tlv_PayrollType
                                                    , Tlv_Grade
                                                    , Tlv_PayrollGroup
                                                    , Tlv_Authority1Comments
                                                    , Tlv_Authority2Comments
                                                    , Tlv_Authority3Comments
                                                    , Tlv_Authority4Comments
                                                    , Tlv_Authority5Comments
                                                    , Tlv_Delegation
                                                    , Tlv_DocumentBatchNo
                                                    , Tlv_OriginalDocumentNo
                                                    , Tlv_CreatedBy
                                                    , Tlv_CreatedDate
                                                    , Tlv_UPDATEdBy
                                                    , Tlv_UPDATEdDate)

                                                    SELECT A.Tlv_DocumentNo
	                                                    , A.Tlv_PayCycle
	                                                    , A.Tlv_RequestType
	                                                    , A.Tlv_RequestDate
	                                                    , A.Tlv_IDNo
	                                                    , A.Tlv_LeaveDate
	                                                    , A.Tlv_LeaveCode
	                                                    , A.Tlv_StartTime
	                                                    , A.Tlv_EndTime
	                                                    , A.Tlv_LeaveHours
	                                                    , A.Tlv_LeaveUnit
	                                                    , A.Tlv_ReasonForRequest
	                                                    , A.Tlv_InitiatedBy
	                                                    , A.Tlv_LeaveReasonCode
	                                                    , A.Tlv_LeaveClass
	                                                    , A.Tlv_LeaveStatus
	                                                    , A.Tlv_LeaveFlag
	                                                    , A.Tlv_SubmittedBy
	                                                    , A.Tlv_SubmittedDate
	                                                    , A.Tlv_Authority1
	                                                    , A.Tlv_Authority1Date
	                                                    , A.Tlv_Authority2
	                                                    , A.Tlv_Authority2Date
	                                                    , A.Tlv_Authority3
	                                                    , A.Tlv_Authority3Date
	                                                    , A.Tlv_Authority4
	                                                    , A.Tlv_Authority4Date
	                                                    , A.Tlv_Authority5
	                                                    , A.Tlv_Authority5Date
	                                                    , A.Tlv_ShiftCode
	                                                    , A.Tlv_CostcenterCode
	                                                    , A.Tlv_EmploymentStatusCode
	                                                    , A.Tlv_PayrollType
	                                                    , A.Tlv_Grade
	                                                    , A.Tlv_PayrollGroup
	                                                    , A.Tlv_Authority1Comments
	                                                    , A.Tlv_Authority2Comments
	                                                    , A.Tlv_Authority3Comments
	                                                    , A.Tlv_Authority4Comments
	                                                    , A.Tlv_Authority5Comments
	                                                    , A.Tlv_Delegation
	                                                    , A.Tlv_DocumentBatchNo
	                                                    , A.Tlv_OriginalDocumentNo
	                                                    , A.Tlv_CreatedBy
	                                                    , A.Tlv_CreatedDate
	                                                    , A.Tlv_UPDATEdBy
	                                                    , A.Tlv_UPDATEdDate
                                                    FROM T_EmpLeave A
                                                    LEFT JOIN T_EmpLeaveHst B ON A.Tlv_DocumentNo = B.Tlv_DocumentNo
                                                    WHERE A.Tlv_PayCycle = @CURPAYPERIOD
                                                        AND A.Tlv_LeaveDate < @NEXTSTARTDATE
	                                                    AND A.Tlv_LeaveFlag IN ('P','C')
	                                                    AND A.Tlv_LeaveStatus IN ('03','05','07','09','11','13','14','15')
	                                                    AND B.Tlv_PayCycle IS NULL ";

            public const string insertDeleteLeaveLdgCycle = @"INSERT INTO T_EmpLeaveLdgCycleHst 
                                                        (Tll_PayCycle
                                                        , Tll_LeaveYear
                                                        , Tll_IDNo
                                                        , Tll_LeaveCode
                                                        , Tll_BegCredit
                                                        , Tll_CarryForwardCredit
                                                        , Tll_UsedCredit
                                                        , Tll_ConvertedCredit
                                                        , Tll_PendingCreditA
                                                        , Tll_PendingCreditC
                                                        , Tll_UsedCreditThisCycle
                                                        , Tll_RecordStatus
                                                        , Tll_CreatedBy
                                                        , Tll_CreatedDate
                                                        , Tll_UpdatedBy
                                                        , Tll_UpdatedDate)
                                                        SELECT A.Tll_PayCycle
	                                                        , A.Tll_LeaveYear
	                                                        , A.Tll_IDNo
	                                                        , A.Tll_LeaveCode
	                                                        , A.Tll_BegCredit
	                                                        , A.Tll_CarryForwardCredit
	                                                        , A.Tll_UsedCredit
	                                                        , A.Tll_ConvertedCredit
	                                                        , A.Tll_PendingCreditA
	                                                        , A.Tll_PendingCreditC
	                                                        , A.Tll_UsedCreditThisCycle
	                                                        , A.Tll_RecordStatus
	                                                        , A.Tll_CreatedBy
	                                                        , A.Tll_CreatedDate
	                                                        , A.Tll_UpdatedBy
	                                                        , A.Tll_UpdatedDate
                                                        FROM  T_EmpLeaveLdgCycle A
                                                        LEFT JOIN T_EmpLeaveLdgCycleHst B ON B.Tll_LeaveYear = A.Tll_LeaveYear 
	                                                        AND B.Tll_IDNo = A.Tll_IDNo                                     
	                                                        AND B.Tll_PayCycle = A.Tll_PayCycle
	                                                        AND B.Tll_LeaveCode = A.Tll_LeaveCode
                                                        WHERE A.Tll_PayCycle = @CURPAYPERIOD
	                                                        AND B.Tll_PayCycle IS NULL

                                                        DELETE FROM T_EmpLeaveLdgCycle WHERE Tll_PayCycle = @CURPAYPERIOD";

            
            public const string insertOvertime = @"INSERT INTO T_EmpOvertimeHst 
                                                    (Tot_DocumentNo
                                                    , Tot_PayCycle
                                                    , Tot_RequestType
                                                    , Tot_RequestDate
                                                    , Tot_IDNo
                                                    , Tot_OvertimeDate
                                                    , Tot_OvertimeType
                                                    , Tot_StartTime
                                                    , Tot_EndTime
                                                    , Tot_OvertimeHours
                                                    , Tot_ReasonForRequest
                                                    , Tot_OvertimeClass
                                                    , Tot_OvertimeStatus
                                                    , Tot_OvertimeFlag
                                                    , Tot_SubmittedBy
                                                    , Tot_SubmittedDate
                                                    , Tot_Authority1
                                                    , Tot_Authority1Date
                                                    , Tot_Authority2
                                                    , Tot_Authority2Date
                                                    , Tot_Authority3
                                                    , Tot_Authority3Date
                                                    , Tot_Authority4
                                                    , Tot_Authority4Date
                                                    , Tot_Authority5
                                                    , Tot_Authority5Date
                                                    , Tot_ShiftCode
                                                    , Tot_CostcenterCode
                                                    , Tot_EmploymentStatusCode
                                                    , Tot_PayrollType
                                                    , Tot_Grade
                                                    , Tot_PayrollGroup
                                                    , Tot_Authority1Comments
                                                    , Tot_Authority2Comments
                                                    , Tot_Authority3Comments
                                                    , Tot_Authority4Comments
                                                    , Tot_Authority5Comments
                                                    , Tot_Delegation
                                                    , Tot_DocumentBatchNo
                                                    , Tot_OriginalDocumentNo
                                                    , Tot_CreatedBy
                                                    , Tot_CreatedDate
                                                    , Tot_UpdatedBy
                                                    , Tot_UpdatedDate)

                                                    SELECT A.Tot_DocumentNo
	                                                    , A.Tot_PayCycle
	                                                    , A.Tot_RequestType
	                                                    , A.Tot_RequestDate
	                                                    , A.Tot_IDNo
	                                                    , A.Tot_OvertimeDate
	                                                    , A.Tot_OvertimeType
	                                                    , A.Tot_StartTime
	                                                    , A.Tot_EndTime
	                                                    , A.Tot_OvertimeHours
	                                                    , A.Tot_ReasonForRequest
	                                                    , A.Tot_OvertimeClass
	                                                    , A.Tot_OvertimeStatus
	                                                    , A.Tot_OvertimeFlag
	                                                    , A.Tot_SubmittedBy
	                                                    , A.Tot_SubmittedDate
	                                                    , A.Tot_Authority1
	                                                    , A.Tot_Authority1Date
	                                                    , A.Tot_Authority2
	                                                    , A.Tot_Authority2Date
	                                                    , A.Tot_Authority3
	                                                    , A.Tot_Authority3Date
	                                                    , A.Tot_Authority4
	                                                    , A.Tot_Authority4Date
	                                                    , A.Tot_Authority5
	                                                    , A.Tot_Authority5Date
	                                                    , A.Tot_ShiftCode
	                                                    , A.Tot_CostcenterCode
	                                                    , A.Tot_EmploymentStatusCode
	                                                    , A.Tot_PayrollType
	                                                    , A.Tot_Grade
	                                                    , A.Tot_PayrollGroup
	                                                    , A.Tot_Authority1Comments
	                                                    , A.Tot_Authority2Comments
	                                                    , A.Tot_Authority3Comments
	                                                    , A.Tot_Authority4Comments
	                                                    , A.Tot_Authority5Comments
	                                                    , A.Tot_Delegation
	                                                    , A.Tot_DocumentBatchNo
	                                                    , A.Tot_OriginalDocumentNo
	                                                    , A.Tot_CreatedBy
	                                                    , A.Tot_CreatedDate
	                                                    , A.Tot_UPDATEdBy
	                                                    , A.Tot_UPDATEdDate
                                                    FROM  T_EmpOvertime A
                                                    LEFT JOIN T_EmpOvertimeHst B ON A.Tot_DocumentNo = B.Tot_DocumentNo
                                                    WHERE A.Tot_PayCycle = @CURPAYPERIOD
                                                        AND A.Tot_OvertimeDate < @NEXTSTARTDATE
	                                                    AND A.Tot_OvertimeFlag IN ('P','C')
	                                                    AND A.Tot_OvertimeStatus IN ('03','05','07','09','11','13','14','15')
	                                                    AND B.Tot_PayCycle IS NULL";

            

            public const string insertEmployeeMaster = @"INSERT INTO M_EmployeeHst 
                                                        (Mem_PayCycle
                                                        ,Mem_IDNo
                                                        ,Mem_EmploymentStatusCode
                                                        ,Mem_EmploymentType
                                                        ,Mem_WorkStatus
                                                        ,Mem_ShiftCode
                                                        ,Mem_CompanyDate
                                                        ,Mem_CompanyCode
                                                        ,Mem_ProfileCode
                                                        ,Mem_PayrollGroup
                                                        ,Mem_CostcenterDate
                                                        ,Mem_CostcenterCode
                                                        ,Mem_PositionDate
                                                        ,Mem_PositionCode
                                                        ,Mem_PositionGrade
                                                        ,Mem_PositionLevel
                                                        ,Mem_SalaryDate
                                                        ,Mem_PayrollType
                                                        ,Mem_Salary
                                                        ,Mem_OldSalaryDate
                                                        ,Mem_OldPayrollType
                                                        ,Mem_OldSalary
                                                        ,Mem_RestDate
                                                        ,Mem_RestDay
                                                        ,Mem_LocationDate
                                                        ,Mem_WorkLocationCode
                                                        ,Mem_CalendarGrpDate
                                                        ,Mem_CalendarGrpCode
                                                        ,Mem_PremiumGrpDate
                                                        ,Mem_PremiumGrpCode
                                                        ,Mem_PaymentMode
                                                        ,Mem_PayrollBankCode
                                                        ,Mem_BankAcctNo
                                                        ,Mem_TaxCode
                                                        ,Mem_IsTaxExempted
                                                        ,Mem_WifeClaim
                                                        ,Mem_IsComputedPayroll
                                                        ,Mem_IsComputedPerDay
                                                        ,Mem_IsMultipleSalary
                                                        ,Mem_SSSRule
                                                        ,Mem_SSSShare
                                                        ,Mem_PHRule
                                                        ,Mem_PHShare
                                                        ,Mem_PagIbigRule
                                                        ,Mem_PagIbigShare
                                                        ,Mem_UnionRule
                                                        ,Mem_UnionShare
                                                        ,Mem_TaxRule
                                                        ,Mem_TaxShare
                                                        ,Mem_ExpenseClass
                                                        ,Mem_AltAcctCode
                                                        ,Mem_ComputedPayrollCode
                                                        ,Mem_CreatedBy
                                                        ,Mem_CreatedDate
                                                        ,Mem_UpdatedBy
                                                        ,Mem_UpdatedDate)

                                                        SELECT  @CURPAYPERIOD
	                                                        , A.Mem_IDNo
                                                            , A.Mem_EmploymentStatusCode
                                                            , A.Mem_EmploymentType
                                                            , A.Mem_WorkStatus
                                                            , A.Mem_ShiftCode
                                                            , A.Mem_CompanyDate
                                                            , A.Mem_CompanyCode
                                                            , A.Mem_ProfileCode
                                                            , A.Mem_PayrollGroup
                                                            , A.Mem_CostcenterDate
                                                            , A.Mem_CostcenterCode
                                                            , A.Mem_PositionDate
                                                            , A.Mem_PositionCode
                                                            , A.Mem_PositionGrade
                                                            , A.Mem_PositionLevel
                                                            , A.Mem_SalaryDate
                                                            , A.Mem_PayrollType
                                                            , A.Mem_Salary
                                                            , A.Mem_OldSalaryDate
                                                            , A.Mem_OldPayrollType
                                                            , A.Mem_OldSalary
                                                            , A.Mem_RestDate
                                                            , A.Mem_RestDay
                                                            , A.Mem_LocationDate
                                                            , A.Mem_WorkLocationCode
                                                            , A.Mem_CalendarGrpDate
                                                            , A.Mem_CalendarGrpCode
                                                            , A.Mem_PremiumGrpDate
                                                            , A.Mem_PremiumGrpCode
                                                            , A.Mem_PaymentMode
                                                            , A.Mem_PayrollBankCode
                                                            , A.Mem_BankAcctNo
                                                            , A.Mem_TaxCode
                                                            , A.Mem_IsTaxExempted
                                                            , A.Mem_WifeClaim
                                                            , A.Mem_IsComputedPayroll
                                                            , A.Mem_IsComputedPerDay
                                                            , A.Mem_IsMultipleSalary
                                                            , A.Mem_SSSRule
                                                            , A.Mem_SSSShare
                                                            , A.Mem_PHRule
                                                            , A.Mem_PHShare
                                                            , A.Mem_PagIbigRule
                                                            , A.Mem_PagIbigShare
                                                            , A.Mem_UnionRule
                                                            , A.Mem_UnionShare
                                                            , A.Mem_TaxRule
                                                            , A.Mem_TaxShare
                                                            , A.Mem_ExpenseClass
                                                            , A.Mem_AltAcctCode
                                                            , A.Mem_ComputedPayrollCode
                                                            , A.Mem_CreatedBy
                                                            , A.Mem_CreatedDate
                                                            , A.Mem_UpdatedBy
                                                            , A.Mem_UpdatedDate
                                                        FROM M_Employee A
                                                        LEFT JOIN M_EmployeeHst B ON A.Mem_IDNo = B.Mem_IDNo
	                                                        AND B.Mem_PayCycle = @CURPAYPERIOD
                                                        WHERE B.Mem_IDNo IS NULL";

            public const string insertTimeCorrection = @"INSERT INTO T_EmpTimeCorrectionHst 
                                                    (Ttm_DocumentNo
                                                    ,Ttm_PayCycle
                                                    ,Ttm_RequestType
                                                    ,Ttm_RequestDate
                                                    ,Ttm_IDNo
                                                    ,Ttm_TimeCorDate
                                                    ,Ttm_TimeCorType
                                                    ,Ttm_TimeIn01
                                                    ,Ttm_TimeOut01
                                                    ,Ttm_TimeIn02
                                                    ,Ttm_TimeOut02
                                                    ,Ttm_TimeIn03
                                                    ,Ttm_TimeOut03
                                                    ,Ttm_TimeIn04
                                                    ,Ttm_TimeOut04
                                                    ,Ttm_TimeIn05
                                                    ,Ttm_TimeOut05
                                                    ,Ttm_TimeIn06
                                                    ,Ttm_TimeOut06
                                                    ,Ttm_TimeIn07
                                                    ,Ttm_TimeOut07
                                                    ,Ttm_TimeIn08
                                                    ,Ttm_TimeOut08
                                                    ,Ttm_TimeIn09
                                                    ,Ttm_TimeOut09
                                                    ,Ttm_TimeIn10
                                                    ,Ttm_TimeOut10
                                                    ,Ttm_TimeIn11
                                                    ,Ttm_TimeOut11
                                                    ,Ttm_TimeIn12
                                                    ,Ttm_TimeOut12
                                                    ,Ttm_ReasonForRequest
                                                    ,Ttm_TimeCorStatus
                                                    ,Ttm_TimeCorFlag
                                                    ,Ttm_SubmittedBy
                                                    ,Ttm_SubmittedDate
                                                    ,Ttm_Authority1
                                                    ,Ttm_Authority1Date
                                                    ,Ttm_Authority2
                                                    ,Ttm_Authority2Date
                                                    ,Ttm_Authority3
                                                    ,Ttm_Authority3Date
                                                    ,Ttm_Authority4
                                                    ,Ttm_Authority4Date
                                                    ,Ttm_Authority5
                                                    ,Ttm_Authority5Date
                                                    ,Ttm_ShiftCode
                                                    ,Ttm_CostcenterCode
                                                    ,Ttm_EmploymentStatusCode
                                                    ,Ttm_PayrollType
                                                    ,Ttm_Grade
                                                    ,Ttm_PayrollGroup
                                                    ,Ttm_Authority1Comments
                                                    ,Ttm_Authority2Comments
                                                    ,Ttm_Authority3Comments
                                                    ,Ttm_Authority4Comments
                                                    ,Ttm_Authority5Comments
                                                    ,Ttm_Delegation
                                                    ,Ttm_DocumentBatchNo
                                                    ,Ttm_OriginalDocumentNo
                                                    ,Ttm_LogControl
                                                    ,Ttm_Classification
                                                    ,Ttm_CreatedBy
                                                    ,Ttm_CreatedDate
                                                    ,Ttm_UpdatedBy
                                                    ,Ttm_UpdatedDate)

                                                    SELECT A.Ttm_DocumentNo
                                                    ,A.Ttm_PayCycle
                                                    ,A.Ttm_RequestType
                                                    ,A.Ttm_RequestDate
                                                    ,A.Ttm_IDNo
                                                    ,A.Ttm_TimeCorDate
                                                    ,A.Ttm_TimeCorType
                                                    ,A.Ttm_TimeIn01
                                                    ,A.Ttm_TimeOut01
                                                    ,A.Ttm_TimeIn02
                                                    ,A.Ttm_TimeOut02
                                                    ,A.Ttm_TimeIn03
                                                    ,A.Ttm_TimeOut03
                                                    ,A.Ttm_TimeIn04
                                                    ,A.Ttm_TimeOut04
                                                    ,A.Ttm_TimeIn05
                                                    ,A.Ttm_TimeOut05
                                                    ,A.Ttm_TimeIn06
                                                    ,A.Ttm_TimeOut06
                                                    ,A.Ttm_TimeIn07
                                                    ,A.Ttm_TimeOut07
                                                    ,A.Ttm_TimeIn08
                                                    ,A.Ttm_TimeOut08
                                                    ,A.Ttm_TimeIn09
                                                    ,A.Ttm_TimeOut09
                                                    ,A.Ttm_TimeIn10
                                                    ,A.Ttm_TimeOut10
                                                    ,A.Ttm_TimeIn11
                                                    ,A.Ttm_TimeOut11
                                                    ,A.Ttm_TimeIn12
                                                    ,A.Ttm_TimeOut12
                                                    ,A.Ttm_ReasonForRequest
                                                    ,A.Ttm_TimeCorStatus
                                                    ,A.Ttm_TimeCorFlag
                                                    ,A.Ttm_SubmittedBy
                                                    ,A.Ttm_SubmittedDate
                                                    ,A.Ttm_Authority1
                                                    ,A.Ttm_Authority1Date
                                                    ,A.Ttm_Authority2
                                                    ,A.Ttm_Authority2Date
                                                    ,A.Ttm_Authority3
                                                    ,A.Ttm_Authority3Date
                                                    ,A.Ttm_Authority4
                                                    ,A.Ttm_Authority4Date
                                                    ,A.Ttm_Authority5
                                                    ,A.Ttm_Authority5Date
                                                    ,A.Ttm_ShiftCode
                                                    ,A.Ttm_CostcenterCode
                                                    ,A.Ttm_EmploymentStatusCode
                                                    ,A.Ttm_PayrollType
                                                    ,A.Ttm_Grade
                                                    ,A.Ttm_PayrollGroup
                                                    ,A.Ttm_Authority1Comments
                                                    ,A.Ttm_Authority2Comments
                                                    ,A.Ttm_Authority3Comments
                                                    ,A.Ttm_Authority4Comments
                                                    ,A.Ttm_Authority5Comments
                                                    ,A.Ttm_Delegation
                                                    ,A.Ttm_DocumentBatchNo
                                                    ,A.Ttm_OriginalDocumentNo
                                                    ,A.Ttm_LogControl
                                                    ,A.Ttm_Classification
                                                    ,A.Ttm_CreatedBy
                                                    ,A.Ttm_CreatedDate
                                                    ,A.Ttm_UpdatedBy
                                                    ,A.Ttm_UpdatedDate
                                                    FROM T_EmpTimeCorrection A
                                                    LEFT JOIN T_EmpTimeCorrectionHst B ON A.Ttm_DocumentNo = B.Ttm_DocumentNo
                                                    WHERE A.Ttm_PayCycle = @CURPAYPERIOD
                                                        AND A.Ttm_TimeCorDate < @NEXTSTARTDATE
	                                                    AND A.Ttm_TimeCorFlag IN ('P','C')
	                                                    AND A.Ttm_TimeCorStatus IN ('03','05','07','09','11','13','14','15')
	                                                    AND B.Ttm_PayCycle IS NULL";

            public const string insertShift = @"INSERT INTO T_EmpShiftHst (Tes_DocumentNo
                                                ,Tes_PayCycle
                                                ,Tes_RequestType
                                                ,Tes_RequestDate
                                                ,Tes_IDNo
                                                ,Tes_ShiftDate
                                                ,Tes_ShiftCode
                                                ,Tes_ReasonForRequest
                                                ,Tes_ShiftStatus
                                                ,Tes_ShiftFlag
                                                ,Tes_SubmittedBy
                                                ,Tes_SubmittedDate
                                                ,Tes_Authority1
                                                ,Tes_Authority1Date
                                                ,Tes_Authority2
                                                ,Tes_Authority2Date
                                                ,Tes_Authority3
                                                ,Tes_Authority3Date
                                                ,Tes_Authority4
                                                ,Tes_Authority4Date
                                                ,Tes_Authority5
                                                ,Tes_Authority5Date
                                                ,Tes_CurShiftCode
                                                ,Tes_CostcenterCode
                                                ,Tes_EmploymentStatusCode
                                                ,Tes_PayrollType
                                                ,Tes_Grade
                                                ,Tes_PayrollGroup
                                                ,Tes_Authority1Comments
                                                ,Tes_Authority2Comments
                                                ,Tes_Authority3Comments
                                                ,Tes_Authority4Comments
                                                ,Tes_Authority5Comments
                                                ,Tes_Delegation
                                                ,Tes_DocumentBatchNo
                                                ,Tes_OriginalDocumentNo
                                                ,Tes_CreatedBy
                                                ,Tes_CreatedDate
                                                ,Tes_UpdatedBy
                                                ,Tes_UpdatedDate)
                                                SELECT A.Tes_DocumentNo
                                                    ,A.Tes_PayCycle
                                                    ,A.Tes_RequestType
                                                    ,A.Tes_RequestDate
                                                    ,A.Tes_IDNo
                                                    ,A.Tes_ShiftDate
                                                    ,A.Tes_ShiftCode
                                                    ,A.Tes_ReasonForRequest
                                                    ,A.Tes_ShiftStatus
                                                    ,A.Tes_ShiftFlag
                                                    ,A.Tes_SubmittedBy
                                                    ,A.Tes_SubmittedDate
                                                    ,A.Tes_Authority1
                                                    ,A.Tes_Authority1Date
                                                    ,A.Tes_Authority2
                                                    ,A.Tes_Authority2Date
                                                    ,A.Tes_Authority3
                                                    ,A.Tes_Authority3Date
                                                    ,A.Tes_Authority4
                                                    ,A.Tes_Authority4Date
                                                    ,A.Tes_Authority5
                                                    ,A.Tes_Authority5Date
                                                    ,A.Tes_CurShiftCode
                                                    ,A.Tes_CostcenterCode
                                                    ,A.Tes_EmploymentStatusCode
                                                    ,A.Tes_PayrollType
                                                    ,A.Tes_Grade
                                                    ,A.Tes_PayrollGroup
                                                    ,A.Tes_Authority1Comments
                                                    ,A.Tes_Authority2Comments
                                                    ,A.Tes_Authority3Comments
                                                    ,A.Tes_Authority4Comments
                                                    ,A.Tes_Authority5Comments
                                                    ,A.Tes_Delegation
                                                    ,A.Tes_DocumentBatchNo
                                                    ,A.Tes_OriginalDocumentNo
                                                    ,A.Tes_CreatedBy
                                                    ,A.Tes_CreatedDate
                                                    ,A.Tes_UpdatedBy
                                                    ,A.Tes_UpdatedDate
                                                 FROM  T_EmpShift A
                                                 LEFT JOIN T_EmpShiftHst B ON A.Tes_DocumentNo = B.Tes_DocumentNo
                                                 WHERE A.Tes_PayCycle = @CURPAYPERIOD
                                                    AND A.Tes_ShiftDate < @NEXTSTARTDATE
	                                                AND A.Tes_ShiftFlag IN ('P','C')
	                                                AND A.Tes_ShiftStatus IN ('03','05','07','09','11','13','14','15')
	                                                AND B.Tes_PayCycle IS NULL";

            public const string insertEmpinfo = @"INSERT INTO T_EmpInfoPDHst (Tpd_DocumentNo
							                        ,Tpd_LastName
							                        ,Tpd_FirstName
							                        ,Tpd_MiddleName
							                        ,Tpd_ExtensionName
							                        ,Tpd_Gender
							                        ,Tpd_MaidenName
							                        ,Tpd_BirthDate
							                        ,Tpd_CivilStatusCode
							                        ,Tpd_BloodType
							                        ,Tpd_EducationCode
							                        ,Tpd_SchoolCode
							                        ,Tpd_CourseCode
							                        ,Tpd_PresBarangayCode
							                        ,Tpd_PresLocationCode
							                        ,Tpd_PresMailingAddress
							                        ,Tpd_PresContactNo
							                        ,Tpd_ProvBarangayCode
							                        ,Tpd_ProvLocationCode
							                        ,Tpd_ProvMailingAddress
							                        ,Tpd_ProvContactNo
							                        ,Tpd_ICEContactPerson
							                        ,Tpd_ICERelation
							                        ,Tpd_ICEContactNo
							                        ,Tpd_ICEBarangayCode
							                        ,Tpd_ICELocationCode
							                        ,Tpd_ICEMailingAddress
							                        ,Tpd_ShoeSize
							                        ,Tpd_ShirtSize
							                        ,Tpd_UniformSize
							                        ,Tpd_CurLastName
							                        ,Tpd_CurFirstName
							                        ,Tpd_CurMiddleName
							                        ,Tpd_CurExtensionName
							                        ,Tpd_CurGender
							                        ,Tpd_CurMaidenName
							                        ,Tpd_CurBirthDate
							                        ,Tpd_CurCivilStatusCode
							                        ,Tpd_CurBloodType
							                        ,Tpd_CurEducationCode
							                        ,Tpd_CurSchoolCode
							                        ,Tpd_CurCourseCode
							                        ,Tpd_CurPresBarangayCode
							                        ,Tpd_CurPresLocationCode
							                        ,Tpd_CurPresMailingAddress
							                        ,Tpd_CurPresContactNo
							                        ,Tpd_CurProvBarangayCode
							                        ,Tpd_CurProvLocationCode
							                        ,Tpd_CurProvMailingAddress
							                        ,Tpd_CurProvContactNo
							                        ,Tpd_CurICEContactPerson
							                        ,Tpd_CurICERelation
							                        ,Tpd_CurICEContactNo
							                        ,Tpd_CurICEBarangayCode
							                        ,Tpd_CurICELocationCode
							                        ,Tpd_CurICEMailingAddress
							                        ,Tpd_CurShoeSize
							                        ,Tpd_CurShirtSize
							                        ,Tpd_CurUniformSize
							                        ,Tpd_CreatedBy
							                        ,Tpd_CreatedDate
							                        ,Tpd_UpdatedBy
							                        ,Tpd_UpdatedDate)
							                      SELECT A.Tpd_DocumentNo
							                        ,A.Tpd_LastName
							                        ,A.Tpd_FirstName
							                        ,A.Tpd_MiddleName
							                        ,A.Tpd_ExtensionName
							                        ,A.Tpd_Gender
							                        ,A.Tpd_MaidenName
							                        ,A.Tpd_BirthDate
							                        ,A.Tpd_CivilStatusCode
							                        ,A.Tpd_BloodType
							                        ,A.Tpd_EducationCode
							                        ,A.Tpd_SchoolCode
							                        ,A.Tpd_CourseCode
							                        ,A.Tpd_PresBarangayCode
							                        ,A.Tpd_PresLocationCode
							                        ,A.Tpd_PresMailingAddress
							                        ,A.Tpd_PresContactNo
							                        ,A.Tpd_ProvBarangayCode
							                        ,A.Tpd_ProvLocationCode
							                        ,A.Tpd_ProvMailingAddress
							                        ,A.Tpd_ProvContactNo
							                        ,A.Tpd_ICEContactPerson
							                        ,A.Tpd_ICERelation
							                        ,A.Tpd_ICEContactNo
							                        ,A.Tpd_ICEBarangayCode
							                        ,A.Tpd_ICELocationCode
							                        ,A.Tpd_ICEMailingAddress
							                        ,A.Tpd_ShoeSize
							                        ,A.Tpd_ShirtSize
							                        ,A.Tpd_UniformSize
							                        ,A.Tpd_CurLastName
							                        ,A.Tpd_CurFirstName
							                        ,A.Tpd_CurMiddleName
							                        ,A.Tpd_CurExtensionName
							                        ,A.Tpd_CurGender
							                        ,A.Tpd_CurMaidenName
							                        ,A.Tpd_CurBirthDate
							                        ,A.Tpd_CurCivilStatusCode
							                        ,A.Tpd_CurBloodType
							                        ,A.Tpd_CurEducationCode
							                        ,A.Tpd_CurSchoolCode
							                        ,A.Tpd_CurCourseCode
							                        ,A.Tpd_CurPresBarangayCode
							                        ,A.Tpd_CurPresLocationCode
							                        ,A.Tpd_CurPresMailingAddress
							                        ,A.Tpd_CurPresContactNo
							                        ,A.Tpd_CurProvBarangayCode
							                        ,A.Tpd_CurProvLocationCode
							                        ,A.Tpd_CurProvMailingAddress
							                        ,A.Tpd_CurProvContactNo
							                        ,A.Tpd_CurICEContactPerson
							                        ,A.Tpd_CurICERelation
							                        ,A.Tpd_CurICEContactNo
							                        ,A.Tpd_CurICEBarangayCode
							                        ,A.Tpd_CurICELocationCode
							                        ,A.Tpd_CurICEMailingAddress
							                        ,A.Tpd_CurShoeSize
							                        ,A.Tpd_CurShirtSize
							                        ,A.Tpd_CurUniformSize
							                        ,A.Tpd_CreatedBy
							                        ,A.Tpd_CreatedDate
							                        ,A.Tpd_UpdatedBy
							                        ,A.Tpd_UpdatedDate
							                        FROM  T_EmpInfoPD A
							                      INNER JOIN T_EmpInfo C ON Tei_DocumentNo = Tpd_DocumentNo
                                                  LEFT JOIN T_EmpInfoPDHst B ON A.Tpd_DocumentNo = B.Tpd_DocumentNo
                                                  WHERE C.Tei_PayCycle = @CURPAYPERIOD
                                                       AND C.Tei_RequestDate < @NEXTSTARTDATE
	                                                   AND C.Tei_EmpUpdateFlag IN ('P','C')
	                                                   AND C.Tei_EmpUpdateStatus IN ('03','05','07','09','11','13','14','15')
	                                                   AND B.Tpd_DocumentNo IS NULL

                                                 INSERT INTO T_EmpInfoFDHst (Tfd_DocumentNo
							                        ,Tfd_SeqNo
							                        ,Tfd_LastName
							                        ,Tfd_FirstName
							                        ,Tfd_MiddleName
							                        ,Tfd_BirthDate
							                        ,Tfd_Gender
							                        ,Tfd_CivilStatus
							                        ,Tfd_RelationToEmployee
							                        ,Tfd_Address
							                        ,Tfd_Phone
							                        ,Tfd_Occupation
							                        ,Tfd_Company
							                        ,Tfd_CurLastName
							                        ,Tfd_CurFirstName
							                        ,Tfd_CurMiddleName
							                        ,Tfd_CurBirthDate
							                        ,Tfd_CurGender
							                        ,Tfd_CurCivilStatus
							                        ,Tfd_CurRelationToEmployee
							                        ,Tfd_CurAddress
							                        ,Tfd_CurPhone
							                        ,Tfd_CurOccupation
							                        ,Tfd_CurCompany
							                        ,Tfd_FamilyRefNo
							                        ,Tfd_CreatedBy
							                        ,Tfd_CreatedDate
							                        ,Tfd_UpdatedBy
							                        ,Tfd_UpdatedDate)
							                    SELECT A.Tfd_DocumentNo
								                    ,A.Tfd_SeqNo
								                    ,A.Tfd_LastName
								                    ,A.Tfd_FirstName
								                    ,A.Tfd_MiddleName
								                    ,A.Tfd_BirthDate
								                    ,A.Tfd_Gender
								                    ,A.Tfd_CivilStatus
								                    ,A.Tfd_RelationToEmployee
								                    ,A.Tfd_Address
								                    ,A.Tfd_Phone
								                    ,A.Tfd_Occupation
								                    ,A.Tfd_Company
								                    ,A.Tfd_CurLastName
								                    ,A.Tfd_CurFirstName
								                    ,A.Tfd_CurMiddleName
								                    ,A.Tfd_CurBirthDate
								                    ,A.Tfd_CurGender
								                    ,A.Tfd_CurCivilStatus
								                    ,A.Tfd_CurRelationToEmployee
								                    ,A.Tfd_CurAddress
								                    ,A.Tfd_CurPhone
								                    ,A.Tfd_CurOccupation
								                    ,A.Tfd_CurCompany
								                    ,A.Tfd_FamilyRefNo
								                    ,A.Tfd_CreatedBy
								                    ,A.Tfd_CreatedDate
								                    ,A.Tfd_UpdatedBy
								                    ,A.Tfd_UpdatedDate
							                    FROM T_EmpInfoFD A
							                    INNER JOIN T_EmpInfo C ON Tei_DocumentNo = Tfd_DocumentNo
                                                LEFT JOIN T_EmpInfoFDHst B ON A.Tfd_DocumentNo = B.Tfd_DocumentNo
                                                WHERE C.Tei_PayCycle = @CURPAYPERIOD
                                                     AND C.Tei_RequestDate < @NEXTSTARTDATE
	                                                 AND C.Tei_EmpUpdateFlag IN ('P','C')
	                                                 AND C.Tei_EmpUpdateStatus IN ('03','05','07','09','11','13','14','15')
	                                                 AND B.Tfd_DocumentNo IS NULL

                                                 INSERT INTO T_EmpInfoHst (Tei_DocumentNo
                                                    ,Tei_PayCycle
                                                    ,Tei_RequestType
                                                    ,Tei_UpdateType
                                                    ,Tei_RequestDate
                                                    ,Tei_IDNo
                                                    ,Tei_ReasonForRequest
                                                    ,Tei_EmpUpdateStatus
                                                    ,Tei_EmpUpdateFlag
                                                    ,Tei_SubmittedBy
                                                    ,Tei_SubmittedDate
                                                    ,Tei_Authority1
                                                    ,Tei_Authority1Date
                                                    ,Tei_Authority2
                                                    ,Tei_Authority2Date
                                                    ,Tei_Authority3
                                                    ,Tei_Authority3Date
                                                    ,Tei_Authority4
                                                    ,Tei_Authority4Date
                                                    ,Tei_Authority5
                                                    ,Tei_Authority5Date
                                                    ,Tei_CostcenterCode
                                                    ,Tei_EmploymentStatusCode
                                                    ,Tei_PayrollType
                                                    ,Tei_Grade
                                                    ,Tei_PayrollGroup
                                                    ,Tei_Authority1Comments
                                                    ,Tei_Authority2Comments
                                                    ,Tei_Authority3Comments
                                                    ,Tei_Authority4Comments
                                                    ,Tei_Authority5Comments
                                                    ,Tei_Delegation
                                                    ,Tei_DocumentBatchNo
                                                    ,Tei_OriginalDocumentNo
                                                    ,Tei_CreatedBy
                                                    ,Tei_CreatedDate
                                                    ,Tei_UpdatedBy
                                                    ,Tei_UpdatedDate)
                                                SELECT A.Tei_DocumentNo
                                                    ,A.Tei_PayCycle
                                                    ,A.Tei_RequestType
                                                    ,A.Tei_UpdateType
                                                    ,A.Tei_RequestDate
                                                    ,A.Tei_IDNo
                                                    ,A.Tei_ReasonForRequest
                                                    ,A.Tei_EmpUpdateStatus
                                                    ,A.Tei_EmpUpdateFlag
                                                    ,A.Tei_SubmittedBy
                                                    ,A.Tei_SubmittedDate
                                                    ,A.Tei_Authority1
                                                    ,A.Tei_Authority1Date
                                                    ,A.Tei_Authority2
                                                    ,A.Tei_Authority2Date
                                                    ,A.Tei_Authority3
                                                    ,A.Tei_Authority3Date
                                                    ,A.Tei_Authority4
                                                    ,A.Tei_Authority4Date
                                                    ,A.Tei_Authority5
                                                    ,A.Tei_Authority5Date
                                                    ,A.Tei_CostcenterCode
                                                    ,A.Tei_EmploymentStatusCode
                                                    ,A.Tei_PayrollType
                                                    ,A.Tei_Grade
                                                    ,A.Tei_PayrollGroup
                                                    ,A.Tei_Authority1Comments
                                                    ,A.Tei_Authority2Comments
                                                    ,A.Tei_Authority3Comments
                                                    ,A.Tei_Authority4Comments
                                                    ,A.Tei_Authority5Comments
                                                    ,A.Tei_Delegation
                                                    ,A.Tei_DocumentBatchNo
                                                    ,A.Tei_OriginalDocumentNo
                                                    ,A.Tei_CreatedBy
                                                    ,A.Tei_CreatedDate
                                                    ,A.Tei_UpdatedBy
                                                    ,A.Tei_UpdatedDate
                                                 FROM T_EmpInfo A
                                                 LEFT JOIN T_EmpInfoHst B ON A.Tei_DocumentNo = B.Tei_DocumentNo
                                                 WHERE A.Tei_PayCycle = @CURPAYPERIOD
                                                    AND A.Tei_RequestDate < @NEXTSTARTDATE
	                                                AND A.Tei_EmpUpdateFlag IN ('P','C')
	                                                AND A.Tei_EmpUpdateStatus IN ('03','05','07','09','11','13','14','15')
	                                                AND B.Tei_PayCycle IS NULL ";

            public const string insertDeleteHdrDtlLeaveRefund = @"IF ( SELECT ISNULL(COUNT(Tlh_ControlNo), 0)  FROM T_EmpLeaveRefundHdr WHERE Tlh_PayCycle = @CURPAYPERIOD) > 0 

	                                                        BEGIN
		                                                        INSERT INTO T_EmpLeaveRefundDtlHst 
                                                                (Tld_ControlNo
                                                                    ,Tld_LineNo
                                                                    ,Tld_IDNo
                                                                    ,Tld_LeaveCode
                                                                    ,Tld_LeaveHr
                                                                    ,Tld_LeaveAmt
                                                                    ,Tld_LeaveNontaxableHr
                                                                    ,Tld_LeaveNontaxableAmt
                                                                    ,Tld_LeaveTaxableHr
                                                                    ,Tld_LeaveTaxableAmt
                                                                    ,Tld_SalaryRate
                                                                    ,Tld_HourlyDailyRate
                                                                    ,Tld_PostFlag
                                                                    ,Tld_BegCredit
                                                                    ,Tld_CarryForwardCredit
                                                                    ,Tld_UsedCredit
                                                                    ,Tld_DividendValue
                                                                    ,Tld_DivisorValue
                                                                    ,Tld_CarryForwardCreditNextYear
                                                                    ,Tld_CostCenter
                                                                    ,Tld_PayrollGroup
                                                                    ,Tld_EmploymentStatus
                                                                    ,Tld_PayrollType
                                                                    ,Tld_Position
                                                                    ,Tld_Grade
                                                                    ,Usr_Login
                                                                    ,Ludatetime)

		                                                        SELECT A.Tld_ControlNo
                                                                    ,A.Tld_LineNo
                                                                    ,A.Tld_IDNo
                                                                    ,A.Tld_LeaveCode
                                                                    ,A.Tld_LeaveHr
                                                                    ,A.Tld_LeaveAmt
                                                                    ,A.Tld_LeaveNontaxableHr
                                                                    ,A.Tld_LeaveNontaxableAmt
                                                                    ,A.Tld_LeaveTaxableHr
                                                                    ,A.Tld_LeaveTaxableAmt
                                                                    ,A.Tld_SalaryRate
                                                                    ,A.Tld_HourlyDailyRate
                                                                    ,A.Tld_PostFlag
                                                                    ,A.Tld_BegCredit
                                                                    ,A.Tld_CarryForwardCredit
                                                                    ,A.Tld_UsedCredit
                                                                    ,A.Tld_DividendValue
                                                                    ,A.Tld_DivisorValue
                                                                    ,A.Tld_CarryForwardCreditNextYear
                                                                    ,A.Tld_CostCenter
                                                                    ,A.Tld_PayrollGroup
                                                                    ,A.Tld_EmploymentStatus
                                                                    ,A.Tld_PayrollType
                                                                    ,A.Tld_Position
                                                                    ,A.Tld_Grade
			                                                        ,A.Usr_Login
			                                                        ,A.Ludatetime
		                                                        FROM T_EmpLeaveRefundDtl A
		                                                        INNER JOIN T_EmpLeaveRefundHdr B
		                                                        ON B.Tlh_ControlNo = A.Tld_ControlNo 
			                                                        AND B.Tlh_PayCycle = @CURPAYPERIOD

                                                                INSERT INTO T_EmpLeaveRefundRuleHst
                                                                (Tlr_ControlNo
                                                                    ,Tlr_LineNo
                                                                    ,Tlr_LeaveYear
                                                                    ,Tlr_LeaveCode
                                                                    ,Tlr_EncashmentBasis
                                                                    ,Tlr_EncashmentRate
                                                                    ,Tlr_SalaryDate
                                                                    ,Tlr_EncashmentRule
                                                                    ,Tlr_EncashmentCredit
                                                                    ,Tlr_EncashmentNontaxableRule
                                                                    ,Tlr_EncashmentNontaxableCredit
                                                                    ,Tlr_EncashmentTaxableRule
                                                                    ,Tlr_EncashmentTaxableCredit
                                                                    ,Tlr_CarryForwardRule
                                                                    ,Tlr_CarryForwardCredit
                                                                    ,Tlr_CarryForwardLeaveCode
                                                                    ,Tlr_CarryForwardPickUp
                                                                    ,Usr_Login
                                                                    ,Ludatetime)
                                                                SELECT A.Tlr_ControlNo
                                                                    ,A.Tlr_LineNo
                                                                    ,A.Tlr_LeaveYear
                                                                    ,A.Tlr_LeaveCode
                                                                    ,A.Tlr_EncashmentBasis
                                                                    ,A.Tlr_EncashmentRate
                                                                    ,A.Tlr_SalaryDate
                                                                    ,A.Tlr_EncashmentRule
                                                                    ,A.Tlr_EncashmentCredit
                                                                    ,A.Tlr_EncashmentNontaxableRule
                                                                    ,A.Tlr_EncashmentNontaxableCredit
                                                                    ,A.Tlr_EncashmentTaxableRule
                                                                    ,A.Tlr_EncashmentTaxableCredit
                                                                    ,A.Tlr_CarryForwardRule
                                                                    ,A.Tlr_CarryForwardCredit
                                                                    ,A.Tlr_CarryForwardLeaveCode
                                                                    ,A.Tlr_CarryForwardPickUp
                                                                    ,A.Usr_Login
                                                                    ,A.Ludatetime
                                                                FROM T_EmpLeaveRefundRule A
		                                                        INNER JOIN T_EmpLeaveRefundHdr B
		                                                        ON B.Tlh_ControlNo = A.Tlr_ControlNo 
			                                                        AND B.Tlh_PayCycle = @CURPAYPERIOD                                                   

		                                                        INSERT INTO T_EmpLeaveRefundHdrHst 
                                                                (Tlh_ControlNo
		                                                            , Tlh_PayCycle
		                                                            , Tlh_IDNoLIst
		                                                            , Tlh_CostCenterList
		                                                            , Tlh_PayrollGroupList
		                                                            , Tlh_EmploymentStatusList
		                                                            , Tlh_PayrollTypeList
		                                                            , Tlh_PositionList
		                                                            , Tlh_GradeList
		                                                            , Tlh_HireRegOption
		                                                            , Tlh_HireRegDate
                                                                    , Tlh_RecordStatus
		                                                            , Usr_Login
		                                                            , Ludatetime)
		                                                        SELECT Tlh_ControlNo
			                                                        , Tlh_PayCycle
			                                                        , Tlh_IDNoLIst
			                                                        , Tlh_CostCenterList
			                                                        , Tlh_PayrollGroupList
			                                                        , Tlh_EmploymentStatusList
			                                                        , Tlh_PayrollTypeList
			                                                        , Tlh_PositionList
			                                                        , Tlh_GradeList
			                                                        , Tlh_HireRegOption
			                                                        , Tlh_HireRegDate
                                                                    , Tlh_RecordStatus
			                                                        , Usr_Login
			                                                        , Ludatetime
		                                                        FROM T_EmpLeaveRefundHdr
		                                                        WHERE Tlh_PayCycle = @CURPAYPERIOD

		                                                        DELETE FROM T_EmpLeaveRefundDtl
		                                                        FROM T_EmpLeaveRefundDtl
		                                                        INNER JOIN T_EmpLeaveRefundHdr ON Tlh_ControlNo = Tld_ControlNo 
			                                                        AND Tlh_PayCycle = @CURPAYPERIOD

                                                                DELETE FROM T_EmpLeaveRefundRule
		                                                        FROM T_EmpLeaveRefundRule
		                                                        INNER JOIN T_EmpLeaveRefundHdr ON Tlh_ControlNo = Tlr_ControlNo 
			                                                        AND Tlh_PayCycle = @CURPAYPERIOD

		                                                        DELETE FROM T_EmpLeaveRefundHdr
		                                                        WHERE Tlh_PayCycle = @CURPAYPERIOD
   
                                                           END";


            public const string insertDeleteHdrDtlPerfectAttendance = @"IF ( SELECT ISNULL(COUNT(Tah_ControlNo), 0)  FROM T_EmpAttendanceHdr WHERE Tah_PayCycle = @CURPAYPERIOD) > 0 

	                                                        BEGIN
                                                                INSERT INTO T_EmpAttendanceExceptionHst
                                                                (Tap_ControlNo
                                                                    ,Tap_LineNo
                                                                    ,Tap_LineSplitNo
                                                                    ,Tap_Date
                                                                    ,Tap_ExceptionType
                                                                    ,Tap_Remarks
                                                                    ,Tap_IsSystemGenerated
                                                                    ,Tap_RecordStatus
                                                                    ,Usr_Login
                                                                    ,Ludatetime)

                                                                SELECT A.Tap_ControlNo
                                                                    ,A.Tap_LineNo
                                                                    ,A.Tap_LineSplitNo
                                                                    ,A.Tap_Date
                                                                    ,A.Tap_ExceptionType
                                                                    ,A.Tap_Remarks
                                                                    ,A.Tap_IsSystemGenerated
                                                                    ,A.Tap_RecordStatus
                                                                    ,A.Usr_Login
                                                                    ,A.Ludatetime
                                                                FROM T_EmpAttendanceException A
                                                                INNER JOIN T_EmpAttendanceDtl B
		                                                            ON A.Tap_ControlNo = B.Tad_ControlNo
                                                                    AND A.Tap_LineNo = B.Tad_LineNo
                                                                INNER JOIN T_EmpAttendanceHdr C 
                                                                    ON C.Tah_ControlNo = B.Tad_ControlNo
			                                                        AND C.Tah_PayCycle = @CURPAYPERIOD

		                                                        INSERT INTO T_EmpAttendanceDtlHst 
                                                                (Tad_ControlNo
                                                                    ,Tad_LineNo
                                                                    ,Tad_IDNo
                                                                    ,Tad_EntitledAmt
                                                                    ,Tad_UntitledDays
                                                                    ,Tad_DailyUntitledAmt
                                                                    ,Tad_UntitledAmt
                                                                    ,Tad_DeductionDays
                                                                    ,Tad_DailyDeductionAmt
                                                                    ,Tad_DeductionAmt
                                                                    ,Tad_NetAmt
                                                                    ,Tad_HasAvailed
                                                                    ,Tad_PostFlag
                                                                    ,Tad_Timer
                                                                    ,Tad_CostCenter
                                                                    ,Tad_PayrollGroup
                                                                    ,Tad_EmploymentStatus
                                                                    ,Tad_PayrollType
                                                                    ,Tad_Position
                                                                    ,Tad_Grade
                                                                    ,Usr_Login
                                                                    ,Ludatetime)

		                                                        SELECT A.Tad_ControlNo
                                                                    ,A.Tad_LineNo
                                                                    ,A.Tad_IDNo
                                                                    ,A.Tad_EntitledAmt
                                                                    ,A.Tad_UntitledDays
                                                                    ,A.Tad_DailyUntitledAmt
                                                                    ,A.Tad_UntitledAmt
                                                                    ,A.Tad_DeductionDays
                                                                    ,A.Tad_DailyDeductionAmt
                                                                    ,A.Tad_DeductionAmt
                                                                    ,A.Tad_NetAmt
                                                                    ,A.Tad_HasAvailed
                                                                    ,A.Tad_PostFlag
                                                                    ,A.Tad_Timer
                                                                    ,A.Tad_CostCenter
                                                                    ,A.Tad_PayrollGroup
                                                                    ,A.Tad_EmploymentStatus
                                                                    ,A.Tad_PayrollType
                                                                    ,A.Tad_Position
                                                                    ,A.Tad_Grade
                                                                    ,A.Usr_Login
                                                                    ,A.Ludatetime
		                                                        FROM T_EmpAttendanceDtl A
		                                                        INNER JOIN T_EmpAttendanceHdr B
		                                                        ON B.Tah_ControlNo = A.Tad_ControlNo 
			                                                        AND B.Tah_PayCycle = @CURPAYPERIOD

		                                                        INSERT INTO T_EmpAttendanceHdrHst 
                                                                (Tah_ControlNo
                                                                ,Tah_ProcessedDate
                                                                ,Tah_PayCycle
                                                                ,Tah_RuleCode
                                                                ,Tah_Effectivity
                                                                ,Tah_Frequency
                                                                ,Tah_ComputeEntitlement
                                                                ,Tah_ComputeUntitledDays
                                                                ,Tah_ExclusionFormula
                                                                ,Tah_ExclusionType
                                                                ,Tah_WithTimer
                                                                ,Tah_Computation
                                                                ,Tah_Classification
                                                                ,Tah_IncomeCode
                                                                ,Tah_DeductionCode
                                                                ,Tah_ComputeDeductionDays
                                                                ,Tah_IDNoLIst
                                                                ,Tah_CostCenterList
                                                                ,Tah_PayrollGroupList
                                                                ,Tah_EmploymentStatusList
                                                                ,Tah_PayrollTypeList
                                                                ,Tah_PositionList
                                                                ,Tah_GradeList
                                                                ,Tah_DateOption
                                                                ,Tah_CutOffDate
                                                                ,Tah_StartDate
                                                                ,Tah_EndDate
                                                                ,Tah_RecordStatus
                                                                ,Usr_Login
                                                                ,Ludatetime)

		                                                        SELECT Tah_ControlNo
                                                                    ,Tah_ProcessedDate
                                                                    ,Tah_PayCycle
                                                                    ,Tah_RuleCode
                                                                    ,Tah_Effectivity
                                                                    ,Tah_Frequency
                                                                    ,Tah_ComputeEntitlement
                                                                    ,Tah_ComputeUntitledDays
                                                                    ,Tah_ExclusionFormula
                                                                    ,Tah_ExclusionType
                                                                    ,Tah_WithTimer
                                                                    ,Tah_Computation
                                                                    ,Tah_Classification
                                                                    ,Tah_IncomeCode
                                                                    ,Tah_DeductionCode
                                                                    ,Tah_ComputeDeductionDays
                                                                    ,Tah_IDNoLIst
                                                                    ,Tah_CostCenterList
                                                                    ,Tah_PayrollGroupList
                                                                    ,Tah_EmploymentStatusList
                                                                    ,Tah_PayrollTypeList
                                                                    ,Tah_PositionList
                                                                    ,Tah_GradeList
                                                                    ,Tah_DateOption
                                                                    ,Tah_CutOffDate
                                                                    ,Tah_StartDate
                                                                    ,Tah_EndDate
                                                                    ,Tah_RecordStatus
                                                                    ,Usr_Login
                                                                    ,Ludatetime
		                                                        FROM T_EmpAttendanceHdr
		                                                        WHERE Tah_PayCycle = @CURPAYPERIOD


                                                                INSERT INTO T_EmpAttendanceRuleHst
                                                                (Tar_ControlNo
                                                                ,Tar_RuleType
                                                                ,Tar_Timer
                                                                ,Tar_Classification
                                                                ,Tar_Amount
                                                                ,Usr_Login
                                                                ,Ludatetime)

                                                                SELECT A.Tar_ControlNo
                                                                ,A.Tar_RuleType
                                                                ,A.Tar_Timer
                                                                ,A.Tar_Classification
                                                                ,A.Tar_Amount
                                                                ,A.Usr_Login
                                                                ,A.Ludatetime
                                                                FROM T_EmpAttendanceRule A
                                                                INNER JOIN T_EmpAttendanceHdr B
		                                                        ON B.Tah_ControlNo = A.Tar_ControlNo 
			                                                        AND B.Tah_PayCycle = @CURPAYPERIOD

                                                                IF (SELECT Tah_WithTimer FROM T_EmpAttendanceHdr WHERE Tah_PayCycle = @CURPAYPERIOD) = 1
                                                                BEGIN
                                                                    INSERT INTO {0}..T_EmpAttendanceLdgtrl
                                                                    SELECT A.* FROM {0}..T_EmpAttendanceLdg  A
                                                                    INNER JOIN T_EmpAttendanceDtl B
		                                                                  ON A.Tal_IDNo = B.Tad_IDNo
                                                                    INNER JOIN T_EmpAttendanceHdr C 
                                                                          ON C.Tah_ControlNo = B.Tad_ControlNo
                                                                          AND A.Tal_RuleCode = C.Tah_RuleCode
			                                                              AND C.Tah_PayCycle = @CURPAYPERIOD

                                                                    UPDATE {0}..T_EmpAttendanceLdg 
                                                                    SET Tal_PrevTimer = Tal_Timer
                                                                    , Tal_UpdatedBy = @UserLogin
                                                                    , Tal_UpdatedDate = GETDATE()
                                                                    FROM {0}..T_EmpAttendanceLdg A
                                                                    INNER JOIN T_EmpAttendanceDtl B
		                                                                 ON A.Tal_IDNo = B.Tad_IDNo
                                                                    INNER JOIN T_EmpAttendanceHdr C 
                                                                         ON C.Tah_ControlNo = B.Tad_ControlNo
										                                 AND A.Tal_RuleCode = C.Tah_RuleCode
										                                 AND C.Tah_PayCycle = @CURPAYPERIOD
                                                                END

                                                                UPDATE T_LastTransaction 
												                SET Tlt_LastEffectivity = Tah_Effectivity
												                , Tlt_UpdatedBy = @UserLogin
												                , Tlt_UpdatedDate = GETDATE()
												                FROM T_LastTransaction 
												                INNER JOIN T_EmpAttendanceHdr 
                                                                        ON Tah_RuleCode = Tlt_TransactionCode
												                        AND Tah_PayCycle = @CURPAYPERIOD

                                                                
                                                                DELETE FROM T_EmpAttendanceException 
                                                                FROM T_EmpAttendanceException A
                                                                INNER JOIN T_EmpAttendanceDtl B
		                                                            ON A.Tap_ControlNo = B.Tad_ControlNo
                                                                    AND A.Tap_LineNo = B.Tad_LineNo
                                                                INNER JOIN T_EmpAttendanceHdr C 
                                                                    ON C.Tah_ControlNo = B.Tad_ControlNo
			                                                        AND C.Tah_PayCycle = @CURPAYPERIOD

		                                                        DELETE FROM T_EmpAttendanceDtl
		                                                        FROM T_EmpAttendanceDtl
		                                                        INNER JOIN T_EmpAttendanceHdr 
                                                                    ON Tah_ControlNo = Tad_ControlNo 
			                                                        AND Tah_PayCycle = @CURPAYPERIOD

                                                                
		                                                        DELETE FROM T_EmpAttendanceRule
		                                                        FROM T_EmpAttendanceRule
		                                                        INNER JOIN T_EmpAttendanceHdr ON Tah_ControlNo = Tar_ControlNo 
			                                                        AND Tah_PayCycle = @CURPAYPERIOD

		                                                        DELETE FROM  T_EmpAttendanceHdr
		                                                        WHERE Tah_PayCycle = @CURPAYPERIOD
   
                                                           END";

            public const string insertDeleteHdrDtlBonus = @"IF ( SELECT ISNULL(COUNT(Tbh_ControlNo), 0)  FROM T_EmpBonusHdr WHERE Tbh_PayCycle = @CURPAYPERIOD ) > 0 
	                                                        BEGIN
			                                                    INSERT INTO T_EmpBonusDtlHst 
			                                                    (Tbd_ControlNo
                                                                ,Tbd_LineNo
                                                                ,Tbd_IDNo
                                                                ,Tbd_SalaryRate
                                                                ,Tbd_PayrollType
                                                                ,Tbd_BaseAmt1
                                                                ,Tbd_BaseAmt2
                                                                ,Tbd_TotalBonusAmt
                                                                ,Tbd_AccumBonusBeforeThisCycle
                                                                ,Tbd_BonusNontaxableAmt
                                                                ,Tbd_BonusTaxableAmt
                                                                ,Tbd_PostFlag
                                                                ,Tbd_BaseChar
                                                                ,Tbd_BaseNum
                                                                ,Tbd_CostCenter
                                                                ,Tbd_PayrollGroup
                                                                ,Tbd_EmploymentStatus
                                                                ,Tbd_WorkStatus
                                                                ,Tbd_Grade
                                                                ,Tbd_RetainUserEntry
			                                                    , Usr_Login
			                                                    , Ludatetime)

			                                                    SELECT A.Tbd_ControlNo
                                                                    ,A.Tbd_LineNo
                                                                    ,A.Tbd_IDNo
                                                                    ,A.Tbd_SalaryRate
                                                                    ,A.Tbd_PayrollType
                                                                    ,A.Tbd_BaseAmt1
                                                                    ,A.Tbd_BaseAmt2
                                                                    ,A.Tbd_TotalBonusAmt
                                                                    ,A.Tbd_AccumBonusBeforeThisCycle
                                                                    ,A.Tbd_BonusNontaxableAmt
                                                                    ,A.Tbd_BonusTaxableAmt
                                                                    ,A.Tbd_PostFlag
                                                                    ,A.Tbd_BaseChar
                                                                    ,A.Tbd_BaseNum
                                                                    ,A.Tbd_CostCenter
                                                                    ,A.Tbd_PayrollGroup
                                                                    ,A.Tbd_EmploymentStatus
                                                                    ,A.Tbd_WorkStatus
                                                                    ,A.Tbd_Grade
                                                                    ,A.Tbd_RetainUserEntry
				                                                    ,A.Usr_Login
				                                                    ,A.Ludatetime
			                                                    FROM T_EmpBonusDtl A
			                                                    INNER JOIN T_EmpBonusHdr B ON B.Tbh_ControlNo = A.Tbd_ControlNo 
				                                                    AND B.Tbh_PayCycle = @CURPAYPERIOD 

			                                                    INSERT INTO T_EmpBonusHdrHst 
			                                                    (Tbh_ControlNo
                                                                ,Tbh_PayCycle
                                                                ,Tbh_BonusCode
                                                                ,Tbh_StartCoverage
                                                                ,Tbh_EndCoverage
                                                                ,Tbh_Mode
                                                                ,Tbh_BaseAmt1Formula
                                                                ,Tbh_BaseAmt2Formula
                                                                ,Tbh_BaseNumFormula
                                                                ,Tbh_BaseCharFormula
                                                                ,Tbh_BaseSalaryFormula
                                                                ,Tbh_BasePayrollTypeFormula
                                                                ,Tbh_BonusFormula
                                                                ,Tbh_BonusCheckFormula
                                                                ,Tbh_NontaxableCode
                                                                ,Tbh_TaxableCode
                                                                ,Tbh_IDNoLIst
                                                                ,Tbh_CostCenterList
                                                                ,Tbh_PayrollGroupList
                                                                ,Tbh_EmploymentStatusList
                                                                ,Tbh_PayrollTypeList
                                                                ,Tbh_WorkStatusList
                                                                ,Tbh_GradeList
                                                                ,Tbh_HireRegOption
                                                                ,Tbh_HireRegDate
                                                                ,Tbh_OverrideBonusCeiling
                                                                ,Tbh_TaxCompensationLevel
                                                                ,Tbh_RecordStatus
			                                                    ,Usr_Login
			                                                    ,Ludatetime)

			                                                    SELECT Tbh_ControlNo
                                                                    ,Tbh_PayCycle
                                                                    ,Tbh_BonusCode
                                                                    ,Tbh_StartCoverage
                                                                    ,Tbh_EndCoverage
                                                                    ,Tbh_Mode
                                                                    ,Tbh_BaseAmt1Formula
                                                                    ,Tbh_BaseAmt2Formula
                                                                    ,Tbh_BaseNumFormula
                                                                    ,Tbh_BaseCharFormula
                                                                    ,Tbh_BaseSalaryFormula
                                                                    ,Tbh_BasePayrollTypeFormula
                                                                    ,Tbh_BonusFormula
                                                                    ,Tbh_BonusCheckFormula
                                                                    ,Tbh_NontaxableCode
                                                                    ,Tbh_TaxableCode
                                                                    ,Tbh_IDNoLIst
                                                                    ,Tbh_CostCenterList
                                                                    ,Tbh_PayrollGroupList
                                                                    ,Tbh_EmploymentStatusList
                                                                    ,Tbh_PayrollTypeList
                                                                    ,Tbh_WorkStatusList
                                                                    ,Tbh_GradeList
                                                                    ,Tbh_HireRegOption
                                                                    ,Tbh_HireRegDate
                                                                    ,Tbh_OverrideBonusCeiling
                                                                    ,Tbh_TaxCompensationLevel
                                                                    ,Tbh_RecordStatus
				                                                    ,Usr_Login
				                                                    ,Ludatetime
			                                                    FROM T_EmpBonusHdr
			                                                    WHERE Tbh_PayCycle = @CURPAYPERIOD

			                                                    DELETE FROM T_EmpBonusDtl
			                                                    FROM T_EmpBonusDtl
			                                                    INNER JOIN T_EmpBonusHdr ON Tbh_ControlNo = Tbd_ControlNo 
				                                                    AND Tbh_PayCycle = @CURPAYPERIOD

			                                                    DELETE FROM  T_EmpBonusHdr
			                                                    WHERE Tbh_PayCycle = @CURPAYPERIOD
	                                                    END";

            public const string updatePosting21 = @"declare @DateCompare as datetime set @DateCompare = (SELECT Tps_EndCycle FROM T_PaySchedule WHERE Tps_PayCycle = @CURPAYPERIOD)
                                                    UPDATE M_Employee
                                                    SET Mem_Age  = CASE
                                                           WHEN dateadd(year, datediff (year, Mem_BirthDate, @DateCompare), Mem_BirthDate) > @DateCompare
                                                        THEN datediff (year, Mem_BirthDate, @DateCompare) - 1
                                                                                 ELSE datediff (year, Mem_BirthDate, @DateCompare) END
                                                                                 WHERE Mem_BirthDate is not null AND (CASE
                                                           WHEN dateadd(year, datediff (year, Mem_BirthDate, @DateCompare), Mem_BirthDate) > @DateCompare
                                                        THEN datediff (year, Mem_BirthDate, @DateCompare) - 1
                                                                                 ELSE datediff (year, Mem_BirthDate, @DateCompare) END) > 0";

            public const string transferOffsetToHistory = @"INSERT INTO T_EmployeeOffsetHist
                                                            SELECT A.* FROM  T_EmployeeOffset A
                                                            Left Join T_EmployeeOffsetHist B
                                                            On A.Eof_CurrentPayPeriod = B.Eof_CurrentPayPeriod
                                                            And A.Eof_EmployeeId = B.Eof_EmployeeId
                                                            And A.Eof_OffsetDate = B.Eof_OffsetDate
                                                            And A.Eof_Seqno = B.Eof_Seqno
                                                            WHERE A.Eof_CurrentPayPeriod = @CURPAYPERIOD
                                                            AND A.Eof_Status in ('0','A')
                                                            AND B.Eof_CurrentPayPeriod Is Null";

            public const string updateSettingControl = @"DECLARE @PayCycle as char(7) = (Select Tps_PayCycle From T_PaySchedule
                                                    Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A')

                                                   UPDATE T_SettingControl
                                                    SET Tsc_SetFlag = 0
	                                                    ,Usr_Login = @UserLogin
                                                    WHERE Tsc_SystemCode = 'PAYROLL'
	                                                    AND Tsc_SettingCode = 'CYCLEOPEN'

                                                    SELECT  Tsc_SystemCode
                                                         , Tsc_SettingCode
                                                         , Tsc_SettingName
                                                         , 0
                                                         , Tsc_AccessType
                                                         , @PayCycle
                                                         , NULL
                                                         , 'A'
                                                         , @UserLogin
                                                         , GETDATE()
                                                    FROM T_SettingControl
                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                    AND Tsc_SettingCode = 'CYCLEOPEN'

                                                    IF RIGHT(@CURPAYPERIOD, 3) = '122'
                                                    BEGIN
	                                                    UPDATE T_SettingControl
	                                                    SET Tsc_SetFlag = 0
		                                                    ,Usr_Login = @UserLogin
	                                                    WHERE Tsc_SystemCode = 'PAYROLL'
		                                                    AND Tsc_SettingCode ='YEAREND'
                                                    END";
            /////Move Refund records to History
            public const string transferLeaveRefund = @"IF ( SELECT ISNULL(COUNT(Tlh_ControlNo), 0)  FROM T_EmpLeaveRefundHdr WHERE Tlh_PayCycle = @CurPayPeriod) > 0 

	BEGIN
	
		INSERT INTO T_EmpLeaveRefundDtlHst (Tld_ControlNo, Tld_LineNo, Tld_IDNo, Tld_LeaveCode, Tld_LeaveHr, Tld_LeaveAmt, Tld_LeaveNontaxableHr, 
        Tld_LeaveNontaxableAmt, Tld_LeaveTaxableHr, Tld_LeaveTaxableAmt, Tld_SalaryRate, Tld_HourlyDailyRate, Tld_PostFlag, Tld_CostCenter, Tld_PayrollGroup, Tld_EmploymentStatus, Tld_PayrollType, Tld_Position, Tld_Grade, Usr_Login, Ludatetime)
		SELECT Tld_ControlNo
			, Tld_LineNo
			, Tld_IDNo
			, Tld_LeaveCode
			, Tld_LeaveHr
			, Tld_LeaveAmt
			, Tld_LeaveNontaxableHr
			, Tld_LeaveNontaxableAmt
			, Tld_LeaveTaxableHr
			, Tld_LeaveTaxableAmt
			, Tld_SalaryRate
			, Tld_HourlyDailyRate
			, Tld_PostFlag
			, Tld_CostCenter
			, Tld_PayrollGroup
			, Tld_EmploymentStatus
			, Tld_PayrollType
			, Tld_Position
			, Tld_Grade
			, Usr_Login
			, Ludatetime
		FROM T_EmpBonusDtl
		INNER JOIN T_EmpBonusHdr ON Tbh_ControlNo = Tbd_ControlNo 
			AND Tbh_PayCycle = @CurPayPeriod

		INSERT INTO T_EmpLeaveRefundHdrHst (Tlh_ControlNo, Tlh_PayCycle, Tlh_IDNoLIst, Tlh_CostCenterList, Tlh_PayrollGroupList, 
            Tlh_EmploymentStatusList, Tlh_PayrollTypeList, Tlh_PositionList, Tlh_GradeList, Tlh_HireRegOption, Tlh_HireRegDate, Usr_Login, Ludatetime)
		SELECT Tlh_ControlNo
			, Tlh_PayCycle
			, Tlh_IDNoLIst
			, Tlh_CostCenterList
			, Tlh_PayrollGroupList
			, Tlh_EmploymentStatusList
			, Tlh_PayrollTypeList
			, Tlh_PositionList
			, Tlh_GradeList
			, Tlh_HireRegOption
			, Tlh_HireRegDate
			, Usr_Login
			, Ludatetime
		FROM T_EmpLeaveRefundHdr
		WHERE Tlh_PayCycle = @CurPayPeriod

		DELETE FROM T_EmpLeaveRefundDtl
		FROM T_EmpLeaveRefundDtl
		INNER JOIN T_EmpLeaveRefundHdr ON Tlh_ControlNo = Tld_ControlNo 
			AND Tlh_PayCycle = @CurPayPeriod

		DELETE FROM  T_EmpLeaveRefundHdr
		WHERE Tlh_PayCycle = @CurPayPeriod
   
   END";


            public const string transferCurrentDeductionDetailBilling = @"Insert into T_EmpDeductionDtlHistBilling
                                                    Select A.* from T_EmpDeductionDtlBilling A
                                                    LEFT JOIN T_EmpDeductionDtlHistBilling B
                                                    ON A.Tdd_IDNo = B.Tdd_IDNo
                                                    AND A.Tdd_DeductionCode = B.Tdd_DeductionCode
                                                    AND A.Tdd_StartDate = B.Tdd_StartDate
                                                    AND A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle
                                                    AND A.Tdd_PayCycle = B.Tdd_PayCycle
                                                    AND A.Tdd_LineNo = B.Tdd_LineNo
                                                    WHERE B.Ludatetime IS NULL";
            public const string transferCurrentDeductionDetailTax = @"Insert into T_EmpDeductionDtlHistTax
                                                    Select A.* from T_EmpDeductionDtlTax A
                                                    LEFT JOIN T_EmpDeductionDtlHistTax B
                                                    ON A.Tdd_IDNo = B.Tdd_IDNo
                                                    AND A.Tdd_DeductionCode = B.Tdd_DeductionCode 
                                                    AND A.Tdd_StartDate = B.Tdd_StartDate 
                                                    AND A.Tdd_ThisPayCycle = B.Tdd_ThisPayCycle 
                                                    AND A.Tdd_PayCycle = B.Tdd_PayCycle 
                                                    AND A.Tdd_LineNo = B.Tdd_LineNo 
                                                    WHERE B.Ludatetime IS NULL";

            public const string transferCurrentCyclePayrollBilling = @"Insert into T_EmpPayrollYearlyBilling
                                                    Select A.* from T_EmpPayrollBilling A
                                                    LEFT JOIN T_EmpPayrollYearlyBilling B
                                                    ON A.Tpy_IDNo = B.Tpy_IDNo
                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE B.Ludatetime IS NULL

                                                    Insert into T_EmpPayrollYearlyBillingExt
                                                    Select A.* from T_EmpPayrollBillingExt A
                                                    LEFT JOIN T_EmpPayrollYearlyBillingExt B
                                                    ON A.Tpy_IDNo = B.Tpy_IDNo
                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE B.Ludatetime IS NULL";
            public const string transferCurrentCyclePayrollTax = @"Insert Into T_EmpPayrollYearlyTax
                                                    Select A.* from T_EmpPayrollTax A
                                                    LEFT JOIN T_EmpPayrollYearlyTax B
                                                    ON A.Tpy_IDNo = B.Tpy_IDNo
                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE B.Ludatetime IS NULL

                                                    Insert Into T_EmpPayrollYearlyTaxExt
                                                    Select A.* from T_EmpPayrollTaxExt A
                                                    LEFT JOIN T_EmpPayrollYearlyTaxExt B
                                                    ON A.Tpy_IDNo = B.Tpy_IDNo
                                                    AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                    WHERE B.Ludatetime IS NULL";

            public const string transferPayrollErrorBilling = @"Insert into T_EmpPayrollCheckHstBilling
                                                    Select A.* from T_EmpPayrollCheckBilling A
                                                    LEFT JOIN T_EmpPayrollCheckHstBilling B
                                                    ON A.Tpc_IDNo = B.Tpc_IDNo
                                                    AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                    WHERE B.Ludatetime IS NULL";
            public const string transferPayrollErrorTax = @"Insert into T_EmpPayrollCheckHstTax
                                                    Select A.* from T_EmpPayrollCheckTax A
                                                    LEFT JOIN T_EmpPayrollCheckHstTax B
                                                    ON A.Tpc_IDNo = B.Tpc_IDNo
                                                    AND A.Tpc_PayCycle = B.Tpc_PayCycle
                                                    WHERE B.Ludatetime IS NULL ";
            public const string updateMovementTransaction = @"UPDATE T_Movement
                                                    SET Mve_Status = 2
                                                        , Mve_Reason = 'CANCELLED BY CYCLE CLOSING'
                                                        , Usr_Login = 'SA'
                                                        , Ludatetime = getdate()
                                                    WHERE Mve_Status NOT IN ('9', 'A')
                                                    AND Mve_Flag = 'C'";
            #endregion
            #region [For Premium and Loan Remittances]
            #region SSS Prem
            public const string SSSPremPosting = @"
                            INSERT INTO {0}..T_EmpGovPremRemittance 
                            (Tgp_PayCycleMonth
							, Tgp_DeductionCode
							, Tgp_IDNo
							, Tgp_ERShare
							, Tgp_EEShare
							, Tgp_ECShare
                            , Tgp_MPFERShare
                            , Tgp_MPFEEShare
							, Tgp_SalaryBase
                            , Tgp_BaseAmount
							, Tgp_RemCode
							, Tgp_RemDate
							, Tgp_EntryType
							, Usr_Login
							, Ludatetime)
                            SELECT LEFT(Tpy_Paycycle,6)
	                            ,Tgp_DeductionCode ='SSSPREM'
	                            ,Tpy_IDNo
	                            ,0.00
	                            ,0.00
	                            ,0.00
	                            ,0.00
	                            ,0.00
                                ,0.00
	                            ,0.00
	                            ,'N'					
	                            ,NULL
	                            ,'R'
	                            ,T_EmpPayroll.Usr_Login
	                            ,GETDATE()
                            FROM T_EmpPayroll
                            INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						    	AND Mpf_IncludePayroll = 1
                            LEFT JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                            AND Tgp_IDNo = Tpy_IDNo
	                            AND Tgp_DeductionCode = 'SSSPREM'
                            WHERE Tpy_PayCycle = @CurPayPeriod
	                            AND Tgp_IDNo IS NULL

                            UPDATE {0}..T_EmpGovPremRemittance
                            SET  Tgp_ERShare = Tgp_ERShare + Tpy_SSSER 
	                            ,Tgp_EEShare = Tgp_EEShare + Tpy_SSSEE + ISNULL(Deduction.Tdd_Amount,0) - ISNULL(Income.Tin_IncomeAmt,0)  
	                            ,Tgp_ECShare = Tgp_ECShare + Tpy_ECFundAmt
                                ,Tgp_MPFERShare = Tgp_MPFERShare + Tpy_MPFER 
                                ,Tgp_MPFEEShare = Tgp_MPFEEShare + Tpy_MPFEE + ISNULL(DeductionMPF.Tdd_Amount,0) - ISNULL(IncomeMPF.Tin_IncomeAmt,0) 
	                            ,Tgp_SalaryBase = ISNULL(Mps_MonthlySalaryCredit,0)
	                            ,Tgp_BaseAmount = Tgp_BaseAmount + Tpy_SSSBaseAmt
	                            ,Tgp_RemCode = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'H'
					                            WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'S'
					                            ELSE Tgp_RemCode END					
	                            ,Tgp_RemDate = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_IntakeDate
					                            WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_SeparationDate
					                            ELSE Tgp_RemDate END
	                            ,Usr_Login =T_EmpPayroll.Usr_Login
	                            ,Ludatetime=GETDATE()
                            FROM T_EmpPayroll
                            INNER JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                            AND Tgp_IDNo = Tpy_IDNo
	                            AND Tgp_DeductionCode = 'SSSPREM'
                            INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                            INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                            INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						    	AND Mpf_IncludePayroll = 1
                            LEFT JOIN ( SELECT Tdd_IDNo, SUM(Tdd_Amount) as Tdd_Amount
			                            FROM T_EmpDeductionDtl
			                            INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                            AND Mdn_CompanyCode = @CompanyCode
				                            AND Mdn_DeductionGroup ='SA'
			                            WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                            AND Tdd_PaymentFlag = 1
				                            AND Tdd_PaymentType = 'P'
			                            GROUP BY Tdd_IDNo ) Deduction on Deduction.Tdd_IDNo = Tpy_IDNo
                            LEFT JOIN ( SELECT Tdd_IDNo, SUM(Tdd_Amount) as Tdd_Amount
			                            FROM T_EmpDeductionDtl
			                            INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                            AND Mdn_CompanyCode = @CompanyCode
				                            AND Mdn_DeductionGroup ='MA'
			                            WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                            AND Tdd_PaymentFlag = 1
				                            AND Tdd_PaymentType = 'P'
			                            GROUP BY Tdd_IDNo ) DeductionMPF on DeductionMPF.Tdd_IDNo = Tpy_IDNo
                            LEFT JOIN ( SELECT Tin_IDNo, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                            FROM T_EmpIncome
			                            INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                            AND Min_CompanyCode = @CompanyCode
				                            AND Min_IncomeGroup ='GSA'
			                            WHERE Tin_PayCycle = @CurPayPeriod
				                            AND Tin_PostFlag = 1
			                            GROUP BY Tin_IDNo ) Income on Income.Tin_IDNo = Tpy_IDNo
                            LEFT JOIN ( SELECT Tin_IDNo, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                            FROM T_EmpIncome
			                            INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                            AND Min_CompanyCode = @CompanyCode
				                            AND Min_IncomeGroup ='GMA'
			                            WHERE Tin_PayCycle = @CurPayPeriod
				                            AND Tin_PostFlag = 1
			                            GROUP BY Tin_IDNo ) IncomeMPF on IncomeMPF.Tin_IDNo = Tpy_IDNo
                            LEFT JOIN {0}..M_PremiumSchedule on Mps_DeductionCode =  'SSSPREM'
	                            AND Mps_CompanyCode = @CompanyCode
	                            AND Mps_EEShare = Tgp_EEShare + Tpy_SSSEE + ISNULL(Deduction.Tdd_Amount,0) - ISNULL(Income.Tin_IncomeAmt,0) 
	                            AND Mps_MPFEEShare = Tgp_MPFEEShare + Tpy_MPFEE + ISNULL(DeductionMPF.Tdd_Amount,0) - ISNULL(IncomeMPF.Tin_IncomeAmt,0) 
                                AND Mps_PayCycle = (SELECT MAX(Mps_PayCycle) FROM {0}..M_PremiumSchedule
							                                WHERE Mps_DeductionCode='SSSPREM'
								                            AND Mps_CompanyCode = @CompanyCode
							                                AND Mps_PayCycle <= @CurPayPeriod)
                            WHERE Tpy_PayCycle = @CurPayPeriod
                            ";
            public const string InsertDeleteSSSPrem = @"INSERT INTO {0}..T_EmpGovPremRemittanceHst
                                                        (Tgp_PayCycleMonth
							                                                        , Tgp_DeductionCode
							                                                        , Tgp_IDNo
							                                                        , Tgp_ERShare
							                                                        , Tgp_EEShare
							                                                        , Tgp_ECShare
                                                                                    , Tgp_MPFERShare
                                                                                    , Tgp_MPFEEShare
							                                                        , Tgp_SalaryBase
                                                                                    , Tgp_BaseAmount
							                                                        , Tgp_RemCode
							                                                        , Tgp_RemDate
							                                                        , Tgp_EntryType
							                                                        , Usr_Login
							                                                        , Ludatetime)
                                                        SELECT A.Tgp_PayCycleMonth
							                                                        , A.Tgp_DeductionCode
							                                                        , A.Tgp_IDNo
							                                                        , A.Tgp_ERShare
							                                                        , A.Tgp_EEShare
							                                                        , A.Tgp_ECShare
                                                                                    , A.Tgp_MPFERShare
                                                                                    , A.Tgp_MPFEEShare
							                                                        , A.Tgp_SalaryBase
                                                                                    , A.Tgp_BaseAmount
							                                                        , A.Tgp_RemCode
							                                                        , A.Tgp_RemDate
							                                                        , A.Tgp_EntryType
							                                                        , A.Usr_Login
							                                                        , A.Ludatetime
                                                    FROM {0}..T_EmpGovPremRemittance A
													INNER JOIN M_Employee ON Mem_IDNo = A.Tgp_IDNo
                                                    LEFT JOIN {0}..T_EmpGovPremRemittanceHst B
														ON A.Tgp_PayCycleMonth = B.Tgp_PayCycleMonth
														AND A.Tgp_DeductionCode = B.Tgp_DeductionCode
														AND A.Tgp_IDNo = B.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'SSSPREM'
                                                        AND B.Tgp_PayCycleMonth IS NULL

                                                    DELETE A 
                                                    FROM {0}..T_EmpGovPremRemittance A
                                                    INNER JOIN M_Employee B ON B.Mem_IDNo = A.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'SSSPREM'";
            #endregion
            #region PHIC Prem
            public const string PHICPremPosting = @"
                        INSERT INTO {0}..T_EmpGovPremRemittance 
                        (Tgp_PayCycleMonth
                        , Tgp_DeductionCode
                        , Tgp_IDNo
                        , Tgp_ERShare
                        , Tgp_EEShare
                        , Tgp_ECShare
                        , Tgp_MPFERShare
                        , Tgp_MPFEEShare
                        , Tgp_SalaryBase
                        , Tgp_BaseAmount
                        , Tgp_RemCode
                        , Tgp_RemDate
                        , Tgp_EntryType
                        , Usr_Login
                        , Ludatetime)
                        SELECT LEFT(Tpy_Paycycle,6)
	                        ,Tgp_DeductionCode ='PHICPREM'
	                        ,Tpy_IDNo
	                        ,0.00
	                        ,0.00
	                        ,0.00
	                        ,0.00
	                        ,0.00
                            ,0.00
	                        ,0.00
	                        ,'N'					
	                        ,NULL
	                        ,'R'
	                        ,T_EmpPayroll.Usr_Login
	                        ,GETDATE()
                        FROM T_EmpPayroll
                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						    AND Mpf_IncludePayroll = 1
                        LEFT JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                        AND Tgp_IDNo = Tpy_IDNo
	                        AND Tgp_DeductionCode = 'PHICPREM'
                        WHERE Tpy_PayCycle = @CurPayPeriod
	                        AND Tgp_IDNo IS NULL
                        
                        UPDATE {0}..T_EmpGovPremRemittance
                        SET  Tgp_ERShare = Tgp_ERShare + Tpy_PhilhealthER 
	                        ,Tgp_EEShare = Tgp_EEShare + Tpy_PhilhealthEE + ISNULL(Tdd_amount,0) - ISNULL(Tin_IncomeAmt,0)  
	                        ,Tgp_ECShare = 0.00
                            ,Tgp_MPFERShare = 0.00
                            ,Tgp_MPFEEShare = 0.00
	                        ,Tgp_SalaryBase = ISNULL(Mps_MonthlySalaryCredit,0)
	                        ,Tgp_BaseAmount = Tgp_BaseAmount + Tpy_PhilhealthBaseAmt
	                        ,Tgp_RemCode = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'H'
				                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'S'
				                        ELSE Tgp_RemCode END					
	                        ,Tgp_RemDate = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_IntakeDate
				                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_SeparationDate
				                        ELSE Tgp_RemDate END
	                        ,Usr_Login = T_EmpPayroll.Usr_Login
	                        ,Ludatetime=GETDATE()
                        FROM T_EmpPayroll
                        INNER JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                        AND Tgp_IDNo = Tpy_IDNo
	                        AND Tgp_DeductionCode = 'PHICPREM'
                        INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                        INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						    AND Mpf_IncludePayroll = 1
                        LEFT JOIN ( SELECT Tdd_IDNo, SUM(Tdd_amount) as Tdd_amount
			                        FROM T_EmpDeductionDtl
			                        INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                        AND Mdn_CompanyCode = @CompanyCode
				                        AND Mdn_DeductionGroup ='PA'
			                        WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                        AND Tdd_PaymentFlag = 1
				                        AND Tdd_PaymentType = 'P'
			                        GROUP BY Tdd_IDNo ) Deduction on Tdd_IDNo = Tpy_IDNo
                        LEFT JOIN ( SELECT Tin_IDNo, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                        FROM T_EmpIncome
			                        INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                        AND Min_CompanyCode = @CompanyCode
				                        AND Min_IncomeGroup ='GPA'
			                        WHERE Tin_PayCycle = @CurPayPeriod
				                        AND Tin_PostFlag = 1
			                        GROUP BY Tin_IDNo ) Income on Tin_IDNo = Tpy_IDNo
                         LEFT JOIN {0}..M_PremiumSchedule on Mps_DeductionCode =  'PHICPREM'
	                            AND Mps_CompanyCode = @CompanyCode
	                            AND Mps_EEShare = Tgp_EEShare + Tpy_PhilhealthEE + ISNULL(Tdd_amount,0) - ISNULL(Tin_IncomeAmt,0) 
	                            AND Mps_PayCycle = (SELECT MAX(Mps_PayCycle) FROM {0}..M_PremiumSchedule
							                                WHERE Mps_DeductionCode='PHICPREM'
								                            AND Mps_CompanyCode = @CompanyCode
							                                AND Mps_PayCycle <= @CurPayPeriod)
                        WHERE Tpy_PayCycle = @CurPayPeriod
                        ";

            public const string InsertDeletePHICPrem = @"INSERT INTO {0}..T_EmpGovPremRemittanceHst
                                                        (Tgp_PayCycleMonth
							                                                        , Tgp_DeductionCode
							                                                        , Tgp_IDNo
							                                                        , Tgp_ERShare
							                                                        , Tgp_EEShare
							                                                        , Tgp_ECShare
                                                                                    , Tgp_MPFERShare
                                                                                    , Tgp_MPFEEShare
							                                                        , Tgp_SalaryBase
                                                                                    , Tgp_BaseAmount
							                                                        , Tgp_RemCode
							                                                        , Tgp_RemDate
							                                                        , Tgp_EntryType
							                                                        , Usr_Login
							                                                        , Ludatetime)
                                                        SELECT A.Tgp_PayCycleMonth
							                                                        , A.Tgp_DeductionCode
							                                                        , A.Tgp_IDNo
							                                                        , A.Tgp_ERShare
							                                                        , A.Tgp_EEShare
							                                                        , A.Tgp_ECShare
                                                                                    , A.Tgp_MPFERShare
                                                                                    , A.Tgp_MPFEEShare
							                                                        , A.Tgp_SalaryBase
                                                                                    , A.Tgp_BaseAmount
							                                                        , A.Tgp_RemCode
							                                                        , A.Tgp_RemDate
							                                                        , A.Tgp_EntryType
							                                                        , A.Usr_Login
							                                                        , A.Ludatetime
                                                    FROM {0}..T_EmpGovPremRemittance A
													INNER JOIN M_Employee ON Mem_IDNo = A.Tgp_IDNo
                                                    LEFT JOIN {0}..T_EmpGovPremRemittanceHst B
														ON A.Tgp_PayCycleMonth = B.Tgp_PayCycleMonth
														AND A.Tgp_DeductionCode = B.Tgp_DeductionCode
														AND A.Tgp_IDNo = B.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'PHICPREM'
                                                        AND B.Tgp_PayCycleMonth IS NULL

                                                    DELETE A 
                                                    FROM {0}..T_EmpGovPremRemittance A
                                                    INNER JOIN M_Employee B ON Mem_IDNo = A.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'PHICPREM'";
            #endregion
            #region HDMF Prem
            public const string HDMFPremPosting = @"
                    INSERT INTO {0}..T_EmpGovPremRemittance 
                    (Tgp_PayCycleMonth
                        , Tgp_DeductionCode
                        , Tgp_IDNo
                        , Tgp_ERShare
                        , Tgp_EEShare
                        , Tgp_ECShare
                        , Tgp_MPFERShare
                        , Tgp_MPFEEShare
                        , Tgp_SalaryBase
                        , Tgp_BaseAmount
                        , Tgp_RemCode
                        , Tgp_RemDate
                        , Tgp_EntryType
                        , Usr_Login
                        , Ludatetime)
                    SELECT LEFT(Tpy_Paycycle,6)
	                    ,Tgp_DeductionCode ='HDMFPREM'
	                    ,Tpy_IDNo
	                    ,0.00
	                    ,0.00
	                    ,0.00
	                    ,0.00
	                    ,0.00
                        ,0.00
	                    ,0.00
	                    ,'N'				
	                    ,NULL
	                    ,'R'
	                    ,T_EmpPayroll.Usr_Login
	                    ,GETDATE()
                    FROM T_EmpPayroll
                    INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						AND Mpf_IncludePayroll = 1
                    LEFT JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                    AND Tgp_IDNo = Tpy_IDNo
	                    AND Tgp_DeductionCode = 'HDMFPREM'
                    WHERE Tpy_PayCycle = @CurPayPeriod
	                    AND Tgp_IDNo IS NULL


                    UPDATE {0}..T_EmpGovPremRemittance
                    SET  Tgp_ERShare = Tgp_ERShare + Tpy_PagIbigER 
	                    ,Tgp_EEShare = Tgp_EEShare  + Tpy_PagIbigEE + ISNULL(Tpy_PagIbigTaxEE, 0) + ISNULL(Tdd_amount,0) - ISNULL(Tin_IncomeAmt,0)  
	                    ,Tgp_ECShare = 0.00
                        ,Tgp_MPFERShare = 0.00
                        ,Tgp_MPFEEShare = 0.00
	                    ,Tgp_SalaryBase = 0.00
	                    ,Tgp_BaseAmount = Tpy_PagIbigBaseAmt
	                    ,Tgp_RemCode = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'H'
					                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'S'
					                   ELSE Tgp_RemCode END					
	                    ,Tgp_RemDate = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_IntakeDate
					                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN Mem_SeparationDate
					                    ELSE Tgp_RemDate END
	                    ,Tgp_EntryType = 'R'
	                    ,Usr_Login =T_EmpPayroll.Usr_Login
	                    ,Ludatetime=GETDATE()
                    FROM T_EmpPayroll
                    INNER JOIN {0}..T_EmpGovPremRemittance on Tgp_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                    AND Tgp_IDNo = Tpy_IDNo
	                    AND Tgp_DeductionCode = 'HDMFPREM'
                    INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                    INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                    INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
						AND Mpf_IncludePayroll = 1
                    LEFT JOIN ( SELECT Tdd_IDNo, SUM(Tdd_amount) as Tdd_amount
			                    FROM T_EmpDeductionDtl
			                    INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                    AND Mdn_CompanyCode = @CompanyCode
				                    AND Mdn_DeductionGroup ='HA'
			                    WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                    AND Tdd_PaymentFlag = 1
				                    AND Tdd_PaymentType = 'P'
			                    GROUP BY Tdd_IDNo ) Deduction on Tdd_IDNo = Tpy_IDNo
                    LEFT JOIN ( SELECT Tin_IDNo, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                    FROM T_EmpIncome
			                    INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                    AND Min_CompanyCode = @CompanyCode
				                    AND Min_IncomeGroup ='GHA'
			                    WHERE Tin_PayCycle = @CurPayPeriod
				                    AND Tin_PostFlag = 1
			                    GROUP BY Tin_IDNo ) Income on Tin_IDNo = Tpy_IDNo
                    WHERE Tpy_PayCycle = @CurPayPeriod";

            public const string InsertDeleteHDMFPrem = @"INSERT INTO {0}..T_EmpGovPremRemittanceHst
                                                        (Tgp_PayCycleMonth
							                                                        , Tgp_DeductionCode
							                                                        , Tgp_IDNo
							                                                        , Tgp_ERShare
							                                                        , Tgp_EEShare
							                                                        , Tgp_ECShare
                                                                                    , Tgp_MPFERShare
                                                                                    , Tgp_MPFEEShare
							                                                        , Tgp_SalaryBase
                                                                                    , Tgp_BaseAmount
							                                                        , Tgp_RemCode
							                                                        , Tgp_RemDate
							                                                        , Tgp_EntryType
							                                                        , Usr_Login
							                                                        , Ludatetime)
                                                        SELECT A.Tgp_PayCycleMonth
							                                                        , A.Tgp_DeductionCode
							                                                        , A.Tgp_IDNo
							                                                        , A.Tgp_ERShare
							                                                        , A.Tgp_EEShare
							                                                        , A.Tgp_ECShare
                                                                                    , A.Tgp_MPFERShare
                                                                                    , A.Tgp_MPFEEShare
							                                                        , A.Tgp_SalaryBase
                                                                                    , A.Tgp_BaseAmount
							                                                        , A.Tgp_RemCode
							                                                        , A.Tgp_RemDate
							                                                        , A.Tgp_EntryType
							                                                        , A.Usr_Login
							                                                        , A.Ludatetime
                                                    FROM {0}..T_EmpGovPremRemittance A
													INNER JOIN M_Employee ON Mem_IDNo = A.Tgp_IDNo
                                                    LEFT JOIN {0}..T_EmpGovPremRemittanceHst B
														ON A.Tgp_PayCycleMonth = B.Tgp_PayCycleMonth
														AND A.Tgp_DeductionCode = B.Tgp_DeductionCode
														AND A.Tgp_IDNo = B.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'HDMFPREM'
                                                        AND B.Tgp_PayCycleMonth IS NULL

                                                    DELETE A 
                                                    FROM {0}..T_EmpGovPremRemittance A
                                                    INNER JOIN M_Employee B ON B.Mem_IDNo = A.Tgp_IDNo
                                                    WHERE A.Tgp_PayCycleMonth = '{1}'
                                                        AND A.Tgp_DeductionCode = 'HDMFPREM'";
            #endregion
            #region No Earnings
            public const string PremiumNoEarnings = @"
                            DECLARE @CurrentEndCycle AS DATE= (SELECT CONVERT(DATE,Tps_EndCycle) FROM T_PaySchedule WHERE Tps_PayCycle = @CurPayPeriod)
                                                
	                        IF (SELECT ISNULL(Mgf_CreateNoEarning,0)
		                        FROM {0}..M_GovRemittance
		                        INNER JOIN {0}..M_GovRemittanceFile ON Mgf_CompanyCode = Mgr_CompanyCode 
			                        AND Mgf_RemittanceCode = Mgr_RemittanceCode
			                        AND Mgf_RemittanceFile = Mgr_RemittanceFile
			                        AND Mgf_BankFileLayout = Mgr_BankFileLayout
		                        WHERE Mgr_RemittanceCode = 'SSSPREM' -- post an error if no record retrieved
			                        AND Mgr_CompanyCode = @CompanyCode
			                        AND Mgf_CreateNoEarning = 1) = 1

		                        BEGIN
				                        INSERT INTO {0}..T_EmpGovPremRemittance 
                                        (Tgp_PayCycleMonth
                                        , Tgp_DeductionCode
                                        , Tgp_IDNo
                                        , Tgp_ERShare
                                        , Tgp_EEShare
                                        , Tgp_ECShare
                                        , Tgp_MPFERShare
                                        , Tgp_MPFEEShare
                                        , Tgp_SalaryBase
                                        , Tgp_BaseAmount
                                        , Tgp_RemCode
                                        , Tgp_RemDate
                                        , Tgp_EntryType
                                        , Usr_Login
                                        , Ludatetime)
				                        SELECT LEFT(@CurPayPeriod,6)
					                        ,Tgp_DeductionCode ='SSSPREM'
					                        ,Mem_IDNo
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
                                            ,0.00
					                        ,0.00
					                        ,'X'					
					                        ,NULL
					                        ,'R'
					                        ,@UserLogin
					                        ,GETDATE()
				                        FROM M_Employee	
                                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							                AND Mpf_IncludePayroll = 1	
				                        LEFT JOIN T_EmpPayroll 	ON Tpy_Paycycle = @CurPayPeriod
					                        AND Tpy_IDNo = Mem_IDNo	
				                        WHERE Mem_WorkStatus like 'A%'		
					                        AND CONVERT(DATE,Mem_IntakeDate) <= @CurrentEndCycle
					                        AND Tpy_IDNo is null		
					                        AND Mem_SSSRule <> 'N'
		                        END

		                        ----PHPREM
	                        IF (SELECT ISNULL(Mgf_CreateNoEarning,0)
		                        FROM {0}..M_GovRemittance
		                        INNER JOIN {0}..M_GovRemittanceFile ON Mgf_CompanyCode = Mgr_CompanyCode 
			                        AND Mgf_RemittanceCode = Mgr_RemittanceCode
			                        AND Mgf_RemittanceFile = Mgr_RemittanceFile
			                        AND Mgf_BankFileLayout = Mgr_BankFileLayout
		                        WHERE Mgr_RemittanceCode = 'PHICPREM' -- post an error if no record retrieved
			                        AND Mgr_CompanyCode = @CompanyCode
			                        AND Mgf_CreateNoEarning = 1) = 1

		                        BEGIN
				                        INSERT INTO {0}..T_EmpGovPremRemittance 
                                        (Tgp_PayCycleMonth
                                        , Tgp_DeductionCode
                                        , Tgp_IDNo
                                        , Tgp_ERShare
                                        , Tgp_EEShare
                                        , Tgp_ECShare
                                        , Tgp_MPFERShare
                                        , Tgp_MPFEEShare
                                        , Tgp_SalaryBase
                                        , Tgp_BaseAmount
                                        , Tgp_RemCode
                                        , Tgp_RemDate
                                        , Tgp_EntryType
                                        , Usr_Login
                                        , Ludatetime)
				                        SELECT LEFT(@CurPayPeriod,6)
					                        ,Tgp_DeductionCode ='PHICPREM'
					                        ,Mem_IDNo
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
                                            ,0.00
					                        ,0.00
					                        ,'X'					
					                        ,NULL
					                        ,'R'
					                        ,@UserLogin
					                        ,GETDATE()
				                        FROM M_Employee	
                                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							                AND Mpf_IncludePayroll = 1		
				                        LEFT JOIN T_EmpPayroll ON Tpy_Paycycle = @CurPayPeriod
					                        AND Tpy_IDNo = Mem_IDNo	
				                        WHERE Mem_WorkStatus like 'A%'		
					                        AND CONVERT(DATE,Mem_IntakeDate) <= @CurrentEndCycle
					                        AND Tpy_IDNo is null		
					                        AND Mem_SSSRule <> 'N'
		                        END
                                                
		                        -----HDMFPREM
		                        IF (SELECT ISNULL(Mgf_CreateNoEarning,0)
			                        FROM {0}..M_GovRemittance
			                        INNER JOIN {0}..M_GovRemittanceFile ON Mgf_CompanyCode = Mgr_CompanyCode 
				                        AND Mgf_RemittanceCode = Mgr_RemittanceCode
				                        AND Mgf_RemittanceFile = Mgr_RemittanceFile
				                        AND Mgf_BankFileLayout = Mgr_BankFileLayout
			                        WHERE Mgr_RemittanceCode = 'HDMFPREM' -- post an error if no record retrieved
			                        AND Mgr_CompanyCode = @CompanyCode
			                        AND Mgf_CreateNoEarning = 1) = 1

		                        BEGIN
				                        INSERT INTO {0}..T_EmpGovPremRemittance 
                                        (Tgp_PayCycleMonth
                                        , Tgp_DeductionCode
                                        , Tgp_IDNo
                                        , Tgp_ERShare
                                        , Tgp_EEShare
                                        , Tgp_ECShare
                                        , Tgp_MPFERShare
                                        , Tgp_MPFEEShare
                                        , Tgp_SalaryBase
                                        , Tgp_BaseAmount
                                        , Tgp_RemCode
                                        , Tgp_RemDate
                                        , Tgp_EntryType
                                        , Usr_Login
                                        , Ludatetime)
				                        SELECT LEFT(@CurPayPeriod,6)
					                        ,Tgp_DeductionCode ='HDMFPREM'
					                        ,Mem_IDNo
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
					                        ,0.00
                                            ,0.00
					                        ,0.00
					                        ,'X'					
					                        ,NULL
					                        ,'R'
					                        ,@UserLogin
					                        ,GETDATE()
				                        FROM M_Employee	
                                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							                AND Mpf_IncludePayroll = 1			
				                        LEFT JOIN T_EmpPayroll ON Tpy_Paycycle = @CurPayPeriod
					                        AND Tpy_IDNo = Mem_IDNo	
				                        WHERE Mem_WorkStatus like 'A%'		
						                        AND CONVERT(DATE,Mem_IntakeDate) <= @CurrentEndCycle
						                        AND Tpy_IDNo is null		
						                        AND Mem_SSSRule <> 'N'

			                        END";
            #endregion
            #region SSS Loan
            public const string SSSLoanPosting = @"
                        INSERT INTO {0}..T_EmpGovLoanRemittance 
                        (Tgl_PayCycleMonth
                        , Tgl_DeductionCode
                        , Tgl_LoanType
                        , Tgl_IDNo
                        , Tgl_AmortPaid
                        , Tgl_PenaltyAmt
                        , Tgl_LoanAmt
                        , Tgl_LoanDate
                        , Tgl_RemCode
                        , Tgl_RemDate
                        , Tgl_DocumentNo
                        , Usr_Login
                        , Ludatetime)
                        SELECT LEFT(@CurPayPeriod,6)
	                        ,'SSSLOAN'
	                        ,Mcd_Code
	                        ,Tpy_IDNo
	                        ,0.00
	                        ,0.00
	                        ,0.00
	                        ,NULL
	                        ,NULL				
	                        ,NULL
	                        ,NULL
	                        ,T_EmpPayroll.Usr_Login
	                        ,GETDATE()
                        FROM T_EmpPayroll
                        LEFT JOIN {0}..T_EmpGovLoanRemittance on Tgl_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                        AND Tgl_IDNo = Tpy_IDNo
	                        AND Tgl_DeductionCode = 'SSSLOAN'
                        LEFT JOIN {0}..M_CodeDtl on Mcd_CodeType ='SSSLNTYPE'
	                        AND Mcd_CompanyCode = @CompanyCode
                        LEFT JOIN ( SELECT Tdd_IDNo, Mdn_RemittanceLoanType, SUM(Tdd_amount) as Tdd_amount, MAX(Tdh_PrincipalAmount) as Tdh_PrincipalAmount, MAX(Tdh_CheckDate) as Tdh_CheckDate, MAX(Tdh_AgreementNo) as Tdh_AgreementNo 
			                        FROM T_EmpDeductionDtl
			                        INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                        AND Mdn_CompanyCode = @CompanyCode
				                        AND Mdn_DeductionGroup ='LS'
			                        INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = Tdd_IDNo
				                        AND Tdh_DeductionCode = Tdd_DeductionCode
				                        AND Tdh_StartDate = Tdd_StartDate
			                        WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                        AND Tdd_PaymentFlag = 1
				                        AND Tdd_PaymentType = 'P'
			                        GROUP BY Tdd_IDNo, Mdn_RemittanceLoanType ) Deduction on Tdd_IDNo = Tpy_IDNo
					                        AND Mdn_RemittanceLoanType = Mcd_Code
                        LEFT JOIN ( SELECT Tin_IDNo, Min_RemittanceLoanType, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                        FROM T_EmpIncome
			                        INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                        AND Min_CompanyCode = @CompanyCode
				                        AND Min_IncomeGroup ='LSR'
			                        WHERE Tin_PayCycle = @CurPayPeriod
				                        AND Tin_PostFlag = 1
			                        GROUP BY Tin_IDNo,Min_RemittanceLoanType ) Income on Tin_IDNo = Tpy_IDNo
					                        AND Min_RemittanceLoanType = Mcd_Code
                        INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                        INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							AND Mpf_IncludePayroll = 1		
                        WHERE Tpy_PayCycle = @CurPayPeriod 
	                        AND Tgl_IDNo is null
	                        AND  (ISNULL(Tdd_amount,0) <> 0 OR ISNULL(Tin_IncomeAmt,0) <> 0)
    
                        UPDATE {0}..T_EmpGovLoanRemittance
                        SET  Tgl_AmortPaid = Tgl_AmortPaid + ISNULL(Tdd_amount,0) - ISNULL(Tin_IncomeAmt,0)
	                        ,Tgl_LoanAmt = ISNULL(Tdh_PrincipalAmount,0)
	                        ,Tgl_LoanDate = Tdh_CheckDate
	                        ,Tgl_RemCode = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'H'
						                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'S'
						                        ELSE Tgl_RemCode END					
	                        , Tgl_RemDate = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN CONVERT(DATE,Mem_IntakeDate)
						                        WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN CONVERT(DATE,Mem_SeparationDate)
						                        ELSE Tgl_RemDate END
	                        ,Tgl_DocumentNo = Tdh_AgreementNo
	                        ,Usr_Login =T_EmpPayroll.Usr_Login
	                        ,Ludatetime = GETDATE()
                        FROM T_EmpPayroll
                        INNER JOIN {0}..T_EmpGovLoanRemittance on Tgl_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                        AND Tgl_IDNo = Tpy_IDNo
	                        AND Tgl_DeductionCode = 'SSSLOAN'
                        LEFT JOIN ( SELECT Tdd_IDNo, Mdn_RemittanceLoanType, SUM(Tdd_amount) as Tdd_amount, MAX(Tdh_PrincipalAmount) as Tdh_PrincipalAmount, MAX(Tdh_CheckDate) as Tdh_CheckDate, MAX(Tdh_AgreementNo) as Tdh_AgreementNo 
			                        FROM T_EmpDeductionDtl
			                        INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                        AND Mdn_CompanyCode = @CompanyCode
				                        AND Mdn_DeductionGroup ='LS'
			                        INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = Tdd_IDNo
				                        AND Tdh_DeductionCode = Tdd_DeductionCode
				                        AND Tdh_StartDate = Tdd_StartDate
			                        WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                        AND Tdd_PaymentFlag = 1
				                        AND Tdd_PaymentType = 'P'
			                        GROUP BY Tdd_IDNo, Mdn_RemittanceLoanType ) Deduction on Tdd_IDNo = Tpy_IDNo
			                        AND Tgl_LoanType = Mdn_RemittanceLoanType
                        LEFT JOIN ( SELECT Tin_IDNo, Min_RemittanceLoanType, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                        FROM T_EmpIncome
			                        INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                        AND Min_CompanyCode = @CompanyCode
				                        AND Min_IncomeGroup ='LSR'
			                        WHERE Tin_PayCycle = @CurPayPeriod
				                        AND Tin_PostFlag = 1
			                        GROUP BY Tin_IDNo,Min_RemittanceLoanType ) Income on Tin_IDNo = Tpy_IDNo
			                        AND Tgl_LoanType = Min_RemittanceLoanType
                        INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                        INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                        INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							AND Mpf_IncludePayroll = 1
                        WHERE Tpy_PayCycle = @CurPayPeriod 
	                        AND Tgl_IDNo is not null
	                        AND  (ISNULL(Tdd_amount,0) <> 0 OR ISNULL(Tin_IncomeAmt,0) <> 0)

                        ";

            public const string InsertDeleteSSSLoan = @"INSERT INTO {0}..T_EmpGovLoanRemittanceHst
                                                                        (Tgl_PayCycleMonth
                                                                        , Tgl_DeductionCode
                                                                        , Tgl_LoanType
                                                                        , Tgl_IDNo
                                                                        , Tgl_AmortPaid
                                                                        , Tgl_PenaltyAmt
                                                                        , Tgl_LoanAmt
                                                                        , Tgl_LoanDate
                                                                        , Tgl_RemCode
                                                                        , Tgl_RemDate
                                                                        , Tgl_DocumentNo
                                                                        , Usr_Login
                                                                        , Ludatetime)
                                                        SELECT A.Tgl_PayCycleMonth
							                                        , A.Tgl_DeductionCode
							                                        , A.Tgl_LoanType
							                                        , A.Tgl_IDNo
							                                        , A.Tgl_AmortPaid
							                                        , A.Tgl_PenaltyAmt
							                                        , A.Tgl_LoanAmt
							                                        , A.Tgl_LoanDate
							                                        , A.Tgl_RemCode
							                                        , A.Tgl_RemDate
							                                        , A.Tgl_DocumentNo
							                                        , A.Usr_Login
							                                        , A.Ludatetime
                                                    FROM {0}..T_EmpGovLoanRemittance A
													INNER JOIN M_Employee ON Mem_IDNo = A.Tgl_IDNo
                                                    LEFT JOIN {0}..T_EmpGovLoanRemittanceHst B
														ON A.Tgl_PayCycleMonth = B.Tgl_PayCycleMonth
														AND A.Tgl_DeductionCode = B.Tgl_DeductionCode
														AND A.Tgl_IDNo = B.Tgl_IDNo
                                                    WHERE A.Tgl_PayCycleMonth = '{1}'
                                                        AND A.Tgl_DeductionCode = 'SSSLOAN'
                                                        AND B.Tgl_PayCycleMonth IS NULL

                                                    DELETE A
                                                    FROM {0}..T_EmpGovLoanRemittance A 
                                                    INNER JOIN M_Employee B ON B.Mem_IDNo = A.Tgl_IDNo
                                                    WHERE A.Tgl_PayCycleMonth = '{1}'
                                                        AND A.Tgl_DeductionCode = 'SSSLOAN'";
            #endregion
            #region HDMF Loan
            public const string HDMFLoanPosting = @"
                                --Newly-added loans for the period
                                INSERT INTO {0}..T_EmpGovLoanRemittance 
                                (Tgl_PayCycleMonth
                                , Tgl_DeductionCode
                                , Tgl_LoanType
                                , Tgl_IDNo
                                , Tgl_AmortPaid
                                , Tgl_PenaltyAmt
                                , Tgl_LoanAmt
                                , Tgl_LoanDate
                                , Tgl_RemCode
                                , Tgl_RemDate
                                , Tgl_DocumentNo
                                , Usr_Login
                                , Ludatetime)
                                SELECT LEFT(@CurPayPeriod,6)
	                                ,'HDMFLOAN'
	                                ,Mcd_Code
	                                ,Tpy_IDNo
	                                ,0.00
	                                ,0.00
	                                ,0.00
	                                ,NULL
	                                ,NULL					
	                                ,NULL
                                    ,NULL
	                                ,T_EmpPayroll.Usr_Login
	                                ,GETDATE()
                                FROM T_EmpPayroll
                                LEFT JOIN {0}..T_EmpGovLoanRemittance on Tgl_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                                AND Tgl_IDNo = Tpy_IDNo
	                                AND Tgl_DeductionCode = 'HDMFLOAN'
                                LEFT JOIN {0}..M_CodeDtl on Mcd_CodeType ='HDMFLNTYPE'
	                                AND Mcd_CompanyCode = @CompanyCode
                                LEFT JOIN ( SELECT Tdd_IDNo, Mdn_RemittanceLoanType, SUM(Tdd_amount) as Tdd_amount, MAX(Tdh_PrincipalAmount) as Tdh_PrincipalAmount, MAX(Tdh_CheckDate) as Tdh_CheckDate, MAX(Tdh_AgreementNo) as Tdh_AgreementNo 
			                                FROM T_EmpDeductionDtl
			                                INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                                AND Mdn_CompanyCode = @CompanyCode
				                                AND Mdn_DeductionGroup ='LP'
			                                INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = Tdd_IDNo
				                                AND Tdh_DeductionCode = Tdd_DeductionCode
				                                AND Tdh_StartDate = Tdd_StartDate
			                                WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                                AND Tdd_PaymentFlag = 1
				                                AND Tdd_PaymentType = 'P'
			                                GROUP BY Tdd_IDNo, Mdn_RemittanceLoanType ) Deduction on Tdd_IDNo = Tpy_IDNo
					                                AND Mdn_RemittanceLoanType = Mcd_Code
                                LEFT JOIN ( SELECT Tin_IDNo, Min_RemittanceLoanType, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                                FROM T_EmpIncome
			                                INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                                AND Min_CompanyCode = @CompanyCode
				                                AND Min_IncomeGroup ='LPR'
			                                WHERE Tin_PayCycle = @CurPayPeriod
				                                AND Tin_PostFlag = 1
			                                GROUP BY Tin_IDNo,Min_RemittanceLoanType ) Income on Tin_IDNo = Tpy_IDNo
					                                AND Min_RemittanceLoanType = Mcd_Code
                                INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                                INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                                INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							        AND Mpf_IncludePayroll = 1
                                WHERE Tpy_PayCycle = @CurPayPeriod 
	                                AND Tgl_IDNo is null
	                                AND (ISNULL(Tdd_amount,0) <> 0 OR ISNULL(Tin_IncomeAmt,0) <> 0)

                                UPDATE {0}..T_EmpGovLoanRemittance
                                SET  Tgl_AmortPaid = Tgl_AmortPaid + ISNULL(Tdd_amount,0) - ISNULL(Tin_IncomeAmt,0)
	                                ,Tgl_RemCode = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'H'
						                                WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN 'S'
						                                ELSE Tgl_RemCode END					
	                                ,Tgl_RemDate = CASE WHEN CONVERT(DATE,Mem_IntakeDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN CONVERT(DATE,Mem_IntakeDate)
						                                WHEN CONVERT(DATE,Mem_SeparationDate) BETWEEN CONVERT(DATE,Tps_StartCycle) AND CONVERT(DATE,Tps_EndCycle) THEN CONVERT(DATE,Mem_SeparationDate)
						                                ELSE Tgl_RemDate END
	                                ,Tgl_DocumentNo = Tdh_AgreementNo
	                                ,Usr_Login = T_EmpPayroll.Usr_Login
	                                ,Ludatetime = GETDATE()
                                FROM T_EmpPayroll
                                INNER JOIN {0}..T_EmpGovLoanRemittance on Tgl_PayCycleMonth = LEFT(@CurPayPeriod,6)
	                                AND Tgl_IDNo = Tpy_IDNo
	                                AND Tgl_DeductionCode = 'HDMFLOAN'
                                LEFT JOIN ( SELECT Tdd_IDNo, Mdn_RemittanceLoanType, SUM(Tdd_amount) as Tdd_amount, MAX(Tdh_PrincipalAmount) as Tdh_PrincipalAmount, MAX(Tdh_CheckDate) as Tdh_CheckDate, MAX(Tdh_AgreementNo) as Tdh_AgreementNo
			                                FROM T_EmpDeductionDtl
			                                INNER JOIN {0}..M_Deduction on Mdn_DeductionCode = Tdd_DeductionCode
				                                AND Mdn_CompanyCode = @CompanyCode
				                                AND Mdn_DeductionGroup ='LP'
			                                INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = Tdd_IDNo
				                                AND Tdh_DeductionCode = Tdd_DeductionCode
				                                AND Tdh_StartDate = Tdd_StartDate
			                                WHERE Tdd_ThisPayCycle = @CurPayPeriod
				                                AND Tdd_PaymentFlag = 1
				                                AND Tdd_PaymentType = 'P'
			                                GROUP BY Tdd_IDNo, Mdn_RemittanceLoanType ) Deduction on Tdd_IDNo = Tpy_IDNo
			                                AND Tgl_LoanType = Mdn_RemittanceLoanType
                                LEFT JOIN ( SELECT Tin_IDNo, Min_RemittanceLoanType, SUM(Tin_IncomeAmt) as Tin_IncomeAmt
			                                FROM T_EmpIncome
			                                INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
				                                AND Min_CompanyCode = @CompanyCode
				                                AND Min_IncomeGroup ='LPR'
			                                WHERE Tin_PayCycle = @CurPayPeriod
				                                AND Tin_PostFlag = 1
			                                GROUP BY Tin_IDNo,Min_RemittanceLoanType ) Income on Tin_IDNo = Tpy_IDNo
			                                AND Tgl_LoanType = Min_RemittanceLoanType
                                INNER JOIN M_Employee on Mem_IDNo = Tpy_IDNo
                                INNER JOIN T_PaySchedule on Tps_PayCycle = Tpy_PayCycle
                                INNER JOIN {0}..M_Profile ON Mpf_DatabaseNo = @ProfileCode
							        AND Mpf_IncludePayroll = 1
                                WHERE Tpy_PayCycle = @CurPayPeriod 
	                                AND Tgl_IDNo IS NOT NULL
	                                AND (ISNULL(Tdd_amount,0) <> 0 OR ISNULL(Tin_IncomeAmt,0) <> 0)
                                ";

            public const string InsertDeleteHDMFLoan = @"INSERT INTO {0}..T_EmpGovLoanRemittanceHst
                                                                        (Tgl_PayCycleMonth
                                                                        , Tgl_DeductionCode
                                                                        , Tgl_LoanType
                                                                        , Tgl_IDNo
                                                                        , Tgl_AmortPaid
                                                                        , Tgl_PenaltyAmt
                                                                        , Tgl_LoanAmt
                                                                        , Tgl_LoanDate
                                                                        , Tgl_RemCode
                                                                        , Tgl_RemDate
                                                                        , Tgl_DocumentNo
                                                                        , Usr_Login
                                                                        , Ludatetime)
                                                        SELECT A.Tgl_PayCycleMonth
							                                        , A.Tgl_DeductionCode
							                                        , A.Tgl_LoanType
							                                        , A.Tgl_IDNo
							                                        , A.Tgl_AmortPaid
							                                        , A.Tgl_PenaltyAmt
							                                        , A.Tgl_LoanAmt
							                                        , A.Tgl_LoanDate
							                                        , A.Tgl_RemCode
							                                        , A.Tgl_RemDate
							                                        , A.Tgl_DocumentNo
							                                        , A.Usr_Login
							                                        , A.Ludatetime
                                                    FROM {0}..T_EmpGovLoanRemittance A
													INNER JOIN M_Employee ON Mem_IDNo = A.Tgl_IDNo
                                                    LEFT JOIN {0}..T_EmpGovLoanRemittanceHst B
														ON A.Tgl_PayCycleMonth = B.Tgl_PayCycleMonth
														AND A.Tgl_DeductionCode = B.Tgl_DeductionCode
														AND A.Tgl_IDNo = B.Tgl_IDNo
                                                    WHERE A.Tgl_PayCycleMonth = '{1}'
                                                        AND A.Tgl_DeductionCode = 'HDMFLOAN'
                                                        AND B.Tgl_PayCycleMonth IS NULL

                                                    DELETE A
                                                    FROM {0}..T_EmpGovLoanRemittance A
                                                    INNER JOIN M_Employee B ON B.Mem_IDNo = A.Tgl_IDNo
                                                    WHERE A.Tgl_PayCycleMonth = '{1}'
                                                        AND A.Tgl_DeductionCode = 'HDMFLOAN'";
            #endregion
            #endregion
            #region [For Year-End House Keeping]
            public const string insertAnnualPayrollHistory = @"INSERT INTO T_EmpPayrollHst 
                                                                (Tpy_IDNo
                                                                , Tpy_PayCycle
                                                                , Tpy_SalaryRate
                                                                , Tpy_HourRate
                                                                , Tpy_SpecialRate
                                                                , Tpy_SpecialHourRate
                                                                , Tpy_LTHr
                                                                , Tpy_LTAmt
                                                                , Tpy_UTHr
                                                                , Tpy_UTAmt
                                                                , Tpy_UPLVHr
                                                                , Tpy_UPLVAmt
                                                                , Tpy_ABSLEGHOLHr
                                                                , Tpy_ABSLEGHOLAmt
                                                                , Tpy_ABSSPLHOLHr
                                                                , Tpy_ABSSPLHOLAmt
                                                                , Tpy_ABSCOMPHOLHr
                                                                , Tpy_ABSCOMPHOLAmt
                                                                , Tpy_ABSPSDHr
                                                                , Tpy_ABSPSDAmt
                                                                , Tpy_ABSOTHHOLHr
                                                                , Tpy_ABSOTHHOLAmt
                                                                , Tpy_WDABSHr
                                                                , Tpy_WDABSAmt
                                                                , Tpy_LTUTMaxHr
                                                                , Tpy_LTUTMaxAmt
                                                                , Tpy_ABSHr
                                                                , Tpy_ABSAmt
                                                                , Tpy_REGHr
                                                                , Tpy_REGAmt
                                                                , Tpy_PDLVHr
                                                                , Tpy_PDLVAmt
                                                                , Tpy_PDLEGHOLHr
                                                                , Tpy_PDLEGHOLAmt
                                                                , Tpy_PDSPLHOLHr
                                                                , Tpy_PDSPLHOLAmt
                                                                , Tpy_PDCOMPHOLHr
                                                                , Tpy_PDCOMPHOLAmt
                                                                , Tpy_PDPSDHr
                                                                , Tpy_PDPSDAmt
                                                                , Tpy_PDOTHHOLHr
                                                                , Tpy_PDOTHHOLAmt
                                                                , Tpy_PDRESTLEGHOLHr
                                                                , Tpy_PDRESTLEGHOLAmt
                                                                , Tpy_TotalREGHr
                                                                , Tpy_TotalREGAmt
                                                                , Tpy_REGOTHr
                                                                , Tpy_REGOTAmt
                                                                , Tpy_REGNDHr
                                                                , Tpy_REGNDAmt
                                                                , Tpy_REGNDOTHr
                                                                , Tpy_REGNDOTAmt
                                                                , Tpy_RESTHr
                                                                , Tpy_RESTAmt
                                                                , Tpy_RESTOTHr
                                                                , Tpy_RESTOTAmt
                                                                , Tpy_RESTNDHr
                                                                , Tpy_RESTNDAmt
                                                                , Tpy_RESTNDOTHr
                                                                , Tpy_RESTNDOTAmt
                                                                , Tpy_LEGHOLHr
                                                                , Tpy_LEGHOLAmt
                                                                , Tpy_LEGHOLOTHr
                                                                , Tpy_LEGHOLOTAmt
                                                                , Tpy_LEGHOLNDHr
                                                                , Tpy_LEGHOLNDAmt
                                                                , Tpy_LEGHOLNDOTHr
                                                                , Tpy_LEGHOLNDOTAmt
                                                                , Tpy_SPLHOLHr
                                                                , Tpy_SPLHOLAmt
                                                                , Tpy_SPLHOLOTHr
                                                                , Tpy_SPLHOLOTAmt
                                                                , Tpy_SPLHOLNDHr
                                                                , Tpy_SPLHOLNDAmt
                                                                , Tpy_SPLHOLNDOTHr
                                                                , Tpy_SPLHOLNDOTAmt
                                                                , Tpy_PSDHr
                                                                , Tpy_PSDAmt
                                                                , Tpy_PSDOTHr
                                                                , Tpy_PSDOTAmt
                                                                , Tpy_PSDNDHr
                                                                , Tpy_PSDNDAmt
                                                                , Tpy_PSDNDOTHr
                                                                , Tpy_PSDNDOTAmt
                                                                , Tpy_COMPHOLHr
                                                                , Tpy_COMPHOLAmt
                                                                , Tpy_COMPHOLOTHr
                                                                , Tpy_COMPHOLOTAmt
                                                                , Tpy_COMPHOLNDHr
                                                                , Tpy_COMPHOLNDAmt
                                                                , Tpy_COMPHOLNDOTHr
                                                                , Tpy_COMPHOLNDOTAmt
                                                                , Tpy_RESTLEGHOLHr
                                                                , Tpy_RESTLEGHOLAmt
                                                                , Tpy_RESTLEGHOLOTHr
                                                                , Tpy_RESTLEGHOLOTAmt
                                                                , Tpy_RESTLEGHOLNDHr
                                                                , Tpy_RESTLEGHOLNDAmt
                                                                , Tpy_RESTLEGHOLNDOTHr
                                                                , Tpy_RESTLEGHOLNDOTAmt
                                                                , Tpy_RESTSPLHOLHr
                                                                , Tpy_RESTSPLHOLAmt
                                                                , Tpy_RESTSPLHOLOTHr
                                                                , Tpy_RESTSPLHOLOTAmt
                                                                , Tpy_RESTSPLHOLNDHr
                                                                , Tpy_RESTSPLHOLNDAmt
                                                                , Tpy_RESTSPLHOLNDOTHr
                                                                , Tpy_RESTSPLHOLNDOTAmt
                                                                , Tpy_RESTCOMPHOLHr
                                                                , Tpy_RESTCOMPHOLAmt
                                                                , Tpy_RESTCOMPHOLOTHr
                                                                , Tpy_RESTCOMPHOLOTAmt
                                                                , Tpy_RESTCOMPHOLNDHr
                                                                , Tpy_RESTCOMPHOLNDAmt
                                                                , Tpy_RESTCOMPHOLNDOTHr
                                                                , Tpy_RESTCOMPHOLNDOTAmt
                                                                , Tpy_RESTPSDHr
                                                                , Tpy_RESTPSDAmt
                                                                , Tpy_RESTPSDOTHr
                                                                , Tpy_RESTPSDOTAmt
                                                                , Tpy_RESTPSDNDHr
                                                                , Tpy_RESTPSDNDAmt
                                                                , Tpy_RESTPSDNDOTHr
                                                                , Tpy_RESTPSDNDOTAmt
                                                                , Tpy_TotalOTNDAmt
                                                                , Tpy_WorkDay
                                                                , Tpy_DayCountOldSalaryRate
                                                                , Tpy_SRGAdjHr
                                                                , Tpy_SRGAdjAmt
                                                                , Tpy_SOTAdjHr
                                                                , Tpy_SOTAdjAmt
                                                                , Tpy_SHOLAdjHr
                                                                , Tpy_SHOLAdjAmt
                                                                , Tpy_SNDAdjHr
                                                                , Tpy_SNDAdjAmt
                                                                , Tpy_SLVAdjHr
                                                                , Tpy_SLVAdjAmt
                                                                , Tpy_MRGAdjHr
                                                                , Tpy_MRGAdjAmt
                                                                , Tpy_MOTAdjHr
                                                                , Tpy_MOTAdjAmt
                                                                , Tpy_MHOLAdjHr
                                                                , Tpy_MHOLAdjAmt
                                                                , Tpy_MNDAdjHr
                                                                , Tpy_MNDAdjAmt
                                                                , Tpy_TotalAdjAmt
                                                                , Tpy_TaxableIncomeAmt
                                                                , Tpy_TotalTaxableIncomeAmt
                                                                , Tpy_NontaxableIncomeAmt
                                                                , Tpy_GrossIncomeAmt
                                                                , Tpy_WtaxAmt
                                                                , Tpy_TaxBaseAmt
                                                                , Tpy_TaxRule
                                                                , Tpy_TaxShare
                                                                , Tpy_TaxBracket
                                                                , Tpy_TaxCode
                                                                , Tpy_IsTaxExempted
                                                                , Tpy_SSSEE
                                                                , Tpy_SSSER
                                                                , Tpy_ECFundAmt
                                                                , Tpy_SSSBaseAmt
                                                                , Tpy_SSSRule
                                                                , Tpy_SSSShare
                                                                , Tpy_MPFEE
                                                                , Tpy_MPFER
                                                                , Tpy_PhilhealthEE
                                                                , Tpy_PhilhealthER
                                                                , Tpy_PhilhealthBaseAmt
                                                                , Tpy_PhilhealthRule
                                                                , Tpy_PhilhealthShare
                                                                , Tpy_PagIbigEE
                                                                , Tpy_PagIbigER
                                                                , Tpy_PagIbigTaxEE
                                                                , Tpy_PagIbigBaseAmt
                                                                , Tpy_PagIbigRule
                                                                , Tpy_PagIbigShare
                                                                , Tpy_UnionAmt
                                                                , Tpy_UnionRule
                                                                , Tpy_UnionShare
                                                                , Tpy_UnionBaseAmt
                                                                , Tpy_OtherDeductionAmt
                                                                , Tpy_TotalDeductionAmt
                                                                , Tpy_NetAmt
                                                                , Tpy_CostcenterCode
                                                                , Tpy_PositionCode
                                                                , Tpy_EmploymentStatus
                                                                , Tpy_PayrollType
                                                                , Tpy_PaymentMode
                                                                , Tpy_BankCode
                                                                , Tpy_BankAcctNo
                                                                , Tpy_PayrollGroup
                                                                , Tpy_CalendarGrpCode
                                                                , Tpy_WorkLocationCode
                                                                , Tpy_AltAcctCode
                                                                , Tpy_ExpenseClass
                                                                , Tpy_PositionGrade
                                                                , Tpy_WorkStatus
                                                                , Tpy_PremiumGrpCode
                                                                , Tpy_IsComputedPerDay
                                                                , Tpy_IsMultipleSalary
                                                                , Tpy_RegRule
                                                                , Usr_Login
                                                                , Ludatetime)

                                                                SELECT A.Tpy_IDNo
                                                                    , A.Tpy_PayCycle
                                                                    , A.Tpy_SalaryRate
                                                                    , A.Tpy_HourRate
                                                                    , A.Tpy_SpecialRate
                                                                    , A.Tpy_SpecialHourRate
                                                                    , A.Tpy_LTHr
                                                                    , A.Tpy_LTAmt
                                                                    , A.Tpy_UTHr
                                                                    , A.Tpy_UTAmt
                                                                    , A.Tpy_UPLVHr
                                                                    , A.Tpy_UPLVAmt
                                                                    , A.Tpy_ABSLEGHOLHr
                                                                    , A.Tpy_ABSLEGHOLAmt
                                                                    , A.Tpy_ABSSPLHOLHr
                                                                    , A.Tpy_ABSSPLHOLAmt
                                                                    , A.Tpy_ABSCOMPHOLHr
                                                                    , A.Tpy_ABSCOMPHOLAmt
                                                                    , A.Tpy_ABSPSDHr
                                                                    , A.Tpy_ABSPSDAmt
                                                                    , A.Tpy_ABSOTHHOLHr
                                                                    , A.Tpy_ABSOTHHOLAmt
                                                                    , A.Tpy_WDABSHr
                                                                    , A.Tpy_WDABSAmt
                                                                    , A.Tpy_LTUTMaxHr
                                                                    , A.Tpy_LTUTMaxAmt
                                                                    , A.Tpy_ABSHr
                                                                    , A.Tpy_ABSAmt
                                                                    , A.Tpy_REGHr
                                                                    , A.Tpy_REGAmt
                                                                    , A.Tpy_PDLVHr
                                                                    , A.Tpy_PDLVAmt
                                                                    , A.Tpy_PDLEGHOLHr
                                                                    , A.Tpy_PDLEGHOLAmt
                                                                    , A.Tpy_PDSPLHOLHr
                                                                    , A.Tpy_PDSPLHOLAmt
                                                                    , A.Tpy_PDCOMPHOLHr
                                                                    , A.Tpy_PDCOMPHOLAmt
                                                                    , A.Tpy_PDPSDHr
                                                                    , A.Tpy_PDPSDAmt
                                                                    , A.Tpy_PDOTHHOLHr
                                                                    , A.Tpy_PDOTHHOLAmt
                                                                    , A.Tpy_PDRESTLEGHOLHr
                                                                    , A.Tpy_PDRESTLEGHOLAmt
                                                                    , A.Tpy_TotalREGHr
                                                                    , A.Tpy_TotalREGAmt
                                                                    , A.Tpy_REGOTHr
                                                                    , A.Tpy_REGOTAmt
                                                                    , A.Tpy_REGNDHr
                                                                    , A.Tpy_REGNDAmt
                                                                    , A.Tpy_REGNDOTHr
                                                                    , A.Tpy_REGNDOTAmt
                                                                    , A.Tpy_RESTHr
                                                                    , A.Tpy_RESTAmt
                                                                    , A.Tpy_RESTOTHr
                                                                    , A.Tpy_RESTOTAmt
                                                                    , A.Tpy_RESTNDHr
                                                                    , A.Tpy_RESTNDAmt
                                                                    , A.Tpy_RESTNDOTHr
                                                                    , A.Tpy_RESTNDOTAmt
                                                                    , A.Tpy_LEGHOLHr
                                                                    , A.Tpy_LEGHOLAmt
                                                                    , A.Tpy_LEGHOLOTHr
                                                                    , A.Tpy_LEGHOLOTAmt
                                                                    , A.Tpy_LEGHOLNDHr
                                                                    , A.Tpy_LEGHOLNDAmt
                                                                    , A.Tpy_LEGHOLNDOTHr
                                                                    , A.Tpy_LEGHOLNDOTAmt
                                                                    , A.Tpy_SPLHOLHr
                                                                    , A.Tpy_SPLHOLAmt
                                                                    , A.Tpy_SPLHOLOTHr
                                                                    , A.Tpy_SPLHOLOTAmt
                                                                    , A.Tpy_SPLHOLNDHr
                                                                    , A.Tpy_SPLHOLNDAmt
                                                                    , A.Tpy_SPLHOLNDOTHr
                                                                    , A.Tpy_SPLHOLNDOTAmt
                                                                    , A.Tpy_PSDHr
                                                                    , A.Tpy_PSDAmt
                                                                    , A.Tpy_PSDOTHr
                                                                    , A.Tpy_PSDOTAmt
                                                                    , A.Tpy_PSDNDHr
                                                                    , A.Tpy_PSDNDAmt
                                                                    , A.Tpy_PSDNDOTHr
                                                                    , A.Tpy_PSDNDOTAmt
                                                                    , A.Tpy_COMPHOLHr
                                                                    , A.Tpy_COMPHOLAmt
                                                                    , A.Tpy_COMPHOLOTHr
                                                                    , A.Tpy_COMPHOLOTAmt
                                                                    , A.Tpy_COMPHOLNDHr
                                                                    , A.Tpy_COMPHOLNDAmt
                                                                    , A.Tpy_COMPHOLNDOTHr
                                                                    , A.Tpy_COMPHOLNDOTAmt
                                                                    , A.Tpy_RESTLEGHOLHr
                                                                    , A.Tpy_RESTLEGHOLAmt
                                                                    , A.Tpy_RESTLEGHOLOTHr
                                                                    , A.Tpy_RESTLEGHOLOTAmt
                                                                    , A.Tpy_RESTLEGHOLNDHr
                                                                    , A.Tpy_RESTLEGHOLNDAmt
                                                                    , A.Tpy_RESTLEGHOLNDOTHr
                                                                    , A.Tpy_RESTLEGHOLNDOTAmt
                                                                    , A.Tpy_RESTSPLHOLHr
                                                                    , A.Tpy_RESTSPLHOLAmt
                                                                    , A.Tpy_RESTSPLHOLOTHr
                                                                    , A.Tpy_RESTSPLHOLOTAmt
                                                                    , A.Tpy_RESTSPLHOLNDHr
                                                                    , A.Tpy_RESTSPLHOLNDAmt
                                                                    , A.Tpy_RESTSPLHOLNDOTHr
                                                                    , A.Tpy_RESTSPLHOLNDOTAmt
                                                                    , A.Tpy_RESTCOMPHOLHr
                                                                    , A.Tpy_RESTCOMPHOLAmt
                                                                    , A.Tpy_RESTCOMPHOLOTHr
                                                                    , A.Tpy_RESTCOMPHOLOTAmt
                                                                    , A.Tpy_RESTCOMPHOLNDHr
                                                                    , A.Tpy_RESTCOMPHOLNDAmt
                                                                    , A.Tpy_RESTCOMPHOLNDOTHr
                                                                    , A.Tpy_RESTCOMPHOLNDOTAmt
                                                                    , A.Tpy_RESTPSDHr
                                                                    , A.Tpy_RESTPSDAmt
                                                                    , A.Tpy_RESTPSDOTHr
                                                                    , A.Tpy_RESTPSDOTAmt
                                                                    , A.Tpy_RESTPSDNDHr
                                                                    , A.Tpy_RESTPSDNDAmt
                                                                    , A.Tpy_RESTPSDNDOTHr
                                                                    , A.Tpy_RESTPSDNDOTAmt
                                                                    , A.Tpy_TotalOTNDAmt
                                                                    , A.Tpy_WorkDay
                                                                    , A.Tpy_DayCountOldSalaryRate
                                                                    , A.Tpy_SRGAdjHr
                                                                    , A.Tpy_SRGAdjAmt
                                                                    , A.Tpy_SOTAdjHr
                                                                    , A.Tpy_SOTAdjAmt
                                                                    , A.Tpy_SHOLAdjHr
                                                                    , A.Tpy_SHOLAdjAmt
                                                                    , A.Tpy_SNDAdjHr
                                                                    , A.Tpy_SNDAdjAmt
                                                                    , A.Tpy_SLVAdjHr
                                                                    , A.Tpy_SLVAdjAmt
                                                                    , A.Tpy_MRGAdjHr
                                                                    , A.Tpy_MRGAdjAmt
                                                                    , A.Tpy_MOTAdjHr
                                                                    , A.Tpy_MOTAdjAmt
                                                                    , A.Tpy_MHOLAdjHr
                                                                    , A.Tpy_MHOLAdjAmt
                                                                    , A.Tpy_MNDAdjHr
                                                                    , A.Tpy_MNDAdjAmt
                                                                    , A.Tpy_TotalAdjAmt
                                                                    , A.Tpy_TaxableIncomeAmt
                                                                    , A.Tpy_TotalTaxableIncomeAmt
                                                                    , A.Tpy_NontaxableIncomeAmt
                                                                    , A.Tpy_GrossIncomeAmt
                                                                    , A.Tpy_WtaxAmt
                                                                    , A.Tpy_TaxBaseAmt
                                                                    , A.Tpy_TaxRule
                                                                    , A.Tpy_TaxShare
                                                                    , A.Tpy_TaxBracket
                                                                    , A.Tpy_TaxCode
                                                                    , A.Tpy_IsTaxExempted
                                                                    , A.Tpy_SSSEE
                                                                    , A.Tpy_SSSER
                                                                    , A.Tpy_ECFundAmt
                                                                    , A.Tpy_SSSBaseAmt
                                                                    , A.Tpy_SSSRule
                                                                    , A.Tpy_SSSShare
                                                                    , A.Tpy_MPFEE
                                                                    , A.Tpy_MPFER
                                                                    , A.Tpy_PhilhealthEE
                                                                    , A.Tpy_PhilhealthER
                                                                    , A.Tpy_PhilhealthBaseAmt
                                                                    , A.Tpy_PhilhealthRule
                                                                    , A.Tpy_PhilhealthShare
                                                                    , A.Tpy_PagIbigEE
                                                                    , A.Tpy_PagIbigER
                                                                    , A.Tpy_PagIbigTaxEE
                                                                    , A.Tpy_PagIbigBaseAmt
                                                                    , A.Tpy_PagIbigRule
                                                                    , A.Tpy_PagIbigShare
                                                                    , A.Tpy_UnionAmt
                                                                    , A.Tpy_UnionRule
                                                                    , A.Tpy_UnionShare
                                                                    , A.Tpy_UnionBaseAmt
                                                                    , A.Tpy_OtherDeductionAmt
                                                                    , A.Tpy_TotalDeductionAmt
                                                                    , A.Tpy_NetAmt
                                                                    , A.Tpy_CostcenterCode
                                                                    , A.Tpy_PositionCode
                                                                    , A.Tpy_EmploymentStatus
                                                                    , A.Tpy_PayrollType
                                                                    , A.Tpy_PaymentMode
                                                                    , A.Tpy_BankCode
                                                                    , A.Tpy_BankAcctNo
                                                                    , A.Tpy_PayrollGroup
                                                                    , A.Tpy_CalendarGrpCode
                                                                    , A.Tpy_WorkLocationCode
                                                                    , A.Tpy_AltAcctCode
                                                                    , A.Tpy_ExpenseClass
                                                                    , A.Tpy_PositionGrade
                                                                    , A.Tpy_WorkStatus
                                                                    , A.Tpy_PremiumGrpCode
                                                                    , A.Tpy_IsComputedPerDay
                                                                    , A.Tpy_IsMultipleSalary
                                                                    , A.Tpy_RegRule
	                                                                , A.Usr_Login
	                                                                , A.Ludatetime 
                                                                FROM T_EmpPayrollYearly A
                                                                LEFT JOIN T_EmpPayrollHst B ON A.Tpy_IDNo = B.Tpy_IDNo 
	                                                                AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                                WHERE B.Tpy_PayCycle IS NULL

                                                               INSERT INTO T_EmpPayrollMiscHst 
                                                                (Tpm_IDNo
                                                                , Tpm_PayCycle
                                                                , Tpm_Misc1Hr
                                                                , Tpm_Misc1Amt
                                                                , Tpm_Misc1OTHr
                                                                , Tpm_Misc1OTAmt
                                                                , Tpm_Misc1NDHr
                                                                , Tpm_Misc1NDAmt
                                                                , Tpm_Misc1NDOTHr
                                                                , Tpm_Misc1NDOTAmt
                                                                , Tpm_Misc2Hr
                                                                , Tpm_Misc2Amt
                                                                , Tpm_Misc2OTHr
                                                                , Tpm_Misc2OTAmt
                                                                , Tpm_Misc2NDHr
                                                                , Tpm_Misc2NDAmt
                                                                , Tpm_Misc2NDOTHr
                                                                , Tpm_Misc2NDOTAmt
                                                                , Tpm_Misc3Hr
                                                                , Tpm_Misc3Amt
                                                                , Tpm_Misc3OTHr
                                                                , Tpm_Misc3OTAmt
                                                                , Tpm_Misc3NDHr
                                                                , Tpm_Misc3NDAmt
                                                                , Tpm_Misc3NDOTHr
                                                                , Tpm_Misc3NDOTAmt
                                                                , Tpm_Misc4Hr
                                                                , Tpm_Misc4Amt
                                                                , Tpm_Misc4OTHr
                                                                , Tpm_Misc4OTAmt
                                                                , Tpm_Misc4NDHr
                                                                , Tpm_Misc4NDAmt
                                                                , Tpm_Misc4NDOTHr
                                                                , Tpm_Misc4NDOTAmt
                                                                , Tpm_Misc5Hr
                                                                , Tpm_Misc5Amt
                                                                , Tpm_Misc5OTHr
                                                                , Tpm_Misc5OTAmt
                                                                , Tpm_Misc5NDHr
                                                                , Tpm_Misc5NDAmt
                                                                , Tpm_Misc5NDOTHr
                                                                , Tpm_Misc5NDOTAmt
                                                                , Tpm_Misc6Hr
                                                                , Tpm_Misc6Amt
                                                                , Tpm_Misc6OTHr
                                                                , Tpm_Misc6OTAmt
                                                                , Tpm_Misc6NDHr
                                                                , Tpm_Misc6NDAmt
                                                                , Tpm_Misc6NDOTHr
                                                                , Tpm_Misc6NDOTAmt
                                                                , Usr_Login
                                                                , Ludatetime)
                                                                SELECT A.Tpm_IDNo
	                                                                , A.Tpm_PayCycle
	                                                                , A.Tpm_Misc1Hr
	                                                                , A.Tpm_Misc1Amt
	                                                                , A.Tpm_Misc1OTHr
	                                                                , A.Tpm_Misc1OTAmt
	                                                                , A.Tpm_Misc1NDHr
	                                                                , A.Tpm_Misc1NDAmt
	                                                                , A.Tpm_Misc1NDOTHr
	                                                                , A.Tpm_Misc1NDOTAmt
	                                                                , A.Tpm_Misc2Hr
	                                                                , A.Tpm_Misc2Amt
	                                                                , A.Tpm_Misc2OTHr
	                                                                , A.Tpm_Misc2OTAmt
	                                                                , A.Tpm_Misc2NDHr
	                                                                , A.Tpm_Misc2NDAmt
	                                                                , A.Tpm_Misc2NDOTHr
	                                                                , A.Tpm_Misc2NDOTAmt
	                                                                , A.Tpm_Misc3Hr
	                                                                , A.Tpm_Misc3Amt
	                                                                , A.Tpm_Misc3OTHr
	                                                                , A.Tpm_Misc3OTAmt
	                                                                , A.Tpm_Misc3NDHr
	                                                                , A.Tpm_Misc3NDAmt
	                                                                , A.Tpm_Misc3NDOTHr
	                                                                , A.Tpm_Misc3NDOTAmt
	                                                                , A.Tpm_Misc4Hr
	                                                                , A.Tpm_Misc4Amt
	                                                                , A.Tpm_Misc4OTHr
	                                                                , A.Tpm_Misc4OTAmt
	                                                                , A.Tpm_Misc4NDHr
	                                                                , A.Tpm_Misc4NDAmt
	                                                                , A.Tpm_Misc4NDOTHr
	                                                                , A.Tpm_Misc4NDOTAmt
	                                                                , A.Tpm_Misc5Hr
	                                                                , A.Tpm_Misc5Amt
	                                                                , A.Tpm_Misc5OTHr
	                                                                , A.Tpm_Misc5OTAmt
	                                                                , A.Tpm_Misc5NDHr
	                                                                , A.Tpm_Misc5NDAmt
	                                                                , A.Tpm_Misc5NDOTHr
	                                                                , A.Tpm_Misc5NDOTAmt
	                                                                , A.Tpm_Misc6Hr
	                                                                , A.Tpm_Misc6Amt
	                                                                , A.Tpm_Misc6OTHr
	                                                                , A.Tpm_Misc6OTAmt
	                                                                , A.Tpm_Misc6NDHr
	                                                                , A.Tpm_Misc6NDAmt
	                                                                , A.Tpm_Misc6NDOTHr
	                                                                , A.Tpm_Misc6NDOTAmt
	                                                                , A.Usr_Login
	                                                                , A.Ludatetime
                                                                FROM T_EmpPayrollMiscYearly A
                                                                LEFT JOIN T_EmpPayrollMiscHst B ON A.Tpm_IDNo = B.Tpm_IDNo 
	                                                                AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                                WHERE B.Tpm_PayCycle IS NULL

                                                                INSERT INTO T_EmpPayroll2Hst 
                                                                (Tpy_IDNo
                                                                , Tpy_PayCycle
                                                                , Tpy_RemainingPayCycle
                                                                , Tpy_YTDRegularAmtBefore
                                                                , Tpy_AssumeRegularAmt
                                                                , Tpy_RegularTotal
                                                                , Tpy_YTDRecurringAllowanceAmtBefore
                                                                , Tpy_YTDRecurringAllowanceAmt
                                                                , Tpy_RecurringAllowanceAmt
                                                                , Tpy_AssumeRecurringAllowanceAmt
                                                                , Tpy_RecurringAllowanceTotal
                                                                , Tpy_YTDBonusAmtBefore
                                                                , Tpy_BonusNontaxAmt
                                                                , Tpy_BonusTaxAmt
                                                                , Tpy_Assume13thMonthAmt
                                                                , Tpy_BonusTotal
                                                                , Tpy_BonusTaxRevaluated
                                                                , Tpy_YTDBonusTaxBefore
                                                                , Tpy_YTDOtherTaxableIncomeAmtBefore
                                                                , Tpy_OtherTaxableIncomeAmt
                                                                , Tpy_OtherTaxableIncomeTotal
                                                                , Tpy_YTDSSSAmtBefore
                                                                , Tpy_AssumeSSSAmt
                                                                , Tpy_SSSTotal
                                                                , Tpy_YTDPhilhealthAmtBefore
                                                                , Tpy_AssumePhilhealthAmt
                                                                , Tpy_PhilhealthTotal
                                                                , Tpy_YTDPagIbigAmtBefore
                                                                , Tpy_AssumePagIbigAmt
                                                                , Tpy_PagIbigTotal
                                                                , Tpy_YTDPagIbigTaxAmtBefore
                                                                , Tpy_AssumePagIbigTaxAmt
                                                                , Tpy_TotalTaxableIncomeWAssumeAmt
                                                                , Tpy_YTDUnionAmtBefore
                                                                , Tpy_AssumeUnionAmt
                                                                , Tpy_UnionTotal
                                                                , Tpy_PremiumPaidOnHealth
                                                                , Tpy_TotalExemptions
                                                                , Tpy_NetTaxableIncomeAmt
                                                                , Tpy_YTDREGAmt
                                                                , Tpy_YTDTotalTaxableIncomeAmtBefore
                                                                , Tpy_YTDTotalTaxableIncomeAmt
                                                                , Tpy_YTDWtaxAmtBefore
                                                                , Tpy_YTDWtaxAmt
                                                                , Tpy_YTDSSSAmt
                                                                , Tpy_YTDPhilhealthAmt
                                                                , Tpy_YTDPagIbigAmt
                                                                , Tpy_YTDPagIbigTaxAmt
                                                                , Tpy_YTDUnionAmt
                                                                , Tpy_YTDNontaxableAmtBefore
                                                                , Tpy_YTDNontaxableAmt
                                                                , Tpy_BIRTotalAmountofCompensation
                                                                , Tpy_BIRStatutoryMinimumWage
                                                                , Tpy_BIRHolidayOvertimeNightShiftHazard
                                                                , Tpy_BIR13thMonthPayOtherBenefits
                                                                , Tpy_BIRDeMinimisBenefits
                                                                , Tpy_BIRSSSGSISPHICHDMFUnionDues
                                                                , Tpy_BIROtherNonTaxableCompensation
                                                                , Tpy_BIRTotalTaxableCompensation
                                                                , Tpy_BIRTaxableCompensationNotSubjectToWithholdingTax
                                                                , Tpy_BIRTotalTaxesWithheld
                                                                , Tpy_TaxDue
                                                                , Tpy_AssumeMonthlyRegularAmt
                                                                , Tpy_AssumeMonthlySSSAmt
                                                                , Tpy_AssumeMonthlyPhilhealthAmt
                                                                , Tpy_AssumeMonthlyPagibigAmt
                                                                , Tpy_AssumeMonthlyUnionAmt
                                                                , Tpy_YTDMPFAmtBefore
                                                                , Tpy_YTDMPFAmt
                                                                , Usr_Login
                                                                , Ludatetime)

                                                                SELECT A.Tpy_IDNo
                                                                    , A.Tpy_PayCycle
                                                                    , A.Tpy_RemainingPayCycle
                                                                    , A.Tpy_YTDRegularAmtBefore
                                                                    , A.Tpy_AssumeRegularAmt
                                                                    , A.Tpy_RegularTotal
                                                                    , A.Tpy_YTDRecurringAllowanceAmtBefore
                                                                    , A.Tpy_YTDRecurringAllowanceAmt
                                                                    , A.Tpy_RecurringAllowanceAmt
                                                                    , A.Tpy_AssumeRecurringAllowanceAmt
                                                                    , A.Tpy_RecurringAllowanceTotal
                                                                    , A.Tpy_YTDBonusAmtBefore
                                                                    , A.Tpy_BonusNontaxAmt
                                                                    , A.Tpy_BonusTaxAmt
                                                                    , A.Tpy_Assume13thMonthAmt
                                                                    , A.Tpy_BonusTotal
                                                                    , A.Tpy_BonusTaxRevaluated
                                                                    , A.Tpy_YTDBonusTaxBefore
                                                                    , A.Tpy_YTDOtherTaxableIncomeAmtBefore
                                                                    , A.Tpy_OtherTaxableIncomeAmt
                                                                    , A.Tpy_OtherTaxableIncomeTotal
                                                                    , A.Tpy_YTDSSSAmtBefore
                                                                    , A.Tpy_AssumeSSSAmt
                                                                    , A.Tpy_SSSTotal
                                                                    , A.Tpy_YTDPhilhealthAmtBefore
                                                                    , A.Tpy_AssumePhilhealthAmt
                                                                    , A.Tpy_PhilhealthTotal
                                                                    , A.Tpy_YTDPagIbigAmtBefore
                                                                    , A.Tpy_AssumePagIbigAmt
                                                                    , A.Tpy_PagIbigTotal
                                                                    , A.Tpy_YTDPagIbigTaxAmtBefore
                                                                    , A.Tpy_AssumePagIbigTaxAmt
                                                                    , A.Tpy_TotalTaxableIncomeWAssumeAmt
                                                                    , A.Tpy_YTDUnionAmtBefore
                                                                    , A.Tpy_AssumeUnionAmt
                                                                    , A.Tpy_UnionTotal
                                                                    , A.Tpy_PremiumPaidOnHealth
                                                                    , A.Tpy_TotalExemptions
                                                                    , A.Tpy_NetTaxableIncomeAmt
                                                                    , A.Tpy_YTDREGAmt
                                                                    , A.Tpy_YTDTotalTaxableIncomeAmtBefore
                                                                    , A.Tpy_YTDTotalTaxableIncomeAmt
                                                                    , A.Tpy_YTDWtaxAmtBefore
                                                                    , A.Tpy_YTDWtaxAmt
                                                                    , A.Tpy_YTDSSSAmt
                                                                    , A.Tpy_YTDPhilhealthAmt
                                                                    , A.Tpy_YTDPagIbigAmt
                                                                    , A.Tpy_YTDPagIbigTaxAmt
                                                                    , A.Tpy_YTDUnionAmt
                                                                    , A.Tpy_YTDNontaxableAmtBefore
                                                                    , A.Tpy_YTDNontaxableAmt
                                                                    , A.Tpy_BIRTotalAmountofCompensation
                                                                    , A.Tpy_BIRStatutoryMinimumWage
                                                                    , A.Tpy_BIRHolidayOvertimeNightShiftHazard
                                                                    , A.Tpy_BIR13thMonthPayOtherBenefits
                                                                    , A.Tpy_BIRDeMinimisBenefits
                                                                    , A.Tpy_BIRSSSGSISPHICHDMFUnionDues
                                                                    , A.Tpy_BIROtherNonTaxableCompensation
                                                                    , A.Tpy_BIRTotalTaxableCompensation
                                                                    , A.Tpy_BIRTaxableCompensationNotSubjectToWithholdingTax
                                                                    , A.Tpy_BIRTotalTaxesWithheld
                                                                    , A.Tpy_TaxDue
                                                                    , A.Tpy_AssumeMonthlyRegularAmt
                                                                    , A.Tpy_AssumeMonthlySSSAmt
                                                                    , A.Tpy_AssumeMonthlyPhilhealthAmt
                                                                    , A.Tpy_AssumeMonthlyPagibigAmt
                                                                    , A.Tpy_AssumeMonthlyUnionAmt
                                                                    , A.Tpy_YTDMPFAmtBefore
                                                                    , A.Tpy_YTDMPFAmt
	                                                                , A.Usr_Login
	                                                                , A.Ludatetime
                                                                FROM T_EmpPayroll2Yearly A
                                                                LEFT JOIN T_EmpPayroll2Hst B ON A.Tpy_IDNo = B.Tpy_IDNo 
	                                                                AND A.Tpy_PayCycle = B.Tpy_PayCycle
                                                                WHERE B.Tpy_PayCycle IS NULL

                                                                INSERT INTO T_EmpPayrollDtlHst
                                                                (Tpd_IDNo
                                                                , Tpd_PayCycle
                                                                , Tpd_Date
                                                                , Tpd_DayCode
                                                                , Tpd_RestDayFlag
                                                                , Tpd_WorkDay
                                                                , Tpd_SalaryRate
                                                                , Tpd_HourRate
                                                                , Tpd_PayrollType
                                                                , Tpd_SpecialRate
                                                                , Tpd_SpecialHourRate
                                                                , Tpd_PremiumGrpCode
                                                                , Tpd_LTHr
                                                                , Tpd_LTAmt
                                                                , Tpd_UTHr
                                                                , Tpd_UTAmt
                                                                , Tpd_UPLVHr
                                                                , Tpd_UPLVAmt
                                                                , Tpd_ABSLEGHOLHr
                                                                , Tpd_ABSLEGHOLAmt
                                                                , Tpd_ABSSPLHOLHr
                                                                , Tpd_ABSSPLHOLAmt
                                                                , Tpd_ABSCOMPHOLHr
                                                                , Tpd_ABSCOMPHOLAmt
                                                                , Tpd_ABSPSDHr
                                                                , Tpd_ABSPSDAmt
                                                                , Tpd_ABSOTHHOLHr
                                                                , Tpd_ABSOTHHOLAmt
                                                                , Tpd_WDABSHr
                                                                , Tpd_WDABSAmt
                                                                , Tpd_LTUTMaxHr
                                                                , Tpd_LTUTMaxAmt
                                                                , Tpd_ABSHr
                                                                , Tpd_ABSAmt
                                                                , Tpd_REGHr
                                                                , Tpd_REGAmt
                                                                , Tpd_PDLVHr
                                                                , Tpd_PDLVAmt
                                                                , Tpd_PDLEGHOLHr
                                                                , Tpd_PDLEGHOLAmt
                                                                , Tpd_PDSPLHOLHr
                                                                , Tpd_PDSPLHOLAmt
                                                                , Tpd_PDCOMPHOLHr
                                                                , Tpd_PDCOMPHOLAmt
                                                                , Tpd_PDPSDHr
                                                                , Tpd_PDPSDAmt
                                                                , Tpd_PDOTHHOLHr
                                                                , Tpd_PDOTHHOLAmt
                                                                , Tpd_PDRESTLEGHOLHr
                                                                , Tpd_PDRESTLEGHOLAmt
                                                                , Tpd_TotalREGHr
                                                                , Tpd_TotalREGAmt
                                                                , Tpd_REGOTHr
                                                                , Tpd_REGOTAmt
                                                                , Tpd_REGNDHr
                                                                , Tpd_REGNDAmt
                                                                , Tpd_REGNDOTHr
                                                                , Tpd_REGNDOTAmt
                                                                , Tpd_RESTHr
                                                                , Tpd_RESTAmt
                                                                , Tpd_RESTOTHr
                                                                , Tpd_RESTOTAmt
                                                                , Tpd_RESTNDHr
                                                                , Tpd_RESTNDAmt
                                                                , Tpd_RESTNDOTHr
                                                                , Tpd_RESTNDOTAmt
                                                                , Tpd_LEGHOLHr
                                                                , Tpd_LEGHOLAmt
                                                                , Tpd_LEGHOLOTHr
                                                                , Tpd_LEGHOLOTAmt
                                                                , Tpd_LEGHOLNDHr
                                                                , Tpd_LEGHOLNDAmt
                                                                , Tpd_LEGHOLNDOTHr
                                                                , Tpd_LEGHOLNDOTAmt
                                                                , Tpd_SPLHOLHr
                                                                , Tpd_SPLHOLAmt
                                                                , Tpd_SPLHOLOTHr
                                                                , Tpd_SPLHOLOTAmt
                                                                , Tpd_SPLHOLNDHr
                                                                , Tpd_SPLHOLNDAmt
                                                                , Tpd_SPLHOLNDOTHr
                                                                , Tpd_SPLHOLNDOTAmt
                                                                , Tpd_PSDHr
                                                                , Tpd_PSDAmt
                                                                , Tpd_PSDOTHr
                                                                , Tpd_PSDOTAmt
                                                                , Tpd_PSDNDHr
                                                                , Tpd_PSDNDAmt
                                                                , Tpd_PSDNDOTHr
                                                                , Tpd_PSDNDOTAmt
                                                                , Tpd_COMPHOLHr
                                                                , Tpd_COMPHOLAmt
                                                                , Tpd_COMPHOLOTHr
                                                                , Tpd_COMPHOLOTAmt
                                                                , Tpd_COMPHOLNDHr
                                                                , Tpd_COMPHOLNDAmt
                                                                , Tpd_COMPHOLNDOTHr
                                                                , Tpd_COMPHOLNDOTAmt
                                                                , Tpd_RESTLEGHOLHr
                                                                , Tpd_RESTLEGHOLAmt
                                                                , Tpd_RESTLEGHOLOTHr
                                                                , Tpd_RESTLEGHOLOTAmt
                                                                , Tpd_RESTLEGHOLNDHr
                                                                , Tpd_RESTLEGHOLNDAmt
                                                                , Tpd_RESTLEGHOLNDOTHr
                                                                , Tpd_RESTLEGHOLNDOTAmt
                                                                , Tpd_RESTSPLHOLHr
                                                                , Tpd_RESTSPLHOLAmt
                                                                , Tpd_RESTSPLHOLOTHr
                                                                , Tpd_RESTSPLHOLOTAmt
                                                                , Tpd_RESTSPLHOLNDHr
                                                                , Tpd_RESTSPLHOLNDAmt
                                                                , Tpd_RESTSPLHOLNDOTHr
                                                                , Tpd_RESTSPLHOLNDOTAmt
                                                                , Tpd_RESTCOMPHOLHr
                                                                , Tpd_RESTCOMPHOLAmt
                                                                , Tpd_RESTCOMPHOLOTHr
                                                                , Tpd_RESTCOMPHOLOTAmt
                                                                , Tpd_RESTCOMPHOLNDHr
                                                                , Tpd_RESTCOMPHOLNDAmt
                                                                , Tpd_RESTCOMPHOLNDOTHr
                                                                , Tpd_RESTCOMPHOLNDOTAmt
                                                                , Tpd_RESTPSDHr
                                                                , Tpd_RESTPSDAmt
                                                                , Tpd_RESTPSDOTHr
                                                                , Tpd_RESTPSDOTAmt
                                                                , Tpd_RESTPSDNDHr
                                                                , Tpd_RESTPSDNDAmt
                                                                , Tpd_RESTPSDNDOTHr
                                                                , Tpd_RESTPSDNDOTAmt
                                                                , Tpd_TotalOTNDAmt
                                                                , Usr_Login
                                                                , Ludatetime)
                                                                SELECT A.Tpd_IDNo
                                                                , A.Tpd_PayCycle
                                                                , A.Tpd_Date
                                                                , A.Tpd_DayCode
                                                                , A.Tpd_RestDayFlag
                                                                , A.Tpd_WorkDay
                                                                , A.Tpd_SalaryRate
                                                                , A.Tpd_HourRate
                                                                , A.Tpd_PayrollType
                                                                , A.Tpd_SpecialRate
                                                                , A.Tpd_SpecialHourRate
                                                                , A.Tpd_PremiumGrpCode
                                                                , A.Tpd_LTHr
                                                                , A.Tpd_LTAmt
                                                                , A.Tpd_UTHr
                                                                , A.Tpd_UTAmt
                                                                , A.Tpd_UPLVHr
                                                                , A.Tpd_UPLVAmt
                                                                , A.Tpd_ABSLEGHOLHr
                                                                , A.Tpd_ABSLEGHOLAmt
                                                                , A.Tpd_ABSSPLHOLHr
                                                                , A.Tpd_ABSSPLHOLAmt
                                                                , A.Tpd_ABSCOMPHOLHr
                                                                , A.Tpd_ABSCOMPHOLAmt
                                                                , A.Tpd_ABSPSDHr
                                                                , A.Tpd_ABSPSDAmt
                                                                , A.Tpd_ABSOTHHOLHr
                                                                , A.Tpd_ABSOTHHOLAmt
                                                                , A.Tpd_WDABSHr
                                                                , A.Tpd_WDABSAmt
                                                                , A.Tpd_LTUTMaxHr
                                                                , A.Tpd_LTUTMaxAmt
                                                                , A.Tpd_ABSHr
                                                                , A.Tpd_ABSAmt
                                                                , A.Tpd_REGHr
                                                                , A.Tpd_REGAmt
                                                                , A.Tpd_PDLVHr
                                                                , A.Tpd_PDLVAmt
                                                                , A.Tpd_PDLEGHOLHr
                                                                , A.Tpd_PDLEGHOLAmt
                                                                , A.Tpd_PDSPLHOLHr
                                                                , A.Tpd_PDSPLHOLAmt
                                                                , A.Tpd_PDCOMPHOLHr
                                                                , A.Tpd_PDCOMPHOLAmt
                                                                , A.Tpd_PDPSDHr
                                                                , A.Tpd_PDPSDAmt
                                                                , A.Tpd_PDOTHHOLHr
                                                                , A.Tpd_PDOTHHOLAmt
                                                                , A.Tpd_PDRESTLEGHOLHr
                                                                , A.Tpd_PDRESTLEGHOLAmt
                                                                , A.Tpd_TotalREGHr
                                                                , A.Tpd_TotalREGAmt
                                                                , A.Tpd_REGOTHr
                                                                , A.Tpd_REGOTAmt
                                                                , A.Tpd_REGNDHr
                                                                , A.Tpd_REGNDAmt
                                                                , A.Tpd_REGNDOTHr
                                                                , A.Tpd_REGNDOTAmt
                                                                , A.Tpd_RESTHr
                                                                , A.Tpd_RESTAmt
                                                                , A.Tpd_RESTOTHr
                                                                , A.Tpd_RESTOTAmt
                                                                , A.Tpd_RESTNDHr
                                                                , A.Tpd_RESTNDAmt
                                                                , A.Tpd_RESTNDOTHr
                                                                , A.Tpd_RESTNDOTAmt
                                                                , A.Tpd_LEGHOLHr
                                                                , A.Tpd_LEGHOLAmt
                                                                , A.Tpd_LEGHOLOTHr
                                                                , A.Tpd_LEGHOLOTAmt
                                                                , A.Tpd_LEGHOLNDHr
                                                                , A.Tpd_LEGHOLNDAmt
                                                                , A.Tpd_LEGHOLNDOTHr
                                                                , A.Tpd_LEGHOLNDOTAmt
                                                                , A.Tpd_SPLHOLHr
                                                                , A.Tpd_SPLHOLAmt
                                                                , A.Tpd_SPLHOLOTHr
                                                                , A.Tpd_SPLHOLOTAmt
                                                                , A.Tpd_SPLHOLNDHr
                                                                , A.Tpd_SPLHOLNDAmt
                                                                , A.Tpd_SPLHOLNDOTHr
                                                                , A.Tpd_SPLHOLNDOTAmt
                                                                , A.Tpd_PSDHr
                                                                , A.Tpd_PSDAmt
                                                                , A.Tpd_PSDOTHr
                                                                , A.Tpd_PSDOTAmt
                                                                , A.Tpd_PSDNDHr
                                                                , A.Tpd_PSDNDAmt
                                                                , A.Tpd_PSDNDOTHr
                                                                , A.Tpd_PSDNDOTAmt
                                                                , A.Tpd_COMPHOLHr
                                                                , A.Tpd_COMPHOLAmt
                                                                , A.Tpd_COMPHOLOTHr
                                                                , A.Tpd_COMPHOLOTAmt
                                                                , A.Tpd_COMPHOLNDHr
                                                                , A.Tpd_COMPHOLNDAmt
                                                                , A.Tpd_COMPHOLNDOTHr
                                                                , A.Tpd_COMPHOLNDOTAmt
                                                                , A.Tpd_RESTLEGHOLHr
                                                                , A.Tpd_RESTLEGHOLAmt
                                                                , A.Tpd_RESTLEGHOLOTHr
                                                                , A.Tpd_RESTLEGHOLOTAmt
                                                                , A.Tpd_RESTLEGHOLNDHr
                                                                , A.Tpd_RESTLEGHOLNDAmt
                                                                , A.Tpd_RESTLEGHOLNDOTHr
                                                                , A.Tpd_RESTLEGHOLNDOTAmt
                                                                , A.Tpd_RESTSPLHOLHr
                                                                , A.Tpd_RESTSPLHOLAmt
                                                                , A.Tpd_RESTSPLHOLOTHr
                                                                , A.Tpd_RESTSPLHOLOTAmt
                                                                , A.Tpd_RESTSPLHOLNDHr
                                                                , A.Tpd_RESTSPLHOLNDAmt
                                                                , A.Tpd_RESTSPLHOLNDOTHr
                                                                , A.Tpd_RESTSPLHOLNDOTAmt
                                                                , A.Tpd_RESTCOMPHOLHr
                                                                , A.Tpd_RESTCOMPHOLAmt
                                                                , A.Tpd_RESTCOMPHOLOTHr
                                                                , A.Tpd_RESTCOMPHOLOTAmt
                                                                , A.Tpd_RESTCOMPHOLNDHr
                                                                , A.Tpd_RESTCOMPHOLNDAmt
                                                                , A.Tpd_RESTCOMPHOLNDOTHr
                                                                , A.Tpd_RESTCOMPHOLNDOTAmt
                                                                , A.Tpd_RESTPSDHr
                                                                , A.Tpd_RESTPSDAmt
                                                                , A.Tpd_RESTPSDOTHr
                                                                , A.Tpd_RESTPSDOTAmt
                                                                , A.Tpd_RESTPSDNDHr
                                                                , A.Tpd_RESTPSDNDAmt
                                                                , A.Tpd_RESTPSDNDOTHr
                                                                , A.Tpd_RESTPSDNDOTAmt
                                                                , A.Tpd_TotalOTNDAmt
                                                                , A.Usr_Login
                                                                , A.Ludatetime
                                                                FROM T_EmpPayrollDtlYearly A
                                                                LEFT JOIN T_EmpPayrollDtlHst B ON A.Tpd_IDNo = B.Tpd_IDNo 
	                                                                AND A.Tpd_PayCycle = B.Tpd_PayCycle
                                                                    AND A.Tpd_Date = B.Tpd_Date
                                                                WHERE B.Tpd_PayCycle IS NULL

                                                                INSERT INTO T_EmpPayrollDtlMiscHst
                                                                (Tpm_IDNo
                                                                ,Tpm_PayCycle
                                                                ,Tpm_Date
                                                                ,Tpm_Misc1Hr
                                                                ,Tpm_Misc1Amt
                                                                ,Tpm_Misc1OTHr
                                                                ,Tpm_Misc1OTAmt
                                                                ,Tpm_Misc1NDHr
                                                                ,Tpm_Misc1NDAmt
                                                                ,Tpm_Misc1NDOTHr
                                                                ,Tpm_Misc1NDOTAmt
                                                                ,Tpm_Misc2Hr
                                                                ,Tpm_Misc2Amt
                                                                ,Tpm_Misc2OTHr
                                                                ,Tpm_Misc2OTAmt
                                                                ,Tpm_Misc2NDHr
                                                                ,Tpm_Misc2NDAmt
                                                                ,Tpm_Misc2NDOTHr
                                                                ,Tpm_Misc2NDOTAmt
                                                                ,Tpm_Misc3Hr
                                                                ,Tpm_Misc3Amt
                                                                ,Tpm_Misc3OTHr
                                                                ,Tpm_Misc3OTAmt
                                                                ,Tpm_Misc3NDHr
                                                                ,Tpm_Misc3NDAmt
                                                                ,Tpm_Misc3NDOTHr
                                                                ,Tpm_Misc3NDOTAmt
                                                                ,Tpm_Misc4Hr
                                                                ,Tpm_Misc4Amt
                                                                ,Tpm_Misc4OTHr
                                                                ,Tpm_Misc4OTAmt
                                                                ,Tpm_Misc4NDHr
                                                                ,Tpm_Misc4NDAmt
                                                                ,Tpm_Misc4NDOTHr
                                                                ,Tpm_Misc4NDOTAmt
                                                                ,Tpm_Misc5Hr
                                                                ,Tpm_Misc5Amt
                                                                ,Tpm_Misc5OTHr
                                                                ,Tpm_Misc5OTAmt
                                                                ,Tpm_Misc5NDHr
                                                                ,Tpm_Misc5NDAmt
                                                                ,Tpm_Misc5NDOTHr
                                                                ,Tpm_Misc5NDOTAmt
                                                                ,Tpm_Misc6Hr
                                                                ,Tpm_Misc6Amt
                                                                ,Tpm_Misc6OTHr
                                                                ,Tpm_Misc6OTAmt
                                                                ,Tpm_Misc6NDHr
                                                                ,Tpm_Misc6NDAmt
                                                                ,Tpm_Misc6NDOTHr
                                                                ,Tpm_Misc6NDOTAmt
                                                                ,Usr_Login
                                                                ,Ludatetime)
                                                                SELECT A.Tpm_IDNo
                                                                ,A.Tpm_PayCycle
                                                                ,A.Tpm_Date
                                                                ,A.Tpm_Misc1Hr
                                                                ,A.Tpm_Misc1Amt
                                                                ,A.Tpm_Misc1OTHr
                                                                ,A.Tpm_Misc1OTAmt
                                                                ,A.Tpm_Misc1NDHr
                                                                ,A.Tpm_Misc1NDAmt
                                                                ,A.Tpm_Misc1NDOTHr
                                                                ,A.Tpm_Misc1NDOTAmt
                                                                ,A.Tpm_Misc2Hr
                                                                ,A.Tpm_Misc2Amt
                                                                ,A.Tpm_Misc2OTHr
                                                                ,A.Tpm_Misc2OTAmt
                                                                ,A.Tpm_Misc2NDHr
                                                                ,A.Tpm_Misc2NDAmt
                                                                ,A.Tpm_Misc2NDOTHr
                                                                ,A.Tpm_Misc2NDOTAmt
                                                                ,A.Tpm_Misc3Hr
                                                                ,A.Tpm_Misc3Amt
                                                                ,A.Tpm_Misc3OTHr
                                                                ,A.Tpm_Misc3OTAmt
                                                                ,A.Tpm_Misc3NDHr
                                                                ,A.Tpm_Misc3NDAmt
                                                                ,A.Tpm_Misc3NDOTHr
                                                                ,A.Tpm_Misc3NDOTAmt
                                                                ,A.Tpm_Misc4Hr
                                                                ,A.Tpm_Misc4Amt
                                                                ,A.Tpm_Misc4OTHr
                                                                ,A.Tpm_Misc4OTAmt
                                                                ,A.Tpm_Misc4NDHr
                                                                ,A.Tpm_Misc4NDAmt
                                                                ,A.Tpm_Misc4NDOTHr
                                                                ,A.Tpm_Misc4NDOTAmt
                                                                ,A.Tpm_Misc5Hr
                                                                ,A.Tpm_Misc5Amt
                                                                ,A.Tpm_Misc5OTHr
                                                                ,A.Tpm_Misc5OTAmt
                                                                ,A.Tpm_Misc5NDHr
                                                                ,A.Tpm_Misc5NDAmt
                                                                ,A.Tpm_Misc5NDOTHr
                                                                ,A.Tpm_Misc5NDOTAmt
                                                                ,A.Tpm_Misc6Hr
                                                                ,A.Tpm_Misc6Amt
                                                                ,A.Tpm_Misc6OTHr
                                                                ,A.Tpm_Misc6OTAmt
                                                                ,A.Tpm_Misc6NDHr
                                                                ,A.Tpm_Misc6NDAmt
                                                                ,A.Tpm_Misc6NDOTHr
                                                                ,A.Tpm_Misc6NDOTAmt
                                                                ,A.Usr_Login
                                                                ,A.Ludatetime
                                                                FROM T_EmpPayrollDtlMiscYearly A
                                                                LEFT JOIN T_EmpPayrollDtlMiscHst B ON A.Tpm_IDNo = B.Tpm_IDNo 
	                                                                AND A.Tpm_PayCycle = B.Tpm_PayCycle
                                                                    AND A.Tpm_Date = B.Tpm_Date
                                                                WHERE B.Tpm_PayCycle IS NULL";

            public const string insertAlphalistHistory = @"INSERT INTO {0}..T_EmpAlphalistHdrHst 
                                                                (Tah_IDNo
                                                                , Tah_TaxYear
                                                                , Tah_StartDate
                                                                , Tah_EndDate
                                                                , Tah_LastName
                                                                , Tah_FirstName
                                                                , Tah_MiddleName
                                                                , Tah_ExtensionName
                                                                , Tah_Schedule
                                                                , Tah_TIN
                                                                , Tah_PresCompleteAddress
                                                                , Tah_PresAddressMunicipalityCity
                                                                , Tah_TelephoneNo
                                                                , Tah_ProvCompleteAddress
                                                                , Tah_ProvAddressMunicipalityCity
                                                                , Tah_WifeClaim
                                                                , Tah_MWEBasicCurER
                                                                , Tah_MWEHolidayCurER
                                                                , Tah_MWEOvertimeCurER
                                                                , Tah_MWENightShiftCurER
                                                                , Tah_MWEHazardCurER
                                                                , Tah_Nontaxable13thMonthCurER
                                                                , Tah_DeMinimisCurER
                                                                , Tah_PremiumsUnionDuesCurER
                                                                , Tah_NontaxableSalariesCompensationCurER
                                                                , Tah_TaxableBasicCurER
                                                                , Tah_TaxableBasicNetPremiumsCurER
                                                                , Tah_TaxableOvertimeCurER
                                                                , Tah_Taxable13thMonthCurER
                                                                , Tah_TaxableSalariesCompensationCurER
                                                                , Tah_MWEBasicPrvER
                                                                , Tah_MWEHolidayPrvER
                                                                , Tah_MWEOvertimePrvER
                                                                , Tah_MWENightShiftPrvER
                                                                , Tah_MWEHazardPrvER
                                                                , Tah_Nontaxable13thMonthPrvER
                                                                , Tah_DeMinimisPrvER
                                                                , Tah_PremiumsUnionDuesPrvER
                                                                , Tah_NontaxableSalariesCompensationPrvER
                                                                , Tah_TaxableBasicPrvER
                                                                , Tah_TaxableBasicNetPremiumsPrvER
                                                                , Tah_TaxableOvertimePrvER
                                                                , Tah_Taxable13thMonthPrvER
                                                                , Tah_TaxableSalariesCompensationPrvER
                                                                , Tah_RepresentationCurER
                                                                , Tah_TransportationCurER
                                                                , Tah_CostLivingAllowanceCurER
                                                                , Tah_FixedHousingAllowanceCurER
                                                                , Tah_OtherTaxable1CurER
                                                                , Tah_OtherTaxable2CurER
                                                                , Tah_CommisionCurER
                                                                , Tah_ProfitSharingCurER
                                                                , Tah_FeesCurER
                                                                , Tah_HazardCurER
                                                                , Tah_SupplementaryTaxable1CurER
                                                                , Tah_SupplementaryTaxable2CurER
                                                                , Tah_RepresentationPrvER
                                                                , Tah_TransportationPrvER
                                                                , Tah_CostLivingAllowancePrvER
                                                                , Tah_FixedHousingAllowancePrvER
                                                                , Tah_OtherTaxable1PrvER
                                                                , Tah_OtherTaxable2PrvER
                                                                , Tah_CommisionPrvER
                                                                , Tah_ProfitSharingPrvER
                                                                , Tah_FeesPrvER
                                                                , Tah_HazardPrvER
                                                                , Tah_SupplementaryTaxable1PrvER
                                                                , Tah_SupplementaryTaxable2PrvER
                                                                , Tah_ExemptionCode
                                                                , Tah_ExemptionAmount
                                                                , Tah_PremiumPaidOnHealth
                                                                , Tah_GrossCompensationIncome
                                                                , Tah_NontaxableIncomeCurER
                                                                , Tah_NontaxableIncomePrvER
                                                                , Tah_TaxableIncomeCurER
                                                                , Tah_TaxableIncomePrvER
                                                                , Tah_NetTaxableIncome
                                                                , Tah_TaxDue
                                                                , Tah_TaxWithheldPrvER
                                                                , Tah_TaxWithheldCurER
                                                                , Tah_TotalTaxWithheld
                                                                , Tah_TotalTaxWithheldJanDec
                                                                , Tah_TaxAmount
                                                                , Tah_TaxBracket
                                                                , Tah_IsSubstitutedFiling
                                                                , Tah_IsTaxExempted
                                                                , Tah_FinalPayIndicator
                                                                , Tah_IsZeroOutLastQuinYear
                                                                , Tah_CostcenterCode
                                                                , Tah_PayrollGroup
                                                                , Tah_PayrollType
                                                                , Tah_EmploymentStatus
                                                                , Tah_WorkStatus
                                                                , Tah_AssumeBasic
                                                                , Tah_Assume13th
                                                                , Tah_AssumeSalariesCompensation
                                                                , Tah_AssumePremiumsUnionDues
                                                                , Tah_AssumePayCycle
                                                                , Tah_CurrentEmploymentStatus
                                                                , Tah_Nationality
                                                                , Tah_SeparationReason
                                                                , Usr_Login
                                                                , Ludatetime)

                                                    SELECT A.Tah_IDNo
                                                            , A.Tah_TaxYear
                                                            , A.Tah_StartDate
                                                            , A.Tah_EndDate
                                                            , A.Tah_LastName
                                                            , A.Tah_FirstName
                                                            , A.Tah_MiddleName
                                                            , A.Tah_ExtensionName
                                                            , A.Tah_Schedule
                                                            , A.Tah_TIN
                                                            , A.Tah_PresCompleteAddress
                                                            , A.Tah_PresAddressMunicipalityCity
                                                            , A.Tah_TelephoneNo
                                                            , A.Tah_ProvCompleteAddress
                                                            , A.Tah_ProvAddressMunicipalityCity
                                                            , A.Tah_WifeClaim
                                                            , A.Tah_MWEBasicCurER
                                                            , A.Tah_MWEHolidayCurER
                                                            , A.Tah_MWEOvertimeCurER
                                                            , A.Tah_MWENightShiftCurER
                                                            , A.Tah_MWEHazardCurER
                                                            , A.Tah_Nontaxable13thMonthCurER
                                                            , A.Tah_DeMinimisCurER
                                                            , A.Tah_PremiumsUnionDuesCurER
                                                            , A.Tah_NontaxableSalariesCompensationCurER
                                                            , A.Tah_TaxableBasicCurER
                                                            , A.Tah_TaxableBasicNetPremiumsCurER
                                                            , A.Tah_TaxableOvertimeCurER
                                                            , A.Tah_Taxable13thMonthCurER
                                                            , A.Tah_TaxableSalariesCompensationCurER
                                                            , A.Tah_MWEBasicPrvER
                                                            , A.Tah_MWEHolidayPrvER
                                                            , A.Tah_MWEOvertimePrvER
                                                            , A.Tah_MWENightShiftPrvER
                                                            , A.Tah_MWEHazardPrvER
                                                            , A.Tah_Nontaxable13thMonthPrvER
                                                            , A.Tah_DeMinimisPrvER
                                                            , A.Tah_PremiumsUnionDuesPrvER
                                                            , A.Tah_NontaxableSalariesCompensationPrvER
                                                            , A.Tah_TaxableBasicPrvER
                                                            , A.Tah_TaxableBasicNetPremiumsPrvER
                                                            , A.Tah_TaxableOvertimePrvER
                                                            , A.Tah_Taxable13thMonthPrvER
                                                            , A.Tah_TaxableSalariesCompensationPrvER
                                                            , A.Tah_RepresentationCurER
                                                            , A.Tah_TransportationCurER
                                                            , A.Tah_CostLivingAllowanceCurER
                                                            , A.Tah_FixedHousingAllowanceCurER
                                                            , A.Tah_OtherTaxable1CurER
                                                            , A.Tah_OtherTaxable2CurER
                                                            , A.Tah_CommisionCurER
                                                            , A.Tah_ProfitSharingCurER
                                                            , A.Tah_FeesCurER
                                                            , A.Tah_HazardCurER
                                                            , A.Tah_SupplementaryTaxable1CurER
                                                            , A.Tah_SupplementaryTaxable2CurER
                                                            , A.Tah_RepresentationPrvER
                                                            , A.Tah_TransportationPrvER
                                                            , A.Tah_CostLivingAllowancePrvER
                                                            , A.Tah_FixedHousingAllowancePrvER
                                                            , A.Tah_OtherTaxable1PrvER
                                                            , A.Tah_OtherTaxable2PrvER
                                                            , A.Tah_CommisionPrvER
                                                            , A.Tah_ProfitSharingPrvER
                                                            , A.Tah_FeesPrvER
                                                            , A.Tah_HazardPrvER
                                                            , A.Tah_SupplementaryTaxable1PrvER
                                                            , A.Tah_SupplementaryTaxable2PrvER
                                                            , A.Tah_ExemptionCode
                                                            , A.Tah_ExemptionAmount
                                                            , A.Tah_PremiumPaidOnHealth
                                                            , A.Tah_GrossCompensationIncome
                                                            , A.Tah_NontaxableIncomeCurER
                                                            , A.Tah_NontaxableIncomePrvER
                                                            , A.Tah_TaxableIncomeCurER
                                                            , A.Tah_TaxableIncomePrvER
                                                            , A.Tah_NetTaxableIncome
                                                            , A.Tah_TaxDue
                                                            , A.Tah_TaxWithheldPrvER
                                                            , A.Tah_TaxWithheldCurER
                                                            , A.Tah_TotalTaxWithheld
                                                            , A.Tah_TotalTaxWithheldJanDec
                                                            , A.Tah_TaxAmount
                                                            , A.Tah_TaxBracket
                                                            , A.Tah_IsSubstitutedFiling
                                                            , A.Tah_IsTaxExempted
                                                            , A.Tah_FinalPayIndicator
                                                            , A.Tah_IsZeroOutLastQuinYear
                                                            , A.Tah_CostcenterCode
                                                            , A.Tah_PayrollGroup
                                                            , A.Tah_PayrollType
                                                            , A.Tah_EmploymentStatus
                                                            , A.Tah_WorkStatus
                                                            , A.Tah_AssumeBasic
                                                            , A.Tah_Assume13th
                                                            , A.Tah_AssumeSalariesCompensation
                                                            , A.Tah_AssumePremiumsUnionDues
                                                            , A.Tah_AssumePayCycle
                                                            , A.Tah_CurrentEmploymentStatus
                                                            , A.Tah_Nationality
                                                            , A.Tah_SeparationReason
                                                            , A.Usr_Login
                                                            , A.Ludatetime
                                                    FROM {0}..T_EmpAlphalistHdr A
                                                    INNER JOIN M_Employee ON Mem_IDNo = A.Tah_IDNo
                                                            --- AND Mem_WorkStatus <> 'IM'
                                                    LEFT JOIN {0}..T_EmpAlphalistHdrHst B
                                                    ON A.Tah_IDNo = B.Tah_IDNo
                                                    AND A.Tah_TaxYear = B.Tah_TaxYear  
                                                    WHERE A.Tah_TaxYear <= '{1}'
                                                        AND B.Tah_TaxYear IS NULL

                                                    DELETE A
                                                    FROM {0}..T_EmpAlphalistHdr A
                                                    INNER JOIN M_Employee ON Mem_IDNo = A.Tah_IDNo
	                                                        ----AND Mem_WorkStatus <> 'IM'
                                                    WHERE A.Tah_TaxYear <= '{1}'

                                                        INSERT INTO {0}..T_EmpAlphalistDtlHst 
                                                        (Tad_IDNo
                                                        ,Tad_TaxYear
                                                        ,Tad_LineNo
                                                        ,Tad_LastName
                                                        ,Tad_FirstName
                                                        ,Tad_MiddleName
                                                        ,Tad_BirthDate
                                                        ,Usr_Login
                                                        ,Ludatetime)

                                                        SELECT A.Tad_IDNo
                                                            ,A.Tad_TaxYear
                                                            ,A.Tad_LineNo
                                                            ,A.Tad_LastName
                                                            ,A.Tad_FirstName
                                                            ,A.Tad_MiddleName
                                                            ,A.Tad_BirthDate
                                                            ,A.Usr_Login
                                                            ,A.Ludatetime
                                                        FROM {0}..T_EmpAlphalistDtl A
                                                        INNER JOIN M_Employee ON Mem_IDNo = A.Tad_IDNo
	                                                        --- AND Mem_WorkStatus <> 'IM'
                                                        LEFT JOIN {0}..T_EmpAlphalistDtlHst B
                                                        ON A.Tad_IDNo = B.Tad_IDNo
                                                        AND A.Tad_TaxYear = B.Tad_TaxYear
                                                        AND A.Tad_LineNo = B.Tad_LineNo
                                                        WHERE A.Tad_TaxYear <= '{1}'
                                                         AND B.Tad_TaxYear IS NULL

                                                        DELETE A
                                                        FROM {0}..T_EmpAlphalistDtl A
                                                        INNER JOIN M_Employee ON Mem_IDNo = A.Tad_IDNo
	                                                        ---AND Mem_WorkStatus <> 'IM'
                                                        WHERE A.Tad_TaxYear <= '{1}'


                                                        INSERT INTO {0}..T_EmpAlphalistStagingHst 
                                                            (Tas_TaxYear
                                                            , Tas_IDNo
                                                            , Tas_PayCycle
                                                            , Tas_ProfileCode
                                                            , Tas_DataSource
                                                            , Tas_SalaryRate
                                                            , Tas_IsTaxExempted
                                                            , Tas_Basic_PAY
                                                            , Tas_Basic_INC
                                                            , Tas_Basic_YTD
                                                            , Tas_Basic_ADJ
                                                            , Tas_Representation_INC
                                                            , Tas_Representation_YTD
                                                            , Tas_Transportation_INC
                                                            , Tas_Transportation_YTD
                                                            , Tas_CostLivingAllowance_INC
                                                            , Tas_CostLivingAllowance_YTD
                                                            , Tas_FixedHousingAllowance_INC
                                                            , Tas_FixedHousingAllowance_YTD
                                                            , Tas_RegularOtherTaxableIncome1_PAY
                                                            , Tas_RegularOtherTaxableIncome1_INC
                                                            , Tas_RegularOtherTaxableIncome1_YTD
                                                            , Tas_RegularOtherTaxableIncome2_PAY
                                                            , Tas_RegularOtherTaxableIncome2_INC
                                                            , Tas_RegularOtherTaxableIncome2_YTD
                                                            , Tas_Commision_INC
                                                            , Tas_Commision_YTD
                                                            , Tas_ProfitSharing_INC
                                                            , Tas_ProfitSharing_YTD
                                                            , Tas_Fees_INC
                                                            , Tas_Fees_YTD
                                                            , Tas_Hazard_INC
                                                            , Tas_Hazard_YTD
                                                            , Tas_Overtime_PAY
                                                            , Tas_Overtime_INC
                                                            , Tas_Overtime_YTD
                                                            , Tas_Overtime_ADJ
                                                            , Tas_SupplementaryOtherTaxableIncome1_PAY
                                                            , Tas_SupplementaryOtherTaxableIncome1_INC
                                                            , Tas_SupplementaryOtherTaxableIncome1_YTD
                                                            , Tas_SupplementaryOtherTaxableIncome2_PAY
                                                            , Tas_SupplementaryOtherTaxableIncome2_INC
                                                            , Tas_SupplementaryOtherTaxableIncome2_YTD
                                                            , Tas_MWEBasic_PAY
                                                            , Tas_MWEBasic_INC
                                                            , Tas_MWEBasic_YTD
                                                            , Tas_MWEBasic_ADJ
                                                            , Tas_MWEHoliday_PAY
                                                            , Tas_MWEHoliday_INC
                                                            , Tas_MWEHoliday_YTD
                                                            , Tas_MWEHoliday_ADJ
                                                            , Tas_MWEOvertime_PAY
                                                            , Tas_MWEOvertime_INC
                                                            , Tas_MWEOvertime_YTD
                                                            , Tas_MWEOvertime_ADJ
                                                            , Tas_MWENightShift_PAY
                                                            , Tas_MWENightShift_INC
                                                            , Tas_MWENightShift_YTD
                                                            , Tas_MWENightShift_ADJ
                                                            , Tas_MWEHazard_INC
                                                            , Tas_MWEHazard_YTD
                                                            , Tas_13thMonthBen_PAY
                                                            , Tas_13thMonthBen_INC
                                                            , Tas_13thMonthBen_YTD
                                                            , Tas_DeMinimis_INC
                                                            , Tas_DeMinimis_YTD
                                                            , Tas_Premiums_PAY
                                                            , Tas_Premiums_INC
                                                            , Tas_Premiums_DED
                                                            , Tas_Premiums_YTD
                                                            , Tas_NontaxableSalaries_INC
                                                            , Tas_NontaxableSalaries_YTD
                                                            , Tas_Tax_PAY
                                                            , Tas_Tax_INC
                                                            , Tas_Tax_DED
                                                            , Tas_Tax_YTD
                                                            , Tas_PremiumPaidOnHealth
                                                            , Usr_Login
                                                            , Ludatetime)

                                                            SELECT A.Tas_TaxYear
                                                            , A.Tas_IDNo
                                                            , A.Tas_PayCycle
                                                            , A.Tas_ProfileCode
                                                            , A.Tas_DataSource
                                                            , A.Tas_SalaryRate
                                                            , A.Tas_IsTaxExempted
                                                            , A.Tas_Basic_PAY
                                                            , A.Tas_Basic_INC
                                                            , A.Tas_Basic_YTD
                                                            , A.Tas_Basic_ADJ
                                                            , A.Tas_Representation_INC
                                                            , A.Tas_Representation_YTD
                                                            , A.Tas_Transportation_INC
                                                            , A.Tas_Transportation_YTD
                                                            , A.Tas_CostLivingAllowance_INC
                                                            , A.Tas_CostLivingAllowance_YTD
                                                            , A.Tas_FixedHousingAllowance_INC
                                                            , A.Tas_FixedHousingAllowance_YTD
                                                            , A.Tas_RegularOtherTaxableIncome1_PAY
                                                            , A.Tas_RegularOtherTaxableIncome1_INC
                                                            , A.Tas_RegularOtherTaxableIncome1_YTD
                                                            , A.Tas_RegularOtherTaxableIncome2_PAY
                                                            , A.Tas_RegularOtherTaxableIncome2_INC
                                                            , A.Tas_RegularOtherTaxableIncome2_YTD
                                                            , A.Tas_Commision_INC
                                                            , A.Tas_Commision_YTD
                                                            , A.Tas_ProfitSharing_INC
                                                            , A.Tas_ProfitSharing_YTD
                                                            , A.Tas_Fees_INC
                                                            , A.Tas_Fees_YTD
                                                            , A.Tas_Hazard_INC
                                                            , A.Tas_Hazard_YTD
                                                            , A.Tas_Overtime_PAY
                                                            , A.Tas_Overtime_INC
                                                            , A.Tas_Overtime_YTD
                                                            , A.Tas_Overtime_ADJ
                                                            , A.Tas_SupplementaryOtherTaxableIncome1_PAY
                                                            , A.Tas_SupplementaryOtherTaxableIncome1_INC
                                                            , A.Tas_SupplementaryOtherTaxableIncome1_YTD
                                                            , A.Tas_SupplementaryOtherTaxableIncome2_PAY
                                                            , A.Tas_SupplementaryOtherTaxableIncome2_INC
                                                            , A.Tas_SupplementaryOtherTaxableIncome2_YTD
                                                            , A.Tas_MWEBasic_PAY
                                                            , A.Tas_MWEBasic_INC
                                                            , A.Tas_MWEBasic_YTD
                                                            , A.Tas_MWEBasic_ADJ
                                                            , A.Tas_MWEHoliday_PAY
                                                            , A.Tas_MWEHoliday_INC
                                                            , A.Tas_MWEHoliday_YTD
                                                            , A.Tas_MWEHoliday_ADJ
                                                            , A.Tas_MWEOvertime_PAY
                                                            , A.Tas_MWEOvertime_INC
                                                            , A.Tas_MWEOvertime_YTD
                                                            , A.Tas_MWEOvertime_ADJ
                                                            , A.Tas_MWENightShift_PAY
                                                            , A.Tas_MWENightShift_INC
                                                            , A.Tas_MWENightShift_YTD
                                                            , A.Tas_MWENightShift_ADJ
                                                            , A.Tas_MWEHazard_INC
                                                            , A.Tas_MWEHazard_YTD
                                                            , A.Tas_13thMonthBen_PAY
                                                            , A.Tas_13thMonthBen_INC
                                                            , A.Tas_13thMonthBen_YTD
                                                            , A.Tas_DeMinimis_INC
                                                            , A.Tas_DeMinimis_YTD
                                                            , A.Tas_Premiums_PAY
                                                            , A.Tas_Premiums_INC
                                                            , A.Tas_Premiums_DED
                                                            , A.Tas_Premiums_YTD
                                                            , A.Tas_NontaxableSalaries_INC
                                                            , A.Tas_NontaxableSalaries_YTD
                                                            , A.Tas_Tax_PAY
                                                            , A.Tas_Tax_INC
                                                            , A.Tas_Tax_DED
                                                            , A.Tas_Tax_YTD
                                                            , A.Tas_PremiumPaidOnHealth
                                                            , A.Usr_Login
                                                            , A.Ludatetime
                                                            FROM {0}..T_EmpAlphalistStaging A
                                                            INNER JOIN M_Employee ON Mem_IDNo = A.Tas_IDNo
	                                                        --- AND Mem_WorkStatus <> 'IM'
                                                            LEFT JOIN {0}..T_EmpAlphalistStagingHst B
                                                            ON A.Tas_TaxYear = B.Tas_TaxYear
                                                                AND A.Tas_IDNo = B.Tas_IDNo
                                                                AND A.Tas_PayCycle = B.Tas_PayCycle
                                                                AND A.Tas_ProfileCode = B.Tas_ProfileCode
                                                                AND A.Tas_DataSource = B.Tas_DataSource
                                                            WHERE A.Tas_TaxYear <= '{1}'
                                                            AND B.Tas_TaxYear IS NULL

                                                            DELETE A
                                                            FROM {0}..T_EmpAlphalistStaging A
                                                            INNER JOIN M_Employee ON Mem_IDNo = A.Tas_IDNo
	                                                            ----AND Mem_WorkStatus <> 'IM'
                                                            WHERE A.Tas_TaxYear <= '{1}'";

            public const string insertYTDHistory = @"INSERT INTO {0}..T_EmpYTDHst 
                                                            (Tyt_IDNo
                                                            , Tyt_TaxYear
                                                            , Tyt_StartDate
                                                            , Tyt_EndDate
                                                            , Tyt_EmployerType
                                                            , Tyt_EmployerName
                                                            , Tyt_TIN
                                                            , Tyt_EmployerAddress
                                                            , Tyt_EmployerZipCode
                                                            , Tyt_MWEBasic
                                                            , Tyt_MWEHoliday
                                                            , Tyt_MWEOvertime
                                                            , Tyt_MWENightShift
                                                            , Tyt_MWEHazard
                                                            , Tyt_Nontaxable13thMonth
                                                            , Tyt_DeMinimis
                                                            , Tyt_PremiumsUnionDues
                                                            , Tyt_NontaxableSalariesCompensation
                                                            , Tyt_TaxableBasic
                                                            , Tyt_TaxableBasicNetPremiums
                                                            , Tyt_Taxable13thMonth
                                                            , Tyt_TaxableSalariesCompensation
                                                            , Tyt_TaxableOvertime
                                                            , Tyt_Hazard
                                                            , Tyt_PremiumPaidOnHealth
                                                            , Tyt_TaxWithheld
                                                            , Tyt_Representation
                                                            , Tyt_Transportation
                                                            , Tyt_CostLivingAllowance
                                                            , Tyt_FixedHousingAllowance
                                                            , Tyt_OtherTaxable1
                                                            , Tyt_OtherTaxable2
                                                            , Tyt_Commision
                                                            , Tyt_ProfitSharing
                                                            , Tyt_Fees
                                                            , Tyt_SupplementaryTaxable1
                                                            , Tyt_SupplementaryTaxable2
                                                            , Tyt_EmploymentStatus
                                                            , Tyt_SeparationReason
                                                            , Usr_Login
                                                            , Ludatetime)

                                                        SELECT A.Tyt_IDNo
                                                            , A.Tyt_TaxYear
                                                            , A.Tyt_StartDate
                                                            , A.Tyt_EndDate
                                                            , A.Tyt_EmployerType
                                                            , A.Tyt_EmployerName
                                                            , A.Tyt_TIN
                                                            , A.Tyt_EmployerAddress
                                                            , A.Tyt_EmployerZipCode
                                                            , A.Tyt_MWEBasic
                                                            , A.Tyt_MWEHoliday
                                                            , A.Tyt_MWEOvertime
                                                            , A.Tyt_MWENightShift
                                                            , A.Tyt_MWEHazard
                                                            , A.Tyt_Nontaxable13thMonth
                                                            , A.Tyt_DeMinimis
                                                            , A.Tyt_PremiumsUnionDues
                                                            , A.Tyt_NontaxableSalariesCompensation
                                                            , A.Tyt_TaxableBasic
                                                            , A.Tyt_TaxableBasicNetPremiums
                                                            , A.Tyt_Taxable13thMonth
                                                            , A.Tyt_TaxableSalariesCompensation
                                                            , A.Tyt_TaxableOvertime
                                                            , A.Tyt_Hazard
                                                            , A.Tyt_PremiumPaidOnHealth
                                                            , A.Tyt_TaxWithheld
                                                            , A.Tyt_Representation
                                                            , A.Tyt_Transportation
                                                            , A.Tyt_CostLivingAllowance
                                                            , A.Tyt_FixedHousingAllowance
                                                            , A.Tyt_OtherTaxable1
                                                            , A.Tyt_OtherTaxable2
                                                            , A.Tyt_Commision
                                                            , A.Tyt_ProfitSharing
                                                            , A.Tyt_Fees
                                                            , A.Tyt_SupplementaryTaxable1
                                                            , A.Tyt_SupplementaryTaxable2
                                                            , A.Tyt_EmploymentStatus
                                                            , A.Tyt_SeparationReason
                                                            , A.Usr_Login
                                                            , A.Ludatetime
                                                        FROM {0}..T_EmpYTD A
                                                        INNER JOIN M_Employee ON Mem_IDNo = A.Tyt_IDNo
	                                                        ----AND Mem_WorkStatus <> 'IM'
                                                        LEFT JOIN {0}..T_EmpYTDHst B
                                                        ON A.Tyt_IDNo = B.Tyt_IDNo
                                                        AND A.Tyt_TaxYear = B.Tyt_TaxYear
                                                        AND A.Tyt_StartDate = B.Tyt_StartDate
                                                        WHERE A.Tyt_TaxYear <= '{1}'
                                                            AND B.Tyt_TaxYear IS NULL

                                                        DELETE A
                                                        FROM {0}..T_EmpYTD A
                                                        INNER JOIN M_Employee ON Mem_IDNo = A.Tyt_IDNo
	                                                        ----AND Mem_WorkStatus <> 'IM'
                                                        WHERE A.Tyt_TaxYear <= '{1}'";

            public const string countLeaveBalancesRemain = @"Select IsNull(Sum(Elm_VLBalance), 0) SumVL
	                                                                    , IsNull(Sum(Elm_SLBalance), 0) SumSL
	                                                                    , IsNull(Sum(Elm_PLBalance), 0) SumPL
	                                                                    , IsNull(Sum(Elm_BLBalance), 0) SumBL
	                                                                    , IsNull(Sum(Elm_ELBalance), 0) SumEL
		                                                            From T_EmployeeLeaveMaster";
            public const string countLeaveBalancesDeduct = @"Select Sum(Case when Tlr_LeaveCode = 'VL' then Tlr_LeaveHr else 0 end) SumVL
		                                                                , Sum(Case when Tlr_LeaveCode = 'SL' then Tlr_LeaveHr else 0 end) SumSL
	                                                                From T_EmpLeaveConversion";
            public const string deductLeaveBalances = @"UPDATE T_EmployeeLeaveMaster
	                                                                SET Elm_VLBalance = Elm_VLBalance - Tlr_LeaveHr
	                                                                FROM T_EmployeeLeaveMaster 
	                                                                Inner join  T_EmpLeaveConversion on  Tlr_IDNo = Elm_EmployeeID
	                                                                and Tlr_LeaveCode = 'VL'

	                                                                UPDATE T_EmployeeLeaveMaster
	                                                                SET Elm_SLBalance = Elm_SLBalance - Tlr_LeaveHr
	                                                                FROM T_EmployeeLeaveMaster 
	                                                                Inner join  T_EmpLeaveConversion on  Tlr_IDNo = Elm_EmployeeID
	                                                                and Tlr_LeaveCode = 'SL'

	                                                                UPDATE T_EmployeeLeaveMaster
	                                                                SET Elm_PLBalance = 0,
	                                                                Elm_BLBalance = 0,
	                                                                Elm_ELBalance = 0
	                                                                FROM T_EmployeeLeaveMaster 
	                                                                INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeID
	                                                                and Left(Mem_WorkStatus, 1) = 'A'";
            public const string countLeaveBalancesPost = @"DECLARE @EndOfYear as Datetime Set @EndOfYear  = '12/31/'+ (select Mcm_ProcessYear from M_Company)
                                                                    DECLARE @VLCREDIT  decimal(7,4), @SLCREDIT decimal(7,4)

                                                                    SET @VLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                                    where Mph_PolicyCode = 'VLCREDIT' and Mph_RecordStatus = 'A')

                                                                    SET @SLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                                    where Mph_PolicyCode = 'SLCREDIT' and Mph_RecordStatus = 'A')

                                                                    SELECT SUM(CASE WHEN
			                                                                        CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear )), Mem_IntakeDate) > @EndOfYear  THEN 
					                                                                        datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear  )) - 1
				                                                                        ELSE 
					                                                                        datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear ))
				                                                                        END  >= 1 THEN  @VLCREDIT
	                                                                        ELSE 0 END) as VLBal
                                                                    ,SUM(CASE WHEN
			                                                                        CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear )), Mem_IntakeDate) > @EndOfYear  THEN 
						                                                                        datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear  )) - 1
					                                                                        ELSE 
						                                                                        datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear ))
					                                                                        END  >= 1 THEN  @SLCREDIT 
		                                                                        ELSE 0 END) as SLBal
                                                                    From T_EmployeeLeaveMaster
                                                                    INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeID
                                                                        and CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear )), 		Mem_IntakeDate) > @EndOfYear  THEN 
				                                                                        datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear  )) 		- 1
			                                                                        ELSE 
				                                                                        datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear ))
			                                                                        END  >= 1
                                                                        and LEFT(Mem_WorkStatus, 1) = 'A'";
            public const string insertLeaveBalancesOLD = @"DECLARE @EndOfYear as Datetime Set @EndOfYear  = '12/31/'+ (select Mcm_ProcessYear from M_Company)
                                                                    DECLARE @VLCREDIT  decimal(7,4), @SLCREDIT decimal(7,4)

                                                                    SET @VLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                                    where Mph_PolicyCode = 'VLCREDIT' and Mph_RecordStatus = 'A')

                                                                    SET @SLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                                    where Mph_PolicyCode = 'SLCREDIT' and Mph_RecordStatus = 'A')

                                                                    UPDATE T_EmployeeLeaveMaster
                                                                    SET	Elm_VLBalance = Elm_VLBalance + 
	                                                                    CASE WHEN
			                                                                    CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear )), Mem_IntakeDate) > @EndOfYear  THEN 
						                                                                    datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear  )) - 1
					                                                                    ELSE 
						                                                                    datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear ))
					                                                                    END  >= 1 THEN  @VLCREDIT
		                                                                    ELSE 0 END
                                                                    , Elm_SLBalance = Elm_SLBalance + 
		                                                                    CASE WHEN
				                                                                    CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear )), Mem_IntakeDate) > @EndOfYear  THEN 
							                                                                    datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear  )) - 1
						                                                                    ELSE 
							                                                                    datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfYear ))
						                                                                    END  >= 1 THEN  @SLCREDIT
			                                                                    ELSE 0 END
                                                                    From T_EmployeeLeaveMaster
                                                                    INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeID
	                                                                    and CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear )), 		Mem_IntakeDate) > @EndOfYear  THEN 
					                                                                    datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear  )) 		- 1
				                                                                    ELSE 
					                                                                    datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfYear ))
				                                                                    END  >= 1
	                                                                    and LEFT(Mem_WorkStatus, 1) = 'A'
                                                                        and Mem_EmploymentStatusCode = 'RG'";
            
            

            public const string countYearsService = @"SELECT CASE	WHEN dateadd(year, datediff (year, @NextPayPeriodStartDate, Convert(Datetime,@NextPayPeriodEndDate )), @NextPayPeriodStartDate) > @NextPayPeriodEndDate  
			                                                        THEN  datediff (year, @NextPayPeriodStartDate,Convert(Datetime,@NextPayPeriodEndDate  )) - 1
			                                                        ELSE datediff (year, @NextPayPeriodStartDate,Convert(Datetime,@NextPayPeriodEndDate )) 
	                                                         END";

            public const string updateProcessFlagLeaveCredit = @"Update T_SettingControl
	                                                            Set Tsc_SetFlag = 0
	                                                            ,Usr_Login = @UserLogin
	                                                            ,Ludatetime = GetDate()
	                                                            Where Tsc_SystemCode = 'LEAVE'
	                                                            And Tsc_SettingCode = 'LVEREFUND'";
            public const string updateProcessFlagYearEnd = @"   UPDATE T_SettingControl
                                                                SET Tsc_SetFlag = 1
	                                                            ,Usr_Login = @UserLogin
	                                                            ,Ludatetime = GetDate()
                                                                WHERE Tsc_SystemCode = 'PAYROLL'
                                                                AND Tsc_SettingCode = 'YEAREND'
                                                                    
                                                                 SELECT  Tsc_SystemCode
                                                                     , Tsc_SettingCode
                                                                     , Tsc_SettingName
                                                                     , 1
                                                                     , Tsc_AccessType
                                                                     , @CurPayPeriod
                                                                     , NULL
                                                                     , 'A'
                                                                     , @UserLogin
                                                                     , GETDATE()
                                                                FROM T_SettingControl
                                                                 WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                AND Tsc_SettingCode = 'YEAREND'";

            #endregion
            #region [For Cycle Opening]
            
            public const string deleteIncomeRecords = @"DELETE FROM T_EmpIncome
                                                                FROM T_EmpIncome
                                                                INNER JOIN {0}..M_Income on Min_IncomeCode = Tin_IncomeCode
	                                                                AND Min_IsRecurring = 0
                                                                    AND Min_CompanyCode = @CompanyCode
                                                                WHERE Tin_PostFlag = 1
	                                                                and Tin_PayCycle = @CurPayPeriod";

            public const string deleteTimebasedIncomeRecords = @"DELETE FROM T_EmpTimeBaseAllowanceCycle
                                                                WHERE Tta_PostFlag = 1
	                                                                and Tta_PayCycle = @CurPayPeriod";

            public const string deleteInsertRecurringIncomeRecords = @"DELETE FROM T_EmpIncome
                                                                    FROM T_EmpIncome
                                                                    INNER JOIN {0}..M_Income ON Min_IncomeCode = Tin_IncomeCode
	                                                                    AND Min_IsRecurring = 1
                                                                        AND Min_CompanyCode = @CompanyCode
                                                                    WHERE Tin_PayCycle = @CurPayPeriod
                                                                        ---AND Tin_PostFlag = 1
																		AND Min_CycleOpenUnpostedRule = 'R'

                                                                    UPDATE T_EmpIncome 
																		SET Tin_PayCycle = @NextPayPeriod
																		, Usr_Login = @UserLogin
																		, Ludatetime = GETDATE()
																		FROM T_EmpIncome
																		INNER JOIN {0}..M_Income 
																		ON Min_IncomeCode = Tin_IncomeCode
																			AND Min_IsRecurring = 1
																			AND Min_CompanyCode = @CompanyCode
																		WHERE Tin_PayCycle =  @CurPayPeriod
																			AND Tin_PostFlag = 0
																			AND Min_CycleOpenUnpostedRule = 'C'

                                                                    	SELECT RecurAllow.Tfa_IDNo
		                                                                      ,MAX(RecurAllow.Tfa_StartPayCycle) AS PayPeriod
		                                                                      ,RecurAllow.Tfa_AllowanceCode
                                                                          INTO #TempList
                                                                          FROM {0}..T_EmpFixAllowance RecurAllow
                                                                          INNER JOIN M_Employee ON Tfa_IDNo = Mem_IDNo
																				AND Mem_WorkStatus = 'A'
                                                                          INNER JOIN {0}..M_Income 
                                                                          ON Min_IncomeCode = RecurAllow.Tfa_AllowanceCode
	                                                                            AND Min_IsRecurring = 1
                                                                                AND Min_CompanyCode = @CompanyCode
	                                                                            AND Min_RecordStatus = 'A'
	                                                                            AND (Min_ApplicablePayCycle = '0' OR Min_ApplicablePayCycle = @Quincena)
 	                                                                      WHERE Tfa_RecordStatus = 'A'
	                                                                            AND Tfa_StartPayCycle <= @NextPayPeriod
                                                                                AND (ISNULL(Tfa_EndPayCycle,'') = '' OR Tfa_EndPayCycle >= @NextPayPeriod)
                                                                                AND Tfa_Amount <> 0
                                                                      GROUP BY Tfa_IDNo,
 		                                                                       Tfa_AllowanceCode

                                                                    INSERT INTO T_EmpIncome
                                                                                (Tin_IDNo
                                                                               ,Tin_PayCycle
                                                                               ,Tin_OrigPayCycle
                                                                               ,Tin_IncomeCode
                                                                               ,Tin_PostFlag
                                                                               ,Tin_IncomeAmt
                                                                               ,Usr_Login
                                                                               ,Ludatetime)
                                                                         SELECT #TempList.Tfa_IDNo
		                                                                       ,@NextPayPeriod as Tfa_StartPayCycle
                                                                               ,@NextPayPeriod as Tfa_OrigStartPayCycle
		                                                                       ,#TempList.Tfa_AllowanceCode
		                                                                       ,0 as Tin_PostFlag 
		                                                                       ,RecurAllow.Tfa_Amount
		                                                                       ,Usr_Login = @UserLogin
		                                                                       ,Ludatetime = GETDATE()
	                                                                       FROM #TempList 
                                                                     INNER JOIN {0}..T_EmpFixAllowance RecurAllow  
		                                                                     ON #TempList.Tfa_IDNo = RecurAllow.Tfa_IDNo
		                                                                    AND #TempList.PayPeriod	= RecurAllow.Tfa_StartPayCycle
		                                                                    AND #TempList.Tfa_AllowanceCode = RecurAllow.Tfa_AllowanceCode
                                                                     DROP TABLE #TempList";

            public const string updateIncomeRecords = @"UPDATE T_EmpIncome
                                                                SET Tin_PayCycle = @NextPayPeriod,
	                                                                Usr_Login = @UserLogin,
	                                                                Ludatetime = GETDATE()
                                                                WHERE Tin_PayCycle = @CurPayPeriod";            

            public const string deleteManualAdjustmentExtOverrideRecords = @"
                                                                --posted T_EmpManualAdjMisc2
                                                                DELETE FROM T_EmpManualAdjMisc2
                                                                FROM T_EmpManualAdjMisc2
                                                                INNER JOIN T_EmpManualAdj ON Tma_IDNo = Tmm_IDNo
	                                                                AND Tma_PayCycle = Tmm_PayCycle
                                                                    AND Tma_OrigPayCycle = Tmm_OrigPayCycle
	                                                                AND Tma_SalaryRate = Tmm_SalaryRate
	                                                                AND Tma_PostFlag = 1
                                                                WHERE Tmm_PayCycle = @CurPayPeriod
                                                                
                                                                --posted T_EmpManualAdjMisc
                                                                DELETE FROM T_EmpManualAdjMisc
                                                                FROM T_EmpManualAdjMisc
                                                                INNER JOIN T_EmpManualAdj ON Tma_IDNo = Tmm_IDNo
	                                                                AND Tma_PayCycle = Tmm_PayCycle
                                                                    AND Tma_OrigPayCycle = Tmm_OrigPayCycle
	                                                                AND Tma_SalaryRate = Tmm_SalaryRate
	                                                                AND Tma_PostFlag = 1
                                                                WHERE Tmm_PayCycle = @CurPayPeriod
                                                                "; 

            public const string deleteLaborHrsAdjustmentExtRecords = @"DELETE FROM T_EmpSystemAdjMisc
                                                                        WHERE Tsm_IDNo + '' + Tsm_AdjPayCycle + '' + Tsm_PayCycle + '' + CAST(Tsm_Date AS VARCHAR) IN
                                                                            (SELECT A.Tsm_IDNo + '' + A.Tsm_AdjPayCycle + '' + A.Tsm_PayCycle + '' + CAST(A.Tsm_Date AS VARCHAR)
                                                                            FROM T_EmpSystemAdjMisc A
                                                                            INNER JOIN T_EmpSystemAdj B
                                                                            ON A.Tsm_IDNo = B.Tsa_IDNo
                                                                            AND A.Tsm_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                            AND A.Tsm_PayCycle = B.Tsa_PayCycle
                                                                            AND A.Tsm_Date = B.Tsa_Date
                                                                            AND B.Tsa_PostFlag = 1
                                                                            AND B.Tsa_AdjPayCycle = @CurPayPeriod)";
            public const string deleteManualAdjustmentRecords = @"--posted T_EmpManualAdj
                                                                    DELETE FROM T_EmpManualAdj2
                                                                    FROM T_EmpManualAdj2 A INNER JOIN T_EmpManualAdj B
                                                                    ON A.Tma_IDNo = B.Tma_IDNo
                                                                    AND A.Tma_PayCycle = B.Tma_PayCycle
                                                                    AND A.Tma_OrigPayCycle = B.Tma_OrigPayCycle
                                                                    AND A.Tma_SalaryRate = B.Tma_SalaryRate                                                            
                                                                    WHERE B.Tma_PostFlag = 1
                                                                    AND A.Tma_PayCycle = @CurPayPeriod

                                                                    DELETE FROM T_EmpManualAdj
                                                                    WHERE Tma_PostFlag = 1
	                                                                    AND Tma_PayCycle = @CurPayPeriod
                                                                    
                                                                    ";

            public const string deleteSystemAdjustmentOverrideRecords = @"--retain manual T_EmpSystemAdj2
                                                                    
                                                                    DELETE FROM T_EmpSystemAdj2 
                                                                    FROM T_EmpSystemAdj2 A
                                                                    INNER JOIN T_EmpSystemAdj B on  A.Tsa_IDNo =  B.Tsa_IDNo
		                                                                    AND  A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                            AND  A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
		                                                                    AND  A.Tsa_PayCycle = B.Tsa_PayCycle
		                                                                    AND  A.Tsa_Date = B.Tsa_Date
		                                                                    AND B.Tsa_PostFlag = 0
                                                                    WHERE A.Tsa_IDNo + A.Tsa_AdjPayCycle + A.Tsa_OrigAdjPayCycle 
                                                                                                            IN (SELECT DISTINCT Tma_IDNo + Tma_PayCycle + Tma_OrigPayCycle
										                                                                    FROM T_EmpManualAdj
										                                                                    WHERE Tma_RetainUserEntry = 1
											                                                                    AND Tma_PostFlag = 1
											                                                                    AND Tma_PayCycle = @CurPayPeriod)
	                                                                    AND A.Tsa_AdjPayCycle = @CurPayPeriod

                                                                    --posted T_EmpSystemAdj2
                                                                    DELETE FROM T_EmpSystemAdj2 
                                                                    FROM T_EmpSystemAdj2 A
                                                                    INNER JOIN T_EmpSystemAdj B on  A.Tsa_IDNo =  B.Tsa_IDNo
	                                                                    AND  A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                        AND  A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
	                                                                    AND  A.Tsa_PayCycle = B.Tsa_PayCycle
	                                                                    AND  A.Tsa_Date = B.Tsa_Date
	                                                                    AND  B.Tsa_PostFlag = 1
                                                                    WHERE A.Tsa_AdjPayCycle = @CurPayPeriod";

            public const string deleteSystemAdjustmentExtOverrideRecords = @"
                                                                    --retain manual T_EmpSystemAdjMisc2
                                                                    DELETE FROM T_EmpSystemAdjMisc2
                                                                    FROM T_EmpSystemAdjMisc2
                                                                    INNER JOIN T_EmpSystemAdj on  Tsa_IDNo = Tsm_IDNo
	                                                                    AND Tsa_AdjPayCycle = Tsm_AdjPayCycle
                                                                        AND Tsa_OrigAdjPayCycle = Tsm_OrigAdjPayCycle
	                                                                    AND Tsa_PayCycle = Tsm_PayCycle
	                                                                    AND Tsa_Date = Tsm_Date
	                                                                    AND Tsa_PostFlag = 0
                                                                    WHERE Tsm_IDNo + Tsm_AdjPayCycle + Tsm_OrigAdjPayCycle 
                                                                                                        IN (SELECT DISTINCT Tma_IDNo + Tma_PayCycle + Tma_OrigPayCycle 
									                                                                     FROM T_EmpManualAdj
									                                                                     WHERE Tma_RetainUserEntry = 1
										                                                                    AND Tma_PostFlag = 1
										                                                                    AND Tma_PayCycle = @CurPayPeriod)
	                                                                    AND Tsm_AdjPayCycle = @CurPayPeriod

                                                                    --posted T_EmpSystemAdjMisc2
                                                                    DELETE FROM T_EmpSystemAdjMisc2
                                                                    FROM T_EmpSystemAdjMisc2
                                                                    INNER JOIN T_EmpSystemAdj ON Tsa_IDNo = Tsm_IDNo
	                                                                    AND Tsa_AdjPayCycle = Tsm_AdjPayCycle
                                                                        AND Tsa_OrigAdjPayCycle = Tsm_OrigAdjPayCycle
	                                                                    AND Tsa_PayCycle = Tsm_PayCycle
	                                                                    AND Tsa_Date = Tsm_Date
	                                                                    AND Tsa_PostFlag = 1
                                                                    WHERE Tsm_AdjPayCycle = @CurPayPeriod                                                                    

                                                                    --retain manual T_EmpSystemAdjMisc
                                                                    DELETE FROM T_EmpSystemAdjMisc
                                                                    FROM T_EmpSystemAdjMisc
                                                                    INNER JOIN T_EmpSystemAdj ON Tsa_IDNo = Tsm_IDNo
	                                                                    AND Tsa_AdjPayCycle = Tsm_AdjPayCycle
	                                                                    AND Tsa_PayCycle = Tsm_PayCycle
                                                                        AND Tsa_OrigAdjPayCycle = Tsm_OrigAdjPayCycle
	                                                                    AND Tsa_Date = Tsm_Date
	                                                                    AND Tsa_PostFlag = 0
                                                                    WHERE Tsm_IDNo + Tsm_AdjPayCycle + Tsm_OrigAdjPayCycle
                                                                                                        IN (SELECT DISTINCT Tma_IDNo + Tma_PayCycle + Tma_OrigPayCycle 
									                                                                     FROM T_EmpManualAdj
									                                                                     WHERE Tma_RetainUserEntry = 1
										                                                                    AND Tma_PostFlag = 1
										                                                                    AND Tma_PayCycle = @CurPayPeriod)
	                                                                    AND Tsm_AdjPayCycle = @CurPayPeriod

                                                                    --posted T_EmpSystemAdjMisc
                                                                     DELETE FROM T_EmpSystemAdjMisc
                                                                    FROM T_EmpSystemAdjMisc A
                                                                    INNER JOIN T_EmpSystemAdj B on  A.Tsm_IDNo =  B.Tsa_IDNo
	                                                                    AND  A.Tsm_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                        AND  A.Tsm_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
	                                                                    AND  A.Tsm_PayCycle = B.Tsa_PayCycle
	                                                                    AND  A.Tsm_Date = B.Tsa_Date
	                                                                    AND  B.Tsa_PostFlag = 1
                                                                    WHERE A.Tsm_AdjPayCycle = @CurPayPeriod

                                                                    ";

            public const string deleteSystemAdjustmentRecords = @"--posted T_EmpSystemAdj
                                    
                                                                    DELETE FROM T_EmpSystemAdj2
                                                                    FROM T_EmpSystemAdj2 A INNER JOIN T_EmpSystemAdj B
                                                                    ON A.Tsa_IDNo = B.Tsa_IDNo
                                                                    AND A.Tsa_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                    AND A.Tsa_OrigAdjPayCycle = B.Tsa_OrigAdjPayCycle
                                                                    AND A.Tsa_PayCycle = B.Tsa_PayCycle
                                                                    AND A.Tsa_Date = B.Tsa_Date
                                                                    WHERE A.Tsa_AdjPayCycle = @CurPayPeriod
                                                                    AND B.Tsa_PostFlag = 1

                                                                    DELETE FROM T_EmpSystemAdj
                                                                    WHERE Tsa_AdjPayCycle = @CurPayPeriod
	                                                                    AND Tsa_PostFlag = 1

                                                                    --retain manual T_EmpSystemAdj
                                                                    DELETE FROM T_EmpSystemAdj
                                                                    WHERE Tsa_IDNo + Tsa_AdjPayCycle + Tsa_OrigAdjPayCycle IN (SELECT DISTINCT Tma_IDNo + Tma_PayCycle + Tma_OrigPayCycle
									                                                                    FROM T_EmpManualAdj
									                                                                    WHERE Tma_RetainUserEntry = 1
										                                                                    AND Tma_PostFlag = 1
										                                                                    AND Tma_PayCycle = @CurPayPeriod)
	                                                                    AND Tsa_AdjPayCycle = @CurPayPeriod
	                                                                    AND Tsa_PostFlag = 0

                                                                    UPDATE T_EmpSystemAdj
                                                                    SET Tsa_AdjPayCycle  = @NextPayPeriod,
                                                                        Usr_Login = @UserLogin,
                                                                        Ludatetime = getdate()
                                                                    WHERE Tsa_AdjPayCycle = @CurPayPeriod

                                                                    UPDATE T_EmpSystemAdj2
                                                                    SET Tsa_AdjPayCycle  = @NextPayPeriod,
                                                                        Usr_Login = @UserLogin,
                                                                        Ludatetime = getdate()
                                                                    WHERE Tsa_AdjPayCycle = @CurPayPeriod";

            public const string initializeSystemAdjustmentMiscRecords = @"UPDATE T_EmpSystemAdjMisc
                                                                    SET Tsm_AdjPayCycle  = @NextPayPeriod,
                                                                        Usr_Login = @UserLogin,
                                                                        Ludatetime = getdate()
                                                                    WHERE Tsm_AdjPayCycle = @CurPayPeriod

                                                                    UPDATE T_EmpSystemAdjMisc2
                                                                    SET Tsm_AdjPayCycle  = @NextPayPeriod,
                                                                        Usr_Login = @UserLogin,
                                                                        Ludatetime = getdate()
                                                                    WHERE Tsm_AdjPayCycle = @CurPayPeriod";

            public const string initializeManualAdjustmentRecords = @"UPDATE T_EmpManualAdj
                                                                        SET Tma_PayCycle = @NextPayPeriod,
                                                                            Usr_Login = @UserLogin,
                                                                            Ludatetime = getdate()
                                                                        WHERE Tma_PayCycle = @CurPayPeriod

                                                                        UPDATE T_EmpManualAdj2
                                                                        SET Tma_PayCycle = @NextPayPeriod,
                                                                            Usr_Login = @UserLogin,
                                                                            Ludatetime = getdate()
                                                                        WHERE Tma_PayCycle = @CurPayPeriod";
            public const string initializeManualAdjustmentExtRecords = @"UPDATE T_EmpManualAdjMisc
                                                                        SET Tmm_PayCycle = @NextPayPeriod,
                                                                            Usr_Login = @UserLogin,
                                                                            Ludatetime = getdate()
                                                                        WHERE Tmm_PayCycle = @CurPayPeriod

                                                                        UPDATE T_EmpManualAdjMisc2
                                                                        SET Tmm_PayCycle = @NextPayPeriod,
                                                                            Usr_Login = @UserLogin,
                                                                            Ludatetime = getdate()
                                                                        WHERE Tmm_PayCycle = @CurPayPeriod";

            public const string deleteDeductionDeferred = @"DELETE FROM T_EmpDeductionDefer
                                                                FROM T_EmpDeductionDefer
                                                                INNER JOIN T_EmpDeductionDtl on T_EmpDeductionDtl.Tdd_IDNo =   T_EmpDeductionDefer.Tdd_IDNo 
	                                                                AND T_EmpDeductionDtl.Tdd_DeductionCode = T_EmpDeductionDefer.Tdd_DeductionCode
	                                                                AND T_EmpDeductionDtl.Tdd_StartDate  = T_EmpDeductionDefer.Tdd_StartDate
	                                                                AND T_EmpDeductionDtl.Tdd_PayCycle = T_EmpDeductionDefer.Tdd_PayCycle
	                                                                AND T_EmpDeductionDtl.Tdd_LineNo = T_EmpDeductionDefer.Tdd_LineNo
	                                                                AND Tdd_PaymentFlag = 1
	                                                                AND Tdd_ThisPayCycle = @CurPayPeriod 

                                                                INSERT INTO T_EmpDeductionDefer
                                                                SELECT T_EmpDeductionDtl.Tdd_IDNo
	                                                                    , T_EmpDeductionDtl.Tdd_DeductionCode
	                                                                    , T_EmpDeductionDtl.Tdd_StartDate
	                                                                    , T_EmpDeductionDtl.Tdd_PayCycle
	                                                                    , T_EmpDeductionDtl.Tdd_LineNo
	                                                                    , T_EmpDeductionDtl.Tdd_Amount
                                                                        , T_EmpDeductionDtl.Tdd_Remarks
	                                                                    , 'SA'
	                                                                    , GETDATE()
                                                                FROM T_EmpDeductionDtl
                                                                LEFT JOIN T_EmpDeductionDefer ON T_EmpDeductionDtl.Tdd_IDNo =   T_EmpDeductionDefer.Tdd_IDNo 							
                                                                    AND T_EmpDeductionDtl.Tdd_DeductionCode = T_EmpDeductionDefer.Tdd_DeductionCode								
                                                                    AND T_EmpDeductionDtl.Tdd_StartDate  = T_EmpDeductionDefer.Tdd_StartDate								
                                                                    AND T_EmpDeductionDtl.Tdd_PayCycle = T_EmpDeductionDefer.Tdd_PayCycle								
                                                                    AND T_EmpDeductionDtl.Tdd_LineNo = T_EmpDeductionDefer.Tdd_LineNo								
                                                                WHERE T_EmpDeductionDefer.Tdd_IDNo IS NULL
                                                                    AND Tdd_DeferredFlag = 1
                                                                    AND Tdd_PaymentFlag = 0
                                                                    AND Tdd_ThisPayCycle = @CurPayPeriod";

            
            public const string updateBirthdayLeaveCredits = @"UPDATE T_EmployeeLeaveMaster
                                                                SET Elm_DLBalance = Elm_DLBalance + (SELECT Mph_NumValue FROM M_PolicyHdr WHERE Mph_PolicyCode = 'DLCREDIT' and Mph_RecordStatus ='A')
                                                                  , Usr_Login = @UserLogin
                                                                  , Ludatetime = GetDate()
                                                                FROM T_EmployeeLeaveMaster
	                                                            INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeId
	                                                            Where Left(Mem_WorkStatus, 1) = 'A'
	                                                            And Substring(Convert(Char(6),Mem_BirthDate, 101), 1, 2) + 
		                                                            Substring(Convert(Char(6),Mem_BirthDate, 101), 4, 2) between @NextPayPeriodStartDate and @NextPayPeriodEndDate";
            
            public const string deleteDeductionDtlHst = @"DELETE FROM T_EmpDeductionDtlHst
                                                                FROM T_EmpDeductionDtlHst
                                                                INNER JOIN {0}..T_EmpDeductionHdr on Tdh_IDNo = Tdd_IDNo
                                                                    AND Tdh_DeductionCode = Tdd_DeductionCode
                                                                    AND Tdh_StartDate = Tdd_StartDate
                                                                    AND Tdh_PaymentDate IS NOT NULL
                                                                    AND Tdh_DeductionAmount = Tdh_PaidAmount

                                                                --?? M_Employee
                                                                DELETE FROM {0}..T_EmpDeductionHdr
                                                                FROM {0}..T_EmpDeductionHdr
                                                                INNER JOIN M_Employee ON Mem_IDNo = Tdh_IDNo
                                                                WHERE Tdh_PaymentDate IS NOT NULL
	                                                                AND Tdh_DeductionAmount = Tdh_PaidAmount";

            public const string InsertDeductionBackupMaster = @"INSERT INTO M_DeductionHst
                                                                    (Mdn_CompanyCode
                                                                    ,Mdn_PayCycle
                                                                    ,Mdn_DeductionCode
                                                                    ,Mdn_DeductionName
                                                                    ,Mdn_DeductionGroup
                                                                    ,Mdn_PriorityNo
                                                                    ,Mdn_PaymentTerms
                                                                    ,Mdn_ApplicablePayCycle
                                                                    ,Mdn_IsAllowDeferred
                                                                    ,Mdn_IsAllowPartialPayment
                                                                    ,Mdn_WithPrincipalAmount
                                                                    ,Mdn_WithCheckDate
                                                                    ,Mdn_AlphalistCategory
                                                                    ,Mdn_WithAccountingVoucher
                                                                    ,Mdn_PaidUpAmount
                                                                    ,Mdn_IsRecurring
                                                                    ,Mdn_AccountGrp
                                                                    ,Mdn_RemittanceLoanType
                                                                    ,Mdn_IsSystemReserved
                                                                    ,Mdn_ProcessFlag
                                                                    ,Mdn_ProcessInfo
                                                                    ,Mdn_RecordStatus
                                                                    ,Mdn_CreatedBy
                                                                    ,Mdn_CreatedDate
                                                                    ,Mdn_UpdatedBy
                                                                    ,Mdn_UpdatedDate)
                                                                SELECT Mdn_CompanyCode
                                                                , @CurPayPeriod
                                                                ,Mdn_DeductionCode
                                                                ,Mdn_DeductionName
                                                                ,Mdn_DeductionGroup
                                                                ,Mdn_PriorityNo
                                                                ,Mdn_PaymentTerms
                                                                ,Mdn_ApplicablePayCycle
                                                                ,Mdn_IsAllowDeferred
                                                                ,Mdn_IsAllowPartialPayment
                                                                ,Mdn_WithPrincipalAmount
                                                                ,Mdn_WithCheckDate
                                                                ,Mdn_AlphalistCategory
                                                                ,Mdn_WithAccountingVoucher
                                                                ,Mdn_PaidUpAmount
                                                                ,Mdn_IsRecurring
                                                                ,Mdn_AccountGrp
                                                                ,Mdn_RemittanceLoanType
                                                                ,Mdn_IsSystemReserved
                                                                ,Mdn_ProcessFlag
                                                                ,Mdn_ProcessInfo
                                                                ,Mdn_RecordStatus
                                                                ,Mdn_CreatedBy
                                                                ,Mdn_CreatedDate
                                                                ,Mdn_UpdatedBy
                                                                ,Mdn_UpdatedDate
                                                                FROM B_Deduction
                                                                WHERE Mdn_CompanyCode = @CompanyCode";

            public const string insertDeleteMonthlyTax = @"INSERT INTO {0}..T_MonthlyTaxAdjHst
                                                    (Tta_CompanyCode
                                                    ,Tta_YearMonth
                                                    ,Tta_PreviousMonth
                                                    ,Tta_DatePaid
                                                    ,Tta_DraweeBankAgency
                                                    ,Tta_RORNumber
                                                    ,Tta_TaxPaid
                                                    ,Tta_ShouldBeTaxDue
                                                    ,Tta_Adjustment
                                                    ,Usr_Login
                                                    ,Ludatetime)

                                                    SELECT A.Tta_CompanyCode
                                                    ,A.Tta_YearMonth
                                                    ,A.Tta_PreviousMonth
                                                    ,A.Tta_DatePaid
                                                    ,A.Tta_DraweeBankAgency
                                                    ,A.Tta_RORNumber
                                                    ,A.Tta_TaxPaid
                                                    ,A.Tta_ShouldBeTaxDue
                                                    ,A.Tta_Adjustment
                                                    ,A.Usr_Login
                                                    ,A.Ludatetime  
                                                    FROM {0}..T_MonthlyTaxAdj A
                                                    INNER JOIN {0}..T_MonthlyTax C
                                                        ON A.Tta_CompanyCode = C.Tmt_CompanyCode
                                                        AND A.Tta_YearMonth = C.Tmt_YearMonth
                                                        AND C.Tmt_ProfileCode = '{2}'
                                                    LEFT JOIN {0}..T_MonthlyTaxAdjHst B
														ON A.Tta_CompanyCode = B.Tta_CompanyCode
														AND A.Tta_YearMonth = B.Tta_YearMonth
                                                    WHERE A.Tta_YearMonth = '{1}'
														AND A.Tta_CompanyCode = @CompanyCode
														AND B.Tta_YearMonth IS NULL

                                                        INSERT INTO {0}..T_MonthlyTaxHst
                                                        (Tmt_CompanyCode
                                                        ,Tmt_YearMonth
                                                        ,Tmt_ProfileCode
                                                        ,Tmt_IsAmendedReturn
                                                        ,Tmt_AnyTaxesWithheld
                                                        ,Tmt_NumberofSheetsAttached
                                                        ,Tmt_IsPayeesAvailingTaxRelief
                                                        ,Tmt_TaxReliefSpecify
                                                        ,Tmt_TotalAmountofCompensationPayroll
                                                        ,Tmt_TotalAmountofCompensationAdj
                                                        ,Tmt_TotalAmountofCompensation
                                                        ,Tmt_StatutoryMinimumWagePayroll
                                                        ,Tmt_StatutoryMinimumWageAdj
                                                        ,Tmt_StatutoryMinimumWage
                                                        ,Tmt_HolidayOvertimeNightShiftHazardPayroll
                                                        ,Tmt_HolidayOvertimeNightShiftHazardAdj
                                                        ,Tmt_HolidayOvertimeNightShiftHazard
                                                        ,Tmt_13thMonthPayOtherBenefitsPayroll
                                                        ,Tmt_13thMonthPayOtherBenefitsAdj
                                                        ,Tmt_13thMonthPayOtherBenefits
                                                        ,Tmt_DeMinimisBenefitsPayroll
                                                        ,Tmt_DeMinimisBenefitsAdj
                                                        ,Tmt_DeMinimisBenefits
                                                        ,Tmt_SSSGSISPHICHDMFUnionDuesPayroll
                                                        ,Tmt_SSSGSISPHICHDMFUnionDuesAdj
                                                        ,Tmt_SSSGSISPHICHDMFUnionDues
                                                        ,Tmt_OtherNonTaxableCompensationPayroll
                                                        ,Tmt_OtherNonTaxableCompensationAdj
                                                        ,Tmt_OtherNonTaxableCompensationSpecify
                                                        ,Tmt_OtherNonTaxableCompensation
                                                        ,Tmt_TotalNontaxableCompensation
                                                        ,Tmt_TotalTaxableCompensation
                                                        ,Tmt_TaxableCompensationNotSubjectToWithholdingTaxPayroll
                                                        ,Tmt_TaxableCompensationNotSubjectToWithholdingTaxAdj
                                                        ,Tmt_TaxableCompensationNotSubjectToWithholdingTax
                                                        ,Tmt_NetTaxableCompensation
                                                        ,Tmt_TotalTaxesWithheldPayroll
                                                        ,Tmt_TotalTaxesWithheldAdj
                                                        ,Tmt_TotalTaxesWithheld
                                                        ,Tmt_AdjustmentofTaxesWithheldFromPreviousMonths
                                                        ,Tmt_TaxesWithheldForRemittance
                                                        ,Tmt_TaxRemittedInReturnPreviouslyFiled
                                                        ,Tmt_OtherRemittancesMade
                                                        ,Tmt_OtherRemittancesMadeSpecify
                                                        ,Tmt_TotalTaxRemittancesMade
                                                        ,Tmt_TaxStillDueOver
                                                        ,Tmt_Surcharge
                                                        ,Tmt_Interest
                                                        ,Tmt_Compromise
                                                        ,Tmt_TotalPenalties
                                                        ,Tmt_TotalAmountStillDueOver
                                                        ,Tmt_PaymentMode
                                                        ,Tmt_DraweeBankAgency
                                                        ,Tmt_OthersSpecify
                                                        ,Tmt_RORNumber
                                                        ,Tmt_PaymentDate
                                                        ,Usr_Login
                                                        ,Ludatetime)

                                                        SELECT A.Tmt_CompanyCode
                                                        ,A.Tmt_YearMonth
                                                        ,A.Tmt_ProfileCode
                                                        ,A.Tmt_IsAmendedReturn
                                                        ,A.Tmt_AnyTaxesWithheld
                                                        ,A.Tmt_NumberofSheetsAttached
                                                        ,A.Tmt_IsPayeesAvailingTaxRelief
                                                        ,A.Tmt_TaxReliefSpecify
                                                        ,A.Tmt_TotalAmountofCompensationPayroll
                                                        ,A.Tmt_TotalAmountofCompensationAdj
                                                        ,A.Tmt_TotalAmountofCompensation
                                                        ,A.Tmt_StatutoryMinimumWagePayroll
                                                        ,A.Tmt_StatutoryMinimumWageAdj
                                                        ,A.Tmt_StatutoryMinimumWage
                                                        ,A.Tmt_HolidayOvertimeNightShiftHazardPayroll
                                                        ,A.Tmt_HolidayOvertimeNightShiftHazardAdj
                                                        ,A.Tmt_HolidayOvertimeNightShiftHazard
                                                        ,A.Tmt_13thMonthPayOtherBenefitsPayroll
                                                        ,A.Tmt_13thMonthPayOtherBenefitsAdj
                                                        ,A.Tmt_13thMonthPayOtherBenefits
                                                        ,A.Tmt_DeMinimisBenefitsPayroll
                                                        ,A.Tmt_DeMinimisBenefitsAdj
                                                        ,A.Tmt_DeMinimisBenefits
                                                        ,A.Tmt_SSSGSISPHICHDMFUnionDuesPayroll
                                                        ,A.Tmt_SSSGSISPHICHDMFUnionDuesAdj
                                                        ,A.Tmt_SSSGSISPHICHDMFUnionDues
                                                        ,A.Tmt_OtherNonTaxableCompensationPayroll
                                                        ,A.Tmt_OtherNonTaxableCompensationAdj
                                                        ,A.Tmt_OtherNonTaxableCompensationSpecify
                                                        ,A.Tmt_OtherNonTaxableCompensation
                                                        ,A.Tmt_TotalNontaxableCompensation
                                                        ,A.Tmt_TotalTaxableCompensation
                                                        ,A.Tmt_TaxableCompensationNotSubjectToWithholdingTaxPayroll
                                                        ,A.Tmt_TaxableCompensationNotSubjectToWithholdingTaxAdj
                                                        ,A.Tmt_TaxableCompensationNotSubjectToWithholdingTax
                                                        ,A.Tmt_NetTaxableCompensation
                                                        ,A.Tmt_TotalTaxesWithheldPayroll
                                                        ,A.Tmt_TotalTaxesWithheldAdj
                                                        ,A.Tmt_TotalTaxesWithheld
                                                        ,A.Tmt_AdjustmentofTaxesWithheldFromPreviousMonths
                                                        ,A.Tmt_TaxesWithheldForRemittance
                                                        ,A.Tmt_TaxRemittedInReturnPreviouslyFiled
                                                        ,A.Tmt_OtherRemittancesMade
                                                        ,A.Tmt_OtherRemittancesMadeSpecify
                                                        ,A.Tmt_TotalTaxRemittancesMade
                                                        ,A.Tmt_TaxStillDueOver
                                                        ,A.Tmt_Surcharge
                                                        ,A.Tmt_Interest
                                                        ,A.Tmt_Compromise
                                                        ,A.Tmt_TotalPenalties
                                                        ,A.Tmt_TotalAmountStillDueOver
                                                        ,A.Tmt_PaymentMode
                                                        ,A.Tmt_DraweeBankAgency
                                                        ,A.Tmt_OthersSpecify
                                                        ,A.Tmt_RORNumber
                                                        ,A.Tmt_PaymentDate
                                                        ,A.Usr_Login
                                                        ,A.Ludatetime
                                                    FROM {0}..T_MonthlyTax A
                                                    LEFT JOIN {0}..T_MonthlyTaxHst B
														ON A.Tmt_CompanyCode = B.Tmt_CompanyCode
														AND A.Tmt_YearMonth = B.Tmt_YearMonth
                                                    WHERE A.Tmt_YearMonth = '{1}'
														AND A.Tmt_CompanyCode = @CompanyCode
														AND A.Tmt_ProfileCode = '{2}'
														AND B.Tmt_YearMonth IS NULL

                                                    DELETE A
                                                    FROM {0}..T_MonthlyTaxAdj A
                                                    INNER JOIN {0}..T_MonthlyTax B
                                                        ON A.Tta_CompanyCode = B.Tmt_CompanyCode
                                                        AND A.Tta_YearMonth = B.Tmt_YearMonth
                                                        AND B.Tmt_ProfileCode = '{2}'
                                                    WHERE A.Tta_YearMonth = '{1}'
                                                        AND A.Tta_CompanyCode = @CompanyCode
                                                    
                                                    DELETE FROM {0}..T_MonthlyTax 
                                                    WHERE Tmt_YearMonth = '{1}'
                                                        AND Tmt_CompanyCode = @CompanyCode
														AND Tmt_ProfileCode = '{2}'

                                                   ";

            public const string initializeOffsetRecords = @"UPDATE T_EmpTimeRegister
	                                                        SET Ttr_ForOffsetMin = IsNull(OffsetMin, 0) 
	                                                        FROM T_EmpTimeRegister
	                                                        LEFT JOIN (SELECT Off_EmployeeId
	                                                        , Off_ApplicableDate
	                                                        , OffsetMin = Sum(Off_HoursUsed * 60)
	                                                        FROM T_Offset
	                                                        Where Off_ApplicableDate BETWEEN @NextPayPeriodStartDate and @NextPayPeriodEndDate
                                                            GROUP BY Off_EmployeeId
                                                            , Off_ApplicableDate ) OffTrn ON  Off_EmployeeId = Ttr_IDNo
                                                            AND Off_ApplicableDate = Ttr_Date
                                                            WHERE Ttr_PayCycle = @NextPayPeriod
                                                            AND Ttr_ForOffsetMin <> IsNull(OffsetMin, 0)";
            public const string updateLogControlRecord = @"UPDATE T_EmpLogControl
                                                            SET Tlc_YearMonth = @NextPayPeriod
                                                            , Tlc_Day01 = 0
                                                            , Tlc_Day02 = 0
                                                            , Tlc_Day03 = 0
                                                            , Tlc_Day04 = 0
                                                            , Tlc_Day05 = 0
                                                            , Tlc_Day06 = 0
                                                            , Tlc_Day07 = 0
                                                            , Tlc_Day08 = 0
                                                            , Tlc_Day09 = 0
                                                            , Tlc_Day10 = 0
                                                            , Tlc_Day11 = 0
                                                            , Tlc_Day12 = 0
                                                            , Tlc_Day13 = 0
                                                            , Tlc_Day14 = 0
                                                            , Tlc_Day15 = 0
                                                            , Tlc_Day16 = 0
                                                            , Tlc_Day17 = 0
                                                            , Tlc_Day18 = 0
                                                            , Tlc_Day19 = 0
                                                            , Tlc_Day20 = 0
                                                            , Usr_Login = @UserLogin
                                                            , Ludatetime = getdate()";
            
            public const string updateEmployeeLeaveMasterML = @"DECLARE @EndOfMonth as Datetime

                                                            Set @EndOfMonth = (Select Tps_EndCycle From T_PaySchedule
			                                                              Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A')


                                                            DECLARE @VLCREDIT  decimal(7,4), @SLCREDIT decimal(7,4)

                                                            SET @VLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode = 'VLCREDIT'
                                                            and Mph_RecordStatus = 'A')

                                                            SET @SLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode = 'SLCREDIT'
                                                            and Mph_RecordStatus = 'A')

                                                            UPDATE T_EmployeeLeaveMaster
                                                            SET	Elm_VLBalance = Elm_VLBalance + 
                                                            CASE WHEN
                                                            CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth)), Mem_IntakeDate) > @EndOfMonth THEN 
			                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth )) - 1
		                                                            ELSE 
			                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth))
		                                                            END  >= 1 THEN  @VLCREDIT /8.000 /12.0000
                                                            ELSE 0 END
                                                            , Elm_SLBalance = Elm_SLBalance + 
                                                            CASE WHEN
	                                                            CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth)), Mem_IntakeDate) > @EndOfMonth THEN 
				                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth )) - 1
			                                                            ELSE 
				                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth))
			                                                            END  >= 1 THEN  @SLCREDIT /8.000 /12.0000
                                                            ELSE 0 END
                                                            From T_EmployeeLeaveMaster
                                                            INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeID
                                                            and CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth)), 		Mem_IntakeDate) > @EndOfMonth THEN 
		                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth )) 		- 1
	                                                            ELSE 
		                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth))
	                                                            END  >= 1
                                                            and LEFT(Mem_WorkStatus, 1) = 'A'";
            public const string updateEmployeeLeaveMasterAL = @"DECLARE @EndOfMonth as Datetime

                                                            Set @EndOfMonth = (Select Tps_EndCycle From T_PaySchedule
			                                                              Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A')


                                                            DECLARE @VLCREDIT  decimal(7,4), @SLCREDIT decimal(7,4)

                                                            SET @VLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode = 'VLCREDIT'
                                                            and Mph_RecordStatus = 'A')

                                                            SET @SLCREDIT = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode = 'SLCREDIT'
                                                            and Mph_RecordStatus = 'A')

                                                            UPDATE T_EmployeeLeaveMaster
                                                            SET	Elm_VLBalance = Elm_VLBalance + 
                                                            CASE WHEN
	                                                            CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth)), Mem_IntakeDate) > @EndOfMonth THEN 
				                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth )) - 1
			                                                            ELSE 
				                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth))
			                                                            END  >= 1 THEN  @VLCREDIT
                                                            ELSE 0 END
                                                            , Elm_SLBalance = Elm_SLBalance + 
                                                            CASE WHEN
		                                                            CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth)), Mem_IntakeDate) > @EndOfMonth THEN 
					                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth )) - 1
				                                                            ELSE 
					                                                            datediff (year, Mem_IntakeDate, 		Convert(Datetime,@EndOfMonth))
				                                                            END  >= 1 THEN  @SLCREDIT
	                                                            ELSE 0 END
                                                            From T_EmployeeLeaveMaster
                                                            INNER JOIN M_Employee on Mem_IDNo = Elm_EmployeeID
                                                            and CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth)), 		Mem_IntakeDate) > @EndOfMonth THEN 
			                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth )) 		- 1
		                                                            ELSE 
			                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth))
		                                                            END  >= 1
                                                            and LEFT(Mem_WorkStatus, 1) = 'A' and right(convert(char(8),Mem_IntakeDate,112),4) between @NextPayPeriodStartDay and @NextPayPeriodEndDay 

                                                            -- Reset to No anniversary indicator
                                                            UPDATE M_Employee
                                                            SET Mem_IsCompanyAnniversary = 0
                                                            WHERE Mem_IsCompanyAnniversary = 1


                                                            -- Post Yes anniversary indicator for employees whose anniversary falls on the new current cycle
                                                            UPDATE M_Employee
                                                            SET Mem_IsCompanyAnniversary = 1
                                                            WHERE CASE WHEN dateadd(year, datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth)), 		Mem_IntakeDate) > @EndOfMonth THEN 
			                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth )) 		- 1
		                                                            ELSE 
			                                                            datediff (year, Mem_IntakeDate, Convert(Datetime,@EndOfMonth))
		                                                            END  >= 1
                                                            and LEFT(Mem_WorkStatus, 1) = 'A' and right(convert(char(8),Mem_IntakeDate,112),4) between @NextPayPeriodStartDay and @NextPayPeriodEndDay ";

            public const string updateNewPayrollPeriod = @"DECLARE @EndDate as Datetime

                                                            Set @EndDate = (Select Tps_EndCycle From T_PaySchedule
                                                                          Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A')

                                                            UPDATE T_PaySchedule
                                                            SET Tps_CycleIndicator = 'C'
                                                            , Tps_UpdatedBy = @UserLogin
                                                            , Tps_UpdatedDate = GETDATE()
                                                            WHERE Tps_StartCycle = dateadd(dd,1,@EndDate)
                                                                AND Tps_CycleIndicator <> 'S'
                                                            
                                                            UPDATE T_PaySchedule
                                                            SET Tps_CycleIndicator = 'P'
                                                            , Tps_UpdatedBy = @UserLogin
                                                            , Tps_UpdatedDate = GETDATE()
                                                            WHERE Tps_EndCycle = @EndDate and Tps_RecordStatus = 'A' 
                                                                AND Right(Tps_PayCycle,1) in ('1','2','0','3','4','5') 
                                                                AND Tps_CycleIndicator != 'S'";

            public const string updateProcessFlagCycleOpening = @"
                                                                UPDATE T_SettingControl
                                                                Set Tsc_SetFlag = 0
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'TIME'
                                                                And Tsc_SettingCode In ('CUT-OFF')

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                    FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'TIME'
	                                                                    AND Tsc_SettingCode = 'CUT-OFF'


                                                                UPDATE T_SettingControl
                                                                Set Tsc_SetFlag = 0
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'OVERTIME'
                                                                And Tsc_SettingCode = 'CUT-OFF'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                    FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'OVERTIME'
	                                                                    AND Tsc_SettingCode = 'CUT-OFF'

                                                                UPDATE T_SettingControl
                                                                Set Tsc_SetFlag = 0
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'LEAVE'
                                                                And Tsc_SettingCode = 'CUT-OFF'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                    FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'LEAVE'
	                                                                    AND Tsc_SettingCode = 'CUT-OFF'

                                                                Update T_SettingControl
                                                                Set Tsc_SetFlag = 0
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'GENERAL'
                                                                And Tsc_SettingCode In  ('CYCCUT-OFF')

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                    FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'GENERAL'
	                                                                    AND Tsc_SettingCode = 'CYCCUT-OFF'

                                                                Update M_PolicyDtl
                                                                Set Mpd_ParamValue = 0
                                                                ,Mpd_UpdatedBy = @UserLogin
                                                                ,Mpd_UpdatedDate = GETDATE()
                                                                Where Mpd_PolicyCode = 'ATMDISKGEN'

                                                                UPDATE T_SettingControl
                                                                Set Tsc_SetFlag = 0
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'PAYROLL'
                                                                And Tsc_SettingCode In  ('CUT-OFF','PAYCALC','ATMDISKGEN','NORMALPAY','LCSCALC','LCSCOSTPAY')

                                                                 INSERT INTO T_SettingControlTrl
                                                                 SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'CUT-OFF'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'PAYCALC'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'ATMDISKGEN'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'NORMALPAY'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'LCSCALC'

                                                                INSERT INTO T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 0
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'LCSCOSTPAY'
                                                                

                                                                Update T_SettingControl
                                                                Set Tsc_SetFlag = 1
                                                                ,Usr_Login = @UserLogin
                                                                ,Ludatetime = GetDate()
                                                                Where Tsc_SystemCode = 'PAYROLL'
                                                                And Tsc_SettingCode = 'CYCLEOPEN'

                                                                Insert Into T_SettingControlTrl
                                                                SELECT  Tsc_SystemCode
                                                                         , Tsc_SettingCode
                                                                         , Tsc_SettingName
                                                                         , 1
                                                                         , Tsc_AccessType
                                                                         , @CurPayPeriod
                                                                         , NULL
                                                                         , 'A'
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                 FROM T_SettingControl
                                                                     WHERE Tsc_SystemCode = 'PAYROLL'
	                                                                    AND Tsc_SettingCode = 'CYCLEOPEN'
";
            public const string updateParametersOffCycleOpen = @"Update M_PolicyDtl
                                                                Set Mpd_ParamValue = 0
                                                                ,Mpd_UpdatedBy = @UserLogin
                                                                ,Mpd_UpdatedDate = GETDATE()
                                                                Where Mpd_PolicyCode = 'OFFATMGEN'";
            public const string checkInvalidShiftCode = @"SELECT Mem_IDNo + ' - ' + Mem_FirstName + ' ' + Mem_LastName + '  (' + Case when Msh_RecordStatus = 'I' then 'Invalid Shift' else 'Unregistered Shift' end + ')'
                                                            FROM M_Employee A
                                                            LEFT JOIN {0}..M_Shift  ON  Msh_ShiftCode = Mem_ShiftCode  
                                                                AND Msh_CompanyCode = @CompanyCode
                                                            Where Left(Mem_WorkStatus, 1) = 'A'  and
                                                            ( Msh_RecordStatus = 'I' or Msh_ShiftCode is null) 
                                                            Order by Mem_LastName,
                                                                Mem_FirstName";
            public const string checkPayrollTrack = @"SELECT Mem_IDNo + ' - ' + Mem_FirstName + ' ' + Mem_LastName + '  (' + Tpt_ModuleCode + ')'
                                                            FROM M_Employee A
                                                            INNER JOIN T_EmpPayroll ON Mem_IDNo = Tpy_IDNo
                                                                AND Tpy_PayCycle = '{0}'
                                                            INNER JOIN T_EmpPayrollTrack
                                                                ON Tpt_IDNo = Mem_IDNo
                                                                AND Tpt_Type = 'N'
                                                            ORDER BY Mem_LastName, Mem_FirstName";
            public const string updateEncodedOTCycOpen = @"UPDATE T_EmpTimeRegister
                                                        SET Ttr_WFOTAdvHr = Isnull(AdvOvtHr,0)
                                                        , Ttr_WFOTPostHr = Isnull(PostOvtHr,0) 
                                                        FROM T_EmpTimeRegister
                                                        LEFT JOIN (SELECT Tot_IDNo
                                                        , Tot_OvertimeDate
                                                        , AdvOvtHr = Sum(Case when Tot_OvertimeType = 'A' Then Tot_OvertimeHours Else 0 End)
                                                        , PostOvtHr = Sum(Case when Tot_OvertimeType = 'P' Then Tot_OvertimeHours Else 0 End)
                                                        FROM T_EmpOvertime
                                                        WHERE Tot_OvertimeStatus in ('A', '9')
                                                        GROUP BY Tot_IDNo
                                                        , Tot_OvertimeDate ) OvtTrn ON  Tot_IDNo = Ttr_IDNo
                                                        AND Tot_OvertimeDate = Ttr_Date
                                                        WHERE ( Ttr_WFOTAdvHr <> IsNull(AdvOvtHr, 0) OR
                                                        Ttr_WFOTPostHr <> IsNull(PostOvtHr, 0))";

            #endregion

            #region [For Labor Hour Generation]
            public const string fetchPreLaborHourProcessingError = @"Select Ttr_IDNo [Employee ID]
                                                                         , @CurPayPeriod as [Current Payperiod]
                                                                         , null as [Process Date]
                                                                         , 'No restday set-up' as Remarks
                                                                    From T_EmpTimeRegister
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                                    Group by Ttr_IDNo
                                                                    Having Sum(Case when Ttr_RestDayFlag = 1 then 1 else 0 end) = 0

                                                                    UNION

                                                                    SELECT Ttr_IDNo
                                                                           , @CurPayPeriod as CurrentPayperiod
                                                                           ,Ttr_Date as ProcessDate
                                                                           , RTRIM(Ttr_DayCode) + '-Invalid Day Code' as Remarks
                                                                    FROM T_EmpTimeRegister
                                                                    LEFT JOIN M_Day ON Mdy_DayCode = Ttr_DayCode
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                                          AND ( Mdy_DayCode is null or Mdn_RecordStatus = 'C')


                                                                    UNION

                                                                    SELECT Ttr_IDNo
                                                                           ,@CurPayPeriod as CurrentPayperiod
                                                                           ,Ttr_Date as ProcessDate
                                                                           , RTRIM(Ttr_ShiftCode) + '-Invalid Shift Code' as Remarks
                                                                    FROM T_EmpTimeRegister
                                                                    LEFT JOIN M_Shift ON Msh_ShiftCode = Ttr_ShiftCode
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                                        AND ( Msh_ShiftCode is null or Msh_RecordStatus = 'C') 
                                    
                                                                     UNION

                                                                     SELECT  Ttr_IDNo
                                                                           ,@CurPayPeriod as CurrentPayperiod
                                                                           , Ttr_Date as ProcessDate
                                                                           , RTRIM(Ttr_ShiftCode) + '-Non-Regular days not 8 hours' as Remarks
                                                                    FROM T_EmpTimeRegister
                                                                    LEFT JOIN M_Shift ON Msh_ShiftCode = Ttr_ShiftCode
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                                          and LEN(RTRIM(Scm_EquivalentShiftCode)) > 0
                                                                          AND Scm_ShiftHours > 8
                                                                          AND Ttr_DayCode <>  'REG'
                                                                  UNION

                                                                 SELECT Ttr_IDNo
                                                                           , @CurPayPeriod as CurrentPayperiod
                                                                           ,Ttr_Date as ProcessDate
                                                                           , RTRIM(Ttr_DayCode) + '- No Special Prem Set-up' as Remarks
                                                                    FROM T_EmpTimeRegister
                                                                    LEFT JOIN M_Day ON Mdy_DayCode = Ttr_DayCode
                                                                 LEFT JOIN T_SpecialDayPremiumMaster on Dpm_Daycode = Ttr_DayCode
                                                                   And Mdp_RestDayFlag = Ttr_RestDayFlag
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                                       And left(Ttr_WorkLocationCode,1)='D'
                                                                       And Mdp_DayCode is null

                                                                UNION

                                                                 SELECT Ttr_IDNo
                                                                       , @CurPayPeriod as CurrentPayperiod
                                                                       , Ttr_Date as ProcessDate
                                                                       , 'No Work Location Set-up' as Remarks
                                                                    FROM T_EmpTimeRegister
                                                                    WHERE Ttr_PayCycle = @CurPayPeriod  
                                                                  And (Ttr_WorkLocationCode is null or len(rtrim(Ttr_WorkLocationCode))=0)

                                                                union 
    
                                                                select Ttr_IDNo
                                                                   , @CurPayPeriod as CurrentPayperiod
                                                                   , Ttr_Date as ProcessDate
                                                                   , 'Incorrect day code' as Remarks
                                                                 from  T_EmpTimeRegister
                                                                inner join T_Holiday on Thl_HolidayDate = Ttr_Date
                                                                 and Thl_LocationCode = Ttr_WorkLocationCode
                                                                where Ttr_DayCode <> Hmt_HolidayCode
                                                                       and Ttr_PayCycle = @CurPayPeriod";

            public const string updateEncodedOffSet = @"UPDATE T_EmpTimeRegister
                                                    SET Ttr_ForOffsetMin = IsNull(OffsetMin, 0) 
                                                    FROM T_EmpTimeRegister
                                                    LEFT JOIN (SELECT Off_EmployeeId
                                                                , Off_ApplicableDate
                                                                , OffsetMin = Sum(Off_HoursUsed * 60)
                                                                FROM T_Offset
                                                                Where Off_ApplicableDate 
                                                                BETWEEN (Select Tps_StartCycle From T_PaySchedule Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A') 
                                                                AND (Select Tps_EndCycle From T_PaySchedule Where Tps_CycleIndicator = 'C' and Tps_RecordStatus = 'A')
                                                                GROUP BY Off_EmployeeId
                                                                , Off_ApplicableDate 
                                                               ) OffTrn ON  Off_EmployeeId = Ttr_IDNo
                                                               AND Off_ApplicableDate = Ttr_Date
                                                    WHERE Ttr_PayCycle = @CurPayPeriod
                                                     AND Ttr_ForOffsetMin <> IsNull(OffsetMin, 0)";


            public const string updateEncodedOT = @"UPDATE T_EmpTimeRegister
                                                        SET Ttr_WFOTAdvHr = Isnull(AdvOvtHr,0) 
                                                        , Ttr_WFOTPostHr = Isnull(PostOvtHr,0) 
                                                        FROM T_EmpTimeRegister
                                                        LEFT JOIN (SELECT Tof_IDNo
                                                        , Tot_OvertimeDate
                                                        , AdvOvtHr = Sum(Case when Tot_OvertimeType = 'A' Then Tot_OvertimeHours Else 0 End)
                                                        , PostOvtHr = Sum(Case when Tot_OvertimeType = 'P' Then Tot_OvertimeHours Else 0 End)
                                                        FROM T_EmpOvertime
                                                        WHERE Tot_OvertimeStatus in ('A', '9')
                                                        GROUP BY Tof_IDNo
                                                        , Tot_OvertimeDate ) OvtTrn ON  Tof_IDNo = Ttr_IDNo
                                                        AND Tot_OvertimeDate = Ttr_Date
                                                        WHERE Ttr_PayCycle = @CurPayPeriod
                                                        AND ( Ttr_WFOTAdvHr <> IsNull(AdvOvtHr, 0) OR
                                                        Ttr_WFOTPostHr <> IsNull(PostOvtHr, 0) )";
            ////changed : 11/14/2009
            ////jccapetillo
//            public const string updateEncodedPaidLeave = @"UPDATE T_EmpTimeRegister
//                                                        SET  Ttr_WFPayLVCode = CASE WHEN  IsNull(LveHour, 0) = 0 THEN '' ELSE Ttr_WFPayLVCode END
//				                                            , Ttr_WFPayLVHr =  IsNull(LveHour, 0) 
//                                                        FROM T_EmpTimeRegister
//                                                        LEFT JOIN ( SELECT Tlv_IDNo
//                                                                            , Tlv_LeaveDate
//                                                                            , LveHour = Sum(Tlv_LeaveHours)
//                                                                    FROM T_EmpLeave INNER JOIN M_Leave 
//							                                            ON Mlv_LeaveCode = Tlv_LeaveCode
//                                                                            AND Mlv_IsPaidLeave = 1
//                                                                    WHERE Tlv_LeaveFlag = 'C' 
//                                                                        AND Tlv_LeaveStatus in ('A', '9')
//                                                                    GROUP BY Tlv_IDNo
//                                                                            , Tlv_LeaveDate ) LveTrn 
//						                                            ON Tlv_IDNo = Ttr_IDNo
//                                                                     AND Tlv_LeaveDate = Ttr_Date
//                                                        WHERE Ttr_PayCycle = @CurPayPeriod
//                                                            AND Ttr_WFPayLVHr <> IsNull(LveHour,0)
//
//                                                        UPDATE T_EmpTimeRegister
//                                                        SET  Ttr_WFPayLVCode = ''
//                                                        WHERE Ttr_WFPayLVHr = 0.00
//                                                          and LEN(RTRIM(Ttr_WFPayLVCode)) > 0";

            public const string updateEncodedPaidLeave = @"
                                                        UPDATE T_EmpTimeRegister
                                                        SET  Ttr_WFPayLVCode = ''
                                                        WHERE Ttr_WFPayLVHr = 0.00
                                                          and LEN(RTRIM(Ttr_WFPayLVCode)) > 0";
            ////end

            ////changed : 11/14/2009
            ////jccapetillo
//            public const string updateEncodedNoPayLeave = @"UPDATE T_EmpTimeRegister
//                                                        SET Ttr_WFNoPayLVCode = CASE WHEN  IsNull(LveHour, 0) = 0 THEN '' ELSE Ttr_WFNoPayLVCode END
//				                                            ,Ttr_WFNoPayLVHr = Isnull( LveHour, 0)
//                                                        FROM T_EmpTimeRegister
//                                                        INNER JOIN ( SELECT Tlv_IDNo
//					                                                        , Tlv_LeaveDate
//					                                                        , LveHour = Sum(Tlv_LeaveHours)
//			                                                        FROM T_EmpLeave 
//			                                                        INNER JOIN  M_Leave ON Mlv_LeaveCode = Tlv_LeaveCode
//					                                                        AND Mlv_IsPaidLeave = 0
//			                                                        WHERE Tlv_LeaveFlag = 'C'
//				                                                        AND Tlv_LeaveStatus in ('A', '9')
//			                                                        GROUP BY Tlv_IDNo
//					                                                        , Tlv_LeaveDate ) LveTrn ON Tlv_IDNo = Ttr_IDNo
//								                                                        AND Tlv_LeaveDate = Ttr_Date
//                                                        WHERE Ttr_PayCycle = @CurPayPeriod
//	                                                        AND Ttr_WFNoPayLVHr <> IsNull(LveHour, 0)
//
//                                                        UPDATE T_EmpTimeRegister
//                                                        SET  Ttr_WFNoPayLVCode = ''
//                                                        WHERE Ttr_WFNoPayLVHr = 0.00
//                                                        and LEN(RTRIM(Ttr_WFNoPayLVCode)) > 0";

            public const string updateEncodedNoPayLeave = @"
                                                        UPDATE T_EmpTimeRegister
                                                        SET  Ttr_WFNoPayLVCode = ''
                                                        WHERE Ttr_WFNoPayLVHr = 0.00
                                                        and LEN(RTRIM(Ttr_WFNoPayLVCode)) > 0";
            ////end

            public const string fetchEmployeePayrollType = @"Select Distinct Mem_IDNo
				                                                            ,Mem_PayrollType 
				                                                            ,Mem_LastName + ', ' + Mem_FirstName + ' ' + LEFT(Mem_MiddleName,1) + '.' [Emt_EmployeeName]
                                                            From T_EmpTimeRegister Inner join M_Employee 
                                                            on Mem_IDNo = Ttr_IDNo
                                                            Where Ttr_PayCycle = @CurPayperiod";

            #endregion
            #region [For Labor Hour Adjustment]
            public const string fetchLaborHoursAdjErrorData = @"Select DIstinct Tsa_PayCycle 
                                                                From T_EmpSystemAdj
                                                                Left Join ( Select Mem_PayCycle
                                                                        , Count(Mem_IDNo) as Cnt
                                                                            From M_EmployeeHst 
                                                                           Group by Mem_PayCycle ) Period on Mem_PayCycle = Tsa_PayCycle
                                                                Where Tsa_AdjPayCycle = @CurPayperiod
                                                                    and Mem_PayCycle is null

                                                                Select Distinct Tsa_IDNo
                                                                        , Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' [Lha_EmployeeName]
                                                                        , Tsa_PayCycle as 'Adjusted Period'
                                                                        , case when M_EmployeeHst.Mem_IDNo is null  then 'No employee record.'
                                                                                else 'Salary rate is zero.' end as Remark
                                                                From T_EmpSystemAdj
                                                                        Left Join M_EmployeeHst  on Mem_PayCycle = Tsa_PayCycle
                                                                         and Mem_IDNo = Tsa_IDNo 
                                                                        Left Join M_Employee on M_Employee.Mem_IDNo = T_EmpSystemAdj.Tsa_IDNo
                                                                 Where Tsa_AdjPayCycle = @CurPayperiod
                                                                    and (M_EmployeeHst.Mem_IDNo is null or Isnull(M_EmployeeHst.Mem_Salary, 0) = 0)
                                                                Order by Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' ,Tsa_PayCycle";
            public const string fetchEmployeeForLaborHoursAdj = @"Select DISTINCT Tsa_IDNo,@CurPayPeriod [Tsa_PayCycle],Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' [Lha_EmployeeName]
                                                                From T_EmpSystemAdj
                                                                JOIN	M_Employee
                                                                ON		Mem_IDNo = Tsa_IDNo
                                                                Where Tsa_AdjPayCycle = @CurPayPeriod
                                                                AND		Tsa_AdjPayCycle = 0";

            public const string updateEmployeeAdj = @"UPDATE T_EmpManualAdj
                                                        SET Tma_HourRate = Adj.HourlyRate,
														  Tma_REGHr = Tma_REGHr + Adj.RegularHr,
                                                          Tma_REGOTHr = Tma_REGOTHr + Adj.RegularOTHr,
                                                          Tma_REGNDHr = Tma_REGNDHr + Adj.RegularNDHr,
                                                          Tma_REGNDOTHr = Tma_REGNDOTHr + Adj.RegularOTNDHr,
                                                          Tma_RESTHr = Tma_RESTHr + Adj.RestdayHr,
                                                          Tma_RESTOTHr = Tma_RESTOTHr + Adj.RestdayOTHr,
                                                          Tma_RESTNDHr = Tma_RESTNDHr + Adj.RestdayNDHr,
                                                          Tma_RESTNDOTHr = Tma_RESTNDOTHr + Adj.RestdayOTNDHr,
                                                          Tma_LEGHOLHr = Tma_LEGHOLHr + Adj.LegalHolidayHr,
                                                          Tma_LEGHOLOTHr = Tma_LEGHOLOTHr + Adj.LegalHolidayOTHr,
                                                          Tma_LEGHOLNDHr = Tma_LEGHOLNDHr + Adj.LegalHolidayNDHr,
                                                          Tma_LEGHOLNDOTHr = Tma_LEGHOLNDOTHr + Adj.LegalHolidayOTNDHr,
                                                          Tma_SPLHOLHr = Tma_SPLHOLHr + Adj.SpecialHolidayHr,
                                                          Tma_SPLHOLOTHr = Tma_SPLHOLOTHr + Adj.SpecialHolidayOTHr,
                                                          Tma_SPLHOLNDHr = Tma_SPLHOLNDHr + Adj.SpecialHolidayNDHr,
                                                          Tma_SPLHOLNDOTHr = Tma_SPLHOLNDOTHr + Adj.SpecialHolidayOTNDHr,
                                                          Tma_PSDHr = Tma_PSDHr + Adj.PlantShutdownHr,
                                                          Tma_PSDOTHr = Tma_PSDOTHr + Adj.PlantShutdownOTHr,
                                                          Tma_PSDNDHr = Tma_PSDNDHr + Adj.PlantShutdownNDHr,
                                                          Tma_PSDNDOTHr = Tma_PSDNDOTHr + Adj.PlantShutdownOTNDHr,
                                                          Tma_COHOLHr = Tma_COHOLHr + Adj.CompanyHolidayHr,
                                                          Tma_COHOLOTHr = Tma_COHOLOTHr + Adj.CompanyHolidayOTHr,
                                                          Tma_COHOLNDHr = Tma_COHOLNDHr + Adj.CompanyHolidayNDHr,
                                                          Tma_COHOLNDOTHr = Tma_COHOLNDOTHr + Adj.CompanyHolidayOTNDHr,
                                                          Tma_RESTLEGHOLHr = Tma_RESTLEGHOLHr + Adj.RestdayLegalHolidayHr,
                                                          Tma_RESTLEGHOLOTHr = Tma_RESTLEGHOLOTHr + Adj.RestdayLegalHolidayOTHr,
                                                          Tma_RESTLEGHOLNDHr = Tma_RESTLEGHOLNDHr + Adj.RestdayLegalHolidayNDHr,
                                                          Tma_RESTLEGHOLNDOTHr =Tma_RESTLEGHOLNDOTHr  + Adj.RestdayLegalHolidayOTNDHr,
                                                          Tma_RESTSPLHOLHr = Tma_RESTSPLHOLHr + Adj.RestdaySpecialHolidayHr,
                                                          Tma_RESTSPLHOLOTHr = Tma_RESTSPLHOLOTHr + Adj.RestdaySpecialHolidayOTHr,
                                                          Tma_RESTSPLHOLNDHr = Tma_RESTSPLHOLNDHr + Adj.RestdaySpecialHolidayNDHr,
                                                          Tma_RESTSPLHOLNDOTHr = Tma_RESTSPLHOLNDOTHr + Adj.RestdaySpecialHolidayOTNDHr,
                                                          Tma_RESTCOHOLHr = Tma_RESTCOHOLHr + Adj.RestdayCompanyHolidayHr,
                                                          Tma_RESTCOHOLOTHr = Tma_RESTCOHOLOTHr + Adj.RestdayCompanyHolidayOTHr,
                                                          Tma_RESTCOHOLNDHr = Tma_RESTCOHOLNDHr + Adj.RestdayCompanyHolidayNDHr,
                                                          Tma_RESTCOHOLNDOTHr = Tma_RESTCOHOLNDOTHr + Adj.RestdayCompanyHolidayOTNDHr,
                                                          Tma_RESTPSDHr = Tma_RESTPSDHr + Adj.RestdayPlantShutdownHr,
                                                          Tma_RESTPSDHr = Tma_RESTPSDHr + Adj.RestdayPlantShutdownOTHr,
                                                          Tma_RESTPSDNDHr = Tma_RESTPSDNDHr + Adj.RestdayPlantShutdownNDHr,
                                                          Tma_RESTPSDNDOTHr = Tma_RESTPSDNDOTHr + Adj.RestdayPlantShutdownOTNDHr,
                                                          Tma_TotalAdjAmt = Tma_TotalAdjAmt + Adj.LaborHrsAdjustmentAmt,
                                                          Usr_Login = @UserLogin,
                                                          Ludatetime = GetDate()
                                                        FROM T_EmpManualAdj
                                                        INNER JOIN  (Select Tsa_IDNo,Tsa_HourRate as HourlyRate
                                                        , Sum(Tsa_REGHr) as RegularHr
                                                        , Sum(Tsa_REGOTHr) as RegularOTHr
                                                        , Sum(Tsa_REGNDHr) as RegularNDHr
                                                        , Sum(Tsa_REGNDOTHr) as RegularOTNDHr
                                                        , Sum(Tsa_RESTHr) as RestdayHr
                                                        , Sum(Tsa_RESTOTHr) as RestdayOTHr
                                                        , Sum(Tsa_RESTNDHr) as RestdayNDHr
                                                        , Sum(Tsa_RESTNDOTHr) as RestdayOTNDHr
                                                        , Sum(Tsa_LEGHOLHr) as LegalHolidayHr
                                                        , Sum(Tsa_LEGHOLOTHr) as LegalHolidayOTHr
                                                        , Sum(Tsa_LEGHOLNDHr) as LegalHolidayNDHr
                                                        , Sum(Tsa_LEGHOLNDOTHr) as LegalHolidayOTNDHr
                                                        , Sum(Tsa_SPLHOLHr) as SpecialHolidayHr
                                                        , Sum(Tsa_SPLHOLOTHr) as SpecialHolidayOTHr
                                                        , Sum(Tsa_SPLHOLNDHr) as SpecialHolidayNDHr
                                                        , Sum(Tsa_SPLHOLNDOTHr) as SpecialHolidayOTNDHr
                                                        , Sum(Tsa_PSDHr) as PlantShutdownHr
                                                        , Sum(Tsa_PSDOTHr) as PlantShutdownOTHr
                                                        , Sum(Tsa_PSDNDHr) as PlantShutdownNDHr
                                                        , Sum(Tsa_PSDNDOTHr) as PlantShutdownOTNDHr
                                                        , Sum(Tsa_COHOLHr) as CompanyHolidayHr
                                                        , Sum(Tsa_COHOLOTHr) as CompanyHolidayOTHr
                                                        , Sum(Tsa_COHOLNDHr) as CompanyHolidayNDHr
                                                        , Sum(Tsa_COHOLNDOTHr) as CompanyHolidayOTNDHr
                                                        , Sum(Tsa_RESTLEGHOLHr) as RestdayLegalHolidayHr
                                                        , Sum(Tsa_RESTLEGHOLOTHr) as RestdayLegalHolidayOTHr
                                                        , Sum(Tsa_RESTLEGHOLNDHr) as RestdayLegalHolidayNDHr
                                                        , Sum(Tsa_RESTLEGHOLNDOTHr) as RestdayLegalHolidayOTNDHr
                                                        , Sum(Tsa_RESTSPLHOLHr) as RestdaySpecialHolidayHr
                                                        , Sum(Tsa_RESTSPLHOLOTHr) as RestdaySpecialHolidayOTHr
                                                        , Sum(Tsa_RESTSPLHOLNDHr) as RestdaySpecialHolidayNDHr
                                                        , Sum(Tsa_RESTSPLHOLNDOTHr) as RestdaySpecialHolidayOTNDHr
                                                        , Sum(Tsa_RESTCOHOLHr) as RestdayCompanyHolidayHr
                                                        , Sum(Tsa_RESTCOHOLOTHr) as RestdayCompanyHolidayOTHr
                                                        , Sum(Tsa_RESTCOHOLNDHr) as RestdayCompanyHolidayNDHr
                                                        , Sum(Tsa_RESTCOHOLNDOTHr) as RestdayCompanyHolidayOTNDHr
                                                        , Sum(Tsa_RESTPSDHr) as RestdayPlantShutdownHr
                                                        , Sum(Tsa_RESTPSDOTHr) as RestdayPlantShutdownOTHr
                                                        , Sum(Tsa_RESTPSDNDHr) as RestdayPlantShutdownNDHr
                                                        , Sum(Tsa_RESTPSDNDOTHr) as RestdayPlantShutdownOTNDHr
                                                        , Sum(Tsa_TotalAdjAmt) as LaborHrsAdjustmentAmt
                                                        From T_EmpSystemAdj
                                                        Where Tsa_AdjPayCycle = @CurPayPeriod
                                                        And	  Tsa_IDNo = @EmployeeID
                                                        And Tsa_AdjPayCycle = 0
                                                        Group by Tsa_IDNo,Tsa_HourRate)  Adj on Adj.Tsa_IDNo = Tma_IDNo  
                                                        Where Tma_PayCycle = @CurPayPeriod
                                                        And	  Tma_IDNo = @EmployeeID
                                                        ----------Update Tsa_AdjPayCycle after update-------
                                                        UPDATE	T_EmpSystemAdj
                                                        SET		Tsa_AdjPayCycle = 1 --SET ALL
                                                        WHERE	Tsa_IDNo = @EmployeeID
                                                        AND		Tsa_AdjPayCycle = @CurPayPeriod";

            public const string updateEmployeeAdjExt = @"UPDATE T_EmpSystemAdjMisc
                                                          SET Tsm_Misc1Hr = Tsm_Misc1Hr + Adj.Filler01Hr
                                                            , Tsm_Misc1OTHr = Tsm_Misc1OTHr + Adj.Filler01OTHr
                                                            , Tsm_Misc1NDHr = Tsm_Misc1NDHr + Adj.Filler01NDHr
                                                            , Tsm_Misc1NDOTHr = Tsm_Misc1NDOTHr + Adj.Filler01OTNDHr
                                                            , Tsm_Misc2Hr = Tsm_Misc2Hr + Adj.Filler02Hr
                                                            , Tsm_Misc2OTHr = Tsm_Misc2OTHr + Adj.Filler02OTHr
                                                            , Tsm_Misc2NDHr = Tsm_Misc2NDHr + Adj.Filler02NDHr
                                                            , Tsm_Misc2NDOTHr = Tsm_Misc2NDOTHr + Adj.Filler02OTNDHr
                                                            , Tsm_Misc3Hr = Tsm_Misc3Hr + Adj.Filler03Hr
                                                            , Tsm_Misc3OTHr = Tsm_Misc3OTHr + Adj.Filler03OTHr
                                                            , Tsm_Misc3NDHr = Tsm_Misc3NDHr + Adj.Filler03NDHr
                                                            , Tsm_Misc3NDOTHr = Tsm_Misc3NDOTHr + Adj.Filler03OTNDHr
                                                            , Tsm_Misc4Hr = Tsm_Misc4Hr + Adj.Filler04Hr
                                                            , Tsm_Misc4OTHr = Tsm_Misc4OTHr + Adj.Filler04OTHr
                                                            , Tsm_Misc4NDHr = Tsm_Misc4NDHr + Adj.Filler04NDHr
                                                            , Tsm_Misc4NDOTHr = Tsm_Misc4NDOTHr + Adj.Filler04OTNDHr
                                                            , Tsm_Misc5Hr = Tsm_Misc5Hr + Adj.Filler05Hr
                                                            , Tsm_Misc5OTHr = Tsm_Misc5OTHr + Adj.Filler05OTHr
                                                            , Tsm_Misc5NDHr = Tsm_Misc5NDHr + Adj.Filler05NDHr
                                                            , Tsm_Misc5NDOTHr = Tsm_Misc5NDOTHr + Adj.Filler05OTNDHr
                                                            , Tsm_Misc6Hr = Tsm_Misc6Hr + Adj.Filler06Hr
                                                            , Tsm_Misc6OTHr = Tsm_Misc6OTHr + Adj.Filler06OTHr
                                                            , Tsm_Misc6NDHr = Tsm_Misc6NDHr + Adj.Filler06NDHr
                                                            , Tsm_Misc6NDOTHr = Tsm_Misc6NDOTHr + Adj.Filler06OTNDHr
                                                            , Usr_Login = @UserLogin
                                                            , Ludatetime = GetDate()
                                                        FROM T_EmpSystemAdjMisc
                                                        INNER JOIN (SELECT A.Tsm_IDNo
                                                            , B.Tsa_HourRate
                                                            , SUM(A.Tsm_Misc1Hr) AS Filler01Hr
                                                            , SUM(A.Tsm_Misc1OTHr) AS Filler01OTHr
                                                            , SUM(A.Tsm_Misc1NDHr) AS Filler01NDHr
                                                            , SUM(A.Tsm_Misc1NDOTHr) AS Filler01OTNDHr
                                                            , SUM(A.Tsm_Misc2Hr) AS Filler02Hr
                                                            , SUM(A.Tsm_Misc2OTHr) AS Filler02OTHr
                                                            , SUM(A.Tsm_Misc2NDHr) AS Filler02NDHr
                                                            , SUM(A.Tsm_Misc2NDOTHr) AS Filler02OTNDHr
                                                            , SUM(A.Tsm_Misc3Hr) AS Filler03Hr
                                                            , SUM(A.Tsm_Misc3OTHr) AS Filler03OTHr
                                                            , SUM(A.Tsm_Misc3NDHr) AS Filler03NDHr
                                                            , SUM(A.Tsm_Misc3NDOTHr) AS Filler03OTNDHr
                                                            , SUM(A.Tsm_Misc4Hr) AS Filler04Hr
                                                            , SUM(A.Tsm_Misc4OTHr) AS Filler04OTHr
                                                            , SUM(A.Tsm_Misc4NDHr) AS Filler04NDHr
                                                            , SUM(A.Tsm_Misc4NDOTHr) AS Filler04OTNDHr
                                                            , SUM(A.Tsm_Misc5Hr) AS Filler05Hr
                                                            , SUM(A.Tsm_Misc5OTHr) AS Filler05OTHr
                                                            , SUM(A.Tsm_Misc5NDHr) AS Filler05NDHr
                                                            , SUM(A.Tsm_Misc5NDOTHr) AS Filler05OTNDHr
                                                            , SUM(A.Tsm_Misc6Hr) AS Filler06Hr
                                                            , SUM(A.Tsm_Misc6OTHr) AS Filler06OTHr
                                                            , SUM(A.Tsm_Misc6NDHr) AS Filler06NDHr
                                                            , SUM(A.Tsm_Misc6NDOTHr) AS Filler06OTNDHr
                                                            FROM T_EmpSystemAdjMisc A
                                                            INNER JOIN T_EmpSystemAdj B 
                                                            ON A.Tsm_IDNo = B.Tsa_IDNo
                                                                AND A.Tsm_AdjPayCycle = B.Tsa_AdjPayCycle
                                                                AND A.Tsm_PayCycle = B.Tsa_PayCycle
                                                                AND A.Tsm_Date = B.Tsa_Date
                                                            WHERE A.Tsm_AdjPayCycle = @CurPayPeriod
                                                                AND	A.Tsm_IDNo = @EmployeeID
                                                                And Tsa_AdjPayCycle = 0
                                                            GROUP BY A.Tsm_IDNo, B.Tsa_HourRate) Adj 
                                                        ON Tma_IDNo = Adj.Tsa_IDNo
                                                        WHERE Tsm_PayCycle = @CurPayPeriod
                                                            AND	Tsm_IDNo = @EmployeeID";

            public const string insertEmployeeAdj = @"INSERT INTO T_EmpManualAdj SELECT
                                                        Tsa_IDNo
                                                        , Tsa_AdjPayCycle
                                                        , 0
                                                        , Tsa_HourRate
                                                        , Sum(Tsa_REGHr) as RegularHr
                                                        , Sum(Tsa_REGOTHr) as RegularOTHr
                                                        , Sum(Tsa_REGNDHr) as RegularNDHr
                                                        , Sum(Tsa_REGNDOTHr) as RegularOTNDHr
                                                        , Sum(Tsa_RESTHr) as RestdayHr
                                                        , Sum(Tsa_RESTOTHr) as RestdayOTHr
                                                        , Sum(Tsa_RESTNDHr) as RestdayNDHr
                                                        , Sum(Tsa_RESTNDOTHr) as RestdayOTNDHr
                                                        , Sum(Tsa_LEGHOLHr) as LegalHolidayHr
                                                        , Sum(Tsa_LEGHOLOTHr) as LegalHolidayOTHr
                                                        , Sum(Tsa_LEGHOLNDHr) as LegalHolidayNDHr
                                                        , Sum(Tsa_LEGHOLNDOTHr) as LegalHolidayOTNDHr
                                                        , Sum(Tsa_SPLHOLHr) as SpecialHolidayHr
                                                        , Sum(Tsa_SPLHOLOTHr) as SpecialHolidayOTHr
                                                        , Sum(Tsa_SPLHOLNDHr) as SpecialHolidayNDHr
                                                        , Sum(Tsa_SPLHOLNDOTHr) as SpecialHolidayOTNDHr
                                                        , Sum(Tsa_PSDHr) as PlantShutdownHr
                                                        , Sum(Tsa_PSDOTHr) as PlantShutdownOTHr
                                                        , Sum(Tsa_PSDNDHr) as PlantShutdownNDHr
                                                        , Sum(Tsa_PSDNDOTHr) as PlantShutdownOTNDHr
                                                        , Sum(Tsa_COHOLHr) as CompanyHolidayHr
                                                        , Sum(Tsa_COHOLOTHr) as CompanyHolidayOTHr
                                                        , Sum(Tsa_COHOLNDHr) as CompanyHolidayNDHr
                                                        , Sum(Tsa_COHOLNDOTHr) as CompanyHolidayOTNDHr
                                                        , Sum(Tsa_RESTLEGHOLHr) as RestdayLegalHolidayHr
                                                        , Sum(Tsa_RESTLEGHOLOTHr) as RestdayLegalHolidayOTHr
                                                        , Sum(Tsa_RESTLEGHOLNDHr) as RestdayLegalHolidayNDHr
                                                        , Sum(Tsa_RESTLEGHOLNDOTHr) as RestdayLegalHolidayOTNDHr
                                                        , Sum(Tsa_RESTSPLHOLHr) as RestdaySpecialHolidayHr
                                                        , Sum(Tsa_RESTSPLHOLOTHr) as RestdaySpecialHolidayOTHr
                                                        , Sum(Tsa_RESTSPLHOLNDHr) as RestdaySpecialHolidayNDHr
                                                        , Sum(Tsa_RESTSPLHOLNDOTHr) as RestdaySpecialHolidayOTNDHr
                                                        , Sum(Tsa_RESTCOHOLHr) as RestdayCompanyHolidayHr
                                                        , Sum(Tsa_RESTCOHOLOTHr) as RestdayCompanyHolidayOTHr
                                                        , Sum(Tsa_RESTCOHOLNDHr) as RestdayCompanyHolidayNDHr
                                                        , Sum(Tsa_RESTCOHOLNDOTHr) as RestdayCompanyHolidayOTNDHr
                                                        , Sum(Tsa_RESTPSDHr) as RestdayPlantShutdownHr
                                                        , Sum(Tsa_RESTPSDOTHr) as RestdayPlantShutdownOTHr
                                                        , Sum(Tsa_RESTPSDNDHr) as RestdayPlantShutdownNDHr
                                                        , Sum(Tsa_RESTPSDNDOTHr) as RestdayPlantShutdownOTNDHr
                                                        , Sum(Tsa_TotalAdjAmt) as LaborHrsAdjustmentAmt
                                                        , 0,0,'',GETDATE()
                                                        From T_EmpSystemAdj
                                                        Where Tsa_AdjPayCycle = @CurPayPeriod
                                                        And	  Tsa_IDNo = @EmployeeID
                                                        Group by Tsa_IDNo, Tsa_AdjPayCycle, Tsa_HourRate
                                                        ----------Update Tsa_AdjPayCycle after insert-------
                                                        UPDATE	T_EmpSystemAdj
                                                        SET		Tsa_AdjPayCycle = 1
                                                        WHERE	Tsa_IDNo = @EmployeeID
                                                        AND		Tsa_AdjPayCycle = @CurPayPeriod";

            public const string insertEmployeeAdjExt = @"INSERT INTO T_EmpManualAdjMisc 
                                                            SELECT A.Tsm_IDNo
                                                            , A.Tsm_AdjPayCycle
                                                            , SUM(A.Tsm_Misc1Hr) AS Filler01Hr
                                                            , SUM(A.Tsm_Misc1OTHr) AS Filler01OTHr
                                                            , SUM(A.Tsm_Misc1NDHr) AS Filler01NDHr
                                                            , SUM(A.Tsm_Misc1NDOTHr) AS Filler01NDOTHr
                                                            , SUM(A.Tsm_Misc2Hr) AS Filler02Hr
                                                            , SUM(A.Tsm_Misc2OTHr) AS Filler02OTHr
                                                            , SUM(A.Tsm_Misc2NDHr) AS Filler02NDHr
                                                            , SUM(A.Tsm_Misc2NDOTHr) AS Filler02NDOTHr
                                                            , SUM(A.Tsm_Misc3Hr) AS Filler03Hr
                                                            , SUM(A.Tsm_Misc3OTHr) AS Filler03OTHr
                                                            , SUM(A.Tsm_Misc3NDHr) AS Filler03NDHr
                                                            , SUM(A.Tsm_Misc3NDOTHr) AS Filler03NDOTHr
                                                            , SUM(A.Tsm_Misc4Hr) AS Filler04Hr
                                                            , SUM(A.Tsm_Misc4OTHr) AS Filler04OTHr
                                                            , SUM(A.Tsm_Misc4NDHr) AS Filler04NDHr
                                                            , SUM(A.Tsm_Misc4NDOTHr) AS Filler04NDOTHr
                                                            , SUM(A.Tsm_Misc5Hr) AS Filler05Hr
                                                            , SUM(A.Tsm_Misc5OTHr) AS Filler05OTHr
                                                            , SUM(A.Tsm_Misc5NDHr) AS Filler05NDHr
                                                            , SUM(A.Tsm_Misc5NDOTHr) AS Filler05NDOTHr
                                                            , SUM(A.Tsm_Misc6Hr) AS Filler06Hr
                                                            , SUM(A.Tsm_Misc6OTHr) AS Filler06OTHr
                                                            , SUM(A.Tsm_Misc6NDHr) AS Filler06NDHr
                                                            , SUM(A.Tsm_Misc6NDOTHr) AS Filler06NDOTHr
                                                            , @UserLogin
                                                            , GetDate()
                                                            FROM T_EmpSystemAdjMisc A
                                                            WHERE A.Tsm_AdjPayCycle = @CurPayPeriod
                                                            AND	A.Tsm_IDNo = @EmployeeID
                                                            GROUP BY A.Tsm_IDNo, A.Tsm_AdjPayCycle";

            #endregion
            #region [For Allowance Posting]
            public const string fetchEmployeeForLaborHoursAlw = @"SELECT DISTINCT Tlr_IDNo,Tlr_LeaveAmt,Min_IncomeCode Elr_AllowanceCode,Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' [Elr_EmployeeName]	, Tlr_LeaveCode, Tlr_TaxClass
                                                                    FROM			T_EmpLeaveConversion
                                                                    INNER JOIN		M_Income
                                                                    ON				LEFT(Min_IncomeCode,2) = Tlr_LeaveCode
                                                                    AND				Min_LinkToLeave = 1
                                                                    AND				Min_TaxClass = Tlr_TaxClass
                                                                    JOIN			M_Employee
                                                                    ON				Mem_IDNo = Tlr_IDNo
                                                                    WHERE			Tlr_PayCycle = @CurPayPeriod
                                                                    AND				Tlr_PostFlag =0
                                                                    -----------------------------------------------------
                                                                    SELECT DISTINCT Tlr_LeaveCode 
                                                                    FROM			T_EmpLeaveConversion
                                                                    LEFT JOIN		M_Income
                                                                    ON				LEFT(Min_IncomeCode,2) = Tlr_LeaveCode
                                                                    AND				Min_LinkToLeave = 1
                                                                    AND				Min_TaxClass = Tlr_TaxClass
                                                                    JOIN			M_Employee
                                                                    ON				Mem_IDNo = Tlr_IDNo
                                                                    AND				Min_IncomeCode IS NULL";
            public const string updateEmployeeAlw = @"Update T_EmpIncome
			                                             Set Tin_IncomeAmt = Tin_IncomeAmt + @AllowanceAmt
	                                                        ,Usr_Login = @UserLogin
	                                                        ,Ludatetime = GetDate()
                                                       Where Tin_IDNo = @EmployeeId
			                                             And Tin_PayCycle = @CurPayPeriod
			                                             And Tin_IncomeCode = @AllowanceCode
                                                       -----------------------------------------------------
                                                       Update T_EmpLeaveConversion
                                                         Set Tlr_PostFlag = 1
                                                       Where Tlr_IDNo = @EmployeeId
                                                         And Tlr_PayCycle = @CurPayPeriod
                                                         And Tlr_LeaveCode = @LeaveType
                                                         And Tlr_TaxClass = @TaxClass";
            public const string insertEmployeeAlw = @"Insert Into T_EmpIncome Values (@EmployeeID
			                                                ,@CurPayPeriod
			                                                ,@AllowanceCode
			                                                ,'False'
			                                                ,@AllowanceAmt
			                                                ,@UserLogin
			                                                ,Getdate())
                                                       -----------------------------------------------------
                                                       Update T_EmpLeaveConversion
                                                         Set Tlr_PostFlag = 1
                                                       Where Tlr_IDNo = @EmployeeId
                                                         And Tlr_PayCycle = @CurPayPeriod
                                                         And Tlr_LeaveCode = @LeaveType
                                                         And Tlr_TaxClass = @TaxClass";
            public const string fetchEmployeeFor13thMonthAlw = @"SELECT DISTINCT Tlr_IDNo,Tlr_LeaveAmt,Min_IncomeCode Elr_AllowanceCode,Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' [Elr_EmployeeName]
                                                                    FROM			T_EmpLeaveConversion
                                                                    INNER JOIN		M_Income
                                                                    ON				LEFT(Min_IncomeCode,2) = Tlr_LeaveCode
                                                                    AND				Min_LinkToLeave = 1
                                                                    AND				Min_TaxClass = Tlr_TaxClass
                                                                    JOIN			M_Employee
                                                                    ON				Mem_IDNo = Tlr_IDNo
                                                                    WHERE			Tlr_PayCycle = @CurPayPeriod
                                                                    AND				Tlr_PostFlag =0
                                                                    -----------------------------------------------------
                                                                    SELECT DISTINCT Tlr_LeaveCode 
                                                                    FROM			T_EmpLeaveConversion
                                                                    LEFT JOIN		M_Income
                                                                    ON				LEFT(Min_IncomeCode,2) = Tlr_LeaveCode
                                                                    AND				Min_LinkToLeave = 1
                                                                    AND				Min_TaxClass = Tlr_TaxClass
                                                                    JOIN			M_Employee
                                                                    ON				Mem_IDNo = Tlr_IDNo
                                                                    AND				Min_IncomeCode IS NULL";
            #endregion
            #region [For Labor Hours Adjustment Calculation]
            public const string fetchEmployeeForLaborHoursCalc = @"SELECT DISTINCT Ttr_IDNo ,Mem_LastName + ', ' + Mem_FirstName + ' ' +  Left(Mem_MiddleName, 1) + '.' [Ell_EmployeeName] 
                                                                    FROM	T_EmpTimeRegisterTrl 
                                                                    JOIN	M_Employee
                                                                    ON		Mem_IDNo = Ttr_IDNo
                                                                    WHERE	Ttr_AdjPayCycle = @CurPayPeriod";
            
            #region [Prvious calculateAdjHours query]
//            public const string calculateAdjHours = @"  
//                                                        DECLARE @MAXABSHR AS decimal
//                                                        SET @MAXABSHR = (select Mph_NumValue from M_PolicyHdr
//                                                         where Mph_PolicyCode = 'MAXABSHR')
//                                                        
//                                                        
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET  Tsa_REGHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//						                                                      ELSE  
//								                                                     0.00  
//						                                                      END),  
//                                                            Tsa_REGOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//							                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//						                                                       ELSE  
//								                                                    0.00  
//						                                                       END),  
//		                                                    Tsa_REGNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//						                                                      ELSE  
//								                                                     0.00  
//						                                                      END),  
//                                                            Tsa_REGNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//							                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//						                                                       ELSE  
//								                                                    0.00  
//						                                                       END),  
//                                                            Tsa_RESTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//						                                                     ELSE  
//								                                                     0.00  
//						                                                     END),  
//                                                            Tsa_RESTOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                    (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//							                                                    ELSE  
//								                                                    0.00  
//							                                                    END),  
//		                                                    Tsa_RESTNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//						                                                     ELSE  
//								                                                     0.00  
//						                                                     END),  
//                                                            Tsa_RESTNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                    (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//							                                                    ELSE  
//								                                                    0.00  
//							                                                    END),  
//                                                            Tsa_LEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                      (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//							                                                      ELSE  
//								                                                      0.00  
//							                                                      END),  
//                                                            Tsa_LEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                     (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                     ELSE  
//									                                                     0.00  
//								                                                    END),  
//		                                                    Tsa_LEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                      (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//							                                                      ELSE  
//								                                                      0.00  
//							                                                      END),  
//                                                            Tsa_LEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                     (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                     ELSE  
//									                                                     0.00  
//								                                                    END),  
//                                                        
//                                                            Tsa_SPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//								                                                    ELSE  
//									                                                    0.00  
//								                                                    END),  
//                                                            Tsa_SPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                      ELSE  
//									                                                       0.00  
//								                                                      END),  
//                                                           Tsa_SPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//								                                                    ELSE  
//									                                                    0.00  
//								                                                    END),  
//                                                            Tsa_SPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                      ELSE  
//									                                                       0.00  
//								                                                      END),  
//                                                            Tsa_PSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    ((T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour) - (T_EmpTimeRegisterTrl.Ttr_REGHour + T_EmpTimeRegisterTrl.Ttr_LVHour))  
//							                                                       ELSE  
//									                                                    0.00  
//							                                                       END),  
//                                                            Tsa_PSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                     ELSE  
//									                                                       0.00  
//							                                                         END),  
//                                                           Tsa_PSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour )  
//							                                                       ELSE  
//									                                                    0.00  
//							                                                       END),  
//                                                            Tsa_PSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                     ELSE  
//									                                                       0.00  
//							                                                         END),  
//		                                                    Tsa_RESTLEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTLEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTLEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTLEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTSPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTSPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTSPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTSPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTCOHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTCOHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTCOHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTCOHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),
//                                                            Tsa_RESTPSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTPSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTPSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTPSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),
//                                                            Tsa_COHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                 (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                  (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                     (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//                                                                                            ELSE 0.00
//                                                                                           END)
//                                                        FROM T_EmpSystemAdj  
//                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
//                                                            and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
//                                                            and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
//                                                        INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
//                                                            and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
//                                                        WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
//
//                                                        --gcd 11.28.2009
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET  Tsa_REGHr = Tsa_REGHr + (T_EmpTimeRegisterTrl.Ttr_ABSHour - T_EmpTimeRegisterHst.Ttr_ABSHour)
//                                                        FROM T_EmpSystemAdj  
//                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
//                                                            and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
//                                                            and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
//                                                        INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
//                                                            and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
//                                                        WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
//                                                        and T_EmpTimeRegisterTrl.Ttr_LVHour <> T_EmpTimeRegisterHst.Ttr_LVHour
//                                                        and T_EmpTimeRegisterTrl.Ttr_ABSHour <> T_EmpTimeRegisterHst.Ttr_ABSHour
//                                                        and T_EmpTimeRegisterTrl.Ttr_REGHour = T_EmpTimeRegisterHst.Ttr_REGHour
//
//                                                        --ADDED BY KEVIN 08082009 - TO ADD MAXIMUM ABSENT HOURS ADJUSTMENT
//
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET Tsa_REGHr = @MAXABSHR
//                                                        WHERE Tsa_AdjPayCycle = @CurPayPeriod
//                                                        AND Tsa_REGHr > @MAXABSHR
//
//                                                        --END OF ADD 08082009 - KEVIN
//
//                                                        --ADDED BY JAN 11242009 - 
//
//                                                        Update T_EmpSystemAdj
//                                                        Set Tsa_REGHr = Ttr_ABSHour
//                                                        From T_EmpSystemAdj
//                                                        Inner Join T_EmpTimeRegisterTrl on Ttr_IDNo = Tsa_IDNo
//                                                          and Ttr_Date = Tsa_Date
//                                                        where Tsa_REGHr > Ttr_ABSHour
//                                                          and Ttr_ABSHour = (@MAXABSHR/2)
//                                                          and Tsa_AdjPayCycle=@CurPayPeriod
//
//                                                        --END OF ADD 11242009 - JAN";
            #endregion

            #region [Previous calculateAdjHours query]
//            public const string calculateAdjHours = @"  
//                                                        DECLARE @MAXABSHR AS decimal
//                                                        SET @MAXABSHR = (select Mph_NumValue from M_PolicyHdr
//                                                         where Mph_PolicyCode = 'MAXABSHR')
//                                                        
//                                                        
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET  Tsa_REGHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//						                                                      ELSE  
//								                                                     0.00  
//						                                                      END),  
//                                                            Tsa_REGOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//							                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//						                                                       ELSE  
//								                                                    0.00  
//						                                                       END),  
//		                                                    Tsa_REGNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//						                                                      ELSE  
//								                                                     0.00  
//						                                                      END),  
//                                                            Tsa_REGNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//							                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//						                                                       ELSE  
//								                                                    0.00  
//						                                                       END),  
//                                                            Tsa_RESTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//						                                                     ELSE  
//								                                                     0.00  
//						                                                     END),  
//                                                            Tsa_RESTOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                    (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//							                                                    ELSE  
//								                                                    0.00  
//							                                                    END),  
//		                                                    Tsa_RESTNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                     (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//						                                                     ELSE  
//								                                                     0.00  
//						                                                     END),  
//                                                            Tsa_RESTNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//								                                                    (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//							                                                    ELSE  
//								                                                    0.00  
//							                                                    END),  
//                                                            Tsa_LEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                      (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//							                                                      ELSE  
//								                                                      0.00  
//							                                                      END),  
//                                                            Tsa_LEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                     (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                     ELSE  
//									                                                     0.00  
//								                                                    END),  
//		                                                    Tsa_LEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//								                                                      (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//							                                                      ELSE  
//								                                                      0.00  
//							                                                      END),  
//                                                            Tsa_LEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                     (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                     ELSE  
//									                                                     0.00  
//								                                                    END),  
//                                                        
//                                                            Tsa_SPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//								                                                    ELSE  
//									                                                    0.00  
//								                                                    END),  
//                                                            Tsa_SPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                      ELSE  
//									                                                       0.00  
//								                                                      END),  
//                                                           Tsa_SPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//								                                                    ELSE  
//									                                                    0.00  
//								                                                    END),  
//                                                            Tsa_SPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                      ELSE  
//									                                                       0.00  
//								                                                      END),  
//                                                            Tsa_PSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    ((T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour) - (T_EmpTimeRegisterTrl.Ttr_REGHour + T_EmpTimeRegisterTrl.Ttr_LVHour))  
//							                                                       ELSE  
//									                                                    0.00  
//							                                                       END),  
//                                                            Tsa_PSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//								                                                     ELSE  
//									                                                       0.00  
//							                                                         END),  
//                                                           Tsa_PSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour )  
//							                                                       ELSE  
//									                                                    0.00  
//							                                                       END),  
//                                                            Tsa_PSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//									                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//								                                                     ELSE  
//									                                                       0.00  
//							                                                         END),  
//		                                                    Tsa_RESTLEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTLEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTLEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTLEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTSPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTSPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTSPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTSPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTCOHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTCOHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),  
//		                                                    Tsa_RESTCOHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//										                                                    ELSE  
//											                                                    0.00  
//										                                                    END),  
//		                                                    Tsa_RESTCOHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//											                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//										                                                     ELSE  
//											                                                       0.00  
//										                                                     END),
//                                                            Tsa_RESTPSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTPSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),  
//		                                                    Tsa_RESTPSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//									                                                    ELSE  
//										                                                    0.00  
//									                                                     END),  
//                                                            Tsa_RESTPSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
//										                                                       (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//									                                                       ELSE  
//										                                                       0.00  
//									                                                       END),
//                                                            Tsa_COHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                 (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                  (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                    (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
//                                                                                            ELSE 0.00
//                                                                                           END),
//                                                             Tsa_COHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
//                                                                                                     (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
//                                                                                            ELSE 0.00
//                                                                                           END)
//                                                        FROM T_EmpSystemAdj  
//                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
//                                                            and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
//                                                            and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
//                                                        INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
//                                                            and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
//                                                        WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
//
//                                                        --gcd 11.28.2009
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET  Tsa_REGHr = Tsa_REGHr + (T_EmpTimeRegisterTrl.Ttr_ABSHour - T_EmpTimeRegisterHst.Ttr_ABSHour)
//                                                        FROM T_EmpSystemAdj  
//                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
//                                                            and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
//                                                            and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
//                                                        INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
//                                                            and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
//                                                        WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
//                                                        and T_EmpTimeRegisterTrl.Ttr_LVHour <> T_EmpTimeRegisterHst.Ttr_LVHour
//                                                        and T_EmpTimeRegisterTrl.Ttr_ABSHour <> T_EmpTimeRegisterHst.Ttr_ABSHour
//                                                        and T_EmpTimeRegisterTrl.Ttr_REGHour = T_EmpTimeRegisterHst.Ttr_REGHour
//
//                                                        --ADDED BY KEVIN 08082009 - TO ADD MAXIMUM ABSENT HOURS ADJUSTMENT
//
//                                                        UPDATE T_EmpSystemAdj  
//                                                        SET Tsa_REGHr = case when Tsa_REGHr < 0 then @MAXABSHR*-1 else @MAXABSHR end 
//                                                        WHERE Tsa_AdjPayCycle = @CurPayPeriod
//                                                        AND Abs(Tsa_REGHr) > @MAXABSHR
//
//                                                        --END OF ADD 08082009 - KEVIN
//
//                                                        --ADDED BY JAN 11242009 - 
//                                                        Update T_EmpSystemAdj
//                                                        Set Tsa_REGHr = Ttr_ABSHour
//                                                        From T_EmpSystemAdj
//                                                        Inner Join T_EmpTimeRegisterTrl on Ttr_IDNo = Tsa_IDNo
//                                                          and Ttr_Date = Tsa_Date
//                                                        where Tsa_REGHr > Ttr_ABSHour
//                                                          and Ttr_ABSHour = (@MAXABSHR/2)
//                                                          and Tsa_AdjPayCycle=@CurPayPeriod
//
//                                                        --ADDED 01132010
//
//                                                        -- for half day leaves
//                                                        Update T_EmpSystemAdj
//                                                        Set Tsa_REGHr = (@MAXABSHR/2) * -1
//                                                        From T_EmpSystemAdj
//                                                        Inner Join T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo = Tsa_IDNo
//                                                          and T_EmpTimeRegisterTrl.Ttr_Date = Tsa_Date
//                                                        Inner Join T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo = Tsa_IDNo
//                                                          and T_EmpTimeRegisterHst.Ttr_Date = Tsa_Date
//                                                        where T_EmpTimeRegisterTrl.Ttr_REGHour > T_EmpTimeRegisterHst.Ttr_REGHour
//                                                                and T_EmpTimeRegisterHst.Ttr_REGHour <  T_EmpTimeRegisterHst.Ttr_LVHour
//                                                                and T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour <> T_EmpTimeRegisterHst.Ttr_ShiftMin/60.00
//                                                                and T_EmpTimeRegisterHst.Ttr_LVHour >= (@MAXABSHR/2)
//                                                                and T_EmpTimeRegisterHst.Ttr_LVHour <= @MAXABSHR  
//                                                                and T_EmpTimeRegisterHst.Ttr_ABSHour =  (@MAXABSHR/2)
//                                                                and T_EmpTimeRegisterTrl.Ttr_LVHour = 0
//                                                                and Tsa_AdjPayCycle=@CurPayPeriod
//  
//                                                        --With Adjusted leave and punches
//                                                        Update T_EmpSystemAdj
//                                                        Set Tsa_REGHr = 0
//                                                        From T_EmpSystemAdj
//                                                        Inner Join T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo = Tsa_IDNo
//                                                          and T_EmpTimeRegisterTrl.Ttr_Date = Tsa_Date
//														  and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
//                                                        Inner Join T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo = Tsa_IDNo
//                                                          and T_EmpTimeRegisterHst.Ttr_Date = Tsa_Date
//                                                        where T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour = T_EmpTimeRegisterTrl.Ttr_REGHour 
//                                                                and T_EmpTimeRegisterTrl.Ttr_LVHour = 0
//                                                                and T_EmpTimeRegisterHst.Ttr_ABSHour = 0
//                                                                and T_EmpTimeRegisterTrl.Ttr_ABSHour = 0
//                                                                and Tsa_AdjPayCycle=@CurPayPeriod";
            #endregion

            public const string calculateAdjHours = @"  
		DECLARE @MAXABSHR AS decimal
		SET @MAXABSHR = (select Mph_NumValue from M_PolicyHdr
		where Mph_PolicyCode = 'MAXABSHR')


		UPDATE T_EmpSystemAdj  
		SET  Tsa_REGHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					 (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
			  ELSE  
					 0.00  
			  END),  
		Tsa_REGOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
				   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
			   ELSE  
					0.00  
			   END),  
		Tsa_REGNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					 (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
			  ELSE  
					 0.00  
			  END),  
		Tsa_REGNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REG' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
				   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
			   ELSE  
					0.00  
			   END),  
		Tsa_RESTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
					 (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
			 ELSE  
					 0.00  
			 END),  
		Tsa_RESTOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
					(T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
				ELSE  
					0.00  
				END),  
		Tsa_RESTNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
					 (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
			 ELSE  
					 0.00  
			 END),  
		Tsa_RESTNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'REST' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
					(T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
				ELSE  
					0.00  
				END),  
		Tsa_LEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					  (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
				  ELSE  
					  0.00  
				  END),  
		Tsa_LEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						 (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
					 ELSE  
						 0.00  
					END),  
		Tsa_LEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					  (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
				  ELSE  
					  0.00  
				  END),  
		Tsa_LEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						 (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
					 ELSE  
						 0.00  
					END),  

		Tsa_SPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						(T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
					ELSE  
						0.00  
					END),  
		Tsa_SPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
					  ELSE  
						   0.00  
					  END),  
		Tsa_SPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
					ELSE  
						0.00  
					END),  
		Tsa_SPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
					   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
					  ELSE  
						   0.00  
					  END),  
		Tsa_PSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						((T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour) - (T_EmpTimeRegisterTrl.Ttr_REGHour + T_EmpTimeRegisterTrl.Ttr_LVHour))  
				   ELSE  
						0.00  
				   END),  
		Tsa_PSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
					 ELSE  
						   0.00  
					 END),  
		Tsa_PSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour )  
				   ELSE  
						0.00  
				   END),  
		Tsa_PSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
					 ELSE  
						   0.00  
					 END),  
		Tsa_RESTLEGHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							(T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
						ELSE  
							0.00  
						 END),  
		Tsa_RESTLEGHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
						   ELSE  
							   0.00  
						   END),  
		Tsa_RESTLEGHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
						ELSE  
							0.00  
						 END),  
		Tsa_RESTLEGHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'HOL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
						   ELSE  
							   0.00  
						   END),  
		Tsa_RESTSPLHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								(T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
							ELSE  
								0.00  
							END),  
		Tsa_RESTSPLHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
							 ELSE  
								   0.00  
							 END),  
		Tsa_RESTSPLHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
							ELSE  
								0.00  
							END),  
		Tsa_RESTSPLHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SPL' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
							 ELSE  
								   0.00  
							 END),  
		Tsa_RESTCOHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								(T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
							ELSE  
								0.00  
							END),  
		Tsa_RESTCOHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
							 ELSE  
								   0.00  
							 END),  
		Tsa_RESTCOHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
							ELSE  
								0.00  
							END),  
		Tsa_RESTCOHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
								   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
							 ELSE  
								   0.00  
							 END),
		Tsa_RESTPSDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							(T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
						ELSE  
							0.00  
						 END),  
		Tsa_RESTPSDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							   (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
						   ELSE  
							   0.00  
						   END),  
		Tsa_RESTPSDNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
						ELSE  
							0.00  
						 END),  
		Tsa_RESTPSDNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'PSD' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 1 then  
							   (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
						   ELSE  
							   0.00  
						   END),
		Tsa_COHOLHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
								 (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour)  
							ELSE 0.00
						   END),
		Tsa_COHOLOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
								  (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  
							ELSE 0.00
						   END),
		Tsa_COHOLNDHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
									(T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
							ELSE 0.00
						   END),
		Tsa_COHOLNDOTHr = (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'COMP' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
									 (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
							ELSE 0.00
						   END)
		FROM T_EmpSystemAdj  
		INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
		INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
		WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod

		--gcd 11.28.2009
		UPDATE T_EmpSystemAdj  
		SET  Tsa_REGHr = Tsa_REGHr + (T_EmpTimeRegisterTrl.Ttr_ABSHour - T_EmpTimeRegisterHst.Ttr_ABSHour)
		FROM T_EmpSystemAdj  
		INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
		INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
		WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = @CurPayPeriod
		and T_EmpTimeRegisterTrl.Ttr_LVHour <> T_EmpTimeRegisterHst.Ttr_LVHour
		and T_EmpTimeRegisterTrl.Ttr_ABSHour <> T_EmpTimeRegisterHst.Ttr_ABSHour
		and T_EmpTimeRegisterTrl.Ttr_REGHour = T_EmpTimeRegisterHst.Ttr_REGHour

		--ADDED BY KEVIN 08082009 - TO ADD MAXIMUM ABSENT HOURS ADJUSTMENT

		UPDATE T_EmpSystemAdj  
		SET Tsa_REGHr = case when Tsa_REGHr < 0 then @MAXABSHR*-1 else @MAXABSHR end 
		WHERE Tsa_AdjPayCycle = @CurPayPeriod
		AND Abs(Tsa_REGHr) > @MAXABSHR

		--END OF ADD 08082009 - KEVIN

		--ADDED BY JAN 11242009 - 
		Update T_EmpSystemAdj
		Set Tsa_REGHr = Ttr_ABSHour
		From T_EmpSystemAdj
		Inner Join T_EmpTimeRegisterTrl on Ttr_IDNo = Tsa_IDNo
		and Ttr_Date = Tsa_Date
		and Ttr_AdjPayCycle  = Tsa_AdjPayCycle    
		where Tsa_REGHr > Ttr_ABSHour
		and Ttr_ABSHour = (@MAXABSHR/2)
		and Tsa_AdjPayCycle=@CurPayPeriod

		--ADDED 01132010

		-- for half day leaves
		Update T_EmpSystemAdj
		Set Tsa_REGHr = (@MAXABSHR/2) * -1
		From T_EmpSystemAdj
		Inner Join T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = Tsa_Date
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = Tsa_AdjPayCycle 
		Inner Join T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterHst.Ttr_Date = Tsa_Date
		where T_EmpTimeRegisterTrl.Ttr_REGHour > T_EmpTimeRegisterHst.Ttr_REGHour
		and T_EmpTimeRegisterHst.Ttr_REGHour <  T_EmpTimeRegisterHst.Ttr_LVHour
		and T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour <> T_EmpTimeRegisterHst.Ttr_ShiftMin/60.00
		and T_EmpTimeRegisterHst.Ttr_LVHour >= (@MAXABSHR/2)
		and T_EmpTimeRegisterHst.Ttr_LVHour <= @MAXABSHR  
		and T_EmpTimeRegisterHst.Ttr_ABSHour =  (@MAXABSHR/2)
		and T_EmpTimeRegisterTrl.Ttr_LVHour = 0
		and Tsa_AdjPayCycle=@CurPayPeriod

		--With Adjusted leave and punches
		Update T_EmpSystemAdj
		Set Tsa_REGHr = 0
		From T_EmpSystemAdj
		Inner Join T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = Tsa_Date
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = Tsa_AdjPayCycle 
		Inner Join T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterHst.Ttr_Date = Tsa_Date
		where T_EmpTimeRegisterHst.Ttr_REGHour + T_EmpTimeRegisterHst.Ttr_LVHour = T_EmpTimeRegisterTrl.Ttr_REGHour 
		and T_EmpTimeRegisterTrl.Ttr_LVHour = 0
		and T_EmpTimeRegisterHst.Ttr_ABSHour = 0
		and T_EmpTimeRegisterTrl.Ttr_ABSHour = 0
		and Tsa_AdjPayCycle=@CurPayPeriod

		Update T_EmpSystemAdj
		Set Tsa_REGHr = 0
		From T_EmpSystemAdj
		Inner Join T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = Tsa_Date
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = Tsa_AdjPayCycle  
		Inner Join T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo = Tsa_IDNo
		and T_EmpTimeRegisterHst.Ttr_Date = Tsa_Date
		where Tsa_AdjPayCycle = @CurPayPeriod
		and T_EmpTimeRegisterHst.Ttr_ABSHour = 0
		and T_EmpTimeRegisterTrl.Ttr_ABSHour = 0
		and (( T_EmpTimeRegisterTrl.Ttr_REGHour = @MAXABSHR
		and T_EmpTimeRegisterHst.Ttr_REGHour > @MAXABSHR) or
		( T_EmpTimeRegisterHst.Ttr_REGHour = @MAXABSHR
		and T_EmpTimeRegisterTrl.Ttr_REGHour > @MAXABSHR))";

            public const string insertToDailyAllowance = @"
-----------------INSERTED BY KEVIN 04072009 - T_EMPLOYEEDAILYALLOWANCE --------------------
Declare @SqlScript1 varchar(max)
Declare @SqlScript2 varchar(max)
Declare @Cnt smallint
Declare @Code varchar(5)
Declare @Payperiod varchar(10)
Declare @user varchar(40)

set @Cnt = 0
set @SqlScript1 = ''
set @SqlScript2 = ''
set @Code =''
set @Payperiod = @CurPayPeriod
set @user = @UserLogin
while (@Cnt < 6)
begin
	set @Cnt = @Cnt + 1
	set @Code = (select right('0' + convert(varchar(2),@Cnt) ,2))
	set @SqlScript1 = @SqlScript1 + 
	'
	insert into T_EmployeeDailyAllowance
	select
	T_EmpSystemAdj.Tsa_IDNo
	, '''+ @Payperiod + '''
	, Alh_AllowanceAdjCode
	, ''false''
	, (isnull(sum(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code +'),0) - isnull(sum(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code +'),0))
	, ''P''
	, '''+ @user + '''
	, GetDate()
	FROM T_EmpSystemAdj 
	INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
	INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
	INNER JOIN T_Allowanceheader ON Alh_LedgerAlwCol = ''' + @Code + '''
	WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = ''' + @Payperiod + '''
	AND (isnull(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code + ',0) - isnull(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code + ',0)) <> 0
    AND ISNULL(T_EmpTimeRegisterTrl.Ttr_AssumedPost, '''') != ''A'' --Added By Rendell Uy - 1/28/2011
group by T_EmpSystemAdj.Tsa_IDNo,Alh_AllowanceAdjCode'
end

while (@Cnt < 12)
begin
	set @Cnt = @Cnt + 1
	set @Code = (select right('0' + convert(varchar(2),@Cnt) ,2))
	set @SqlScript2 = @SqlScript2 + 
	'
	insert into T_EmployeeDailyAllowance
	select
	T_EmpSystemAdj.Tsa_IDNo
	, '''+ @Payperiod + '''
	, Alh_AllowanceAdjCode
	, ''false''
	, (isnull(sum(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code +'),0) - isnull(sum(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code +'),0))
	, ''P''
	, '''+ @user + '''
	, GetDate()
	FROM T_EmpSystemAdj 
	INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
	INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
	INNER JOIN T_Allowanceheader ON Alh_LedgerAlwCol = ''' + @Code + '''
	WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = ''' + @Payperiod + '''
	AND (isnull(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code + ',0) - isnull(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code + ',0)) <> 0
    AND ISNULL(T_EmpTimeRegisterTrl.Ttr_AssumedPost, '''') != ''A'' --Added By Rendell Uy - 1/28/2011
group by T_EmpSystemAdj.Tsa_IDNo,Alh_AllowanceAdjCode'
end

exec (@SqlScript1 + @SqlScript2)
--------------------  END -----------------------------------
";

            public const string insertToDailyAllowanceNotAdj = @"
-----------------INSERTED BY KEVIN 04072009 - T_EMPLOYEEDAILYALLOWANCE --------------------
Declare @SqlScript1 varchar(max)
Declare @SqlScript2 varchar(max)
Declare @Cnt smallint
Declare @Code varchar(5)
Declare @Payperiod varchar(10)
Declare @user varchar(40)

set @Cnt = 0
set @SqlScript1 = ''
set @SqlScript2 = ''
set @Code =''
set @Payperiod = @CurPayPeriod
set @user = @UserLogin
while (@Cnt < 6)
begin
	set @Cnt = @Cnt + 1
	set @Code = (select right('0' + convert(varchar(2),@Cnt) ,2))
	set @SqlScript1 = @SqlScript1 + 
	'
	insert into T_EmployeeDailyAllowance
	select
	T_EmpSystemAdj.Tsa_IDNo
	, '''+ @Payperiod + '''
	, Alh_AllowanceCode
	, ''false''
	, (isnull(sum(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code +'),0) - isnull(sum(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code +'),0))
	, ''C''
	, '''+ @user + '''
	, GetDate()
	FROM T_EmpSystemAdj 
	INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
	INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
	INNER JOIN T_Allowanceheader ON Alh_LedgerAlwCol = ''' + @Code + '''
	WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = ''' + @Payperiod + '''
	AND (isnull(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code + ',0) - isnull(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code + ',0)) <> 0
    AND ISNULL(T_EmpTimeRegisterTrl.Ttr_AssumedPost, '''') = ''A'' --Added By Rendell Uy - 1/28/2011
group by T_EmpSystemAdj.Tsa_IDNo,Alh_AllowanceCode'
end

while (@Cnt < 12)
begin
	set @Cnt = @Cnt + 1
	set @Code = (select right('0' + convert(varchar(2),@Cnt) ,2))
	set @SqlScript2 = @SqlScript2 + 
	'
	insert into T_EmployeeDailyAllowance
	select
	T_EmpSystemAdj.Tsa_IDNo
	, '''+ @Payperiod + '''
	, Alh_AllowanceCode
	, ''false''
	, (isnull(sum(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code +'),0) - isnull(sum(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code +'),0))
	, ''C''
	, '''+ @user + '''
	, GetDate()
	FROM T_EmpSystemAdj 
	INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
		and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
		and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
	INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
		and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
	INNER JOIN T_Allowanceheader ON Alh_LedgerAlwCol = ''' + @Code + '''
	WHERE T_EmpTimeRegisterTrl.Ttr_AdjPayCycle = ''' + @Payperiod + '''
	AND (isnull(T_EmpTimeRegisterHst.Ttr_TBAmt'+ @Code + ',0) - isnull(T_EmpTimeRegisterTrl.Ttr_TBAmt'+ @Code + ',0)) <> 0
    AND ISNULL(T_EmpTimeRegisterTrl.Ttr_AssumedPost, '''') = ''A'' --Added By Rendell Uy - 1/28/2011
group by T_EmpSystemAdj.Tsa_IDNo,Alh_AllowanceCode'
end

exec (@SqlScript1 + @SqlScript2)
--------------------  END -----------------------------------
";

            public const string addAdjHoursForSOFF = @"UPDATE T_EmpSystemAdj  
                                                        SET Tsa_REGOTHr = Tsa_REGOTHr + 
                                                            (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SOFF' and 
                                                                        T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then                                                        
                                                            (T_EmpTimeRegisterHst.Ttr_OTHour - T_EmpTimeRegisterTrl.Ttr_OTHour)  + 
                                                            (T_EmpTimeRegisterHst.Ttr_REGHour - T_EmpTimeRegisterTrl.Ttr_REGHour) 
                                                                ELSE 0.00  
                                                             END),  
	                                                        Tsa_REGNDHr =  Tsa_REGNDHr + (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SOFF' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
							                                                         (T_EmpTimeRegisterHst.Ttr_NDHour - T_EmpTimeRegisterTrl.Ttr_NDHour)  
					                                                          ELSE  
							                                                         0.00  
					                                                          END),  
                                                            Tsa_REGNDOTHr = Tsa_REGNDOTHr + (CASE WHEN T_EmpTimeRegisterTrl.Ttr_DayCode = 'SOFF' and T_EmpTimeRegisterTrl.Ttr_RestDayFlag = 0 then  
						                                                           (T_EmpTimeRegisterHst.Ttr_NDOTHour - T_EmpTimeRegisterTrl.Ttr_NDOTHour)  
					                                                           ELSE  
							                                                        0.00  
					                                                           END)
                                                     FROM T_EmpSystemAdj  
                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
                                                            and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
                                                            and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle   
                                                        INNER JOIN T_EmpTimeRegisterHst on T_EmpTimeRegisterHst.Ttr_IDNo   = T_EmpSystemAdj.Tsa_IDNo  
                                                            and T_EmpTimeRegisterHst.Ttr_Date = T_EmpSystemAdj.Tsa_Date  
                                                        WHERE Tsa_AdjPayCycle = @CurPayPeriod";
            //MODIFIED BY KEVIN 04082009 - FOR PAY type
            public const string updateRates = @"Update T_EmpSystemAdj
                                                        Set Tsa_SalaryRate = {0},
                                                         Tsa_HourRate = ISNULL(CASE 
                                                                         WHEN M_EmployeeHst.{1} = 'D' THEN M_EmployeeHst.{0} / 8
                                                                         WHEN M_EmployeeHst.{1} = 'M' THEN ((M_EmployeeHst.{0} * 12) / (Select Mph_NumValue From M_PolicyHdr Where Mph_PolicyCode = 'MDIVISOR' And Mph_RecordStatus = 'A')) / 8
                                                                         WHEN M_EmployeeHst.{1} = 'H' THEN M_EmployeeHst.{0}
                                                                         END, 0),
                                                         Usr_Login = @UserLogin,
                                                         Ludatetime = Getdate()
                                                        FROM T_EmpSystemAdj 
                                                        Inner Join M_EmployeeHst on Mem_IDNo = Tsa_IDNo
	                                                        and  Mem_PayCycle = Tsa_PayCycle
                                                            WHERE Tsa_AdjPayCycle = @CurPayPeriod";

            public const string deleteZeroSum = @"DELETE FROM T_EmpSystemAdj 
                                                        WHERE (Tsa_REGHr
                                                              + Tsa_REGOTHr
                                                              + Tsa_REGNDHr
                                                              + Tsa_REGNDOTHr
                                                              + Tsa_RESTHr
                                                              + Tsa_RESTOTHr
                                                              + Tsa_RESTNDHr
                                                              + Tsa_RESTNDOTHr
                                                              + Tsa_LEGHOLHr
                                                              + Tsa_LEGHOLOTHr
                                                              + Tsa_LEGHOLNDHr
                                                              + Tsa_LEGHOLNDOTHr
                                                              + Tsa_SPLHOLHr
                                                              + Tsa_SPLHOLOTHr
                                                              + Tsa_SPLHOLNDHr
                                                              + Tsa_SPLHOLNDOTHr
                                                              + Tsa_PSDHr
                                                              + Tsa_PSDOTHr
                                                              + Tsa_PSDNDHr
                                                              + Tsa_PSDNDOTHr
                                                              + Tsa_COHOLHr
                                                              + Tsa_COHOLOTHr
                                                              + Tsa_COHOLNDHr
                                                              + Tsa_COHOLNDOTHr
                                                              + Tsa_RESTLEGHOLHr
                                                              + Tsa_RESTLEGHOLOTHr
                                                              + Tsa_RESTLEGHOLNDHr
                                                              + Tsa_RESTLEGHOLNDOTHr
                                                              + Tsa_RESTSPLHOLHr
                                                              + Tsa_RESTSPLHOLOTHr
                                                              + Tsa_RESTSPLHOLNDHr
                                                              + Tsa_RESTSPLHOLNDOTHr
                                                              + Tsa_RESTCOHOLHr
                                                              + Tsa_RESTCOHOLOTHr
                                                              + Tsa_RESTCOHOLNDHr
                                                              + Tsa_RESTCOHOLNDOTHr
                                                              + Tsa_RESTPSDHr
                                                              + Tsa_RESTPSDOTHr
                                                              + Tsa_RESTPSDNDHr
                                                              + Tsa_RESTPSDNDOTHr) = 0
                                                    AND Tsa_AdjPayCycle = @CurPayPeriod";

            public const string updateLaborHoursAmt = @"UPDATE T_EmpSystemAdj
                                                        SET Tsa_TotalAdjAmt = 
                                                            (Tsa_REGHr * Tsa_HourRate)
                                                          + (Tsa_REGOTHr * Tsa_HourRate * @RegOT) 
                                                          + (Tsa_REGNDHr * Tsa_HourRate * @Reg * @NGTPrem)
                                                          + (Tsa_REGNDOTHr * Tsa_HourRate * @RegOT * @NGTPrem)
                                                          + (Tsa_RESTHr * Tsa_HourRate * @Rest)
                                                          + (Tsa_RESTOTHr * Tsa_HourRate * @RestOT)
                                                          + (Tsa_RESTNDHr * Tsa_HourRate * @Rest * @NGTPrem)
                                                          + (Tsa_RESTNDOTHr * Tsa_HourRate * @RestOT * @NGTPrem)
                                                          + (Tsa_LEGHOLHr * Tsa_HourRate * @Hol)
                                                          + (Tsa_LEGHOLOTHr * Tsa_HourRate * @HolOT)
                                                          + (Tsa_LEGHOLNDHr * Tsa_HourRate * @Hol * @NGTPrem)
                                                          + (Tsa_LEGHOLNDOTHr * Tsa_HourRate * @HolOT * @NGTPrem)
                                                          + (Tsa_SPLHOLHr * Tsa_HourRate * @SPL)
                                                          + (Tsa_SPLHOLOTHr * Tsa_HourRate * @SPLOT)
                                                          + (Tsa_SPLHOLNDHr * Tsa_HourRate * @SPL * @NGTPrem)
                                                          + (Tsa_SPLHOLNDOTHr * Tsa_HourRate * @SPLOT * @NGTPrem)
                                                          + (Tsa_PSDHr * Tsa_HourRate * @PSD)
                                                          + (Tsa_PSDOTHr * Tsa_HourRate * @PSDOT)
                                                          + (Tsa_PSDNDHr * Tsa_HourRate * @PSD * @NGTPrem)
                                                          + (Tsa_PSDNDOTHr * Tsa_HourRate * @PSDOT * @NGTPrem)
                                                          + (Tsa_COHOLHr * Tsa_HourRate * @Comp)
                                                          + (Tsa_COHOLOTHr * Tsa_HourRate * @CompOT)
                                                          + (Tsa_COHOLNDHr * Tsa_HourRate * @Comp * @NGTPrem)
                                                          + (Tsa_COHOLNDOTHr * Tsa_HourRate * @CompOT * @NGTPrem)
                                                          + (Tsa_RESTLEGHOLHr * Tsa_HourRate * @RestHol)
                                                          + (Tsa_RESTLEGHOLOTHr * Tsa_HourRate * @RestHolOT)
                                                          + (Tsa_RESTLEGHOLNDHr * Tsa_HourRate * @RestHol * @NGTPrem)
                                                          + (Tsa_RESTLEGHOLNDOTHr * Tsa_HourRate * @RestHolOT * @NGTPrem) 
                                                          + (Tsa_RESTSPLHOLHr * Tsa_HourRate * @RestSPL)
                                                          + (Tsa_RESTSPLHOLOTHr * Tsa_HourRate * @RestSPLOT)
                                                          + (Tsa_RESTSPLHOLNDHr * Tsa_HourRate * @RestSPL * @NGTPrem) 
                                                          + (Tsa_RESTSPLHOLNDOTHr * Tsa_HourRate * @RestSPLOT * @NGTPrem)
                                                          + (Tsa_RESTCOHOLHr * Tsa_HourRate * @RestComp)
                                                          + (Tsa_RESTCOHOLOTHr * Tsa_HourRate * @RestCompOT) 
                                                          + (Tsa_RESTCOHOLNDHr * Tsa_HourRate * @RestComp * @NGTPrem) 
                                                          + (Tsa_RESTCOHOLNDOTHr * Tsa_HourRate * @RestCompOT * @NGTPrem)
                                                          + (Tsa_RESTPSDHr * Tsa_HourRate * @RestPSD)
                                                          + (Tsa_RESTPSDOTHr * Tsa_HourRate * @RestPSDOT)
                                                          + (Tsa_RESTPSDNDHr * Tsa_HourRate * @RestPSD * @NGTPrem)
                                                          + (Tsa_RESTPSDNDOTHr * Tsa_HourRate * @RestPSDOT * @NGTPrem) 
                                                        FROM T_EmpSystemAdj
                                                        INNER JOIN T_EmpTimeRegisterTrl on T_EmpTimeRegisterTrl.Ttr_IDNo  = T_EmpSystemAdj.Tsa_IDNo
	                                                        and T_EmpTimeRegisterTrl.Ttr_Date = T_EmpSystemAdj.Tsa_Date   
	                                                        and T_EmpTimeRegisterTrl.Ttr_AdjPayCycle  = T_EmpSystemAdj.Tsa_AdjPayCycle    
                                                        WHERE Tsa_AdjPayCycle = @CurPayPeriod
                                                        AND ISNULL(T_EmpTimeRegisterTrl.Ttr_AssumedPost, '') != 'A' --Added By Rendell Uy - 1/28/2011";
            public const string deleteZeroLaborHrsAdjAmt = @"DELETE FROM T_EmpSystemAdj 
                                                             WHERE Tsa_TotalAdjAmt = 0
                                                             AND Tsa_AdjPayCycle = @CurPayPeriod";
            public const string checkRequiredConstant = @"SELECT * FROM DBO.NumericValue('NIGHTPREM')
                                                          SELECT * FROM GETPREMIUMS('REG', 'false')
                                                          SELECT * FROM GETPREMIUMS('REST', 'true')
                                                          SELECT * FROM GETPREMIUMS('HOL', 'false')
                                                          SELECT * FROM GETPREMIUMS('SPL', 'false')
                                                          SELECT * FROM GETPREMIUMS('PSD', 'false')
                                                          SELECT * FROM GETPREMIUMS('COMP', 'false')
                                                          SELECT * FROM GETPREMIUMS('HOL', 'true')
                                                          SELECT * FROM GETPREMIUMS('SPL', 'true')
                                                          SELECT * FROM GETPREMIUMS('COMP', 'true')
                                                          SELECT * FROM GETPREMIUMS('PSD', 'true')
                                                        ------------------------------------------------------------------------
                                                        Select Distinct Tsa_IDNo + ' - ' + Mem_FirstName + ' ' + Mem_LastName + ' (' + convert(char(10),Tps_StartCycle,101) + ' - ' + convert(char(10),Tps_EndCycle,101) + ')'
                                                        FROM  T_EmpSystemAdj 
                                                        LEFT Join M_EmployeeHst on M_EmployeeHst.Mem_IDNo = Tsa_IDNo
                                                        and  Mem_PayCycle = Tsa_PayCycle
                                                        LEFT JOIN M_Employee on M_Employee.Mem_IDNo = M_EmployeeHst.Mem_IDNo
                                                        LEFT JOIN T_PaySchedule on Tps_PayCycle =  Tsa_PayCycle
                                                        WHERE Tsa_AdjPayCycle = @CurPayPeriod
                                                        -- MODIFIED BY KEVIN 04072009 FOR PAY TYPE
                                                        and (M_EmployeeHst.{0} is null or M_EmployeeHst.{0} =0)";
            #endregion
            #region [For Payroll Transaction Posting]
            public const string clearPayrollTransactionTable = @"Update T_EmpPayTranHdr
                                                                Set  Tph_TotalAdjAmt = '0.00'
	                                                                ,Tph_TaxableAdjAmt = '0.00'
	                                                                ,Tph_NontaxableAdjAmt = '0.00'
	                                                                ,Tph_TaxableIncomeAmt = '0.00'
	                                                                ,Tph_NontaxableIncomeAmt = '0.00'
                                                                Where Tph_PayCycle = @CurPayPeriod
                                                                And (Tph_TotalAdjAmt <> 0 
                                                                OR Tph_TaxableAdjAmt <> 0
                                                                OR Tph_NontaxableAdjAmt <> 0
                                                                OR Tph_TaxableIncomeAmt <> 0
                                                                OR Tph_NontaxableIncomeAmt <> 0)";
            public const string updateEmployeeAdjustmentTransaction = @"
                                                                    --Update T_EmpPayTranHdr
                                                                    --Set  Tph_TotalAdjAmt = Tma_TotalAdjAmt
                                                                    --    ,Tph_TaxableAdjAmt = Tma_TaxableAdjAmt
                                                                    --    ,Tph_NontaxableAdjAmt = Tma_NontaxableAdjAmt
                                                                    --    ,Usr_Login = @UserLogin
                                                                    --    ,Ludatetime = Getdate()
                                                                    --From T_EmpManualAdj Inner Join T_EmpPayTranHdr
                                                                    --    On Tma_IDNo = Tph_IDNo
                                                                    --    And Tma_PayCycle = Tph_PayCycle
                                                                    --Where Tma_PayCycle = @CurPayPeriod
                                                                    --    And Tma_PostFlag = 0
                                                                    
                                                                    Update T_EmpPayTranHdr
                                                                    Set  Tph_TotalAdjAmt = Tma_TotalAdjAmt
                                                                        ,Tph_TaxableAdjAmt = Tma_TaxableAdjAmt
                                                                        ,Tph_NontaxableAdjAmt = Tma_NontaxableAdjAmt
                                                                        ,Usr_Login = @UserLogin
                                                                        ,Ludatetime = Getdate()
                                                                    From T_EmpPayTranHdr
                                                                    Inner Join (Select Tma_IDNo, Tma_PayCycle
			                                                                    , Sum(Tma_TotalAdjAmt) as Tma_TotalAdjAmt
			                                                                    , Sum(Tma_TaxableAdjAmt) as Tma_TaxableAdjAmt
			                                                                    , Sum(Tma_NontaxableAdjAmt) as Tma_NontaxableAdjAmt
			                                                                    From T_EmpManualAdj 
			                                                                    Where Tma_PayCycle = @CurPayPeriod
				                                                                    And Tma_PostFlag = 0
			                                                                    Group by Tma_IDNo,Tma_PayCycle ) xx On xx.Tma_IDNo = Tph_IDNo
						                                                                    And xx.Tma_PayCycle = Tph_PayCycle
                                                                    Where Tph_PayCycle = @CurPayPeriod";
            public const string updateEmployeeAdjustmentFlags = @"Update T_EmpManualAdj
                                                                    Set Tma_PostFlag = 1
                                                                    From T_EmpManualAdj Inner Join T_EmpPayTranHdr
                                                                        On Tma_IDNo = Tph_IDNo
                                                                        And Tma_PayCycle = Tph_PayCycle
                                                                    Where Tma_PayCycle = @CurPayPeriod";
            public const string updateEmployeeAllowanceTransaction = @"Update T_EmpPayTranHdr
                                                                        Set  Tph_TaxableIncomeAmt = TaxAllowanceAmt
                                                                            ,Tph_NontaxableIncomeAmt = NonTaxAllowanceAmt
                                                                            ,Usr_Login = @UserLogin
                                                                            ,Ludatetime = Getdate()
                                                                        From T_EmpPayTranHdr Inner Join
                                                                        (Select Tin_IDNo
                                                                                ,TaxAllowanceAmt = Sum(CASE WHEN Min_TaxClass = 'T' THEN Tin_IncomeAmt ELSE 0 END)
                                                                                ,NonTaxAllowanceAmt = Sum(CASE WHEN Min_TaxClass = 'N' THEN Tin_IncomeAmt ELSE 0 END)
                                                                         From T_EmpIncome Inner Join M_Income
                                                                            On Min_IncomeCode = Tin_IncomeCode
                                                                         Where Tin_PayCycle = @CurPayPeriod
                                                                            And Tin_PostFlag = 0
                                                                         Group by Tin_IDNo)Allowance on Tph_IDNo = Tin_IDNo
                                                                        Where Tph_PayCycle = @CurPayPeriod";
            public const string updateEmployeeAllowanceFlags = @"Update T_EmpIncome
                                                                Set Tin_PostFlag = 1
                                                                From T_EmpIncome Inner Join T_EmpPayTranHdr
                                                                    On Tin_IDNo = Tph_IDNo
                                                                    And Tin_PayCycle = Tph_PayCycle
                                                                Where Tin_PayCycle = @CurPayPeriod";

            #endregion
            #region [For Leave Refund Calculation]
            
            //edited by jccapetillo 11152009
//            public const string FetchRecordsForRefund = @"declare @VLDMINIMIS as decimal(9,2)
//
//                                                            set @VLDMINIMIS = (select Mph_NumValue from M_PolicyHdr
//                                                            where Mph_PolicyCode ='VLDMINIMIS')
//
//                                                            SELECT	DISTINCT
//                                                                            Mem_IDNo EmployeeID, 
//                                                                            Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
//                                                                            Mlv_LeaveCode LeaveType, 
//                                                                            Mlv_LeaveDescription LeaveDesc,
//				                                                            CASE WHEN Mlv_LeaveCode = 'VL' THEN 'NON-TAXABLE'
//				                                                            ELSE 'TAXABLE'
//				                                                            END	 TaxClass,
//                                                                            CASE Mlv_LeaveCode
//                                                                            WHEN 'VL' THEN 
//						                                                            CASE WHEN Elm_VLBalance <= @VLDMINIMIS THEN
//								                                                            Elm_VLBalance
//						                                                            ELSE	
//								                                                            @VLDMINIMIS
//						                                                            END
//	                                                                        WHEN 'SL' THEN Elm_SLBalance
//                                                                            WHEN 'PL' THEN Elm_SLBalance 
//                                                                            WHEN 'BL' THEN Elm_SLBalance
//                                                                            WHEN 'DL' THEN Elm_SLBalance
//                                                                            ELSE  0   END LeaveBalance,
//                                                                    0 RefundAmount,
//                                                                    Mem_Salary SalaryRate,
//                                                                    Mem_PayrollType PayrollType,
//                                                                    Mem_BillingSalary BillingRate,
//                                                                    Mem_BillingPayrollType BillingPayrollType,
//                                                                    Mem_TaxSalary TaxRate,
//                                                                    Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
//                                                                    FROM	M_Leave
//                                                                    JOIN	M_Employee ON	LEFT(Mem_WorkStatus, 1) = 'A' 
//                                                            {0}AND  Mem_IsCompanyAnniversary = 1
//                                                                    JOIN	T_EmployeeLeaveMaster ON Elm_EmployeeId = Mem_IDNo
//                                                                    WHERE	Mlv_ConvertibleToCash = 1
//                                                                    AND		Mlv_RecordStatus = 'A'
//                                                                    AND     (CASE Mlv_LeaveCode
//				                                                            WHEN 'VL' THEN Elm_VLBalance
//				                                                            WHEN 'SL' THEN Elm_SLBalance
//				                                                            WHEN 'PL' THEN Elm_SLBalance
//				                                                            WHEN 'BL' THEN Elm_SLBalance
//				                                                            WHEN 'DL' THEN Elm_SLBalance
//				                                                            ELSE  0 END) > 0
//
//                                                            UNION ALL
//
//                                                            SELECT	DISTINCT
//                                                                            Mem_IDNo EmployeeID, 
//                                                                            Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
//                                                                            Mlv_LeaveCode LeaveType, 
//                                                                            Mlv_LeaveDescription LeaveDesc,
//				                                                            'TAXABLE' TaxClass,
//                                                                            Elm_VLBalance - @VLDMINIMIS LeaveBalance,
//                                                                    0 RefundAmount,
//                                                                    Mem_Salary SalaryRate,
//                                                                    Mem_PayrollType PayrollType,
//                                                                    Mem_BillingSalary BillingRate,
//                                                                    Mem_BillingPayrollType BillingPayrollType,
//                                                                    Mem_TaxSalary TaxRate,
//                                                                    Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
//                                                                    FROM	M_Leave
//                                                                    JOIN	M_Employee ON	LEFT(Mem_WorkStatus, 1) = 'A' 
//                                                            {0}AND  Mem_IsCompanyAnniversary = 1
//                                                                     JOIN	T_EmployeeLeaveMaster ON Elm_EmployeeId = Mem_IDNo
//                                                                  WHERE	Mlv_RecordStatus = 'A'
//                                                                    AND    Mlv_LeaveCode='VL'  
//		                                                            AND Elm_VLBalance > @VLDMINIMIS
//                                                                    ORDER BY 1";

            public const string FetchRecordsForRefund = @"  declare @VLDMINIMIS as decimal(9,2)
                                                            set @VLDMINIMIS = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode ='VLDMINIMIS')
                                                             
                                                            SELECT      Mem_IDNo EmployeeID, 
                                                                        Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                        Mlv_LeaveCode LeaveType, 
                                                                        Mlv_LeaveDescription LeaveDesc,
                                                                              CASE WHEN  Elm_Entitled  - Elm_Used  <= @VLDMINIMIS THEN
                                                                                          'NON-TAXABLE'
                                                                              ELSE 'TAXABLE'
                                                                        END   TaxClass, 
                                                                              Elm_Entitled  - Elm_Used  as LeaveBalance,
                                                                        0.00 RefundAmount,
                                                                        Mem_Salary SalaryRate,
                                                                        Mem_PayrollType PayrollType,
                                                                        Mem_BillingSalary BillingRate,
                                                                        Mem_BillingPayrollType BillingPayrollType,
                                                                        Mem_TaxSalary TaxRate,
                                                                        Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
                                                             FROM T_EmployeeLeave
                                                            INNER JOIN M_Leave on Mlv_LeaveCode = Elm_Leavetype
                                                                        and Mlv_ConvertibleToCash = 1
                                                            INNER JOIN  M_Employee ON     Mem_IDNo = Elm_EmployeeId
                                                                  AND LEFT(Mem_WorkStatus, 1) = 'A' 
                                                            {0}AND  Mem_IsCompanyAnniversary = 1
                                                            WHERE Elm_Entitled  - Elm_Used > 0
                                                            --AND Elm_Entitled  - Elm_Used  <= @VLDMINIMIS 
															  and ltrim(isnull(Ltm_PartOfLeave, '')) = ''

                                                            UNION ALL

                                                            SELECT      Mem_IDNo EmployeeID, 
                                                                        Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                        Mlv_LeaveCode LeaveType, 
                                                                        Mlv_LeaveDescription LeaveDesc,
                                                                              CASE WHEN  Elm_Entitled  - Elm_Used  <= @VLDMINIMIS THEN
                                                                                          'NON-TAXABLE'
                                                                              ELSE 'TAXABLE'
                                                                        END   TaxClass,
                                                                              (Elm_Entitled  - Elm_Used) - @VLDMINIMIS as LeaveBalance,
                                                                        0.00 RefundAmount,
                                                                        Mem_Salary SalaryRate,
                                                                        Mem_PayrollType PayrollType,
                                                                        Mem_BillingSalary BillingRate,
                                                                        Mem_BillingPayrollType BillingPayrollType,
                                                                        Mem_TaxSalary TaxRate,
                                                                        Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
                                                             FROM T_EmployeeLeave
                                                            INNER JOIN M_Leave on Mlv_LeaveCode = Elm_Leavetype
                                                                        and Mlv_ConvertibleToCash = 1
                                                            INNER JOIN  M_Employee ON     Mem_IDNo = Elm_EmployeeId
                                                                  AND LEFT(Mem_WorkStatus, 1) = 'A' 
                                                            {0}AND  Mem_IsCompanyAnniversary = 1
                                                            WHERE Elm_Entitled  - Elm_Used > 0  
                                                                  and Elm_Entitled  - Elm_Used  > @VLDMINIMIS 
															      and ltrim(isnull(Ltm_PartOfLeave, '')) = ''
                                                            ORDER BY 1";

            public const string FetchRecordsForRefund2 = @" 
                                                            DECLARE @LeaveConversionYear as varchar(20)
                                                            SET @LeaveConversionYear = '{2}'

                                                            DECLARE @CurrentPayperiod as varchar(7)
                                                            SET @CurrentPayperiod = (
                                                                    Select Tps_PayCycle From T_PaySchedule
                                                                            Where Tps_CycleIndicator = 'C'
                                                                            And Tps_RecordStatus = 'A')

                                                            declare @VLDMINIMIS as decimal(9,2)
                                                            set @VLDMINIMIS = (select Mph_NumValue from M_PolicyHdr
                                                            where Mph_PolicyCode ='VLDMINIMIS')

                                                            DECLARE @LVHRENTRY as bit
                                                            SET @LVHRENTRY = (SELECT Tsc_SetFlag
				                                                            FROM T_SettingControl
				                                                            WHERE Tsc_SystemCode='LEAVE'
				                                                            and  Tsc_SettingCode='LVHRENTRY')

                                                            DECLARE @MDIVISOR as decimal(9,2)

                                                            SET @MDIVISOR = (SELECT	Mph_NumValue 
                                                                            FROM	M_PolicyHdr 
                                                                            WHERE	Mph_PolicyCode = 'MDIVISOR')
                                                            
						                                    If @CurrentPayperiod = '{1}'
                                                                begin
                                                                    SELECT      Mem_IDNo EmployeeID, 
                                                                                Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                                Mlv_LeaveCode LeaveType, 
                                                                                Mlv_LeaveDescription LeaveDesc

                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Entitled
	                                                                                else
	                                                                                (Elm_Entitled)/8
                                                                                  end) as EntitledLeave
                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Used   
	                                                                                else
	                                                                                (Elm_Used)/8.0
                                                                                  end) as UsedLeave
                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Entitled - Elm_Used - Elm_Reserved   
	                                                                                else
	                                                                                (Elm_Entitled - Elm_Used - Elm_Reserved)/8.0
                                                                                  end) as UnusedLeave
                                                                                , 0.00 as Nontax
                                                                                , 0.00 as Tax
                                                                                , 0.00 as Total

                                                                                ,Mem_Salary SalaryRate,
                                                                                Mem_PayrollType PayrollType,
                                                                                Mem_BillingSalary BillingRate,
                                                                                Mem_BillingPayrollType BillingPayrollType,
                                                                                Mem_TaxSalary TaxRate,
                                                                                Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
                                                                    FROM T_EmployeeLeave
                                                                    INNER JOIN M_Leave on Mlv_LeaveCode = Elm_Leavetype
                                                                                and Mlv_ConvertibleToCash = 1
                                                                    INNER JOIN  M_Employee ON Mem_IDNo = Elm_EmployeeId
                                                                          AND LEFT(Mem_WorkStatus, 1) = 'A' and Mem_WorkStatus not in ('AJ', 'AM')
                                                                    {0}AND  Mem_IsCompanyAnniversary = 1
								                                    LEFT JOIN ( SELECT  Elm_LeaveYear
												                                      , Elm_EmployeeId
												                                      , Elm_Used as Used
											                                    FROM T_EmployeeLeave
											                                    INNER JOIN M_Employee on Mem_IDNo = Elm_Employeeid
												                                    and Left(Mem_WorkStatus, 1) = 'A' and Mem_WorkStatus not in ('AJ', 'AM')
											                                    WHERE Elm_Used  > 0
												                                    And Elm_Leaveyear = @LeaveConversionYear
												                                    And Elm_Leavetype = 'GL') GLUsed on GLUsed.Elm_Employeeid =  T_EmployeeLeave.Elm_Employeeid
																		                                    and GLUsed.Elm_Leaveyear =  T_EmployeeLeave.Elm_Leaveyear
                                                                    WHERE Elm_Entitled  - Elm_Used > 0
                                                                          --AND Elm_Entitled  - Elm_Used  >= @VLDMINIMIS
															              and ltrim(isnull(Ltm_PartOfLeave, '')) = ''
								                                          And T_EmployeeLeave.Elm_Leaveyear = @LeaveConversionYear 
                                                                end
						                                    else
                                                                begin
                                                                    SELECT      M_EmployeeHst.Mem_IDNo EmployeeID, 
                                                                                M_Employee.Mem_FirstName + ' ' + M_Employee.Mem_LastName EmployeeName, 
                                                                                Mlv_LeaveCode LeaveType, 
                                                                                Mlv_LeaveDescription LeaveDesc

                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Entitled
	                                                                                else
	                                                                                (Elm_Entitled)/8
                                                                                  end) as EntitledLeave
                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Used   
	                                                                                else
	                                                                                (Elm_Used)/8.0
                                                                                  end) as UsedLeave
                                                                                , Convert(decimal(18,2),case when @LVHRENTRY = 1 then Elm_Entitled - Elm_Used - Elm_Reserved   
	                                                                                else
	                                                                                (Elm_Entitled - Elm_Used - Elm_Reserved)/8.0
                                                                                  end) as UnusedLeave
                                                                                , 0.00 as Nontax
                                                                                , 0.00 as Tax
                                                                                , 0.00 as Total

                                                                                ,M_EmployeeHst.Mem_Salary SalaryRate,
                                                                                M_EmployeeHst.Mem_PayrollType PayrollType,
                                                                                M_EmployeeHst.Mem_BillingSalary BillingRate,
                                                                                M_EmployeeHst.Mem_BillingPayrollType BillingPayrollType,
                                                                                M_EmployeeHst.Mem_TaxSalary TaxRate,
                                                                                M_EmployeeHst.Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
                                                                    FROM T_EmployeeLeave
                                                                    INNER JOIN M_Leave on Mlv_LeaveCode = Elm_Leavetype
                                                                                and Mlv_ConvertibleToCash = 1
                                                                    INNER JOIN  M_EmployeeHst ON M_EmployeeHst.Mem_IDNo = Elm_EmployeeId
                                                                          AND LEFT(M_EmployeeHst.Mem_WorkStatus, 1) = 'A' and M_EmployeeHst.Mem_WorkStatus not in ('AJ', 'AM')
                                                                          AND M_EmployeeHst.Mem_PayCycle = '{1}'
								                                    LEFT JOIN ( SELECT  Elm_LeaveYear
												                                      , Elm_EmployeeId
												                                      , Elm_Used as Used
											                                    FROM T_EmployeeLeave
											                                    INNER JOIN M_EmployeeHst on Mem_IDNo = Elm_Employeeid
												                                    and Left(Mem_WorkStatus, 1) = 'A' and Mem_WorkStatus not in ('AJ', 'AM')
												                                    and Mem_PayCycle = '{1}'
											                                    WHERE Elm_Used  > 0
												                                    And Elm_Leaveyear = @LeaveConversionYear
												                                    And Elm_Leavetype = 'GL') GLUsed on GLUsed.Elm_Employeeid =  T_EmployeeLeave.Elm_Employeeid
																			                                    and GLUsed.Elm_Leaveyear =  T_EmployeeLeave.Elm_Leaveyear
                                                                    INNER JOIN  M_Employee ON M_Employee.Mem_IDNo = T_EmployeeLeave.Elm_EmployeeId
                                                                    WHERE Elm_Entitled  - Elm_Used > 0
                                                                          --AND Elm_Entitled  - Elm_Used  >= @VLDMINIMIS
															              and ltrim(isnull(Ltm_PartOfLeave, '')) = ''
								                                          And T_EmployeeLeave.Elm_Leaveyear = @LeaveConversionYear 
                                                                end";
            //end
            public const string checkPayRates = @"declare @DMaxRate decimal set @DMaxRate = (select Mph_NumValue 
											                                                from M_PolicyHdr
											                                                where Mph_PolicyCode='DMAXRATE'
											                                                and Mph_RecordStatus='A')
                                                    --Employee's Rate <= 0
                                                     SELECT Count(Isnull(Mem_IDNo,0)) as Cnt
                                                     FROM M_Employee 
                                                     INNER JOIN T_EmpPayTranHdr on Tph_IDNo = Mem_IDNo
                                                    WHERE CASE '{0}' 
                                                           WHEN 'B' then Mem_Salary
                                                           WHEN 'T' THEN Mem_TaxSalary
                                                           WHEN 'C' THEN Mem_BillingSalary
                                                           ELSE 0 END <= 0
                                                     UNION
                                                    --Employee's Rate  > Daily-Paid maximum rate AND Payroll Type = Daily
                                                     SELECT Count(Isnull(Mem_IDNo,0)) as Cnt
                                                     FROM M_Employee 
                                                     INNER JOIN T_EmpPayTranHdr on Tph_IDNo = Mem_IDNo
                                                     WHERE CASE '{0}' 
                                                           WHEN 'B' THEN Mem_Salary
                                                           WHEN 'T' THEN Mem_TaxSalary
                                                           WHEN 'C' THEN Mem_BillingSalary
                                                           ELSE 0 END > @DMaxRate 
                                                     AND CASE '{0}' 
                                                           WHEN 'B' THEN Mem_PayrollType
                                                           WHEN 'T' THEN Mem_TaxPayrollType
                                                           WHEN 'C' THEN Mem_BillingPayrollType
                                                           ELSE '' END  = 'D'
                                                     UNION
                                                     --  Employee's Rate <  Daily-Paid maximum rate AND  Payroll Type = Monthly
                                                     SELECT Count(Isnull(Mem_IDNo,0)) as Cnt
                                                     FROM M_Employee 
                                                     INNER JOIN T_EmpPayTranHdr on Tph_IDNo = Mem_IDNo
                                                     WHERE CASE '{0}' 
                                                           WHEN 'B' THEN Mem_Salary
                                                           WHEN 'T' THEN Mem_TaxSalary
                                                           WHEN 'C' THEN Mem_BillingSalary
                                                           ELSE 0 END < @DMaxRate 
                                                     AND CASE '{0}' 
                                                           WHEN 'B' THEN Mem_PayrollType
                                                           WHEN 'T' THEN Mem_TaxPayrollType
                                                           WHEN 'C' THEN Mem_BillingPayrollType
                                                           ELSE '' END  = 'M'
                                                     SELECT COUNT(Tbn_IDNo) FROM dbo.T_EmpBonus WHERE Tbn_PayCycle = @CurPayPeriod";


            #endregion
            #region [For Bonus Calculation]
            public const string fetchEmpBonusRegAndAdjOrOT = @"SELECT	SUM(Tpy_REGAmt) FROM {0}
                                                                WHERE	Tpy_IDNo = @EmployeeID
                                                                AND		Tpy_PayCycle = @PayPeriod

                                                                SELECT	SUM(Tsa_REGHr * Tsa_HourRate) 
                                                                FROM	T_EmpSystemAdj
                                                                WHERE	Tsa_IDNo = @EmployeeID
                                                                AND		Tsa_Date
                                                                BETWEEN	@StartDate
                                                                AND		@EndDate

                                                                SELECT	Sum(Tpy_REGAmt + Tpy_REGOTAmt + 
	                                                                    Tpy_REGNDAmt + Tpy_REGNDOTAmt + 
	                                                                    Tpy_RESTAmt + Tpy_RESTOTAmt + 
	                                                                    Tpy_RESTNDAmt + Tpy_RESTNDOTAmt + 
	                                                                    Tpy_LEGHOLAmt + Tpy_LEGHOLOTAmt + 
	                                                                    Tpy_LEGHOLNDAmt + Tpy_LEGHOLNDOTAmt + 
	                                                                    Tpy_SPLHOLAmt + Tpy_SPLHOLOTAmt + 
	                                                                    Tpy_SPLHOLNDAmt + Tpy_SPLHOLNDOTAmt + 
	                                                                    Tpy_PSDAmt + Tpy_PSDOTAmt + 
	                                                                    Tpy_PSDNDAmt + Tpy_PSDNDOTAmt +
	                                                                    Tpy_COHOLAmt + Tpy_COHOLOTAmt + 
	                                                                    Tpy_COHOLNDAmt + Tpy_COHOLNDOTAmt + 
	                                                                    Tpy_RESTLEGHOLAmt + Tpy_RESTLEGHOLOTAmt + 
	                                                                    Tpy_RESTLEGHOLNDAmt + Tpy_RESTLEGHOLNDOTAmt + 
	                                                                    Tpy_RESTSPLHOLAmt + Tpy_RESTSPLHOLOTAmt + 
	                                                                    Tpy_RESTSPLHOLNDAmt + Tpy_RESTSPLHOLNDOTAmt + 
	                                                                    Tpy_RESTCOHOLAmt + Tpy_RESTCOHOLOTAmt + 
	                                                                    Tpy_RESTCOHOLNDAmt + Tpy_RESTCOHOLNDOTAmt + 
	                                                                    Tpy_RESTPSDAmt + Tpy_RESTPSDOTAmt + 
	                                                                    Tpy_RESTPSDNDAmt + Tpy_RESTPSDNDOTAmt +
	                                                                    Tpy_TotalAdjAmt) FROM {0}
                                                                WHERE	Tpy_IDNo = @EmployeeID
                                                                AND		Tpy_PayCycle = @PayPeriod";

            // Clark/13thMonth START
            public const string insertEmployee13thMonthBonus = @"
                                                        --Retrieve CostcenterCode
                                                        DECLARE @EmployeeCostcenter as varchar(12)
                                                        SELECT  @EmployeeCostcenter = Mem_CostcenterCode
                                                        FROM     M_Employee
                                                        WHERE    Mem_IDNo = @EmployeeId

                                                        --Insert bonus
                                                        INSERT INTO [T_EmpBonus]
                                                                   ([Tbn_PayCycle]
                                                                   ,[Tbn_IDNo]
                                                                   ,[Ebn_SalaryRate]
                                                                   ,[Ebn_PayrollType]
                                                                   ,[Ebn_RegularAmt]
                                                                   ,[Ebn_AdjustmentAmt]
                                                                   ,[Tbn_TotalBonusAmt]
                                                                   ,[usr_login]
                                                                   ,[ludatetime]
                                                                   ,[Ebn_Costcenter]
                                                                   ,[Tbn_AccumBonusBeforeThisCycle]
                                                                   ,[Tbn_BonusNontaxableAmt]
                                                                   ,[Tbn_BonusTaxableAmt]
                                                                   ,[Ebn_Post])
                                                             VALUES(@PayPeriod
                                                                   ,@EmployeeId
                                                                   ,@SalaryRate
                                                                   ,@PayrollType
                                                                   ,@Ebn_RegularAmt
                                                                   ,@Ebn_AdjustmentAmt
                                                                   ,@Amount
                                                                   ,@UserLogin
                                                                   ,GetDate()
                                                                   ,@EmployeeCostcenter
                                                                   ,@Tbn_AccumBonusBeforeThisCycle
                                                                   ,@Tbn_BonusNontaxableAmt
                                                                   ,@Tbn_BonusTaxableAmt
                                                                   ,'False')

                                                        --Delete allowances
                                                        DELETE FROM [T_EmpIncome]
                                                        WHERE Tin_PayCycle = @PayPeriod
                                                        AND   Tin_IDNo = @EmployeeId

                                                        --Insert Non-Taxable Allowance
                                                        IF @Tbn_BonusNontaxableAmt > 0.0
                                                        INSERT INTO [T_EmpIncome]
                                                                   ([Tin_IDNo]
                                                                   ,[Tin_PayCycle]
                                                                   ,[Tin_IncomeCode]
                                                                   ,[Tin_PostFlag]
                                                                   ,[Tin_IncomeAmt]
                                                                   ,[Usr_Login]
                                                                   ,[Ludatetime])
                                                             VALUES (@EmployeeId
                                                                   ,@PayPeriod
                                                                   ,'13MONONTAX'
                                                                   ,'False'
                                                                   ,@Tbn_BonusNontaxableAmt
                                                                   ,@UserLogin
                                                                   ,GetDate())
                                                        
                                                        --Insert Taxable Allowance
                                                        IF @Tbn_BonusTaxableAmt > 0.0
                                                        INSERT INTO [T_EmpIncome]
                                                                   ([Tin_IDNo]
                                                                   ,[Tin_PayCycle]
                                                                   ,[Tin_IncomeCode]
                                                                   ,[Tin_PostFlag]
                                                                   ,[Tin_IncomeAmt]
                                                                   ,[Usr_Login]
                                                                   ,[Ludatetime])
                                                             VALUES (@EmployeeId
                                                                   ,@PayPeriod
                                                                   ,'13MOTAX'
                                                                   ,'False'
                                                                   ,@Tbn_BonusTaxableAmt
                                                                   ,@UserLogin
                                                                   ,GetDate())

                                                        --Update Post Flag for Bonus
                                                            UPDATE [T_EmpBonus]
                                                               SET [Ebn_Post] = 'True'
                                                             WHERE [Tbn_PayCycle] = @PayPeriod
                                                               AND [Tbn_IDNo] = @EmployeeId";
            // Clark/13thMonth END

            public const string insertEmployeeBonus = @"DELETE FROM dbo.T_EmpBonus WHERE Tbn_PayCycle = @PayPeriod AND Tbn_IDNo = @EmployeeId
                                                                        DECLARE @COSTCENTER AS CHAR(12) SET @COSTCENTER = (SELECT Mem_CostcenterCode FROM M_Employee WHERE Mem_IDNo = @EmployeeID)
                                                                        INSERT INTO [T_EmpBonus]
                                                                        VALUES(@PayPeriod
                                                                        ,@EmployeeId
                                                                        ,@SalaryRate
                                                                        ,@PayrollType
                                                                        ,0
                                                                        ,0
                                                                        ,@Amount
                                                                        ,0
                                                                        ,0
                                                                        ,0
                                                                        ,0
                                                                        ,@UserLogin
                                                                        ,GetDate(),@COSTCENTER)";

            public const string insertEmployeeBonusSep = @"DELETE FROM dbo.T_EmpBonusFinalPay WHERE Tbn_IDNo = @EmployeeId
                                                                        DECLARE @COSTCENTER AS CHAR(12) SET @COSTCENTER = (SELECT Mem_CostcenterCode FROM M_Employee WHERE Mem_IDNo = @EmployeeID)
                                                                        INSERT INTO [T_EmpBonusFinalPay]
                                                                        VALUES(@PayPeriod
                                                                        ,@EmployeeId
                                                                        ,@SalaryRate
                                                                        ,@PayrollType
                                                                        ,0
                                                                        ,0
                                                                        ,@Amount
                                                                        ,0
                                                                        ,0
                                                                        ,0
                                                                        ,0
                                                                        ,@UserLogin
                                                                        ,GetDate(),@COSTCENTER)";

            public const string insertEmployeePayrollCalcSpecial = @"DELETE FROM T_EmpPayrollSpecial 
                                                                    WHERE Tpy_IDNo = @EmployeeId 
                                                                    AND Tpy_PayCycle = @PayPeriod

                                                                    INSERT INTO T_EmpPayrollSpecial
                                                                    SELECT  DISTINCT @EmployeeId,
                                                                    @PayPeriod,
                                                                    @SalaryRate,
                                                                    @HourlyRate,    
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    0,0,0,0,0,0,0,0,0,0,
                                                                    @Tax,@NTax,@Tax,
                                                                    0,0,0,0,0,0,0,0,0,0,0,
                                                                    M_Employee.Mem_CostcenterCode,
                                                                    M_Employee.Mem_JobTitleCode,
                                                                    M_Employee.Mem_EmploymentStatusCode,
                                                                    M_Employee.Mem_PayrollType,
                                                                    M_Employee.Mem_PaymentMode,
                                                                    M_Employee.Emt_BankCode,
                                                                    M_Employee.Emt_BankAccountNo,
                                                                    M_Employee.Mem_TaxCode,
                                                                    M_Employee.Mem_CalendarType,
                                                                    M_Employee.Mem_CalendarGroup,
                                                                    M_Employee.Mem_PagIbigRule,
                                                                    M_Employee.Mem_PagIbigShare,
                                                                    M_Employee.Mem_SSSRule,
                                                                    M_Employee.Mem_SSSShare,
                                                                    M_Employee.Mem_PHRule,
                                                                    M_Employee.Mem_PHShare,
                                                                    0,0,0,0,0,0,0,0,0,0,0,0,0,0,
                                                                    M_Employee.Mem_IsConfidential,
                                                                    0,0,@UserLogin,GETDATE()
                                                                    FROM M_Employee 
                                                                    WHERE Mem_IDNo = @EmployeeId";
            public const string insertEmpDeductionDetailSpecial = @"SELECT T_EmpDeductionHdr.Tdh_IDNo
                                                                         , T_EmpDeductionHdr.Tdh_DeductionCode
                                                                         , T_EmpDeductionHdr.Tdh_StartDate
                                                                         ,  @PayPeriod
                                                                         ,  @PayPeriod
                                                                         , '00' as Tdd_LineNo
                                                                         , 'P' as Tdd_PaymentType
                                                                         , Tdh_DeductionAmount - (Tdh_DeferredAmount + Tdh_PaidAmount) as Tdd_Amount
                                                                         , 0 as Tdd_DeferredFlag
                                                                         , 0 as Tdd_PaymentFlag
                                                                         , @UserLogin
                                                                         , GETDATE()
                                                                    FROM T_EmpDeductionHdr
                                                                    WHERE T_EmpDeductionHdr.Tdh_IDNo  = @EmployeeID
                                                                    AND Tdh_DeferredAmount + Tdh_PaidAmount < Tdh_DeductionAmount
                                                                    AND Tdh_CycleAmount > 0
                                                                    AND Tdh_DeductionCode = 'BONUSDEDN'";
            public const string updateBonusAmount = @"UPDATE T_EmpBonus
                                                                    SET  Tbn_AccumBonusBeforeThisCycle = isnull((Select Sum(Tin_IncomeAmt)
						                                                                    From T_EmpIncomeHst
						                                                                    Where Left(Tin_PayCycle,4) = '{0}' -- payperiod year
							                                                                    and  Tin_IncomeCode ='13MONONTAX'
							                                                                    and Tin_PostFlag = 1
							                                                                    and Tin_IDNo = Tbn_IDNo), 0)
                                                                    FROM T_EmpBonus 
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'

                                                                    UPDATE T_EmpBonus
                                                                    SET Tbn_BonusNontaxableAmt = Case When {3} - Tbn_AccumBonusBeforeThisCycle > 0  then
						                                                                    Case When Tbn_TotalBonusAmt > {3} - Tbn_AccumBonusBeforeThisCycle  then
							                                                                        {3} - Tbn_AccumBonusBeforeThisCycle 
						                                                                    Else    Tbn_TotalBonusAmt
					                                                                        End
				                                                                        Else
						                                                                    0
					                                                                    End 
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'

                                                                    UPDATE T_EmpBonus
                                                                    SET Tbn_BonusTaxableAmt = Tbn_TotalBonusAmt - Tbn_BonusNontaxableAmt
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'";
            public const string updateBonusSepAmount = @"UPDATE T_EmpBonusFinalPay
                                                                    SET  Tbn_AccumBonusBeforeThisCycle = isnull((Select Sum(Tin_IncomeAmt)
						                                                                    From T_EmpIncomeHst
						                                                                    Where Left(Tin_PayCycle,4) = '{0}' -- payperiod year
							                                                                    and  Tin_IncomeCode ='13MONONTAX'
							                                                                    and Tin_PostFlag = 1
							                                                                    and Tin_IDNo = Tbn_IDNo), 0)
                                                                    FROM T_EmpBonusFinalPay 
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'

                                                                    UPDATE T_EmpBonusFinalPay
                                                                    SET Tbn_BonusNontaxableAmt = Case When {3} - Tbn_AccumBonusBeforeThisCycle > 0  then
						                                                                    Case When Tbn_TotalBonusAmt > {3} - Tbn_AccumBonusBeforeThisCycle  then
							                                                                        {3} - Tbn_AccumBonusBeforeThisCycle 
						                                                                    Else    Tbn_TotalBonusAmt
					                                                                        End
				                                                                        Else
						                                                                    0
					                                                                    End 
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'

                                                                    UPDATE T_EmpBonusFinalPay
                                                                    SET Tbn_BonusTaxableAmt = Tbn_TotalBonusAmt - Tbn_BonusNontaxableAmt
                                                                    WHERE Tbn_PayCycle = '{1}'--@PayPeriod
                                                                    and Tbn_IDNo = '{2}'";

            #endregion
            #region [For Clearance Computation]
            public const string insertPayrollSeparation = @"INSERT INTO T_EmpPayTranHdrFinalPay(Tph_IDNo
                                                       ,Tph_PayCycleh
                                                       ,Tph_ABSHr
                                                       ,Tph_REGHr
                                                       ,Tph_REGOTHr
                                                       ,Tph_REGNDHr
                                                       ,Tph_REGNDOTHr
                                                       ,Tph_RESTHr
                                                       ,Tph_RESTOTHr
                                                       ,Tph_RESTNDHr
                                                       ,Tph_RESTNDOTHr
                                                       ,Tph_LEGHOLHr
                                                       ,Tph_LEGHOLOTHr
                                                       ,Tph_LEGHOLNDHr
                                                       ,Tph_LEGHOLNDOTHr
                                                       ,Tph_SPLHOLHr
                                                       ,Tph_SPLHOLOTHr
                                                       ,Tph_SPLHOLNDHr
                                                       ,Tph_SPLHOLNDOTHr
                                                       ,Tph_PSDHr
                                                       ,Tph_PSDOTHr
                                                       ,Tph_PSDNDHr
                                                       ,Tph_PSDNDOTHr
                                                       ,Tph_COHOLHr
                                                       ,Tph_COHOLOTHr
                                                       ,Tph_COHOLNDHr
                                                       ,Tph_COHOLNDOTHr
                                                       ,Tph_RESTLEGHOLHr
                                                       ,Tph_RESTLEGHOLOTHr
                                                       ,Tpd_RESTLEGHOLNDHr
                                                       ,Tpd_RESTLEGHOLNDOTHr
                                                       ,Tph_RESTSPLHOLHr
                                                       ,Tph_RESTSPLHOLOTHr
                                                       ,Tph_RESTSPLHOLNDHr
                                                       ,Tph_RESTSPLHOLNDOTHr
                                                       ,Tph_RESTCOHOLHr
                                                       ,Tph_RESTCOHOLOTHr
                                                       ,Tph_RESTCOHOLNDHr
                                                       ,Tph_RESTCOHOLNDOTHr
                                                       ,Tph_TotalAdjAmt
                                                       ,Tph_TaxableAdjAmt
                                                       ,Tph_NontaxableAdjAmt
                                                       ,Tph_TaxableIncomeAmt
                                                       ,Tph_NontaxableIncomeAmt
                                                       ,Tph_RESTLEGHOLDay
                                                       ,Tph_WorkDay
                                                       ,Tph_PayrollType
                                                       ,Tph_RESTPSDHr
                                                       ,Tph_RESTPSDOTHr
                                                       ,Tph_RESTPSDNDHr
                                                       ,Tph_RESTPSDNDOTHr
                                                       ,Tph_LTHr
                                                       ,Tph_UTHr
                                                       ,Tph_WDABSHr
                                                       ,Tph_LTUTMaxHr
                                                       ,Tph_UnpaidLVHr
                                                       ,Tph_ABSLEGHOLHr
                                                       ,Tph_ABSSPLHOLHr
                                                       ,Tph_ABSCOHOLHr
                                                       ,Tph_ABSPSDHr
                                                       ,Tph_ABSOTHHOLHr
                                                       ,Tph_PaidLVHr
                                                       ,Tph_PaidLEGHOLHr
                                                       ,Tph_PaidSPLHOLHr
                                                       ,Tph_PaidCOHOLHr
                                                       ,Tph_PaidOTHHOLHr
                                                       ,Tph_OTAdjAmt
                                                       ,Tph_RetainUserEntry
                                                       ,Usr_Login
                                                       ,Ludatetime)
                                                 VALUES
                                                       (@EmployeeId
                                                       ,@PayPeriod
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,0
                                                       ,0
                                                       ,@PayType
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,'0.00'
                                                       ,0
                                                       ,@UserLogin
                                                       ,GetDate())";
            public const string insertDeductionDetailSep = @"INSERT INTO T_EmpDeductionDtlFinalPay
                                                            ( [Tdd_IDNo]
                                                               ,[Tdd_DeductionCode]
                                                               ,[Tdd_StartDate]
                                                               ,[Tdd_ThisPayCycle]
                                                               ,[Tdd_PayCycle]
                                                               ,[Tdd_LineNo]
                                                               ,[Tdd_PaymentType]
                                                               ,[Tdd_Amount]
                                                               ,[Tdd_DeferredFlag]
                                                               ,[Tdd_PaymentFlag]
                                                               ,[Usr_Login]
                                                               ,[Ludatetime])
                                                            -- For Deffered Cycles
                                                            SELECT    T_EmpDeductionDefer.Tdd_IDNo
                                                              , T_EmpDeductionDefer.Tdd_DeductionCode
                                                              , T_EmpDeductionDefer.Tdd_StartDate
                                                                 , @PayPeriod as Tdd_ThisPayCycle
                                                              , T_EmpDeductionDefer.Tdd_PayCycle   as Tdd_PayCycle
                                                              , T_EmpDeductionDefer.Tdd_LineNo   as Tdd_LineNo
                                                              , 'P' as Tdd_PaymentType
                                                              , T_EmpDeductionDefer.Tdd_DeferredAmt as Tdd_Amount
                                                              , 1 as  Tdd_DeferredFlag
                                                              , 0 as Tdd_PaymentFlag
                                                                 , @UserLogin
                                                                 , GetDate()
                                                            FROM T_EmpDeductionHdr
                                                            INNER JOIN T_EmpDeductionDefer on T_EmpDeductionDefer.Tdd_IDNo = T_EmpDeductionHdr.Tdh_IDNo
                                                                AND T_EmpDeductionDefer.Tdd_DeductionCode = T_EmpDeductionHdr.Tdh_DeductionCode 
                                                                AND T_EmpDeductionDefer.Tdd_StartDate = T_EmpDeductionHdr.Tdh_StartDate 
                                                            Inner Join M_Deduction on Mdn_DeductionCode = Tdh_DeductionCode
                                                              and Mdn_DeductionGroup LIKE 'C%'
                                                            WHERE T_EmpDeductionHdr.Tdh_IDNo = @EmployeeID 

                                                            UNION
                                                            -- For Current Cycles
                                                            SELECT T_EmpDeductionHdr.Tdh_IDNo
                                                             , T_EmpDeductionHdr.Tdh_DeductionCode
                                                             , T_EmpDeductionHdr.Tdh_StartDate
                                                             , @PayPeriod as Tdd_ThisPayCycle
                                                             , @PayPeriod as Tdd_PayCycle
                                                             , '00' as Tdd_LineNo
                                                             , 'P' as Tdd_PaymentType
                                                             , Tdh_DeductionAmount - (Tdh_DeferredAmount + Tdh_PaidAmount) as Tdd_Amount
                                                                , 0 as Tdd_DeferredFlag
                                                                , 0 as Tdd_PaymentFlag
                                                                , @UserLogin
                                                                , GetDate()
                                                            FROM T_EmpDeductionHdr
                                                            Inner Join M_Deduction on Mdn_DeductionCode = Tdh_DeductionCode
                                                              and Mdn_DeductionGroup LIKE 'C%'
                                                            WHERE T_EmpDeductionHdr.Tdh_IDNo = @EmployeeID
                                                                AND Tdh_DeferredAmount + Tdh_PaidAmount < Tdh_DeductionAmount
                                                                AND Tdh_CycleAmount > 0";

            public const string checkClearanceData0 = @"SELECT Tps_PayCycle FROM T_PaySchedule WHERE Tps_CycleIndicator = 'C'";
            public const string checkClearanceData1 = @"SELECT * FROM M_Employee WHERE Mem_IDNo = @EmployeeID";
            public const string checkClearanceData2 = @"SELECT DISTINCT LEFT(Tlr_PayCycle,4) FROM T_EmpLeaveConversion WHERE Tlr_IDNo = @EmployeeID";

            public const string checkClearanceData3 = @"declare @VLDMINIMIS as decimal(9,2)
                                                        set @VLDMINIMIS = (select Mph_NumValue from M_PolicyHdr
                                                        where Mph_PolicyCode ='VLDMINIMIS')

                                                        SELECT	DISTINCT
                                                                Mem_IDNo EmployeeID, 
                                                                Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                Mlv_LeaveCode LeaveType, 
                                                                Mlv_LeaveDescription LeaveDesc,
                                                                CASE WHEN Mlv_LeaveCode = 'VL' THEN 'NON-TAXABLE'
                                                                ELSE 'TAXABLE'
                                                                END	 TaxClass,
                                                                CASE Mlv_LeaveCode
                                                                WHEN 'VL' THEN 
                                                                        CASE WHEN Elm_VLBalance <= @VLDMINIMIS THEN
                                                                                Elm_VLBalance
                                                                        ELSE	
                                                                                @VLDMINIMIS
                                                                        END
                                                                WHEN 'SL' THEN Elm_SLBalance
                                                                WHEN 'PL' THEN Elm_SLBalance 
                                                                WHEN 'BL' THEN Elm_SLBalance
                                                                WHEN 'DL' THEN Elm_SLBalance
                                                                ELSE  0   END LeaveBalance,
                                                        0 RefundAmount,
                                                        Mem_Salary,
                                                        Mem_PayrollType,
                                                        Mem_BillingSalary,
                                                        Mem_BillingPayrollType,
                                                        Mem_TaxSalary,
                                                        Mem_TaxPayrollType, 1 IncludeFlag
                                                        FROM	M_Leave
                                                        JOIN	M_Employee ON	Mem_IDNo = @EmployeeID
                                                        JOIN	T_EmployeeLeaveMaster ON Elm_EmployeeId = Mem_IDNo
                                                        WHERE	Mlv_ConvertibleToCash = 1
                                                        AND		Mlv_RecordStatus = 'A'
                                                        AND     (CASE Mlv_LeaveCode
                                                                WHEN 'VL' THEN Elm_VLBalance
                                                                WHEN 'SL' THEN Elm_SLBalance
                                                                WHEN 'PL' THEN Elm_SLBalance
                                                                WHEN 'BL' THEN Elm_SLBalance
                                                                WHEN 'DL' THEN Elm_SLBalance
                                                                ELSE  0 END) > 0

                                                UNION ALL

                                                SELECT	DISTINCT
                                                                Mem_IDNo EmployeeID, 
                                                                Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                Mlv_LeaveCode LeaveType, 
                                                                Mlv_LeaveDescription LeaveDesc,
                                                                'TAXABLE' TaxClass,
                                                                Elm_VLBalance - @VLDMINIMIS LeaveBalance,
                                                        0 RefundAmount,
                                                        Mem_Salary SalaryRate,
                                                        Mem_PayrollType PayrollType,
                                                        Mem_BillingSalary BillingRate,
                                                        Mem_BillingPayrollType BillingPayrollType,
                                                        Mem_TaxSalary TaxRate,
                                                        Mem_TaxPayrollType TaxRatePayrollType, 1 IncludeFlag
                                                        FROM	M_Leave
                                                        JOIN	M_Employee ON	Mem_IDNo = @EmployeeID
                                                         JOIN	T_EmployeeLeaveMaster ON Elm_EmployeeId = Mem_IDNo
                                                      WHERE	Mlv_RecordStatus = 'A'
                                                        AND    Mlv_LeaveCode='VL'  
                                                        AND Elm_VLBalance > @VLDMINIMIS
                                                        ORDER BY 1";

            public const string checkClearanceData4 = @"SELECT	Ccd_Bonus FROM	M_Company";

            public const string checkClearanceData5 = @"SELECT DISTINCT LEFT(Tbn_PayCycle, 4) FROM	T_EmpBonus WHERE Tbn_PayCycle = @PayPeriod AND Tbn_IDNo = @EmployeeId";

            public const string checkClearanceData6 = @"SELECT	Mem_IDNo EmployeeID, 
                                                                Mem_FirstName + ' ' + Mem_LastName EmployeeName, 
                                                                0 RefundAmount,
                                                                Mem_Salary,
                                                                Mem_PayrollType,
                                                                Mem_BillingSalary,
                                                                Mem_BillingPayrollType,
                                                                Mem_TaxSalary,
                                                                Mem_TaxPayrollType, Mem_CostcenterCode
                                                        FROM	M_Employee
                                                        WHERE	Mem_IDNo = @EmployeeID
                                                        ORDER BY 1  ";
            #endregion
            #region [For Labor Cost]
            public const string insertDeleteHdrDtlLaborCost = @"INSERT INTO T_EmpCostHst 
                                                    (Tec_IDNo
							                         ,Tec_PayCycle
							                         ,Tec_PayrollCode
							                         ,Tec_CostcenterCode
							                         ,Tec_ProrationRate
							                         ,Tec_SIncomeAmt
							                         ,Tec_MIncomeAmt
							                         ,Tec_SDeductionAmt
							                         ,Tec_MDeductionAmt
							                         ,Tec_TotalAmt
							                         ,Tec_EntrySetGroup
							                         ,Tec_PayrollBankCode
							                         ,Tec_ExpenseGroup
							                         ,Usr_Login
							                         ,Ludatetime)
                                                    SELECT A.Tec_IDNo
                                                    ,A.Tec_PayCycle
                                                    ,A.Tec_PayrollCode
                                                    ,A.Tec_CostcenterCode
                                                    ,A.Tec_ProrationRate
                                                    ,A.Tec_SIncomeAmt
                                                    ,A.Tec_MIncomeAmt
                                                    ,A.Tec_SDeductionAmt
                                                    ,A.Tec_MDeductionAmt
                                                    ,A.Tec_TotalAmt
                                                    ,A.Tec_EntrySetGroup
                                                    ,A.Tec_PayrollBankCode
                                                    ,A.Tec_ExpenseGroup
                                                    ,A.Usr_Login
                                                    ,A.Ludatetime
                                                    FROM T_EmpCost A
                                                    LEFT JOIN T_EmpCostHst B 
                                                        ON A.Tec_IDNo = B.Tec_IDNo
														AND A.Tec_PayCycle = B.Tec_PayCycle
														AND A.Tec_PayrollCode = B.Tec_PayrollCode
														AND A.Tec_CostcenterCode = B.Tec_CostcenterCode
                                                    WHERE A.Tec_PayCycle = @CURPAYPERIOD
                                                        AND B.Tec_IDNo IS NULL

                                                    DELETE FROM T_EmpCost
                                                    WHERE Tec_PayCycle = @CURPAYPERIOD

                                                    INSERT INTO T_EmpCostHoursHst 
                                                    (Teh_IDNo
                                                    ,Teh_PayCycle
                                                    ,Teh_CostcenterCode
                                                    ,Teh_Hours
                                                    ,Teh_ProrationRate
                                                    ,Usr_Login
                                                    ,Ludatetime)
                                                    SELECT 
                                                    A.Teh_IDNo
                                                    ,A.Teh_PayCycle
                                                    ,A.Teh_CostcenterCode
                                                    ,A.Teh_Hours
                                                    ,A.Teh_ProrationRate
                                                    ,A.Usr_Login
                                                    ,A.Ludatetime
                                                    FROM T_EmpCostHours A
                                                    LEFT JOIN T_EmpCostHoursHst B 
                                                        ON A.Teh_IDNo = B.Teh_IDNo
                                                        AND A.Teh_PayCycle = B.Teh_PayCycle
                                                        AND A.Teh_CostcenterCode = B.Teh_CostcenterCode
                                                    WHERE A.Teh_PayCycle = @CURPAYPERIOD
                                                        AND B.Teh_IDNo IS NULL

                                                    DELETE FROM T_EmpCostHours
                                                    WHERE Teh_PayCycle = @CURPAYPERIOD

                                                    INSERT INTO T_CostDtlHst 
                                                    (Tcd_ControlNo
						                             ,Tcd_LineNo
						                             ,Tcd_AccountCode
						                             ,Tcd_AccountNature
						                             ,Tcd_SubsidiaryCode
						                             ,Tcd_SubsidiaryItemCode
						                             ,Tcd_Amt
						                             ,Tcd_BaseAmt
						                             ,Tcd_ReportAmt
						                             ,Tcd_ForexDate
						                             ,Tcd_ForexBaseRate
						                             ,Tcd_ForexReportRate
						                             ,Tcd_Explanation
						                             ,Usr_Login
						                             ,Ludatetime)
						                              SELECT Tcd_ControlNo
						                                                    ,Tcd_LineNo
						                                                    ,Tcd_AccountCode
						                                                    ,Tcd_AccountNature
						                                                    ,Tcd_SubsidiaryCode
						                                                    ,Tcd_SubsidiaryItemCode
						                                                    ,Tcd_Amt
						                                                    ,Tcd_BaseAmt
						                                                    ,Tcd_ReportAmt
						                                                    ,Tcd_ForexDate
						                                                    ,Tcd_ForexBaseRate
						                                                    ,Tcd_ForexReportRate
						                                                    ,Tcd_Explanation
						                                                    ,A.Usr_Login
						                                                    ,A.Ludatetime
						                                                    FROM T_CostDtl A
		                                                                    INNER JOIN T_CostHdr B
		                                                                    ON B.Tch_ControlNo = A.Tcd_ControlNo 
			                                                                    AND B.Tch_PayCycle = @CURPAYPERIOD
        
                                                    INSERT INTO T_CostHdrHst (Tch_ControlNo
							                                                    ,Tch_BankCode
							                                                    ,Tch_EntrySetCode
							                                                    ,Tch_EntrySetGroup
							                                                    ,Tch_PayCycle
							                                                    ,Tch_PostDate
                                                                                ,Tch_PostFlag
							                                                    ,Tch_PayrollPeriod
							                                                    ,Tch_RecordStatus
							                                                    ,Usr_Login
							                                                    ,Ludatetime)
						                                                    SELECT Tch_ControlNo
							                                                    ,Tch_BankCode
							                                                    ,Tch_EntrySetCode
							                                                    ,Tch_EntrySetGroup
							                                                    ,Tch_PayCycle
							                                                    ,Tch_PostDate
                                                                                ,Tch_PostFlag
							                                                    ,Tch_PayrollPeriod
							                                                    ,Tch_RecordStatus
							                                                    ,Usr_Login
							                                                    ,Ludatetime																
							                                                    FROM T_CostHdr
							                                                    WHERE Tch_PayCycle = @CURPAYPERIOD

		                                                                        DELETE FROM T_CostDtl
		                                                                        FROM T_CostDtl
		                                                                        INNER JOIN T_CostHdr 
                                                                                ON Tch_ControlNo = Tcd_ControlNo 
			                                                                        AND Tch_PayCycle = @CURPAYPERIOD

		                                                                        DELETE FROM  T_CostHdr
		                                                                        WHERE Tch_PayCycle = @CURPAYPERIOD";

            #endregion

            #endregion

            #region Common Queries
            public const string getGroupPremiums = @"SELECT * FROM DBO.NumericValue('NIGHTPREM')
                                                    SELECT * FROM GETGROUPPREMIUMS('REG', 'false', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('REST', 'true', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('HOL', 'false', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('SPL', 'false', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('PSD', 'false', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('COMP', 'false', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('HOL', 'true', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('SPL', 'true', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('COMP', 'true', @PremiumGroup)
                                                    SELECT * FROM GETGROUPPREMIUMS('PSD', 'true', @PremiumGroup)";
            #endregion
        }
        #endregion

        #region messages

        public class Messages
        {
            public const string msgErrInvalidVersion = "There is a new version that you skipped. Please contact your IT Team for assistance.";
            public const string msgInfoInputUserCode = "Please input your UserCode.";
            public const string msgInfoInputPassword = "Please input your Password.";
            public const string msgDeleteMessage = "You are about to delete this record.\r\nOnce you click Yes, you cannot recover it anymore.\r\nAre you sure you want to delete the selected record?\r\n";
            public const string msgDeleteMessageHeader = "Delete Confirmation.";
            public const string msgHasChangesDuringFormClosing = "There are some changes that are not committed to the database.\r\nClosing this form is not yet allowed.\r\n";
            public const string msgHasChangesDuringFormClosingHeader = "Form Closing Information.";
            public const string msgCodeExist = "Code already exists";
            public const string cancelledGeneric = "Generic record cannot be cancelled since data is used by stock master";
            public const string msgFailedLogOut = "Some forms are still in an Edit/Add mode.\nCannot continue to log-out.";
            public const string msgGenericMasterCode = "Invalid Generic Code";
            public const string msgDescRequired = "Description required";
            public const string msgStatusInf = "Please select status.";
            public const string msgErrInvalidUserCredentials = "The credentials you supplied are invalid.";

            //Payroll Calculation
            public const string msgProceed = "Proceed with processing?";
        }

        #endregion//messages

        #region Misc

        public class Misc
        {
            public const string LoginData = "LoginInfo";
            public const int PasswordLength = 15;
            public const int BOMDepthLevel = 11;
            public const string MDIStatusUser = "User: ";
            public const string SPODummySupplier = "V999999999";
            public const string ErrorLogPathSPOUploader = @"C:\";
            public const string newline = @"";
        }

        #endregion

        #region Data Format

        public class DataFormat
        {
            public const string NumericNoDecimal = "#,##0";
            public const string NumericQty = "#,##0.000";
            public const string NumericAmount = "#,##0.000000";
            public const string NumericTotal = "#,##0.00";
            public const string Date = "MM/dd/yyyy";
            public const string DateTime = "MM/dd/yyyy hh:mm tt";
        }
        #endregion

        public class TableColumnNameValue
        {
            private string ColumnName;
            private string ColumnValue;

            public TableColumnNameValue()
            {
                ColumnValue = "";
                ColumnValue = "";
            }

            public TableColumnNameValue(string ColumnName, string ColumnValue)
            {
                this.ColumnName = ColumnName;
                this.ColumnValue = ColumnValue;
            }

            public string ColumnNameGet { get { return this.ColumnName; } }
            public string ColumnValueGet { get { return this.ColumnValue; } }
        }
    }
}
